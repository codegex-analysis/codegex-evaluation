[
  {
    "sha": "f8a46c005d7c7b0eb668af0658808d90a7fe60d3",
    "filename": "src/main/java/org/isf/hospital/gui/HospitalBrowser.java",
    "status": "modified",
    "additions": 92,
    "deletions": 107,
    "changes": 199,
    "blob_url": "https://github.com/informatici/openhospital-gui/blob/cdcc23f3a7dfda9bea60e13889d35a78b5e31670/src/main/java/org/isf/hospital/gui/HospitalBrowser.java",
    "raw_url": "https://github.com/informatici/openhospital-gui/raw/cdcc23f3a7dfda9bea60e13889d35a78b5e31670/src/main/java/org/isf/hospital/gui/HospitalBrowser.java",
    "contents_url": "https://api.github.com/repos/informatici/openhospital-gui/contents/src/main/java/org/isf/hospital/gui/HospitalBrowser.java?ref=cdcc23f3a7dfda9bea60e13889d35a78b5e31670",
    "patch": "@@ -23,6 +23,7 @@\n \n import java.awt.BorderLayout;\n import java.awt.Dimension;\n+import java.awt.FlowLayout;\n import java.awt.Toolkit;\n import java.awt.event.ActionEvent;\n import java.awt.event.ActionListener;\n@@ -34,7 +35,6 @@\n import javax.swing.JOptionPane;\n import javax.swing.JPanel;\n import javax.swing.JTextField;\n-import javax.swing.SwingUtilities;\n \n import org.isf.generaldata.MessageBundle;\n import org.isf.hospital.manager.HospitalBrowsingManager;\n@@ -62,24 +62,24 @@\n \tprivate JPanel jButtonPanel=null;\n \tprivate JPanel jDataPanel=null;\n \tprivate JPanel jNamePanel=null;\n-\tprivate JPanel jAddPanel=null;\n+\tprivate JPanel jAddressPanel=null;\n \tprivate JPanel jCityPanel=null;\n \tprivate JPanel jTelePanel=null;\n \tprivate JPanel jFaxPanel=null;\n \tprivate JPanel jEmailPanel=null;\t\n \tprivate JPanel jCurrencyCodPanel=null;\t\n \tprivate JTextField nameJTextField;\n-\tprivate JTextField addJTextField;\n+\tprivate JTextField addressJTextField;\n \tprivate JTextField cityJTextField;\n \tprivate JTextField teleJTextField;\n \tprivate JTextField faxJTextField;\n \tprivate JTextField emailJTextField;\n \tprivate JTextField currencyCodJTextField;\n \tprivate HospitalBrowsingManager manager;\n \tprivate Hospital hospital = null;\n-\tprivate JButton EditJButton;\n-\tprivate JButton UpdateJButton;\n-\tprivate JButton ExitJButton;\n+\tprivate JButton editJButton;\n+\tprivate JButton updateJButton;\n+\tprivate JButton exitJButton;\n \t\n \t\n \tpublic HospitalBrowser(){\n@@ -121,7 +121,7 @@ public JPanel getJDataPanel() {\n \t\t\tjDataPanel= new JPanel();\n \t\t\tjDataPanel.setLayout(new BoxLayout(getJDataPanel(),BoxLayout.Y_AXIS));\n \t\t\tjDataPanel.add(getJNamePanel());\n-\t\t\tjDataPanel.add(getJAddPanel());\n+\t\t\tjDataPanel.add(getJAddressPanel());\n \t\t\tjDataPanel.add(getJCityPanel(),null);\n \t\t\tjDataPanel.add(getJTelePanel(),null);\n \t\t\tjDataPanel.add(getJFaxPanel(),null);\n@@ -133,36 +133,36 @@ public JPanel getJDataPanel() {\n \t\n \tpublic JPanel getJNamePanel() {\n \t\tif (jNamePanel==null){\n-\t\t\tjNamePanel= new JPanel();\n-\t\t\tJLabel nameJLabel = new JLabel(\"              \"+MessageBundle.getMessage(\"angal.hospital.name\")+\": \");\n+\t\t\tjNamePanel= new JPanel(new FlowLayout(FlowLayout.RIGHT));\n+\t\t\tJLabel nameJLabel = new JLabel(MessageBundle.getMessage(\"angal.hospital.name\")+\": \");\n \t\t\tjNamePanel.add(nameJLabel);\n-\t\t\tnameJTextField = new JTextField(14);\n+\t\t\tnameJTextField = new JTextField(25);\n \t\t\tnameJTextField.setEditable(false);\t\t\t\n \t\t\tjNamePanel.add(nameJTextField);\n \t\t\tnameJTextField.setText(hospital.getDescription());\t\t\t\n \t\t}\n \t\treturn jNamePanel;\n \t}\n \t\n-\tpublic JPanel getJAddPanel() {\n-\t\tif (jAddPanel==null){\n-\t\t\tjAddPanel= new JPanel();\n-\t\t\tJLabel addJLabel = new JLabel(\"          \"+MessageBundle.getMessage(\"angal.hospital.address\")+\": \");\n-\t\t\tjAddPanel.add(addJLabel);\n-\t\t\taddJTextField = new JTextField(14);\n-\t\t\taddJTextField.setEditable(false);\t\t\t\n-\t\t\tjAddPanel.add(addJTextField);\n-\t\t\taddJTextField.setText(hospital.getAddress());\n+\tpublic JPanel getJAddressPanel() {\n+\t\tif (jAddressPanel==null){\n+\t\t\tjAddressPanel= new JPanel(new FlowLayout(FlowLayout.RIGHT));\n+\t\t\tJLabel addJLabel = new JLabel(MessageBundle.getMessage(\"angal.hospital.address\")+\": \");\n+\t\t\tjAddressPanel.add(addJLabel);\n+\t\t\taddressJTextField = new JTextField(25);\n+\t\t\taddressJTextField.setEditable(false);\n+\t\t\tjAddressPanel.add(addressJTextField);\n+\t\t\taddressJTextField.setText(hospital.getAddress());\n \t\t}\n-\t\treturn jAddPanel;\n+\t\treturn jAddressPanel;\n \t}\n \t\n \tpublic JPanel getJCityPanel() {\n \t\tif (jCityPanel==null){\n-\t\t\tjCityPanel= new JPanel();\n-\t\t\tJLabel cityJLabel = new JLabel(\"                  \"+MessageBundle.getMessage(\"angal.hospital.city\")+\": \");\n+\t\t\tjCityPanel= new JPanel(new FlowLayout(FlowLayout.RIGHT));\n+\t\t\tJLabel cityJLabel = new JLabel(MessageBundle.getMessage(\"angal.hospital.city\")+\": \");\n \t\t\tjCityPanel.add(cityJLabel);\n-\t\t\tcityJTextField = new JTextField(14);\n+\t\t\tcityJTextField = new JTextField(25);\n \t\t\tcityJTextField.setEditable(false);\n \t\t\tcityJTextField.setText(hospital.getCity());\n \t\t\tjCityPanel.add(cityJTextField);\n@@ -171,10 +171,10 @@ public JPanel getJCityPanel() {\n \t}\n \tpublic JPanel getJTelePanel() {\n \t\tif (jTelePanel==null){\n-\t\t\tjTelePanel= new JPanel();\n-\t\t\tJLabel teleJLabel = new JLabel(\"      \"+ MessageBundle.getMessage(\"angal.hospital.telephone\")+\": \");\n+\t\t\tjTelePanel= new JPanel(new FlowLayout(FlowLayout.RIGHT));\n+\t\t\tJLabel teleJLabel = new JLabel(MessageBundle.getMessage(\"angal.hospital.telephone\")+\": \");\n \t\t\tjTelePanel.add(teleJLabel);\n-\t\t\tteleJTextField = new JTextField(14);\n+\t\t\tteleJTextField = new JTextField(25);\n \t\t\tteleJTextField.setEditable(false);\n \t\t\tteleJTextField.setText(hospital.getTelephone());\n \t\t\tjTelePanel.add(teleJTextField);\n@@ -183,10 +183,10 @@ public JPanel getJTelePanel() {\n \t}\n \tpublic JPanel getJFaxPanel() {\n \t\tif (jFaxPanel==null){\n-\t\t\tjFaxPanel= new JPanel();\n-\t\t\tJLabel faxJLabel = new JLabel(\"    \"+MessageBundle.getMessage(\"angal.hospital.faxnumber\")+\": \");\n+\t\t\tjFaxPanel= new JPanel(new FlowLayout(FlowLayout.RIGHT));\n+\t\t\tJLabel faxJLabel = new JLabel(MessageBundle.getMessage(\"angal.hospital.faxnumber\")+\": \");\n \t\t\tjFaxPanel.add(faxJLabel);\n-\t\t\tfaxJTextField = new JTextField(14);\n+\t\t\tfaxJTextField = new JTextField(25);\n \t\t\tfaxJTextField.setEditable(false);\n \t\t\tfaxJTextField.setText(hospital.getFax());\n \t\t\tjFaxPanel.add(faxJTextField);\n@@ -195,10 +195,10 @@ public JPanel getJFaxPanel() {\n \t}\n \tpublic JPanel getJEmailPanel() {\n \t\tif (jEmailPanel==null){\n-\t\t\tjEmailPanel= new JPanel();\n-\t\t\tJLabel emailJLabel = new JLabel(\"\"+ MessageBundle.getMessage(\"angal.hospital.emailaddress\")+\": \");\n+\t\t\tjEmailPanel= new JPanel(new FlowLayout(FlowLayout.RIGHT));\n+\t\t\tJLabel emailJLabel = new JLabel(MessageBundle.getMessage(\"angal.hospital.emailaddress\")+\": \");\n \t\t\tjEmailPanel.add(emailJLabel);\n-\t\t\temailJTextField = new JTextField(14);\n+\t\t\temailJTextField = new JTextField(25);\n \t\t\temailJTextField.setEditable(false);\n \t\t\temailJTextField.setText(hospital.getEmail());\n \t\t\tjEmailPanel.add(emailJTextField);\n@@ -207,34 +207,33 @@ public JPanel getJEmailPanel() {\n \t}\t\n \tpublic JPanel getJCurrencyCodPanel() {\n \t\tif (jCurrencyCodPanel==null){\n-\t\t\tjCurrencyCodPanel= new JPanel();\n-\t\t\tJLabel currencyCodJLabel = new JLabel(\" \"+ MessageBundle.getMessage(\"angal.hospital.currencycod\")+\": \");\n+\t\t\tjCurrencyCodPanel= new JPanel(new FlowLayout(FlowLayout.RIGHT));\n+\t\t\tJLabel currencyCodJLabel = new JLabel(MessageBundle.getMessage(\"angal.hospital.currencycod\")+\": \");\n \t\t\tjCurrencyCodPanel.add(currencyCodJLabel);\n-\t\t\tcurrencyCodJTextField = new VoLimitedTextField(3,14);\n+\t\t\tcurrencyCodJTextField = new VoLimitedTextField(3,25);\n \t\t\tcurrencyCodJTextField.setEditable(false);\n \t\t\tcurrencyCodJTextField.setText(hospital.getCurrencyCod());\n \t\t\tjCurrencyCodPanel.add(currencyCodJTextField);\n \t\t}\n \t\treturn jCurrencyCodPanel;\n \t}\n \t\n-\tprivate boolean isModified(){\n-\t\t\n-\t\tboolean change=false;\n-\t\t\n-\t\tif (!nameJTextField.getText().equalsIgnoreCase(hospital.getDescription()) ||\n-\t\t\t\t!addJTextField.getText().equalsIgnoreCase(hospital.getAddress())||\n-\t\t\t\t!cityJTextField.getText().equalsIgnoreCase(hospital.getCity()) ||\n-\t\t\t\t!teleJTextField.getText().equalsIgnoreCase(hospital.getTelephone()) ||\n-\t\t\t\t!faxJTextField.getText().equalsIgnoreCase(hospital.getFax()) ||\n-\t\t\t\t!emailJTextField.getText().equalsIgnoreCase(hospital.getEmail()) ||\n-\t\t\t\t!currencyCodJTextField.getText().equalsIgnoreCase(hospital.getCurrencyCod()))\n-\t\t{\n-\t\t\tchange=true;\n+\tprivate boolean isModified() {\n+\n+\t\tboolean change = false;\n+\n+\t\tif (!nameJTextField.getText().equalsIgnoreCase(hospital.getDescription()) \n+\t\t\t\t\t\t|| !addressJTextField.getText().equalsIgnoreCase(hospital.getAddress())\n+\t\t\t\t\t\t|| !cityJTextField.getText().equalsIgnoreCase(hospital.getCity())\n+\t\t\t\t\t\t|| !teleJTextField.getText().equalsIgnoreCase(hospital.getTelephone() == null ? \"\" : hospital.getTelephone())\n+\t\t\t\t\t\t|| !faxJTextField.getText().equalsIgnoreCase(hospital.getFax() == null ? \"\" : hospital.getFax())\n+\t\t\t\t\t\t|| !emailJTextField.getText().equalsIgnoreCase(hospital.getEmail() == null ? \"\" : hospital.getEmail())\n+\t\t\t\t\t\t|| !currencyCodJTextField.getText().equalsIgnoreCase(hospital.getCurrencyCod() == null ? \"\" : hospital.getCurrencyCod())) {\n+\t\t\tchange = true;\n \t\t}\n-\t\t\n+\n \t\treturn change;\n-\t}\t\n+\t}\n \t\n \tpublic void saveConfirm() {\n \t\tint n = JOptionPane.showConfirmDialog(\n@@ -244,30 +243,22 @@ public void saveConfirm() {\n \t\t\t\tJOptionPane.YES_NO_OPTION);\n \t\t\n \t\tif ((n == JOptionPane.YES_OPTION)){\n-\t\t\thospital.setDescription(nameJTextField.getText());\n-\t\t\thospital.setAddress(addJTextField.getText());\n-\t\t\thospital.setCity(cityJTextField.getText());\n-\t\t\thospital.setTelephone(teleJTextField.getText());\n-\t\t\thospital.setFax(faxJTextField.getText());\n-\t\t\thospital.setEmail(emailJTextField.getText());\n-\t\t\thospital.setCurrencyCod(currencyCodJTextField.getText());\n-\t\t\t\n-\t\t\tupdateHospital(manager, hospital);\n+\t\t\tupdateHospitalEntity();\n \t\t}\n \t}\n-\t\n+\n \tpublic JPanel getJButtonPanel() {\n \t\tif (jButtonPanel==null){\n \t\t\tjButtonPanel= new JPanel();\n-\t\t\tEditJButton = new JButton(MessageBundle.getMessage(\"angal.common.edit\"));\n-\t\t\tEditJButton.setMnemonic(KeyEvent.VK_E);\n-\t\t\tUpdateJButton = new JButton(MessageBundle.getMessage(\"angal.hospital.update\"));\n-\t\t\tUpdateJButton.setMnemonic(KeyEvent.VK_U);\n-\t\t\tExitJButton = new JButton(MessageBundle.getMessage(\"angal.common.close\"));\n-\t\t\tExitJButton.setMnemonic(KeyEvent.VK_C);\n-\t\t\tUpdateJButton.setEnabled(false);\n+\t\t\teditJButton = new JButton(MessageBundle.getMessage(\"angal.common.edit\"));\n+\t\t\teditJButton.setMnemonic(KeyEvent.VK_E);\n+\t\t\tupdateJButton = new JButton(MessageBundle.getMessage(\"angal.hospital.update\"));\n+\t\t\tupdateJButton.setMnemonic(KeyEvent.VK_U);\n+\t\t\texitJButton = new JButton(MessageBundle.getMessage(\"angal.common.close\"));\n+\t\t\texitJButton.setMnemonic(KeyEvent.VK_C);\n+\t\t\tupdateJButton.setEnabled(false);\n \t\t\t\n-\t\t\tExitJButton.addActionListener(new ActionListener() {\n+\t\t\texitJButton.addActionListener(new ActionListener() {\n \t\t\t\tpublic void actionPerformed(ActionEvent arg0) {\n \t\t\t\t\tif (isModified())\n \t\t\t\t\t{\t\t\t\t\t\t\n@@ -277,56 +268,50 @@ public void actionPerformed(ActionEvent arg0) {\n \t\t\t\t\tdispose();\n \t\t\t\t}\n \t\t\t});\n-\t\t\tEditJButton.addActionListener(new ActionListener() {\n+\t\t\teditJButton.addActionListener(new ActionListener() {\n \t\t\t\tpublic void actionPerformed(ActionEvent arg0) {\n-\t\t\t\t\tnameJTextField.setEditable(true);\n-\t\t\t\t\taddJTextField.setEditable(true);\n-\t\t\t\t\tcityJTextField.setEditable(true);\n-\t\t\t\t\tteleJTextField.setEditable(true);\n-\t\t\t\t\tfaxJTextField.setEditable(true);\n-\t\t\t\t\temailJTextField.setEditable(true);\n-\t\t\t\t\tcurrencyCodJTextField.setEditable(true);\n-\t\t\t\t\tUpdateJButton.setEnabled(true);\n-\t\t\t\t\tEditJButton.setEnabled(false);\n-\t\t\t\t\tSwingUtilities.invokeLater(new Runnable() { \n-\t\t\t\t\t\tpublic void run() { \n-\t\t\t\t\t\t\tnameJTextField.requestFocus(); \n-\t\t\t\t\t\t} \n-\t\t\t\t\t} );\n+\t\t\t\t\tsetFieldsForEditing(true);\n \t\t\t\t}\n \t\t\t});\n-\t\t\tUpdateJButton.addActionListener(new ActionListener() {\n+\t\t\tupdateJButton.addActionListener(new ActionListener() {\n \t\t\t\tpublic void actionPerformed(ActionEvent arg0) {\n-\t\t\t\t\tnameJTextField.setEditable(false);\n-\t\t\t\t\taddJTextField.setEditable(false);\n-\t\t\t\t\tcityJTextField.setEditable(false);\n-\t\t\t\t\tteleJTextField.setEditable(false);\n-\t\t\t\t\tfaxJTextField.setEditable(false);\n-\t\t\t\t\temailJTextField.setEditable(false);\n-\t\t\t\t\tcurrencyCodJTextField.setEditable(false);\n-\t\t\t\t\thospital.setDescription(nameJTextField.getText());\n-\t\t\t\t\thospital.setAddress(addJTextField.getText());\n-\t\t\t\t\thospital.setCity(cityJTextField.getText());\n-\t\t\t\t\thospital.setTelephone(teleJTextField.getText());\n-\t\t\t\t\thospital.setFax(faxJTextField.getText());\n-\t\t\t\t\thospital.setEmail(emailJTextField.getText());\n-\t\t\t\t\thospital.setCurrencyCod(currencyCodJTextField.getText());\n-\t\t\t\t\t\n-\t\t\t\t\tupdateHospital(manager, hospital);\n-\t\t\t\t\t\n-\t\t\t\t\tUpdateJButton.setEnabled(false);\n-\t\t\t\t\tEditJButton.setEnabled(true);\n+\t\t\t\t\tsetFieldsForEditing(false);\n+\t\t\t\t\tupdateHospitalEntity();\n \t\t\t\t}\n \t\t\t\t\n \t\t\t});\n-\t\t\tjButtonPanel.add(EditJButton);\n-\t\t\tjButtonPanel.add(UpdateJButton);\n-\t\t\tjButtonPanel.add(ExitJButton);\n+\t\t\tjButtonPanel.add(editJButton);\n+\t\t\tjButtonPanel.add(updateJButton);\n+\t\t\tjButtonPanel.add(exitJButton);\n \t\t}\n \t\treturn jButtonPanel;\n \t}\n \t\n-\tprivate void updateHospital(HospitalBrowsingManager manager, Hospital hospital) {\n+\tprivate void setFieldsForEditing(boolean enabled) {\n+\t\tnameJTextField.setEditable(enabled);\n+\t\taddressJTextField.setEditable(enabled);\n+\t\tcityJTextField.setEditable(enabled);\n+\t\tteleJTextField.setEditable(enabled);\n+\t\tfaxJTextField.setEditable(enabled);\n+\t\temailJTextField.setEditable(enabled);\n+\t\tcurrencyCodJTextField.setEditable(enabled);\n+\t\tupdateJButton.setEnabled(enabled);\n+\t\teditJButton.setEnabled(!enabled);\n+\t\tnameJTextField.requestFocus(); \n+\t}\n+\t\n+\tprivate void setHospitalEntity() {\n+\t\thospital.setDescription(nameJTextField.getText());\n+\t\thospital.setAddress(addressJTextField.getText());\n+\t\thospital.setCity(cityJTextField.getText());\n+\t\thospital.setTelephone(teleJTextField.getText().equals(\"\") ? null : teleJTextField.getText());\n+\t\thospital.setFax(faxJTextField.getText().equals(\"\") ? null : faxJTextField.getText());\n+\t\thospital.setEmail(emailJTextField.getText().equals(\"\") ? null : emailJTextField.getText());\n+\t\thospital.setCurrencyCod(currencyCodJTextField.getText().equals(\"\") ? null : currencyCodJTextField.getText());\n+\t}\n+\t\n+\tprivate void updateHospitalEntity() {\n+\t\tsetHospitalEntity();\n \t\ttry {\n \t\t\tthis.hospital = manager.updateHospital(hospital);\n \t\t} catch (OHServiceException e) {"
  }
]

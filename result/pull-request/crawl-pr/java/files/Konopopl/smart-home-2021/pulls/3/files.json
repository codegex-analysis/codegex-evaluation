[
  {
    "sha": "06ff46217e739fec1df2aff75330a399d7096352",
    "filename": "hometask_2/src/main/java/ru/sbt/mipt/oop/Action.java",
    "status": "added",
    "additions": 5,
    "deletions": 0,
    "changes": 5,
    "blob_url": "https://github.com/Konopopl/smart-home-2021/blob/173cfd9920468ee207b921d1d3a6e7d369cb957f/hometask_2/src/main/java/ru/sbt/mipt/oop/Action.java",
    "raw_url": "https://github.com/Konopopl/smart-home-2021/raw/173cfd9920468ee207b921d1d3a6e7d369cb957f/hometask_2/src/main/java/ru/sbt/mipt/oop/Action.java",
    "contents_url": "https://api.github.com/repos/Konopopl/smart-home-2021/contents/hometask_2/src/main/java/ru/sbt/mipt/oop/Action.java?ref=173cfd9920468ee207b921d1d3a6e7d369cb957f",
    "patch": "@@ -0,0 +1,5 @@\n+package ru.sbt.mipt.oop;\n+\n+public interface Action {\n+    void accept(Object object);\n+}"
  },
  {
    "sha": "30e892b747f4dc0d0fb531418b2526e9cf9cedcd",
    "filename": "hometask_2/src/main/java/ru/sbt/mipt/oop/Actionable.java",
    "status": "added",
    "additions": 5,
    "deletions": 0,
    "changes": 5,
    "blob_url": "https://github.com/Konopopl/smart-home-2021/blob/173cfd9920468ee207b921d1d3a6e7d369cb957f/hometask_2/src/main/java/ru/sbt/mipt/oop/Actionable.java",
    "raw_url": "https://github.com/Konopopl/smart-home-2021/raw/173cfd9920468ee207b921d1d3a6e7d369cb957f/hometask_2/src/main/java/ru/sbt/mipt/oop/Actionable.java",
    "contents_url": "https://api.github.com/repos/Konopopl/smart-home-2021/contents/hometask_2/src/main/java/ru/sbt/mipt/oop/Actionable.java?ref=173cfd9920468ee207b921d1d3a6e7d369cb957f",
    "patch": "@@ -0,0 +1,5 @@\n+package ru.sbt.mipt.oop;\n+\n+public interface Actionable {\n+    void execute(Action action);\n+}"
  },
  {
    "sha": "feeebd5a2854afba9cad2bb4a86abef79eac51f3",
    "filename": "hometask_2/src/main/java/ru/sbt/mipt/oop/Application.java",
    "status": "renamed",
    "additions": 3,
    "deletions": 4,
    "changes": 7,
    "blob_url": "https://github.com/Konopopl/smart-home-2021/blob/173cfd9920468ee207b921d1d3a6e7d369cb957f/hometask_2/src/main/java/ru/sbt/mipt/oop/Application.java",
    "raw_url": "https://github.com/Konopopl/smart-home-2021/raw/173cfd9920468ee207b921d1d3a6e7d369cb957f/hometask_2/src/main/java/ru/sbt/mipt/oop/Application.java",
    "contents_url": "https://api.github.com/repos/Konopopl/smart-home-2021/contents/hometask_2/src/main/java/ru/sbt/mipt/oop/Application.java?ref=173cfd9920468ee207b921d1d3a6e7d369cb957f",
    "patch": "@@ -1,15 +1,14 @@\n package ru.sbt.mipt.oop;\n \n-import ru.sbt.mipt.oop.commandsender.FakeCommandSender;\n+import java.util.Arrays;\n+\n import ru.sbt.mipt.oop.eventhandler.DoorEventHandler;\n import ru.sbt.mipt.oop.eventhandler.HallDoorEventHandler;\n import ru.sbt.mipt.oop.eventhandler.LightEventHandler;\n import ru.sbt.mipt.oop.eventprovider.RandomSensorEventProvider;\n import ru.sbt.mipt.oop.loader.SmartHomeJsonFileLoader;\n import ru.sbt.mipt.oop.loader.SmartHomeLoader;\n \n-import java.util.Arrays;\n-\n public class Application {\n     private final SmartHomeLoader smartHomeLoader;\n     private final EventCycleRunner eventCycleRunner;\n@@ -28,7 +27,7 @@ public static void main(String... args) {\n                         Arrays.asList(\n                                 new LightEventHandler(),\n                                 new DoorEventHandler(),\n-                                new HallDoorEventHandler(new FakeCommandSender())\n+                                new HallDoorEventHandler()\n                         )\n                 )\n         ).run();",
    "previous_filename": "src/main/java/ru/sbt/mipt/oop/Application.java"
  },
  {
    "sha": "6004a2e26ac64eb5e5bd3c5bbf015e54cd4a122b",
    "filename": "hometask_2/src/main/java/ru/sbt/mipt/oop/EventCycleRunner.java",
    "status": "renamed",
    "additions": 0,
    "deletions": 0,
    "changes": 0,
    "blob_url": "https://github.com/Konopopl/smart-home-2021/blob/173cfd9920468ee207b921d1d3a6e7d369cb957f/hometask_2/src/main/java/ru/sbt/mipt/oop/EventCycleRunner.java",
    "raw_url": "https://github.com/Konopopl/smart-home-2021/raw/173cfd9920468ee207b921d1d3a6e7d369cb957f/hometask_2/src/main/java/ru/sbt/mipt/oop/EventCycleRunner.java",
    "contents_url": "https://api.github.com/repos/Konopopl/smart-home-2021/contents/hometask_2/src/main/java/ru/sbt/mipt/oop/EventCycleRunner.java?ref=173cfd9920468ee207b921d1d3a6e7d369cb957f",
    "previous_filename": "src/main/java/ru/sbt/mipt/oop/EventCycleRunner.java"
  },
  {
    "sha": "b1ec1c53c29cebb28d27f4325fa47b27e3ae45ea",
    "filename": "hometask_2/src/main/java/ru/sbt/mipt/oop/HomeBuilder.java",
    "status": "renamed",
    "additions": 4,
    "deletions": 4,
    "changes": 8,
    "blob_url": "https://github.com/Konopopl/smart-home-2021/blob/173cfd9920468ee207b921d1d3a6e7d369cb957f/hometask_2/src/main/java/ru/sbt/mipt/oop/HomeBuilder.java",
    "raw_url": "https://github.com/Konopopl/smart-home-2021/raw/173cfd9920468ee207b921d1d3a6e7d369cb957f/hometask_2/src/main/java/ru/sbt/mipt/oop/HomeBuilder.java",
    "contents_url": "https://api.github.com/repos/Konopopl/smart-home-2021/contents/hometask_2/src/main/java/ru/sbt/mipt/oop/HomeBuilder.java?ref=173cfd9920468ee207b921d1d3a6e7d369cb957f",
    "patch": "@@ -21,16 +21,16 @@ public static void main(String[] args) throws IOException {\n \n     private static SmartHome buildSmartHome() {\n         Room kitchen = new Room(Arrays.asList(new Light(\"1\", false), new Light(\"2\", true)),\n-                Arrays.asList(new Door(false, \"1\")),\n+                Arrays.asList(new Door(\"1\", false)),\n                 \"kitchen\");\n         Room bathroom = new Room(Arrays.asList(new Light(\"3\", true)),\n-                Arrays.asList(new Door(false, \"2\")),\n+                Arrays.asList(new Door(\"2\", false)),\n                 \"bathroom\");\n         Room bedroom = new Room(Arrays.asList(new Light(\"4\", false), new Light(\"5\", false), new Light(\"6\", false)),\n-                Arrays.asList(new Door(true, \"3\")),\n+                Arrays.asList(new Door(\"3\", true)),\n                 \"bedroom\");\n         Room hall = new Room(Arrays.asList(new Light(\"7\", false), new Light(\"8\", false), new Light(\"9\", false)),\n-                Arrays.asList(new Door(false, \"4\")),\n+                Arrays.asList(new Door(\"4\", false)),\n                 \"hall\");\n         return new SmartHome(Arrays.asList(kitchen, bathroom, bedroom, hall));\n     }",
    "previous_filename": "src/main/java/ru/sbt/mipt/oop/HomeBuilder.java"
  },
  {
    "sha": "dba4e50eaa88a02fac60d7377566041e4483a454",
    "filename": "hometask_2/src/main/java/ru/sbt/mipt/oop/SensorCommand.java",
    "status": "renamed",
    "additions": 0,
    "deletions": 0,
    "changes": 0,
    "blob_url": "https://github.com/Konopopl/smart-home-2021/blob/173cfd9920468ee207b921d1d3a6e7d369cb957f/hometask_2/src/main/java/ru/sbt/mipt/oop/SensorCommand.java",
    "raw_url": "https://github.com/Konopopl/smart-home-2021/raw/173cfd9920468ee207b921d1d3a6e7d369cb957f/hometask_2/src/main/java/ru/sbt/mipt/oop/SensorCommand.java",
    "contents_url": "https://api.github.com/repos/Konopopl/smart-home-2021/contents/hometask_2/src/main/java/ru/sbt/mipt/oop/SensorCommand.java?ref=173cfd9920468ee207b921d1d3a6e7d369cb957f",
    "previous_filename": "src/main/java/ru/sbt/mipt/oop/SensorCommand.java"
  },
  {
    "sha": "203e0ee3101c045fd782d05e484dd40e58d6d346",
    "filename": "hometask_2/src/main/java/ru/sbt/mipt/oop/SensorEvent.java",
    "status": "renamed",
    "additions": 0,
    "deletions": 0,
    "changes": 0,
    "blob_url": "https://github.com/Konopopl/smart-home-2021/blob/173cfd9920468ee207b921d1d3a6e7d369cb957f/hometask_2/src/main/java/ru/sbt/mipt/oop/SensorEvent.java",
    "raw_url": "https://github.com/Konopopl/smart-home-2021/raw/173cfd9920468ee207b921d1d3a6e7d369cb957f/hometask_2/src/main/java/ru/sbt/mipt/oop/SensorEvent.java",
    "contents_url": "https://api.github.com/repos/Konopopl/smart-home-2021/contents/hometask_2/src/main/java/ru/sbt/mipt/oop/SensorEvent.java?ref=173cfd9920468ee207b921d1d3a6e7d369cb957f",
    "previous_filename": "src/main/java/ru/sbt/mipt/oop/SensorEvent.java"
  },
  {
    "sha": "2f2f1701307fcf5211e364011eed9a8ddf98ee7d",
    "filename": "hometask_2/src/main/java/ru/sbt/mipt/oop/SmartHome.java",
    "status": "renamed",
    "additions": 8,
    "deletions": 5,
    "changes": 13,
    "blob_url": "https://github.com/Konopopl/smart-home-2021/blob/173cfd9920468ee207b921d1d3a6e7d369cb957f/hometask_2/src/main/java/ru/sbt/mipt/oop/SmartHome.java",
    "raw_url": "https://github.com/Konopopl/smart-home-2021/raw/173cfd9920468ee207b921d1d3a6e7d369cb957f/hometask_2/src/main/java/ru/sbt/mipt/oop/SmartHome.java",
    "contents_url": "https://api.github.com/repos/Konopopl/smart-home-2021/contents/hometask_2/src/main/java/ru/sbt/mipt/oop/SmartHome.java?ref=173cfd9920468ee207b921d1d3a6e7d369cb957f",
    "patch": "@@ -1,11 +1,11 @@\n package ru.sbt.mipt.oop;\n \n-import ru.sbt.mipt.oop.component.Room;\n-\n import java.util.ArrayList;\n import java.util.Collection;\n \n-public class SmartHome {\n+import ru.sbt.mipt.oop.component.Room;\n+\n+public class SmartHome implements Actionable {\n     Collection<Room> rooms;\n \n     public SmartHome() {\n@@ -20,7 +20,10 @@ public void addRoom(Room room) {\n         rooms.add(room);\n     }\n \n-    public Collection<Room> getRooms() {\n-        return rooms;\n+    @Override\n+    public void execute(Action action) {\n+        action.accept(this);\n+\n+        rooms.forEach(room -> room.execute(action));\n     }\n }",
    "previous_filename": "src/main/java/ru/sbt/mipt/oop/SmartHome.java"
  },
  {
    "sha": "9ef4cf597e141aa4673e89e501ecfb5bac580c81",
    "filename": "hometask_2/src/main/java/ru/sbt/mipt/oop/commandsender/CommandSender.java",
    "status": "renamed",
    "additions": 0,
    "deletions": 0,
    "changes": 0,
    "blob_url": "https://github.com/Konopopl/smart-home-2021/blob/173cfd9920468ee207b921d1d3a6e7d369cb957f/hometask_2/src/main/java/ru/sbt/mipt/oop/commandsender/CommandSender.java",
    "raw_url": "https://github.com/Konopopl/smart-home-2021/raw/173cfd9920468ee207b921d1d3a6e7d369cb957f/hometask_2/src/main/java/ru/sbt/mipt/oop/commandsender/CommandSender.java",
    "contents_url": "https://api.github.com/repos/Konopopl/smart-home-2021/contents/hometask_2/src/main/java/ru/sbt/mipt/oop/commandsender/CommandSender.java?ref=173cfd9920468ee207b921d1d3a6e7d369cb957f",
    "previous_filename": "src/main/java/ru/sbt/mipt/oop/commandsender/CommandSender.java"
  },
  {
    "sha": "4c01e41efede3c249935833c9fd425b7a3d3ade1",
    "filename": "hometask_2/src/main/java/ru/sbt/mipt/oop/commandsender/FakeCommandSender.java",
    "status": "renamed",
    "additions": 0,
    "deletions": 0,
    "changes": 0,
    "blob_url": "https://github.com/Konopopl/smart-home-2021/blob/173cfd9920468ee207b921d1d3a6e7d369cb957f/hometask_2/src/main/java/ru/sbt/mipt/oop/commandsender/FakeCommandSender.java",
    "raw_url": "https://github.com/Konopopl/smart-home-2021/raw/173cfd9920468ee207b921d1d3a6e7d369cb957f/hometask_2/src/main/java/ru/sbt/mipt/oop/commandsender/FakeCommandSender.java",
    "contents_url": "https://api.github.com/repos/Konopopl/smart-home-2021/contents/hometask_2/src/main/java/ru/sbt/mipt/oop/commandsender/FakeCommandSender.java?ref=173cfd9920468ee207b921d1d3a6e7d369cb957f",
    "previous_filename": "src/main/java/ru/sbt/mipt/oop/commandsender/FakeCommandSender.java"
  },
  {
    "sha": "274b5d591ff1caae067374bf0a2d359cb7367f26",
    "filename": "hometask_2/src/main/java/ru/sbt/mipt/oop/component/Door.java",
    "status": "added",
    "additions": 51,
    "deletions": 0,
    "changes": 51,
    "blob_url": "https://github.com/Konopopl/smart-home-2021/blob/173cfd9920468ee207b921d1d3a6e7d369cb957f/hometask_2/src/main/java/ru/sbt/mipt/oop/component/Door.java",
    "raw_url": "https://github.com/Konopopl/smart-home-2021/raw/173cfd9920468ee207b921d1d3a6e7d369cb957f/hometask_2/src/main/java/ru/sbt/mipt/oop/component/Door.java",
    "contents_url": "https://api.github.com/repos/Konopopl/smart-home-2021/contents/hometask_2/src/main/java/ru/sbt/mipt/oop/component/Door.java?ref=173cfd9920468ee207b921d1d3a6e7d369cb957f",
    "patch": "@@ -0,0 +1,51 @@\n+package ru.sbt.mipt.oop.component;\n+\n+import java.util.Objects;\n+\n+import ru.sbt.mipt.oop.Action;\n+import ru.sbt.mipt.oop.Actionable;\n+\n+public class Door implements Actionable {\n+    private final String id;\n+    private boolean isOpen;\n+\n+    public Door(String id, boolean isOpen) {\n+        this.isOpen = isOpen;\n+        this.id = id;\n+    }\n+\n+    public String getId() {\n+        return id;\n+    }\n+\n+    public boolean isOpen() {\n+        return isOpen;\n+    }\n+\n+    public void close() {\n+        isOpen = false;\n+    }\n+\n+    public void open() {\n+        isOpen = true;\n+    }\n+\n+    @Override\n+    public void execute(Action action) {\n+        action.accept(this);\n+    }\n+\n+    @Override\n+    public boolean equals(Object o) {\n+        if (this == o) return true;\n+        if (o == null || getClass() != o.getClass()) return false;\n+        Door door = (Door) o;\n+        return isOpen == door.isOpen &&\n+                id.equals(door.id);\n+    }\n+\n+    @Override\n+    public int hashCode() {\n+        return Objects.hash(id, isOpen);\n+    }\n+}"
  },
  {
    "sha": "8046eaa6155983b688dc5ea03ab37ba19b16c4a1",
    "filename": "hometask_2/src/main/java/ru/sbt/mipt/oop/component/Light.java",
    "status": "added",
    "additions": 51,
    "deletions": 0,
    "changes": 51,
    "blob_url": "https://github.com/Konopopl/smart-home-2021/blob/173cfd9920468ee207b921d1d3a6e7d369cb957f/hometask_2/src/main/java/ru/sbt/mipt/oop/component/Light.java",
    "raw_url": "https://github.com/Konopopl/smart-home-2021/raw/173cfd9920468ee207b921d1d3a6e7d369cb957f/hometask_2/src/main/java/ru/sbt/mipt/oop/component/Light.java",
    "contents_url": "https://api.github.com/repos/Konopopl/smart-home-2021/contents/hometask_2/src/main/java/ru/sbt/mipt/oop/component/Light.java?ref=173cfd9920468ee207b921d1d3a6e7d369cb957f",
    "patch": "@@ -0,0 +1,51 @@\n+package ru.sbt.mipt.oop.component;\n+\n+import java.util.Objects;\n+\n+import ru.sbt.mipt.oop.Action;\n+import ru.sbt.mipt.oop.Actionable;\n+\n+public class Light implements Actionable {\n+    private boolean isOn;\n+    private final String id;\n+\n+    public Light(String id, boolean isOn) {\n+        this.id = id;\n+        this.isOn = isOn;\n+    }\n+\n+    public boolean isOn() {\n+        return isOn;\n+    }\n+\n+    public String getId() {\n+        return id;\n+    }\n+\n+    public void turnOff() {\n+        isOn = false;\n+    }\n+\n+    public void turnOn() {\n+        isOn = true;\n+    }\n+\n+    @Override\n+    public void execute(Action action) {\n+        action.accept(this);\n+    }\n+\n+    @Override\n+    public boolean equals(Object o) {\n+        if (this == o) return true;\n+        if (o == null || getClass() != o.getClass()) return false;\n+        Light light = (Light) o;\n+        return isOn == light.isOn &&\n+                id.equals(light.id);\n+    }\n+\n+    @Override\n+    public int hashCode() {\n+        return Objects.hash(isOn, id);\n+    }\n+}"
  },
  {
    "sha": "5fc963e4503c239ab470ef825e8d001509f9ac82",
    "filename": "hometask_2/src/main/java/ru/sbt/mipt/oop/component/Room.java",
    "status": "renamed",
    "additions": 11,
    "deletions": 8,
    "changes": 19,
    "blob_url": "https://github.com/Konopopl/smart-home-2021/blob/173cfd9920468ee207b921d1d3a6e7d369cb957f/hometask_2/src/main/java/ru/sbt/mipt/oop/component/Room.java",
    "raw_url": "https://github.com/Konopopl/smart-home-2021/raw/173cfd9920468ee207b921d1d3a6e7d369cb957f/hometask_2/src/main/java/ru/sbt/mipt/oop/component/Room.java",
    "contents_url": "https://api.github.com/repos/Konopopl/smart-home-2021/contents/hometask_2/src/main/java/ru/sbt/mipt/oop/component/Room.java?ref=173cfd9920468ee207b921d1d3a6e7d369cb957f",
    "patch": "@@ -2,7 +2,10 @@\n \n import java.util.Collection;\n \n-public class Room {\n+import ru.sbt.mipt.oop.Action;\n+import ru.sbt.mipt.oop.Actionable;\n+\n+public class Room implements Actionable {\n     private final Collection<Light> lights;\n     private final Collection<Door> doors;\n     private final String name;\n@@ -13,15 +16,15 @@ public Room(Collection<Light> lights, Collection<Door> doors, String name) {\n         this.name = name;\n     }\n \n-    public Collection<Light> getLights() {\n-        return lights;\n+    public String getName() {\n+        return name;\n     }\n \n-    public Collection<Door> getDoors() {\n-        return doors;\n-    }\n+    @Override\n+    public void execute(Action action) {\n+        action.accept(this);\n \n-    public String getName() {\n-        return name;\n+        lights.forEach(light -> light.execute(action));\n+        doors.forEach(door -> door.execute(action));\n     }\n }",
    "previous_filename": "src/main/java/ru/sbt/mipt/oop/component/Room.java"
  },
  {
    "sha": "ef5844da9823b483903597a9472dd878e95b6c18",
    "filename": "hometask_2/src/main/java/ru/sbt/mipt/oop/eventhandler/DoorEventHandler.java",
    "status": "added",
    "additions": 54,
    "deletions": 0,
    "changes": 54,
    "blob_url": "https://github.com/Konopopl/smart-home-2021/blob/173cfd9920468ee207b921d1d3a6e7d369cb957f/hometask_2/src/main/java/ru/sbt/mipt/oop/eventhandler/DoorEventHandler.java",
    "raw_url": "https://github.com/Konopopl/smart-home-2021/raw/173cfd9920468ee207b921d1d3a6e7d369cb957f/hometask_2/src/main/java/ru/sbt/mipt/oop/eventhandler/DoorEventHandler.java",
    "contents_url": "https://api.github.com/repos/Konopopl/smart-home-2021/contents/hometask_2/src/main/java/ru/sbt/mipt/oop/eventhandler/DoorEventHandler.java?ref=173cfd9920468ee207b921d1d3a6e7d369cb957f",
    "patch": "@@ -0,0 +1,54 @@\n+package ru.sbt.mipt.oop.eventhandler;\n+\n+import org.apache.log4j.Logger;\n+import ru.sbt.mipt.oop.SensorEvent;\n+import ru.sbt.mipt.oop.SmartHome;\n+import ru.sbt.mipt.oop.component.Door;\n+\n+import static ru.sbt.mipt.oop.type.SensorEventType.DOOR_CLOSED;\n+import static ru.sbt.mipt.oop.type.SensorEventType.DOOR_OPEN;\n+\n+public class DoorEventHandler implements EventHandler {\n+    private static final Logger logger = Logger.getLogger(DoorEventHandler.class);\n+\n+    @Override\n+    public void handleEvent(SmartHome smartHome, SensorEvent event) {\n+        if (!isDoorEvent(event)) {\n+            return;\n+        }\n+\n+        // событие от двери\n+        smartHome.execute(doorCandidate -> {\n+            if (!(doorCandidate instanceof Door)) {\n+                return;\n+            }\n+\n+            Door door = (Door) doorCandidate;\n+\n+            if (!door.getId().equals(event.getObjectId())) {\n+                return;\n+            }\n+\n+            if (event.getType() == DOOR_OPEN) {\n+                handleOpenEvent(door);\n+            } else {\n+                handleClosedEvent(door);\n+            }\n+        });\n+    }\n+\n+\n+    private void handleClosedEvent(Door door) {\n+        door.close();\n+        logger.info(\"Door \" + door.getId() + \" was closed.\");\n+    }\n+\n+    private void handleOpenEvent(Door door) {\n+        door.open();\n+        logger.info(\"Door \" + door.getId() + \" was opened.\");\n+    }\n+\n+    private boolean isDoorEvent(SensorEvent event) {\n+        return event.getType() == DOOR_OPEN || event.getType() == DOOR_CLOSED;\n+    }\n+}"
  },
  {
    "sha": "1e56dfe78959eec783f7c6643a3c5aec02c149b8",
    "filename": "hometask_2/src/main/java/ru/sbt/mipt/oop/eventhandler/EventHandler.java",
    "status": "renamed",
    "additions": 0,
    "deletions": 0,
    "changes": 0,
    "blob_url": "https://github.com/Konopopl/smart-home-2021/blob/173cfd9920468ee207b921d1d3a6e7d369cb957f/hometask_2/src/main/java/ru/sbt/mipt/oop/eventhandler/EventHandler.java",
    "raw_url": "https://github.com/Konopopl/smart-home-2021/raw/173cfd9920468ee207b921d1d3a6e7d369cb957f/hometask_2/src/main/java/ru/sbt/mipt/oop/eventhandler/EventHandler.java",
    "contents_url": "https://api.github.com/repos/Konopopl/smart-home-2021/contents/hometask_2/src/main/java/ru/sbt/mipt/oop/eventhandler/EventHandler.java?ref=173cfd9920468ee207b921d1d3a6e7d369cb957f",
    "previous_filename": "src/main/java/ru/sbt/mipt/oop/eventhandler/EventHandler.java"
  },
  {
    "sha": "56f91a6eae79a892629b2c123aef50882faf1f91",
    "filename": "hometask_2/src/main/java/ru/sbt/mipt/oop/eventhandler/HallDoorEventHandler.java",
    "status": "added",
    "additions": 75,
    "deletions": 0,
    "changes": 75,
    "blob_url": "https://github.com/Konopopl/smart-home-2021/blob/173cfd9920468ee207b921d1d3a6e7d369cb957f/hometask_2/src/main/java/ru/sbt/mipt/oop/eventhandler/HallDoorEventHandler.java",
    "raw_url": "https://github.com/Konopopl/smart-home-2021/raw/173cfd9920468ee207b921d1d3a6e7d369cb957f/hometask_2/src/main/java/ru/sbt/mipt/oop/eventhandler/HallDoorEventHandler.java",
    "contents_url": "https://api.github.com/repos/Konopopl/smart-home-2021/contents/hometask_2/src/main/java/ru/sbt/mipt/oop/eventhandler/HallDoorEventHandler.java?ref=173cfd9920468ee207b921d1d3a6e7d369cb957f",
    "patch": "@@ -0,0 +1,75 @@\n+package ru.sbt.mipt.oop.eventhandler;\n+\n+import org.apache.log4j.Logger;\n+import ru.sbt.mipt.oop.SensorCommand;\n+import ru.sbt.mipt.oop.SensorEvent;\n+import ru.sbt.mipt.oop.SmartHome;\n+import ru.sbt.mipt.oop.commandsender.CommandSender;\n+import ru.sbt.mipt.oop.commandsender.FakeCommandSender;\n+import ru.sbt.mipt.oop.component.Door;\n+import ru.sbt.mipt.oop.component.Light;\n+import ru.sbt.mipt.oop.component.Room;\n+import ru.sbt.mipt.oop.type.CommandType;\n+\n+import static ru.sbt.mipt.oop.type.SensorEventType.DOOR_CLOSED;\n+import static ru.sbt.mipt.oop.type.SensorEventType.DOOR_OPEN;\n+\n+public class HallDoorEventHandler implements EventHandler {\n+    private static final Logger logger = Logger.getLogger(HallDoorEventHandler.class);\n+    private final CommandSender commandSender = new FakeCommandSender();\n+\n+    @Override\n+    public void handleEvent(SmartHome smartHome, SensorEvent event) {\n+        if (isDoorEvent(event)) {\n+            smartHome.execute(roomCandidate -> {\n+                if (!(roomCandidate instanceof Room)) {\n+                    return;\n+                }\n+\n+                Room room = (Room) roomCandidate;\n+\n+                if (!room.getName().equals(\"hall\")) {\n+                    return;\n+                }\n+\n+                room.execute(doorCandidate -> {\n+                    if (!(doorCandidate instanceof Door)) {\n+                        return;\n+                    }\n+                    Door door = (Door) doorCandidate;\n+\n+                    if (!door.getId().equals(event.getObjectId())) {\n+                        return;\n+                    }\n+\n+                    // this event is hall door event, so handle it\n+                    if (event.getType() == DOOR_CLOSED) {\n+                        handleClosedEvent(smartHome);\n+                    }\n+\n+                });\n+            });\n+        }\n+    }\n+\n+    private void handleClosedEvent(SmartHome smartHome) {\n+        smartHome.execute(lightCandidate -> {\n+            if (!(lightCandidate instanceof Light)) {\n+                return;\n+            }\n+\n+            Light light = (Light) lightCandidate;\n+\n+            light.turnOff();\n+            logger.info(\"Light \" + light.getId() + \" was turned off.\");\n+\n+            SensorCommand command = new SensorCommand(CommandType.LIGHT_OFF, light.getId());\n+            commandSender.sendCommand(command);\n+        });\n+    }\n+\n+    private boolean isDoorEvent(SensorEvent event) {\n+        return event.getType() == DOOR_CLOSED || event.getType() == DOOR_OPEN;\n+    }\n+\n+}"
  },
  {
    "sha": "d609b4a74783fd8fa720bcc7b2361a67f51445d2",
    "filename": "hometask_2/src/main/java/ru/sbt/mipt/oop/eventhandler/LightEventHandler.java",
    "status": "added",
    "additions": 54,
    "deletions": 0,
    "changes": 54,
    "blob_url": "https://github.com/Konopopl/smart-home-2021/blob/173cfd9920468ee207b921d1d3a6e7d369cb957f/hometask_2/src/main/java/ru/sbt/mipt/oop/eventhandler/LightEventHandler.java",
    "raw_url": "https://github.com/Konopopl/smart-home-2021/raw/173cfd9920468ee207b921d1d3a6e7d369cb957f/hometask_2/src/main/java/ru/sbt/mipt/oop/eventhandler/LightEventHandler.java",
    "contents_url": "https://api.github.com/repos/Konopopl/smart-home-2021/contents/hometask_2/src/main/java/ru/sbt/mipt/oop/eventhandler/LightEventHandler.java?ref=173cfd9920468ee207b921d1d3a6e7d369cb957f",
    "patch": "@@ -0,0 +1,54 @@\n+package ru.sbt.mipt.oop.eventhandler;\n+\n+import org.apache.log4j.Logger;\n+import ru.sbt.mipt.oop.SensorEvent;\n+import ru.sbt.mipt.oop.SmartHome;\n+import ru.sbt.mipt.oop.component.Light;\n+\n+import static ru.sbt.mipt.oop.type.SensorEventType.LIGHT_OFF;\n+import static ru.sbt.mipt.oop.type.SensorEventType.LIGHT_ON;\n+\n+public class LightEventHandler implements EventHandler {\n+    private static final Logger logger = Logger.getLogger(LightEventHandler.class);\n+\n+    @Override\n+    public void handleEvent(SmartHome smartHome, SensorEvent event) {\n+        if (!isLightEvent(event)) {\n+            return;\n+        }\n+        // событие от источника света\n+        smartHome.execute(lightCandidate -> {\n+            if (!(lightCandidate instanceof Light)) {\n+                return;\n+            }\n+\n+            Light light = (Light) lightCandidate;\n+\n+            if (!light.getId().equals(event.getObjectId())) {\n+                return;\n+            }\n+\n+            if (event.getType() == LIGHT_ON) {\n+                handleOnEvent(light);\n+            } else {\n+                handleOffEvent(light);\n+            }\n+\n+        });\n+    }\n+\n+\n+    private void handleOffEvent(Light light) {\n+        light.turnOff();\n+        logger.info(\"Light \" + light.getId() + \" was turned off.\");\n+    }\n+\n+    private void handleOnEvent(Light light) {\n+        light.turnOn();\n+        logger.info(\"Light \" + light.getId() + \" was turned on.\");\n+    }\n+\n+    private boolean isLightEvent(SensorEvent event) {\n+        return event.getType() == LIGHT_ON || event.getType() == LIGHT_OFF;\n+    }\n+}"
  },
  {
    "sha": "1c10598c762202e963f276ec178d6e01f416a39e",
    "filename": "hometask_2/src/main/java/ru/sbt/mipt/oop/eventprovider/RandomSensorEventProvider.java",
    "status": "renamed",
    "additions": 0,
    "deletions": 0,
    "changes": 0,
    "blob_url": "https://github.com/Konopopl/smart-home-2021/blob/173cfd9920468ee207b921d1d3a6e7d369cb957f/hometask_2/src/main/java/ru/sbt/mipt/oop/eventprovider/RandomSensorEventProvider.java",
    "raw_url": "https://github.com/Konopopl/smart-home-2021/raw/173cfd9920468ee207b921d1d3a6e7d369cb957f/hometask_2/src/main/java/ru/sbt/mipt/oop/eventprovider/RandomSensorEventProvider.java",
    "contents_url": "https://api.github.com/repos/Konopopl/smart-home-2021/contents/hometask_2/src/main/java/ru/sbt/mipt/oop/eventprovider/RandomSensorEventProvider.java?ref=173cfd9920468ee207b921d1d3a6e7d369cb957f",
    "previous_filename": "src/main/java/ru/sbt/mipt/oop/eventprovider/RandomSensorEventProvider.java"
  },
  {
    "sha": "9b27fdfab08d26f53c883a4fcd8484f3599ade2a",
    "filename": "hometask_2/src/main/java/ru/sbt/mipt/oop/eventprovider/SensorEventProvider.java",
    "status": "renamed",
    "additions": 0,
    "deletions": 0,
    "changes": 0,
    "blob_url": "https://github.com/Konopopl/smart-home-2021/blob/173cfd9920468ee207b921d1d3a6e7d369cb957f/hometask_2/src/main/java/ru/sbt/mipt/oop/eventprovider/SensorEventProvider.java",
    "raw_url": "https://github.com/Konopopl/smart-home-2021/raw/173cfd9920468ee207b921d1d3a6e7d369cb957f/hometask_2/src/main/java/ru/sbt/mipt/oop/eventprovider/SensorEventProvider.java",
    "contents_url": "https://api.github.com/repos/Konopopl/smart-home-2021/contents/hometask_2/src/main/java/ru/sbt/mipt/oop/eventprovider/SensorEventProvider.java?ref=173cfd9920468ee207b921d1d3a6e7d369cb957f",
    "previous_filename": "src/main/java/ru/sbt/mipt/oop/eventprovider/SensorEventProvider.java"
  },
  {
    "sha": "9e318373c9d533b4a40ca93035b90cc6b2aaf87e",
    "filename": "hometask_2/src/main/java/ru/sbt/mipt/oop/loader/SmartHomeJsonFileLoader.java",
    "status": "renamed",
    "additions": 0,
    "deletions": 0,
    "changes": 0,
    "blob_url": "https://github.com/Konopopl/smart-home-2021/blob/173cfd9920468ee207b921d1d3a6e7d369cb957f/hometask_2/src/main/java/ru/sbt/mipt/oop/loader/SmartHomeJsonFileLoader.java",
    "raw_url": "https://github.com/Konopopl/smart-home-2021/raw/173cfd9920468ee207b921d1d3a6e7d369cb957f/hometask_2/src/main/java/ru/sbt/mipt/oop/loader/SmartHomeJsonFileLoader.java",
    "contents_url": "https://api.github.com/repos/Konopopl/smart-home-2021/contents/hometask_2/src/main/java/ru/sbt/mipt/oop/loader/SmartHomeJsonFileLoader.java?ref=173cfd9920468ee207b921d1d3a6e7d369cb957f",
    "previous_filename": "src/main/java/ru/sbt/mipt/oop/loader/SmartHomeJsonFileLoader.java"
  },
  {
    "sha": "f1bd6cec9522edf2e990bdb68dc94027c4c3c03d",
    "filename": "hometask_2/src/main/java/ru/sbt/mipt/oop/loader/SmartHomeLoader.java",
    "status": "renamed",
    "additions": 0,
    "deletions": 0,
    "changes": 0,
    "blob_url": "https://github.com/Konopopl/smart-home-2021/blob/173cfd9920468ee207b921d1d3a6e7d369cb957f/hometask_2/src/main/java/ru/sbt/mipt/oop/loader/SmartHomeLoader.java",
    "raw_url": "https://github.com/Konopopl/smart-home-2021/raw/173cfd9920468ee207b921d1d3a6e7d369cb957f/hometask_2/src/main/java/ru/sbt/mipt/oop/loader/SmartHomeLoader.java",
    "contents_url": "https://api.github.com/repos/Konopopl/smart-home-2021/contents/hometask_2/src/main/java/ru/sbt/mipt/oop/loader/SmartHomeLoader.java?ref=173cfd9920468ee207b921d1d3a6e7d369cb957f",
    "previous_filename": "src/main/java/ru/sbt/mipt/oop/loader/SmartHomeLoader.java"
  },
  {
    "sha": "b1f5c1ecbcf4b01d4d3de58ab22e3c60cbd07f3a",
    "filename": "hometask_2/src/main/java/ru/sbt/mipt/oop/type/CommandType.java",
    "status": "renamed",
    "additions": 0,
    "deletions": 0,
    "changes": 0,
    "blob_url": "https://github.com/Konopopl/smart-home-2021/blob/173cfd9920468ee207b921d1d3a6e7d369cb957f/hometask_2/src/main/java/ru/sbt/mipt/oop/type/CommandType.java",
    "raw_url": "https://github.com/Konopopl/smart-home-2021/raw/173cfd9920468ee207b921d1d3a6e7d369cb957f/hometask_2/src/main/java/ru/sbt/mipt/oop/type/CommandType.java",
    "contents_url": "https://api.github.com/repos/Konopopl/smart-home-2021/contents/hometask_2/src/main/java/ru/sbt/mipt/oop/type/CommandType.java?ref=173cfd9920468ee207b921d1d3a6e7d369cb957f",
    "previous_filename": "src/main/java/ru/sbt/mipt/oop/type/CommandType.java"
  },
  {
    "sha": "a9f965742e657d2005e7940d0e77e110ab962269",
    "filename": "hometask_2/src/main/java/ru/sbt/mipt/oop/type/SensorEventType.java",
    "status": "renamed",
    "additions": 0,
    "deletions": 0,
    "changes": 0,
    "blob_url": "https://github.com/Konopopl/smart-home-2021/blob/173cfd9920468ee207b921d1d3a6e7d369cb957f/hometask_2/src/main/java/ru/sbt/mipt/oop/type/SensorEventType.java",
    "raw_url": "https://github.com/Konopopl/smart-home-2021/raw/173cfd9920468ee207b921d1d3a6e7d369cb957f/hometask_2/src/main/java/ru/sbt/mipt/oop/type/SensorEventType.java",
    "contents_url": "https://api.github.com/repos/Konopopl/smart-home-2021/contents/hometask_2/src/main/java/ru/sbt/mipt/oop/type/SensorEventType.java?ref=173cfd9920468ee207b921d1d3a6e7d369cb957f",
    "previous_filename": "src/main/java/ru/sbt/mipt/oop/type/SensorEventType.java"
  },
  {
    "sha": "6c04d934e12c724146c18bff2b47215b76ceebf2",
    "filename": "hometask_2/src/main/java/ru/sbt/mipt/oop/writer/SmartHomeJsonFileWriter.java",
    "status": "renamed",
    "additions": 0,
    "deletions": 0,
    "changes": 0,
    "blob_url": "https://github.com/Konopopl/smart-home-2021/blob/173cfd9920468ee207b921d1d3a6e7d369cb957f/hometask_2/src/main/java/ru/sbt/mipt/oop/writer/SmartHomeJsonFileWriter.java",
    "raw_url": "https://github.com/Konopopl/smart-home-2021/raw/173cfd9920468ee207b921d1d3a6e7d369cb957f/hometask_2/src/main/java/ru/sbt/mipt/oop/writer/SmartHomeJsonFileWriter.java",
    "contents_url": "https://api.github.com/repos/Konopopl/smart-home-2021/contents/hometask_2/src/main/java/ru/sbt/mipt/oop/writer/SmartHomeJsonFileWriter.java?ref=173cfd9920468ee207b921d1d3a6e7d369cb957f",
    "previous_filename": "src/main/java/ru/sbt/mipt/oop/writer/SmartHomeJsonFileWriter.java"
  },
  {
    "sha": "02eb99b38acebee90b82c7462a223f1b06cc27b9",
    "filename": "hometask_2/src/main/java/ru/sbt/mipt/oop/writer/SmartHomeWriter.java",
    "status": "renamed",
    "additions": 0,
    "deletions": 0,
    "changes": 0,
    "blob_url": "https://github.com/Konopopl/smart-home-2021/blob/173cfd9920468ee207b921d1d3a6e7d369cb957f/hometask_2/src/main/java/ru/sbt/mipt/oop/writer/SmartHomeWriter.java",
    "raw_url": "https://github.com/Konopopl/smart-home-2021/raw/173cfd9920468ee207b921d1d3a6e7d369cb957f/hometask_2/src/main/java/ru/sbt/mipt/oop/writer/SmartHomeWriter.java",
    "contents_url": "https://api.github.com/repos/Konopopl/smart-home-2021/contents/hometask_2/src/main/java/ru/sbt/mipt/oop/writer/SmartHomeWriter.java?ref=173cfd9920468ee207b921d1d3a6e7d369cb957f",
    "previous_filename": "src/main/java/ru/sbt/mipt/oop/writer/SmartHomeWriter.java"
  },
  {
    "sha": "cb506e882030ee4e1e0e86af39e9b70690044c8e",
    "filename": "hometask_2/src/main/resources/log4j.properties",
    "status": "renamed",
    "additions": 0,
    "deletions": 0,
    "changes": 0,
    "blob_url": "https://github.com/Konopopl/smart-home-2021/blob/173cfd9920468ee207b921d1d3a6e7d369cb957f/hometask_2/src/main/resources/log4j.properties",
    "raw_url": "https://github.com/Konopopl/smart-home-2021/raw/173cfd9920468ee207b921d1d3a6e7d369cb957f/hometask_2/src/main/resources/log4j.properties",
    "contents_url": "https://api.github.com/repos/Konopopl/smart-home-2021/contents/hometask_2/src/main/resources/log4j.properties?ref=173cfd9920468ee207b921d1d3a6e7d369cb957f",
    "previous_filename": "src/main/resources/log4j.properties"
  },
  {
    "sha": "7a9d72957fc07ea1cc0b69f3b5161f0c61549b63",
    "filename": "hometask_2/src/test/java/ru/sbt/mipt/oop/eventhandler/DoorEventHandlerTest.java",
    "status": "added",
    "additions": 95,
    "deletions": 0,
    "changes": 95,
    "blob_url": "https://github.com/Konopopl/smart-home-2021/blob/173cfd9920468ee207b921d1d3a6e7d369cb957f/hometask_2/src/test/java/ru/sbt/mipt/oop/eventhandler/DoorEventHandlerTest.java",
    "raw_url": "https://github.com/Konopopl/smart-home-2021/raw/173cfd9920468ee207b921d1d3a6e7d369cb957f/hometask_2/src/test/java/ru/sbt/mipt/oop/eventhandler/DoorEventHandlerTest.java",
    "contents_url": "https://api.github.com/repos/Konopopl/smart-home-2021/contents/hometask_2/src/test/java/ru/sbt/mipt/oop/eventhandler/DoorEventHandlerTest.java?ref=173cfd9920468ee207b921d1d3a6e7d369cb957f",
    "patch": "@@ -0,0 +1,95 @@\n+package ru.sbt.mipt.oop.eventhandler;\n+\n+import java.util.Arrays;\n+import java.util.List;\n+\n+import org.junit.Assert;\n+import org.junit.Before;\n+import org.junit.Test;\n+import ru.sbt.mipt.oop.SensorEvent;\n+import ru.sbt.mipt.oop.SmartHome;\n+import ru.sbt.mipt.oop.component.Door;\n+import ru.sbt.mipt.oop.component.Light;\n+import ru.sbt.mipt.oop.component.Room;\n+import ru.sbt.mipt.oop.type.SensorEventType;\n+\n+public class DoorEventHandlerTest {\n+    private SmartHome smartHome;\n+    private DoorEventHandler doorEventHandler;\n+\n+    @Before\n+    public void setup() {\n+        Room testRoom = new Room(\n+                Arrays.asList(\n+                        new Light(\"1\", false),\n+                        new Light(\"2\", true)),\n+                Arrays.asList(\n+                        new Door(\"1\", false),\n+                        new Door(\"2\", false),\n+                        new Door(\"3\", false),\n+                        new Door(\"4\", false)),\n+                \"tesRoom\");\n+\n+        smartHome = new SmartHome(Arrays.asList(testRoom));\n+        doorEventHandler = new DoorEventHandler();\n+    }\n+\n+    @Test\n+    public void openExistingDoorEventTest() {\n+        final String doorId = \"1\";\n+        TestUtils.getDoorById(smartHome, doorId).close();\n+        List<Door> initialAllDoorsCopy = TestUtils.getAllDoorsExceptOneCopy(smartHome, doorId);\n+\n+        SensorEvent event = new SensorEvent(SensorEventType.DOOR_OPEN, doorId);\n+        doorEventHandler.handleEvent(smartHome, event);\n+\n+        Assert.assertEquals(initialAllDoorsCopy, TestUtils.getAllDoorsExceptOneCopy(smartHome, doorId));\n+        Assert.assertTrue(TestUtils.getDoorById(smartHome, doorId).isOpen());\n+    }\n+\n+    @Test\n+    public void closeExistingDoorEventTest() {\n+        final String doorId = \"1\";\n+        List<Door> initialAllDoorsCopy = TestUtils.getAllDoorsExceptOneCopy(smartHome, doorId);\n+        TestUtils.getDoorById(smartHome, doorId).open();\n+\n+        SensorEvent event = new SensorEvent(SensorEventType.DOOR_CLOSED, doorId);\n+        doorEventHandler.handleEvent(smartHome, event);\n+\n+        Assert.assertEquals(initialAllDoorsCopy, TestUtils.getAllDoorsExceptOneCopy(smartHome, doorId));\n+        Assert.assertFalse(TestUtils.getDoorById(smartHome, doorId).isOpen());\n+    }\n+\n+    @Test\n+    public void openNonExistingDoorEventTest() {\n+        final String doorId = \"100\";\n+        List<Door> initialAllDoorsCopy = TestUtils.getAllDoorsCopy(smartHome);\n+\n+        SensorEvent event = new SensorEvent(SensorEventType.DOOR_OPEN, doorId);\n+        doorEventHandler.handleEvent(smartHome, event);\n+\n+        Assert.assertEquals(initialAllDoorsCopy, TestUtils.getAllDoorsCopy(smartHome));\n+    }\n+\n+    @Test\n+    public void closeNonExistingDoorEventTest() {\n+        final String doorId = \"100\";\n+        List<Door> initialAllDoorsCopy = TestUtils.getAllDoorsCopy(smartHome);\n+\n+        SensorEvent event = new SensorEvent(SensorEventType.DOOR_CLOSED, doorId);\n+        doorEventHandler.handleEvent(smartHome, event);\n+\n+        Assert.assertEquals(initialAllDoorsCopy, TestUtils.getAllDoorsCopy(smartHome));\n+    }\n+\n+    @Test\n+    public void handleNotDoorEventTest() {\n+        List<Door> initialAllDoorsCopy = TestUtils.getAllDoorsCopy(smartHome);\n+\n+        SensorEvent event = new SensorEvent(SensorEventType.LIGHT_ON, \"1\");\n+        doorEventHandler.handleEvent(smartHome, event);\n+\n+        Assert.assertEquals(initialAllDoorsCopy, TestUtils.getAllDoorsCopy(smartHome));\n+    }\n+\n+}"
  },
  {
    "sha": "bdaabd628cf319c60a5899e0548861990b69e7eb",
    "filename": "hometask_2/src/test/java/ru/sbt/mipt/oop/eventhandler/HallDoorEventHandlerTest.java",
    "status": "added",
    "additions": 65,
    "deletions": 0,
    "changes": 65,
    "blob_url": "https://github.com/Konopopl/smart-home-2021/blob/173cfd9920468ee207b921d1d3a6e7d369cb957f/hometask_2/src/test/java/ru/sbt/mipt/oop/eventhandler/HallDoorEventHandlerTest.java",
    "raw_url": "https://github.com/Konopopl/smart-home-2021/raw/173cfd9920468ee207b921d1d3a6e7d369cb957f/hometask_2/src/test/java/ru/sbt/mipt/oop/eventhandler/HallDoorEventHandlerTest.java",
    "contents_url": "https://api.github.com/repos/Konopopl/smart-home-2021/contents/hometask_2/src/test/java/ru/sbt/mipt/oop/eventhandler/HallDoorEventHandlerTest.java?ref=173cfd9920468ee207b921d1d3a6e7d369cb957f",
    "patch": "@@ -0,0 +1,65 @@\n+package ru.sbt.mipt.oop.eventhandler;\n+\n+import java.util.Arrays;\n+import java.util.List;\n+\n+import org.junit.Assert;\n+import org.junit.Before;\n+import org.junit.Test;\n+import ru.sbt.mipt.oop.SensorEvent;\n+import ru.sbt.mipt.oop.SmartHome;\n+import ru.sbt.mipt.oop.component.Door;\n+import ru.sbt.mipt.oop.component.Light;\n+import ru.sbt.mipt.oop.component.Room;\n+import ru.sbt.mipt.oop.type.SensorEventType;\n+\n+public class HallDoorEventHandlerTest {\n+    private SmartHome smartHome;\n+    private HallDoorEventHandler hallDoorEventHandler;\n+\n+    @Before\n+    public void setup() {\n+        Room testRoom = new Room(\n+                Arrays.asList(\n+                        new Light(\"1\", true),\n+                        new Light(\"2\", false)),\n+                Arrays.asList(\n+                        new Door(\"1\", false),\n+                        new Door(\"2\", false)),\n+                \"tesRoom\");\n+\n+        Room hall = new Room(\n+                Arrays.asList(\n+                        new Light(\"3\", true),\n+                        new Light(\"4\", true),\n+                        new Light(\"5\", false),\n+                        new Light(\"6\", true)),\n+                Arrays.asList(\n+                        new Door(\"3\", true)),\n+                \"hall\");\n+\n+        smartHome = new SmartHome(Arrays.asList(testRoom, hall));\n+        hallDoorEventHandler = new HallDoorEventHandler();\n+    }\n+\n+    @Test\n+    public void handleCloseHallDoorEventTest() {\n+        final String hallDoorId = \"3\";\n+\n+        SensorEvent sensorEvent = new SensorEvent(SensorEventType.DOOR_CLOSED, hallDoorId);\n+        hallDoorEventHandler.handleEvent(smartHome, sensorEvent);\n+\n+        TestUtils.getAllLightsCopy(smartHome).forEach(light -> Assert.assertFalse(light.isOn()));\n+    }\n+\n+    @Test\n+    public void handleNotHallDoorEventTest() {\n+        List<Light> initialAllLightsCopy = TestUtils.getAllLightsCopy(smartHome);\n+\n+        SensorEvent event = new SensorEvent(SensorEventType.DOOR_CLOSED, \"1\");\n+        hallDoorEventHandler.handleEvent(smartHome, event);\n+\n+        Assert.assertEquals(initialAllLightsCopy, TestUtils.getAllLightsCopy(smartHome));\n+    }\n+\n+}\n\\ No newline at end of file"
  },
  {
    "sha": "7b7802c1c7f84ff0c68dccf44e29f417b3dce7a6",
    "filename": "hometask_2/src/test/java/ru/sbt/mipt/oop/eventhandler/LightEventHandlerTest.java",
    "status": "added",
    "additions": 95,
    "deletions": 0,
    "changes": 95,
    "blob_url": "https://github.com/Konopopl/smart-home-2021/blob/173cfd9920468ee207b921d1d3a6e7d369cb957f/hometask_2/src/test/java/ru/sbt/mipt/oop/eventhandler/LightEventHandlerTest.java",
    "raw_url": "https://github.com/Konopopl/smart-home-2021/raw/173cfd9920468ee207b921d1d3a6e7d369cb957f/hometask_2/src/test/java/ru/sbt/mipt/oop/eventhandler/LightEventHandlerTest.java",
    "contents_url": "https://api.github.com/repos/Konopopl/smart-home-2021/contents/hometask_2/src/test/java/ru/sbt/mipt/oop/eventhandler/LightEventHandlerTest.java?ref=173cfd9920468ee207b921d1d3a6e7d369cb957f",
    "patch": "@@ -0,0 +1,95 @@\n+package ru.sbt.mipt.oop.eventhandler;\n+\n+import java.util.Arrays;\n+import java.util.List;\n+\n+import org.junit.Assert;\n+import org.junit.Before;\n+import org.junit.Test;\n+import ru.sbt.mipt.oop.SensorEvent;\n+import ru.sbt.mipt.oop.SmartHome;\n+import ru.sbt.mipt.oop.component.Door;\n+import ru.sbt.mipt.oop.component.Light;\n+import ru.sbt.mipt.oop.component.Room;\n+import ru.sbt.mipt.oop.type.SensorEventType;\n+\n+public class LightEventHandlerTest {\n+\n+    private SmartHome smartHome;\n+    private LightEventHandler lightEventHandler;\n+\n+    @Before\n+    public void setup() {\n+        Room testRoom = new Room(\n+                Arrays.asList(\n+                        new Light(\"1\", false),\n+                        new Light(\"2\", true),\n+                        new Light(\"3\", false),\n+                        new Light(\"4\", false)),\n+                Arrays.asList(\n+                        new Door(\"1\", false),\n+                        new Door(\"2\", false)),\n+                \"tesRoom\");\n+\n+        smartHome = new SmartHome(Arrays.asList(testRoom));\n+        lightEventHandler = new LightEventHandler();\n+    }\n+\n+    @Test\n+    public void turnOnExistingLightEventTest() {\n+        final String lightId = \"1\";\n+        TestUtils.getLightById(smartHome, lightId).turnOff();\n+        List<Light> initialAllLightsCopy = TestUtils.getAllLightsExceptOneCopy(smartHome, lightId);\n+\n+        SensorEvent event = new SensorEvent(SensorEventType.LIGHT_ON, lightId);\n+        lightEventHandler.handleEvent(smartHome, event);\n+\n+        Assert.assertEquals(initialAllLightsCopy, TestUtils.getAllLightsExceptOneCopy(smartHome, lightId));\n+        Assert.assertTrue(TestUtils.getLightById(smartHome, lightId).isOn());\n+    }\n+\n+    @Test\n+    public void turnOffExistingLightEventTest() {\n+        final String lightId = \"1\";\n+        TestUtils.getLightById(smartHome, lightId).turnOn();\n+        List<Light> initialAllLightsCopy = TestUtils.getAllLightsExceptOneCopy(smartHome, lightId);\n+\n+        SensorEvent event = new SensorEvent(SensorEventType.LIGHT_OFF, lightId);\n+        lightEventHandler.handleEvent(smartHome, event);\n+\n+        Assert.assertEquals(initialAllLightsCopy, TestUtils.getAllLightsExceptOneCopy(smartHome, lightId));\n+        Assert.assertFalse(TestUtils.getLightById(smartHome, lightId).isOn());\n+    }\n+\n+    @Test\n+    public void turnOnNonExistingLightEventTest() {\n+        final String lightId = \"100\";\n+        List<Light> initialAllLightsCopy = TestUtils.getAllLightsCopy(smartHome);\n+\n+        SensorEvent event = new SensorEvent(SensorEventType.LIGHT_ON, lightId);\n+        lightEventHandler.handleEvent(smartHome, event);\n+\n+        Assert.assertEquals(initialAllLightsCopy, TestUtils.getAllLightsCopy(smartHome));\n+    }\n+\n+    @Test\n+    public void turnOffNonExistingLightEventTest() {\n+        final String lightId = \"100\";\n+        List<Light> initialAllLightsCopy = TestUtils.getAllLightsCopy(smartHome);\n+\n+        SensorEvent event = new SensorEvent(SensorEventType.LIGHT_OFF, lightId);\n+        lightEventHandler.handleEvent(smartHome, event);\n+\n+        Assert.assertEquals(initialAllLightsCopy, TestUtils.getAllLightsCopy(smartHome));\n+    }\n+\n+    @Test\n+    public void handleNotLightEventTest() {\n+        List<Light> initialAllLightsCopy = TestUtils.getAllLightsCopy(smartHome);\n+\n+        SensorEvent event = new SensorEvent(SensorEventType.DOOR_CLOSED, \"1\");\n+        lightEventHandler.handleEvent(smartHome, event);\n+\n+        Assert.assertEquals(initialAllLightsCopy, TestUtils.getAllLightsCopy(smartHome));\n+    }\n+}\n\\ No newline at end of file"
  },
  {
    "sha": "cdcd91d7f6c8b227ac182e915fc5fa74b1319a65",
    "filename": "hometask_2/src/test/java/ru/sbt/mipt/oop/eventhandler/TestUtils.java",
    "status": "added",
    "additions": 115,
    "deletions": 0,
    "changes": 115,
    "blob_url": "https://github.com/Konopopl/smart-home-2021/blob/173cfd9920468ee207b921d1d3a6e7d369cb957f/hometask_2/src/test/java/ru/sbt/mipt/oop/eventhandler/TestUtils.java",
    "raw_url": "https://github.com/Konopopl/smart-home-2021/raw/173cfd9920468ee207b921d1d3a6e7d369cb957f/hometask_2/src/test/java/ru/sbt/mipt/oop/eventhandler/TestUtils.java",
    "contents_url": "https://api.github.com/repos/Konopopl/smart-home-2021/contents/hometask_2/src/test/java/ru/sbt/mipt/oop/eventhandler/TestUtils.java?ref=173cfd9920468ee207b921d1d3a6e7d369cb957f",
    "patch": "@@ -0,0 +1,115 @@\n+package ru.sbt.mipt.oop.eventhandler;\n+\n+import java.util.ArrayList;\n+import java.util.List;\n+import java.util.concurrent.atomic.AtomicReference;\n+\n+import ru.sbt.mipt.oop.SmartHome;\n+import ru.sbt.mipt.oop.component.Door;\n+import ru.sbt.mipt.oop.component.Light;\n+\n+public class TestUtils {\n+    public static Light getLightById(SmartHome smartHome, String lightId) {\n+        AtomicReference<Light> light = new AtomicReference<>();\n+\n+        smartHome.execute(lightCandidate -> {\n+            if (!(lightCandidate instanceof Light)) {\n+                return;\n+            }\n+\n+            Light tmpLight = (Light) lightCandidate;\n+\n+            if (tmpLight.getId().equals(lightId)) {\n+                light.set(tmpLight);\n+            }\n+        });\n+\n+        return light.get();\n+    }\n+\n+    public static Door getDoorById(SmartHome smartHome, String doorId) {\n+        AtomicReference<Door> door = new AtomicReference<>();\n+\n+        smartHome.execute(doorCandidate -> {\n+            if (!(doorCandidate instanceof Door)) {\n+                return;\n+            }\n+\n+            Door tmpDoor = (Door) doorCandidate;\n+\n+            if (tmpDoor.getId().equals(doorId)) {\n+                door.set(tmpDoor);\n+            }\n+        });\n+\n+        return door.get();\n+    }\n+\n+    public static List<Light> getAllLightsCopy(SmartHome smartHome) {\n+        List<Light> lights = new ArrayList<>();\n+\n+        smartHome.execute(lightCandidate -> {\n+            if (!(lightCandidate instanceof Light)) {\n+                return;\n+            }\n+\n+            Light tmpLight = (Light) lightCandidate;\n+\n+            lights.add(new Light(tmpLight.getId(), tmpLight.isOn()));\n+        });\n+\n+        return lights;\n+    }\n+\n+    public static List<Door> getAllDoorsCopy(SmartHome smartHome) {\n+        List<Door> doors = new ArrayList<>();\n+\n+        smartHome.execute(doorCandidate -> {\n+            if (!(doorCandidate instanceof Door)) {\n+                return;\n+            }\n+\n+            Door tmpDoor = (Door) doorCandidate;\n+\n+            doors.add(new Door(tmpDoor.getId(), tmpDoor.isOpen()));\n+        });\n+\n+        return doors;\n+    }\n+\n+    public static List<Light> getAllLightsExceptOneCopy(SmartHome smartHome, String lightId) {\n+        List<Light> lights = new ArrayList<>();\n+\n+        smartHome.execute(lightCandidate -> {\n+            if (!(lightCandidate instanceof Light)) {\n+                return;\n+            }\n+\n+            Light tmpLight = (Light) lightCandidate;\n+\n+            if (!tmpLight.getId().equals(lightId)) {\n+                lights.add(new Light(tmpLight.getId(), tmpLight.isOn()));\n+            }\n+        });\n+\n+        return lights;\n+    }\n+\n+    public static List<Door> getAllDoorsExceptOneCopy(SmartHome smartHome, String doorId) {\n+        List<Door> doors = new ArrayList<>();\n+\n+        smartHome.execute(doorCandidate -> {\n+            if (!(doorCandidate instanceof Door)) {\n+                return;\n+            }\n+\n+            Door tmpDoor = (Door) doorCandidate;\n+\n+            if (!tmpDoor.getId().equals(doorId)) {\n+                doors.add(new Door(tmpDoor.getId(), tmpDoor.isOpen()));\n+            }\n+        });\n+\n+        return doors;\n+    }\n+}"
  }
]

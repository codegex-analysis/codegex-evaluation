[
  {
    "sha": "14f87c21005e89eb6b73f8d85939c556c8599486",
    "filename": "src/megameklab/com/ui/StartupGUI.java",
    "status": "modified",
    "additions": 1,
    "deletions": 8,
    "changes": 9,
    "blob_url": "https://github.com/MegaMek/megameklab/blob/d9e8bba94992edd4ee75f11a1db30f58086adbd0/src/megameklab/com/ui/StartupGUI.java",
    "raw_url": "https://github.com/MegaMek/megameklab/raw/d9e8bba94992edd4ee75f11a1db30f58086adbd0/src/megameklab/com/ui/StartupGUI.java",
    "contents_url": "https://api.github.com/repos/MegaMek/megameklab/contents/src/megameklab/com/ui/StartupGUI.java?ref=d9e8bba94992edd4ee75f11a1db30f58086adbd0",
    "patch": "@@ -36,7 +36,6 @@\n import javax.swing.JOptionPane;\n import javax.swing.UIManager;\n \n-import megamek.client.ui.swing.UnitLoadingDialog;\n import megamek.client.ui.swing.widget.MegamekButton;\n import megamek.client.ui.swing.widget.SkinSpecification;\n import megamek.client.ui.swing.widget.SkinXMLHandler;\n@@ -364,14 +363,8 @@ private void newUnit(long type, boolean primitive, boolean industrial, Entity en\n     \n     private void loadUnit() {\n         EquipmentType.initializeTypes();\n-        UnitLoadingDialog unitLoadingDialog = new UnitLoadingDialog(frame);\n-        unitLoadingDialog.setVisible(true);\n-        MegaMekLabUnitSelectorDialog viewer = new MegaMekLabUnitSelectorDialog(frame, unitLoadingDialog);\n-\n-        Entity newUnit = viewer.getChosenEntity();\n-        viewer.setVisible(false);\n-        viewer.dispose();\n \n+        Entity newUnit = MegaMekLabUnitSelectorDialog.showDialog(frame);\n         if (null == newUnit) {\n             return;\n         }"
  },
  {
    "sha": "c611ac3dbf1af694e6ba134d2c805334d086e331",
    "filename": "src/megameklab/com/ui/dialog/MegaMekLabUnitSelectorDialog.java",
    "status": "modified",
    "additions": 77,
    "deletions": 0,
    "changes": 77,
    "blob_url": "https://github.com/MegaMek/megameklab/blob/d9e8bba94992edd4ee75f11a1db30f58086adbd0/src/megameklab/com/ui/dialog/MegaMekLabUnitSelectorDialog.java",
    "raw_url": "https://github.com/MegaMek/megameklab/raw/d9e8bba94992edd4ee75f11a1db30f58086adbd0/src/megameklab/com/ui/dialog/MegaMekLabUnitSelectorDialog.java",
    "contents_url": "https://api.github.com/repos/MegaMek/megameklab/contents/src/megameklab/com/ui/dialog/MegaMekLabUnitSelectorDialog.java?ref=d9e8bba94992edd4ee75f11a1db30f58086adbd0",
    "patch": "@@ -24,11 +24,15 @@\n import megamek.common.Entity;\n import megamek.common.MechSummary;\n import megamek.common.TechConstants;\n+import megamek.common.annotations.Nullable;\n \n import javax.swing.*;\n import java.awt.*;\n \n public class MegaMekLabUnitSelectorDialog extends AbstractUnitSelectorDialog {\n+\n+    private static final long serialVersionUID = -5288332297317618337L;\n+    \n     //region Variable Declarations\n     private Entity chosenEntity;\n     //endregion Variable Declarations\n@@ -96,4 +100,77 @@ public MechSummary getChosenMechSummary() {\n     public Entity getChosenEntity() {\n         return chosenEntity;\n     }\n+\n+    /**\n+     * Shows the {@code MegaMekLabUnitSelectorDialog} and returns\n+     * the selected entity, if any.\n+     * @param parentFrame The parent {@link JFrame}.\n+     * @return The selected {@link Entity}, or {@code null} if cancelled.\n+     */\n+    @Nullable\n+    public static Entity showDialog(JFrame parentFrame) {\n+        Result result = showDialogAndIncludeSummary(parentFrame);\n+        return result.getEntity();\n+    }\n+\n+    /**\n+     * Shows the {@code MegaMekLabUnitSelectorDialog} and returns\n+     * the result of the selection.\n+     * @param parentFrame The parent {@link JFrame}.\n+     * @return The result of the selection.\n+     */\n+    public static Result showDialogAndIncludeSummary(JFrame parentFrame) {\n+        Entity entity = null;\n+        MechSummary mechSummary = null;\n+\n+        UnitLoadingDialog unitLoadingDialog = new UnitLoadingDialog(parentFrame);\n+        try {\n+            unitLoadingDialog.setVisible(true);\n+            \n+            MegaMekLabUnitSelectorDialog viewer = new MegaMekLabUnitSelectorDialog(parentFrame, unitLoadingDialog);\n+            try {\n+                entity = viewer.getChosenEntity();\n+                mechSummary = viewer.getChosenMechSummary();\n+\n+                viewer.setVisible(false);\n+            } finally {\n+                viewer.dispose();\n+            }\n+        } finally {\n+            unitLoadingDialog.dispose();\n+        }\n+\n+        return new Result(entity, mechSummary);\n+    }\n+\n+    /**\n+     * Represents the result of a unit selection.\n+     */\n+    public static class Result {\n+        private final Entity entity;\n+        private final MechSummary mechSummary;\n+\n+        protected Result(Entity entity, MechSummary mechSummary) {\n+            this.entity = entity;\n+            this.mechSummary = mechSummary;\n+        }\n+\n+        /**\n+         * Gets the selected {@link Entity}, or {@code null}\n+         * if the dialog was cancelled.\n+         */\n+        @Nullable\n+        public Entity getEntity() {\n+            return entity;\n+        }\n+\n+        /**\n+         * Gets the selected {@link MechSummary}, or {@code null}\n+         * if the dialog was cancelled.\n+         */\n+        @Nullable\n+        public MechSummary getMechSummary() {\n+            return mechSummary;\n+        }\n+    }\n }"
  },
  {
    "sha": "fab7468369135ed37af9d62af0d76669d348f05f",
    "filename": "src/megameklab/com/ui/dialog/UnitPrintQueueDialog.java",
    "status": "modified",
    "additions": 1,
    "deletions": 8,
    "changes": 9,
    "blob_url": "https://github.com/MegaMek/megameklab/blob/d9e8bba94992edd4ee75f11a1db30f58086adbd0/src/megameklab/com/ui/dialog/UnitPrintQueueDialog.java",
    "raw_url": "https://github.com/MegaMek/megameklab/raw/d9e8bba94992edd4ee75f11a1db30f58086adbd0/src/megameklab/com/ui/dialog/UnitPrintQueueDialog.java",
    "contents_url": "https://api.github.com/repos/MegaMek/megameklab/contents/src/megameklab/com/ui/dialog/UnitPrintQueueDialog.java?ref=d9e8bba94992edd4ee75f11a1db30f58086adbd0",
    "patch": "@@ -40,7 +40,6 @@\n import javax.swing.WindowConstants;\n import javax.swing.filechooser.FileNameExtensionFilter;\n \n-import megamek.client.ui.swing.UnitLoadingDialog;\n import megamek.common.Entity;\n import megamek.common.MechFileParser;\n import megameklab.com.util.UnitPrintManager;\n@@ -163,13 +162,7 @@ public void actionPerformed(ActionEvent ae) {\n         }\n \n         if (ae.getSource().equals(bSelectCache)) {\n-            UnitLoadingDialog unitLoadingDialog = new UnitLoadingDialog(clientgui);\n-            unitLoadingDialog.setVisible(true);\n-            MegaMekLabUnitSelectorDialog viewer = new MegaMekLabUnitSelectorDialog(clientgui, unitLoadingDialog);\n-\n-            viewer.setVisible(false);\n-            Entity entity = viewer.getChosenEntity();\n-\n+            Entity entity = MegaMekLabUnitSelectorDialog.showDialog(clientgui);\n             if (entity != null) {\n                 units.add(entity);\n                 refresh();"
  },
  {
    "sha": "342c38b64f769b429e7470bbb1ff18ba89c450c2",
    "filename": "src/megameklab/com/util/MenuBarCreator.java",
    "status": "modified",
    "additions": 23,
    "deletions": 46,
    "changes": 69,
    "blob_url": "https://github.com/MegaMek/megameklab/blob/d9e8bba94992edd4ee75f11a1db30f58086adbd0/src/megameklab/com/util/MenuBarCreator.java",
    "raw_url": "https://github.com/MegaMek/megameklab/raw/d9e8bba94992edd4ee75f11a1db30f58086adbd0/src/megameklab/com/util/MenuBarCreator.java",
    "contents_url": "https://api.github.com/repos/MegaMek/megameklab/contents/src/megameklab/com/util/MenuBarCreator.java?ref=d9e8bba94992edd4ee75f11a1db30f58086adbd0",
    "patch": "@@ -529,69 +529,50 @@ private void refreshThemeMenu(String currentThemeName) {\n     }\n \n     private void jMenuGetUnitBVFromCache_actionPerformed() {\n-        UnitLoadingDialog unitLoadingDialog = new UnitLoadingDialog(parentFrame);\n-        unitLoadingDialog.setVisible(true);\n-        MegaMekLabUnitSelectorDialog viewer = new MegaMekLabUnitSelectorDialog(parentFrame, unitLoadingDialog);\n-\n-        Entity tempEntity = viewer.getChosenEntity();\n-        if(null == tempEntity) {\n+        Entity tempEntity = MegaMekLabUnitSelectorDialog.showDialog(parentFrame);\n+        if (tempEntity == null) {\n             return;\n         }\n+\n         tempEntity.calculateBattleValue(true, true);\n-        UnitUtil.showBVCalculations(tempEntity.getBVText(), parentFrame);\n \n+        UnitUtil.showBVCalculations(tempEntity.getBVText(), parentFrame);\n     }\n \n     private void jMenuGetUnitValidationFromCache_actionPerformed() {\n-        UnitLoadingDialog unitLoadingDialog = new UnitLoadingDialog(parentFrame);\n-        unitLoadingDialog.setVisible(true);\n-        MegaMekLabUnitSelectorDialog viewer = new MegaMekLabUnitSelectorDialog(parentFrame, unitLoadingDialog);\n-\n-        Entity tempEntity = viewer.getChosenEntity();\n-        if(null == tempEntity) {\n+        Entity tempEntity = MegaMekLabUnitSelectorDialog.showDialog(parentFrame);\n+        if (tempEntity == null) {\n             return;\n         }\n-        UnitUtil.showValidation(tempEntity, parentFrame);\n \n+        UnitUtil.showValidation(tempEntity, parentFrame);\n     }\n \n     private void jMenuGetUnitSpecsFromCache_actionPerformed() {\n-        UnitLoadingDialog unitLoadingDialog = new UnitLoadingDialog(parentFrame);\n-        unitLoadingDialog.setVisible(true);\n-        MegaMekLabUnitSelectorDialog viewer = new MegaMekLabUnitSelectorDialog(parentFrame, unitLoadingDialog);\n-\n-        Entity tempEntity = viewer.getChosenEntity();\n-        if(null == tempEntity) {\n+        Entity tempEntity = MegaMekLabUnitSelectorDialog.showDialog(parentFrame);\n+        if (tempEntity == null) {\n             return;\n         }\n-        UnitUtil.showUnitSpecs(tempEntity, parentFrame);\n \n+        UnitUtil.showUnitSpecs(tempEntity, parentFrame);\n     }\n \n     private void jMenuGetUnitBreakdownFromCache_actionPerformed() {\n-        UnitLoadingDialog unitLoadingDialog = new UnitLoadingDialog(parentFrame);\n-        unitLoadingDialog.setVisible(true);\n-        MegaMekLabUnitSelectorDialog viewer = new MegaMekLabUnitSelectorDialog(parentFrame, unitLoadingDialog);\n-\n-        Entity tempEntity = viewer.getChosenEntity();\n-        if(null == tempEntity) {\n+        Entity tempEntity = MegaMekLabUnitSelectorDialog.showDialog(parentFrame);\n+        if (tempEntity == null) {\n             return;\n         }\n-        UnitUtil.showUnitCostBreakDown(tempEntity, parentFrame);\n \n+        UnitUtil.showUnitCostBreakDown(tempEntity, parentFrame);\n     }\n     \n     private void jMenuGetUnitWeightBreakdownFromCache_actionPerformed() {\n-        UnitLoadingDialog unitLoadingDialog = new UnitLoadingDialog(parentFrame);\n-        unitLoadingDialog.setVisible(true);\n-        MegaMekLabUnitSelectorDialog viewer = new MegaMekLabUnitSelectorDialog(parentFrame, unitLoadingDialog);\n-\n-        Entity tempEntity = viewer.getChosenEntity();\n-        if(null == tempEntity) {\n+        Entity tempEntity = MegaMekLabUnitSelectorDialog.showDialog(parentFrame);\n+        if (tempEntity == null) {\n             return;\n         }\n-        UnitUtil.showUnitWeightBreakDown(tempEntity, parentFrame);\n \n+        UnitUtil.showUnitWeightBreakDown(tempEntity, parentFrame);\n     }\n \n     private void jMenuGetUnitBVFromFile_actionPerformed() {\n@@ -1118,15 +1099,11 @@ private void exportSummaryClipboard() {\n     }\n \n     private void loadUnit() {\n-        UnitLoadingDialog unitLoadingDialog = new UnitLoadingDialog(parentFrame);\n-        unitLoadingDialog.setVisible(true);\n-        MegaMekLabUnitSelectorDialog viewer = new MegaMekLabUnitSelectorDialog(parentFrame, unitLoadingDialog);\n-\n-        Entity newUnit = viewer.getChosenEntity();\n-        viewer.setVisible(false);\n-        viewer.dispose();\n+        MegaMekLabUnitSelectorDialog.Result result \n+                = MegaMekLabUnitSelectorDialog.showDialogAndIncludeSummary(parentFrame);\n \n-        if (null == newUnit) {\n+        Entity newUnit = result.getEntity();\n+        if (newUnit == null) {\n             return;\n         }\n \n@@ -1166,13 +1143,13 @@ private void loadUnit() {\n \n         UnitUtil.updateLoadedUnit(newUnit);\n \n-        if (viewer.getChosenMechSummary().getSourceFile().getName().endsWith(\".zip\")) {\n-            String fileName = viewer.getChosenMechSummary().getSourceFile().getAbsolutePath();\n+        if (result.getMechSummary().getSourceFile().getName().endsWith(\".zip\")) {\n+            String fileName = result.getMechSummary().getSourceFile().getAbsolutePath();\n             fileName = fileName.substring(0, fileName.lastIndexOf(File.separatorChar) + 1);\n             fileName = fileName + createUnitFilename(newUnit);\n             CConfig.updateSaveFiles(fileName);\n         } else {\n-            CConfig.updateSaveFiles(viewer.getChosenMechSummary().getSourceFile().getAbsolutePath());\n+            CConfig.updateSaveFiles(result.getMechSummary().getSourceFile().getAbsolutePath());\n         }\n         parentFrame.setEntity(newUnit);\n         reload();"
  },
  {
    "sha": "3908b3a338c7cff1e0cbc356009c0b3843da90ef",
    "filename": "src/megameklab/com/util/UnitPrintManager.java",
    "status": "modified",
    "additions": 1,
    "deletions": 9,
    "changes": 10,
    "blob_url": "https://github.com/MegaMek/megameklab/blob/d9e8bba94992edd4ee75f11a1db30f58086adbd0/src/megameklab/com/util/UnitPrintManager.java",
    "raw_url": "https://github.com/MegaMek/megameklab/raw/d9e8bba94992edd4ee75f11a1db30f58086adbd0/src/megameklab/com/util/UnitPrintManager.java",
    "contents_url": "https://api.github.com/repos/MegaMek/megameklab/contents/src/megameklab/com/util/UnitPrintManager.java?ref=d9e8bba94992edd4ee75f11a1db30f58086adbd0",
    "patch": "@@ -36,7 +36,6 @@\n import javax.swing.KeyStroke;\n import javax.swing.filechooser.FileNameExtensionFilter;\n \n-import megamek.client.ui.swing.UnitLoadingDialog;\n import megamek.common.Aero;\n import megamek.common.BattleArmor;\n import megamek.common.Dropship;\n@@ -392,20 +391,13 @@ public static JMenu exportMenu(final MegaMekLabMainUI parent) {\n     }\n \n     public static void printSelectedUnit(JFrame parent, boolean pdf) {\n-        UnitLoadingDialog unitLoadingDialog = new UnitLoadingDialog(parent);\n-        unitLoadingDialog.setVisible(true);\n-        MegaMekLabUnitSelectorDialog viewer = new MegaMekLabUnitSelectorDialog(parent, unitLoadingDialog);\n-\n-        viewer.setVisible(false);\n-        Entity entity = viewer.getChosenEntity();\n-\n+        Entity entity = MegaMekLabUnitSelectorDialog.showDialog(parent);\n         if (entity != null) {\n             if (pdf) {\n                 exportEntity(entity, parent);\n             } else {\n                 printEntity(entity);\n             }\n-            viewer.dispose();\n         }\n     }\n "
  }
]

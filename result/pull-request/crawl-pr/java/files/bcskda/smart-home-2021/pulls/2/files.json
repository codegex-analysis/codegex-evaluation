[
  {
    "sha": "1309ef9837926452a5ecbc3783798c6368387504",
    "filename": "src/main/java/ru/sbt/mipt/oop/Action.java",
    "status": "added",
    "additions": 5,
    "deletions": 0,
    "changes": 5,
    "blob_url": "https://github.com/bcskda/smart-home-2021/blob/1448aaa4157f6bd8d01c4245ef40abaaf3c49cd5/src/main/java/ru/sbt/mipt/oop/Action.java",
    "raw_url": "https://github.com/bcskda/smart-home-2021/raw/1448aaa4157f6bd8d01c4245ef40abaaf3c49cd5/src/main/java/ru/sbt/mipt/oop/Action.java",
    "contents_url": "https://api.github.com/repos/bcskda/smart-home-2021/contents/src/main/java/ru/sbt/mipt/oop/Action.java?ref=1448aaa4157f6bd8d01c4245ef40abaaf3c49cd5",
    "patch": "@@ -0,0 +1,5 @@\n+package ru.sbt.mipt.oop;\n+\n+public interface Action {\n+    void execute(HomeComponent component);\n+}"
  },
  {
    "sha": "30e892b747f4dc0d0fb531418b2526e9cf9cedcd",
    "filename": "src/main/java/ru/sbt/mipt/oop/Actionable.java",
    "status": "added",
    "additions": 5,
    "deletions": 0,
    "changes": 5,
    "blob_url": "https://github.com/bcskda/smart-home-2021/blob/1448aaa4157f6bd8d01c4245ef40abaaf3c49cd5/src/main/java/ru/sbt/mipt/oop/Actionable.java",
    "raw_url": "https://github.com/bcskda/smart-home-2021/raw/1448aaa4157f6bd8d01c4245ef40abaaf3c49cd5/src/main/java/ru/sbt/mipt/oop/Actionable.java",
    "contents_url": "https://api.github.com/repos/bcskda/smart-home-2021/contents/src/main/java/ru/sbt/mipt/oop/Actionable.java?ref=1448aaa4157f6bd8d01c4245ef40abaaf3c49cd5",
    "patch": "@@ -0,0 +1,5 @@\n+package ru.sbt.mipt.oop;\n+\n+public interface Actionable {\n+    void execute(Action action);\n+}"
  },
  {
    "sha": "7225d8fad870a8cf5461d1751e239a1670e1eaf0",
    "filename": "src/main/java/ru/sbt/mipt/oop/Application.java",
    "status": "modified",
    "additions": 2,
    "deletions": 1,
    "changes": 3,
    "blob_url": "https://github.com/bcskda/smart-home-2021/blob/1448aaa4157f6bd8d01c4245ef40abaaf3c49cd5/src/main/java/ru/sbt/mipt/oop/Application.java",
    "raw_url": "https://github.com/bcskda/smart-home-2021/raw/1448aaa4157f6bd8d01c4245ef40abaaf3c49cd5/src/main/java/ru/sbt/mipt/oop/Application.java",
    "contents_url": "https://api.github.com/repos/bcskda/smart-home-2021/contents/src/main/java/ru/sbt/mipt/oop/Application.java?ref=1448aaa4157f6bd8d01c4245ef40abaaf3c49cd5",
    "patch": "@@ -20,10 +20,11 @@ public static void main(String[] args) {\n             SmartHome smartHome = new JsonConfigurationReader(Paths.get(filename)).readSmartHome();\n \n             // обработчики и контроллер команд\n-            CommandSender commandSender = new CommandSenderImpl(makeCommandHandlers(smartHome));\n+            CommandSender commandSender = new CommandSenderImpl(smartHome, makeCommandHandlers(smartHome));\n \n             // обработчики событий\n             eventLoop = new SensorEventLoop(\n+                    smartHome,\n                     new RandomSensorEventSource(),\n                     makeEventHandlers(smartHome, commandSender));\n         } catch (Exception e) {"
  },
  {
    "sha": "1f2f5bc44e3c02a9fdea0003c1c05cafde1b039b",
    "filename": "src/main/java/ru/sbt/mipt/oop/CommandSenderImpl.java",
    "status": "modified",
    "additions": 6,
    "deletions": 2,
    "changes": 8,
    "blob_url": "https://github.com/bcskda/smart-home-2021/blob/1448aaa4157f6bd8d01c4245ef40abaaf3c49cd5/src/main/java/ru/sbt/mipt/oop/CommandSenderImpl.java",
    "raw_url": "https://github.com/bcskda/smart-home-2021/raw/1448aaa4157f6bd8d01c4245ef40abaaf3c49cd5/src/main/java/ru/sbt/mipt/oop/CommandSenderImpl.java",
    "contents_url": "https://api.github.com/repos/bcskda/smart-home-2021/contents/src/main/java/ru/sbt/mipt/oop/CommandSenderImpl.java?ref=1448aaa4157f6bd8d01c4245ef40abaaf3c49cd5",
    "patch": "@@ -6,17 +6,21 @@\n import java.util.List;\n \n public class CommandSenderImpl implements CommandSender {\n+    private final SmartHome smartHome;\n     private final List<SensorCommandHandler> commandHandlers;\n \n-    public CommandSenderImpl(List<SensorCommandHandler> commandHandlers) {\n+    public CommandSenderImpl(SmartHome smartHome, List<SensorCommandHandler> commandHandlers) {\n+        this.smartHome = smartHome;\n         this.commandHandlers = commandHandlers;\n     }\n \n     @Override\n     public void sendCommand(SensorCommand command) {\n         for (SensorCommandHandler handler : commandHandlers) {\n             try {\n-                handler.handleCommand(command);\n+                Action action = handler.handleCommand(command);\n+                if (action != null)\n+                    smartHome.execute(action);\n             } catch (Exception e) {\n                 e.printStackTrace();\n             }"
  },
  {
    "sha": "50dfe12526af84d18bac429ddde0e29f72e6beaa",
    "filename": "src/main/java/ru/sbt/mipt/oop/Door.java",
    "status": "modified",
    "additions": 6,
    "deletions": 1,
    "changes": 7,
    "blob_url": "https://github.com/bcskda/smart-home-2021/blob/1448aaa4157f6bd8d01c4245ef40abaaf3c49cd5/src/main/java/ru/sbt/mipt/oop/Door.java",
    "raw_url": "https://github.com/bcskda/smart-home-2021/raw/1448aaa4157f6bd8d01c4245ef40abaaf3c49cd5/src/main/java/ru/sbt/mipt/oop/Door.java",
    "contents_url": "https://api.github.com/repos/bcskda/smart-home-2021/contents/src/main/java/ru/sbt/mipt/oop/Door.java?ref=1448aaa4157f6bd8d01c4245ef40abaaf3c49cd5",
    "patch": "@@ -1,6 +1,6 @@\n package ru.sbt.mipt.oop;\n \n-public class Door {\n+public class Door implements HomeComponent, Actionable {\n     private final String id;\n     private boolean isOpen;\n \n@@ -20,4 +20,9 @@ public void setOpen(boolean open) {\n     public boolean isOpen() {\n         return isOpen;\n     }\n+\n+    @Override\n+    public void execute(Action action) {\n+        action.execute(this);\n+    }\n }"
  },
  {
    "sha": "ae5f52d5c7ca3fb9085c4e8e45206fe34919f99e",
    "filename": "src/main/java/ru/sbt/mipt/oop/HomeBuilder.java",
    "status": "modified",
    "additions": 32,
    "deletions": 29,
    "changes": 61,
    "blob_url": "https://github.com/bcskda/smart-home-2021/blob/1448aaa4157f6bd8d01c4245ef40abaaf3c49cd5/src/main/java/ru/sbt/mipt/oop/HomeBuilder.java",
    "raw_url": "https://github.com/bcskda/smart-home-2021/raw/1448aaa4157f6bd8d01c4245ef40abaaf3c49cd5/src/main/java/ru/sbt/mipt/oop/HomeBuilder.java",
    "contents_url": "https://api.github.com/repos/bcskda/smart-home-2021/contents/src/main/java/ru/sbt/mipt/oop/HomeBuilder.java?ref=1448aaa4157f6bd8d01c4245ef40abaaf3c49cd5",
    "patch": "@@ -8,41 +8,44 @@\n import java.nio.file.Files;\n import java.nio.file.Path;\n import java.nio.file.Paths;\n-import java.util.ArrayList;\n import java.util.Arrays;\n import java.util.Collections;\n \n public class HomeBuilder {\n \n     public static void main(String[] args) throws IOException {\n-        Room kitchen = new Room(new ArrayList<>(), new ArrayList<>(), \"kitchen\");\n-        kitchen.getLights().addAll(Arrays.asList(\n-                new Light(\"1\", false),\n-                new Light(\"2\", true)));\n-        kitchen.getDoors().addAll(Collections.singletonList(\n-                new Door(\"1\", false)));\n-\n-        Room bathroom = new Room(new ArrayList<>(), new ArrayList<>(), \"bathroom\");\n-        bathroom.getLights().addAll(Collections.singletonList(\n-                new Light(\"3\", true)));\n-        bathroom.getDoors().addAll(Collections.singletonList(\n-                new Door(\"2\", false)));\n-\n-        Room bedroom = new Room(new ArrayList<>(), new ArrayList<>(), \"bedroom\");\n-        bedroom.getLights().addAll(Arrays.asList(\n-                new Light(\"4\", false),\n-                new Light(\"5\", false),\n-                new Light(\"6\", false)));\n-        bedroom.getDoors().addAll(Collections.singletonList(\n-                new Door(\"3\",  true)));\n-\n-        Room hall = new Room(new ArrayList<>(), new ArrayList<>(), \"hall\");\n-        hall.getLights().addAll(Arrays.asList(\n-                new Light(\"7\", false),\n-                new Light(\"8\", false),\n-                new Light(\"9\", false)));\n-        hall.getDoors().addAll(Collections.singletonList(\n-                new Door(\"4\", false)));\n+        Room kitchen = new Room(\n+                Arrays.asList(\n+                        new Light(\"1\", false),\n+                        new Light(\"2\", true)),\n+                Collections.singletonList(\n+                        new Door(\"1\", false)),\n+                \"kitchen\");\n+\n+        Room bathroom = new Room(\n+                Collections.singletonList(\n+                        new Light(\"3\", true)),\n+                Collections.singletonList(\n+                        new Door(\"2\", false)),\n+                \"bathroom\");\n+\n+        Room bedroom = new Room(\n+                Arrays.asList(\n+                        new Light(\"4\", false),\n+                        new Light(\"5\", false),\n+                        new Light(\"6\", false)),\n+                Collections.singletonList(\n+                        new Door(\"3\", true)),\n+                \"bedroom\");\n+\n+        Room hall = new Room(\n+                Arrays.asList(\n+                        new Light(\"7\", false),\n+                        new Light(\"8\", false),\n+                        new Light(\"9\", false)),\n+                Collections.singletonList(\n+                        new Door(\"4\", false)),\n+                \"hall\");\n \n         SmartHome smartHome = new SmartHome(Arrays.asList(kitchen, bathroom, bedroom, hall));\n         Gson gson = new GsonBuilder()"
  },
  {
    "sha": "cb536fdc398c10013b9c60cd34b98aa906f9b107",
    "filename": "src/main/java/ru/sbt/mipt/oop/HomeComponent.java",
    "status": "added",
    "additions": 4,
    "deletions": 0,
    "changes": 4,
    "blob_url": "https://github.com/bcskda/smart-home-2021/blob/1448aaa4157f6bd8d01c4245ef40abaaf3c49cd5/src/main/java/ru/sbt/mipt/oop/HomeComponent.java",
    "raw_url": "https://github.com/bcskda/smart-home-2021/raw/1448aaa4157f6bd8d01c4245ef40abaaf3c49cd5/src/main/java/ru/sbt/mipt/oop/HomeComponent.java",
    "contents_url": "https://api.github.com/repos/bcskda/smart-home-2021/contents/src/main/java/ru/sbt/mipt/oop/HomeComponent.java?ref=1448aaa4157f6bd8d01c4245ef40abaaf3c49cd5",
    "patch": "@@ -0,0 +1,4 @@\n+package ru.sbt.mipt.oop;\n+\n+public interface HomeComponent {\n+}"
  },
  {
    "sha": "4e8df93a04bcaf8016c50e73461fcdee045015e8",
    "filename": "src/main/java/ru/sbt/mipt/oop/Light.java",
    "status": "modified",
    "additions": 6,
    "deletions": 1,
    "changes": 7,
    "blob_url": "https://github.com/bcskda/smart-home-2021/blob/1448aaa4157f6bd8d01c4245ef40abaaf3c49cd5/src/main/java/ru/sbt/mipt/oop/Light.java",
    "raw_url": "https://github.com/bcskda/smart-home-2021/raw/1448aaa4157f6bd8d01c4245ef40abaaf3c49cd5/src/main/java/ru/sbt/mipt/oop/Light.java",
    "contents_url": "https://api.github.com/repos/bcskda/smart-home-2021/contents/src/main/java/ru/sbt/mipt/oop/Light.java?ref=1448aaa4157f6bd8d01c4245ef40abaaf3c49cd5",
    "patch": "@@ -1,6 +1,6 @@\n package ru.sbt.mipt.oop;\n \n-public class Light {\n+public class Light implements HomeComponent, Actionable {\n     private boolean isOn;\n     private final String id;\n \n@@ -20,4 +20,9 @@ public String getId() {\n     public void setOn(boolean on) {\n         isOn = on;\n     }\n+\n+    @Override\n+    public void execute(Action action) {\n+        action.execute(this);\n+    }\n }"
  },
  {
    "sha": "9402193825eeebee6c553fd84d59a13dd7b57b46",
    "filename": "src/main/java/ru/sbt/mipt/oop/Room.java",
    "status": "modified",
    "additions": 17,
    "deletions": 15,
    "changes": 32,
    "blob_url": "https://github.com/bcskda/smart-home-2021/blob/1448aaa4157f6bd8d01c4245ef40abaaf3c49cd5/src/main/java/ru/sbt/mipt/oop/Room.java",
    "raw_url": "https://github.com/bcskda/smart-home-2021/raw/1448aaa4157f6bd8d01c4245ef40abaaf3c49cd5/src/main/java/ru/sbt/mipt/oop/Room.java",
    "contents_url": "https://api.github.com/repos/bcskda/smart-home-2021/contents/src/main/java/ru/sbt/mipt/oop/Room.java?ref=1448aaa4157f6bd8d01c4245ef40abaaf3c49cd5",
    "patch": "@@ -1,32 +1,34 @@\n package ru.sbt.mipt.oop;\n \n-import com.google.gson.annotations.Expose;\n-\n import java.util.Collection;\n \n-public class Room {\n-    @Expose\n-    private Collection<Light> lights;\n-    @Expose\n-    private Collection<Door> doors;\n-    @Expose\n-    private String name;\n+public class Room implements HomeComponent, Actionable {\n+    private final Collection<Light> lights;\n+    private final Collection<Door> doors;\n+    private final String name;\n \n     public Room(Collection<Light> lights, Collection<Door> doors, String name) {\n         this.lights = lights;\n         this.doors = doors;\n         this.name = name;\n     }\n \n-    public Collection<Light> getLights() {\n-        return lights;\n+    public String getName() {\n+        return name;\n     }\n \n-    public Collection<Door> getDoors() {\n-        return doors;\n+    public void forEachLight(Action action) {\n+        lights.forEach(light -> light.execute(action));\n     }\n \n-    public String getName() {\n-        return name;\n+    public void forEachDoor(Action action) {\n+        doors.forEach(door -> door.execute(action));\n+    }\n+\n+    @Override\n+    public void execute(Action action) {\n+        action.execute(this);\n+        forEachLight(action);\n+        forEachDoor(action);\n     }\n }"
  },
  {
    "sha": "c556e0b684a3d490215b973064950409fb669ae0",
    "filename": "src/main/java/ru/sbt/mipt/oop/SensorEventLoop.java",
    "status": "modified",
    "additions": 7,
    "deletions": 2,
    "changes": 9,
    "blob_url": "https://github.com/bcskda/smart-home-2021/blob/1448aaa4157f6bd8d01c4245ef40abaaf3c49cd5/src/main/java/ru/sbt/mipt/oop/SensorEventLoop.java",
    "raw_url": "https://github.com/bcskda/smart-home-2021/raw/1448aaa4157f6bd8d01c4245ef40abaaf3c49cd5/src/main/java/ru/sbt/mipt/oop/SensorEventLoop.java",
    "contents_url": "https://api.github.com/repos/bcskda/smart-home-2021/contents/src/main/java/ru/sbt/mipt/oop/SensorEventLoop.java?ref=1448aaa4157f6bd8d01c4245ef40abaaf3c49cd5",
    "patch": "@@ -9,11 +9,14 @@\n import java.util.Map;\n \n public class SensorEventLoop {\n+    SmartHome smartHome;\n     SensorEventSource eventSource;\n     List<SensorEventHandler> eventHandlers;\n \n-    public SensorEventLoop(SensorEventSource eventSource,\n+    public SensorEventLoop(SmartHome smartHome,\n+                           SensorEventSource eventSource,\n                            List<SensorEventHandler> eventHandlers) {\n+        this.smartHome = smartHome;\n         this.eventSource = eventSource;\n         this.eventHandlers = eventHandlers;\n     }\n@@ -42,7 +45,9 @@ void runCatchSuppress() {\n     private void handleEvent(SensorEvent event) {\n         for (SensorEventHandler eventHandler : eventHandlers) {\n             try {\n-                eventHandler.handleEvent(event);\n+                Action action = eventHandler.handleEvent(event);\n+                if (action != null)\n+                    smartHome.execute(action);\n             } catch (Exception e) {\n                 e.printStackTrace();\n             }"
  },
  {
    "sha": "6ff62ddb673964985ebb34454db55a75de17625a",
    "filename": "src/main/java/ru/sbt/mipt/oop/SmartHome.java",
    "status": "modified",
    "additions": 7,
    "deletions": 26,
    "changes": 33,
    "blob_url": "https://github.com/bcskda/smart-home-2021/blob/1448aaa4157f6bd8d01c4245ef40abaaf3c49cd5/src/main/java/ru/sbt/mipt/oop/SmartHome.java",
    "raw_url": "https://github.com/bcskda/smart-home-2021/raw/1448aaa4157f6bd8d01c4245ef40abaaf3c49cd5/src/main/java/ru/sbt/mipt/oop/SmartHome.java",
    "contents_url": "https://api.github.com/repos/bcskda/smart-home-2021/contents/src/main/java/ru/sbt/mipt/oop/SmartHome.java?ref=1448aaa4157f6bd8d01c4245ef40abaaf3c49cd5",
    "patch": "@@ -2,16 +2,10 @@\n \n import java.util.ArrayList;\n import java.util.Collection;\n-import java.util.HashMap;\n-import java.util.Map;\n \n-public class SmartHome {\n+public class SmartHome implements HomeComponent, Actionable {\n     SmartHomeStorage storage = new SmartHomeStorage();\n \n-    Map<String, Light> lightsById = new HashMap<>();\n-    Map<String, Door> doorsById = new HashMap<>();\n-    Map<Door, Room> roomsByDoor = new HashMap<>();\n-\n     public SmartHome() {\n         this(new ArrayList<>());\n     }\n@@ -23,28 +17,15 @@ public SmartHome(Collection<Room> rooms) {\n     // Update\n     public void addRoom(Room room) {\n         storage.rooms.add(room);\n-        for (Light light : room.getLights()) {\n-            lightsById.put(light.getId(), light);\n-        }\n-        for (Door door : room.getDoors()) {\n-            doorsById.put(door.getId(), door);\n-            roomsByDoor.put(door, room);\n-        }\n-    }\n-\n-    public Collection<Room> getRooms() {\n-        return storage.getRooms();\n-    }\n-\n-    public Light getLightById(String lightId) {\n-        return lightsById.get(lightId);\n     }\n \n-    public Door getDoorById(String doorId) {\n-        return doorsById.get(doorId);\n+    public void forEachRoom(Action action) {\n+        storage.getRooms().forEach(room -> room.execute(action));\n     }\n \n-    public Room getRoomByDoor(Door door) {\n-        return roomsByDoor.get(door);\n+    @Override\n+    public void execute(Action action) {\n+        action.execute(this);\n+        forEachRoom(action);\n     }\n }"
  },
  {
    "sha": "c9c6ab6c052456c1c75e72d84952730dc377fea2",
    "filename": "src/main/java/ru/sbt/mipt/oop/commands/handlers/LightOffCommandHandler.java",
    "status": "modified",
    "additions": 12,
    "deletions": 10,
    "changes": 22,
    "blob_url": "https://github.com/bcskda/smart-home-2021/blob/1448aaa4157f6bd8d01c4245ef40abaaf3c49cd5/src/main/java/ru/sbt/mipt/oop/commands/handlers/LightOffCommandHandler.java",
    "raw_url": "https://github.com/bcskda/smart-home-2021/raw/1448aaa4157f6bd8d01c4245ef40abaaf3c49cd5/src/main/java/ru/sbt/mipt/oop/commands/handlers/LightOffCommandHandler.java",
    "contents_url": "https://api.github.com/repos/bcskda/smart-home-2021/contents/src/main/java/ru/sbt/mipt/oop/commands/handlers/LightOffCommandHandler.java?ref=1448aaa4157f6bd8d01c4245ef40abaaf3c49cd5",
    "patch": "@@ -1,5 +1,6 @@\n package ru.sbt.mipt.oop.commands.handlers;\n \n+import ru.sbt.mipt.oop.Action;\n import ru.sbt.mipt.oop.Light;\n import ru.sbt.mipt.oop.SmartHome;\n import ru.sbt.mipt.oop.commands.SensorCommand;\n@@ -14,18 +15,19 @@ public LightOffCommandHandler(SmartHome smartHome) {\n     }\n \n     @Override\n-    public void handleCommand(SensorCommand command) {\n+    public Action handleCommand(SensorCommand command) {\n         if (command.getType() != LIGHT_OFF)\n-            return;\n-        Light light = smartHome.getLightById(command.getObjectId());\n-        if (light == null) {\n-            throw new IllegalArgumentException(\n-                    \"No light with id \" + command.getObjectId());\n-        }\n-        onLightOff(light);\n+            return null;\n+        return onLightOff(command);\n     }\n \n-    private void onLightOff(Light light) {\n-        light.setOn(false);\n+    private Action onLightOff(SensorCommand command) {\n+        return component -> {\n+            if (! (component instanceof Light))\n+                return;\n+            Light light = (Light) component;\n+            if (command.getObjectId().equals(light.getId()))\n+                light.setOn(false);\n+        };\n     }\n }"
  },
  {
    "sha": "dc7fa078c33226346046f4a989bdbc595a8821f5",
    "filename": "src/main/java/ru/sbt/mipt/oop/commands/handlers/LogCommandHandler.java",
    "status": "modified",
    "additions": 3,
    "deletions": 1,
    "changes": 4,
    "blob_url": "https://github.com/bcskda/smart-home-2021/blob/1448aaa4157f6bd8d01c4245ef40abaaf3c49cd5/src/main/java/ru/sbt/mipt/oop/commands/handlers/LogCommandHandler.java",
    "raw_url": "https://github.com/bcskda/smart-home-2021/raw/1448aaa4157f6bd8d01c4245ef40abaaf3c49cd5/src/main/java/ru/sbt/mipt/oop/commands/handlers/LogCommandHandler.java",
    "contents_url": "https://api.github.com/repos/bcskda/smart-home-2021/contents/src/main/java/ru/sbt/mipt/oop/commands/handlers/LogCommandHandler.java?ref=1448aaa4157f6bd8d01c4245ef40abaaf3c49cd5",
    "patch": "@@ -1,10 +1,12 @@\n package ru.sbt.mipt.oop.commands.handlers;\n \n+import ru.sbt.mipt.oop.Action;\n import ru.sbt.mipt.oop.commands.SensorCommand;\n \n public class LogCommandHandler implements SensorCommandHandler {\n     @Override\n-    public void handleCommand(SensorCommand command) {\n+    public Action handleCommand(SensorCommand command) {\n         System.err.println(command);\n+        return null;\n     }\n }"
  },
  {
    "sha": "98c31f9d46a6ce4605fdcbfc06d5ff7aba79ac28",
    "filename": "src/main/java/ru/sbt/mipt/oop/commands/handlers/SensorCommandHandler.java",
    "status": "modified",
    "additions": 2,
    "deletions": 1,
    "changes": 3,
    "blob_url": "https://github.com/bcskda/smart-home-2021/blob/1448aaa4157f6bd8d01c4245ef40abaaf3c49cd5/src/main/java/ru/sbt/mipt/oop/commands/handlers/SensorCommandHandler.java",
    "raw_url": "https://github.com/bcskda/smart-home-2021/raw/1448aaa4157f6bd8d01c4245ef40abaaf3c49cd5/src/main/java/ru/sbt/mipt/oop/commands/handlers/SensorCommandHandler.java",
    "contents_url": "https://api.github.com/repos/bcskda/smart-home-2021/contents/src/main/java/ru/sbt/mipt/oop/commands/handlers/SensorCommandHandler.java?ref=1448aaa4157f6bd8d01c4245ef40abaaf3c49cd5",
    "patch": "@@ -1,7 +1,8 @@\n package ru.sbt.mipt.oop.commands.handlers;\n \n+import ru.sbt.mipt.oop.Action;\n import ru.sbt.mipt.oop.commands.SensorCommand;\n \n public interface SensorCommandHandler {\n-    void handleCommand(SensorCommand command);\n+    Action handleCommand(SensorCommand command);\n }"
  },
  {
    "sha": "98dfbd86c25c6fbc44b005eafc492c997c47e447",
    "filename": "src/main/java/ru/sbt/mipt/oop/events/handlers/DoorClosedEventHandler.java",
    "status": "modified",
    "additions": 11,
    "deletions": 10,
    "changes": 21,
    "blob_url": "https://github.com/bcskda/smart-home-2021/blob/1448aaa4157f6bd8d01c4245ef40abaaf3c49cd5/src/main/java/ru/sbt/mipt/oop/events/handlers/DoorClosedEventHandler.java",
    "raw_url": "https://github.com/bcskda/smart-home-2021/raw/1448aaa4157f6bd8d01c4245ef40abaaf3c49cd5/src/main/java/ru/sbt/mipt/oop/events/handlers/DoorClosedEventHandler.java",
    "contents_url": "https://api.github.com/repos/bcskda/smart-home-2021/contents/src/main/java/ru/sbt/mipt/oop/events/handlers/DoorClosedEventHandler.java?ref=1448aaa4157f6bd8d01c4245ef40abaaf3c49cd5",
    "patch": "@@ -13,18 +13,19 @@ public DoorClosedEventHandler(SmartHome smartHome) {\n     }\n \n     @Override\n-    public void handleEvent(SensorEvent event) {\n+    public Action handleEvent(SensorEvent event) {\n         if (event.getType() != DOOR_CLOSED)\n-            return;\n-        Door door = smartHome.getDoorById(event.getObjectId());\n-        if (door == null) {\n-            throw new IllegalArgumentException(\n-                    \"No door with id \" + event.getObjectId());\n-        }\n-        onDoorClose(door);\n+            return null;\n+        return onDoorClose(event);\n     }\n \n-    private void onDoorClose(Door door) {\n-        door.setOpen(false);\n+    private Action onDoorClose(SensorEvent event) {\n+        return component -> {\n+            if (! (component instanceof Door))\n+                return;\n+            Door door = (Door) component;\n+            if (event.getObjectId().equals(door.getId()))\n+                door.setOpen(false);\n+        };\n     }\n }"
  },
  {
    "sha": "a8d41758305896de1fd91f232d10e55efdfd256e",
    "filename": "src/main/java/ru/sbt/mipt/oop/events/handlers/DoorOpenEventHandler.java",
    "status": "modified",
    "additions": 12,
    "deletions": 10,
    "changes": 22,
    "blob_url": "https://github.com/bcskda/smart-home-2021/blob/1448aaa4157f6bd8d01c4245ef40abaaf3c49cd5/src/main/java/ru/sbt/mipt/oop/events/handlers/DoorOpenEventHandler.java",
    "raw_url": "https://github.com/bcskda/smart-home-2021/raw/1448aaa4157f6bd8d01c4245ef40abaaf3c49cd5/src/main/java/ru/sbt/mipt/oop/events/handlers/DoorOpenEventHandler.java",
    "contents_url": "https://api.github.com/repos/bcskda/smart-home-2021/contents/src/main/java/ru/sbt/mipt/oop/events/handlers/DoorOpenEventHandler.java?ref=1448aaa4157f6bd8d01c4245ef40abaaf3c49cd5",
    "patch": "@@ -1,5 +1,6 @@\n package ru.sbt.mipt.oop.events.handlers;\n \n+import ru.sbt.mipt.oop.Action;\n import ru.sbt.mipt.oop.Door;\n import ru.sbt.mipt.oop.SmartHome;\n import ru.sbt.mipt.oop.events.SensorEvent;\n@@ -14,18 +15,19 @@ public DoorOpenEventHandler(SmartHome smartHome) {\n     }\n \n     @Override\n-    public void handleEvent(SensorEvent event) {\n+    public Action handleEvent(SensorEvent event) {\n         if (event.getType() != DOOR_OPEN)\n-            return;\n-        Door door = smartHome.getDoorById(event.getObjectId());\n-        if (door == null) {\n-            throw new IllegalArgumentException(\n-                    \"No door with id \" + event.getObjectId());\n-        }\n-        onDoorOpen(door);\n+            return null;\n+        return onDoorOpen(event);\n     }\n \n-    private void onDoorOpen(Door door) {\n-        door.setOpen(true);\n+    private Action onDoorOpen(SensorEvent event) {\n+        return component -> {\n+            if (! (component instanceof Door))\n+                return;\n+            Door door = (Door) component;\n+            if (event.getObjectId().equals(door.getId()))\n+                door.setOpen(true);\n+        };\n     }\n }"
  },
  {
    "sha": "1205f0306350f56486d319ebdfec68774709a0e1",
    "filename": "src/main/java/ru/sbt/mipt/oop/events/handlers/HallDoorClosedThenLightsOffHandler.java",
    "status": "modified",
    "additions": 34,
    "deletions": 18,
    "changes": 52,
    "blob_url": "https://github.com/bcskda/smart-home-2021/blob/1448aaa4157f6bd8d01c4245ef40abaaf3c49cd5/src/main/java/ru/sbt/mipt/oop/events/handlers/HallDoorClosedThenLightsOffHandler.java",
    "raw_url": "https://github.com/bcskda/smart-home-2021/raw/1448aaa4157f6bd8d01c4245ef40abaaf3c49cd5/src/main/java/ru/sbt/mipt/oop/events/handlers/HallDoorClosedThenLightsOffHandler.java",
    "contents_url": "https://api.github.com/repos/bcskda/smart-home-2021/contents/src/main/java/ru/sbt/mipt/oop/events/handlers/HallDoorClosedThenLightsOffHandler.java?ref=1448aaa4157f6bd8d01c4245ef40abaaf3c49cd5",
    "patch": "@@ -1,8 +1,6 @@\n package ru.sbt.mipt.oop.events.handlers;\n \n import ru.sbt.mipt.oop.*;\n-import ru.sbt.mipt.oop.commands.CommandType;\n-import ru.sbt.mipt.oop.commands.SensorCommand;\n import ru.sbt.mipt.oop.events.SensorEvent;\n \n import static ru.sbt.mipt.oop.events.SensorEventType.DOOR_CLOSED;\n@@ -17,24 +15,42 @@ public HallDoorClosedThenLightsOffHandler(CommandSender controller, SmartHome sm\n     }\n \n     @Override\n-    public void handleEvent(SensorEvent event) {\n+    public Action handleEvent(SensorEvent event) {\n         if (event.getType() != DOOR_CLOSED)\n-            return;\n-        Door door = smartHome.getDoorById(event.getObjectId());\n-        if (door == null) {\n-            throw new IllegalArgumentException(\n-                    \"No door with id \" + event.getObjectId());\n-        }\n-        if (\"hall\".equals(smartHome.getRoomByDoor(door).getName()))\n-            onHallDoorClose();\n+            return null;\n+        return onAnyDoorClosed(event);\n     }\n \n-    private void onHallDoorClose() {\n-        for (Room homeRoom : smartHome.getRooms()) {\n-            for (Light light : homeRoom.getLights()) {\n-                SensorCommand command = new SensorCommand(CommandType.LIGHT_OFF, light.getId());\n-                controller.sendCommand(command);\n-            }\n-        }\n+    private Action onAnyDoorClosed(SensorEvent event) {\n+        return component -> {\n+            if (! (component instanceof Room))\n+                return;\n+            Room room = (Room) component;\n+            if (! \"hall\".equals(room.getName()))\n+                return;\n+            room.execute(containsThisDoorThen(event, () -> {\n+                smartHome.execute(onHallDoorClose());\n+            }));\n+        };\n+    }\n+\n+    private Action containsThisDoorThen(SensorEvent event, Runnable then) {\n+        return component -> {\n+            if (! (component instanceof Door))\n+                return;\n+            Door door = ((Door) component);\n+            if (! event.getObjectId().equals(door.getId()))\n+                return;\n+            then.run();\n+        };\n+    }\n+\n+    private Action onHallDoorClose() {\n+        return component -> {\n+            if (! (component instanceof Room))\n+                return;\n+            Room asRoom = (Room) component;\n+            asRoom.forEachLight(light -> ((Light) light).setOn(false));\n+        };\n     }\n }"
  },
  {
    "sha": "8e9009982c11b70daa381a399b96315d9e535e27",
    "filename": "src/main/java/ru/sbt/mipt/oop/events/handlers/LightOffEventHandler.java",
    "status": "modified",
    "additions": 12,
    "deletions": 10,
    "changes": 22,
    "blob_url": "https://github.com/bcskda/smart-home-2021/blob/1448aaa4157f6bd8d01c4245ef40abaaf3c49cd5/src/main/java/ru/sbt/mipt/oop/events/handlers/LightOffEventHandler.java",
    "raw_url": "https://github.com/bcskda/smart-home-2021/raw/1448aaa4157f6bd8d01c4245ef40abaaf3c49cd5/src/main/java/ru/sbt/mipt/oop/events/handlers/LightOffEventHandler.java",
    "contents_url": "https://api.github.com/repos/bcskda/smart-home-2021/contents/src/main/java/ru/sbt/mipt/oop/events/handlers/LightOffEventHandler.java?ref=1448aaa4157f6bd8d01c4245ef40abaaf3c49cd5",
    "patch": "@@ -1,5 +1,6 @@\n package ru.sbt.mipt.oop.events.handlers;\n \n+import ru.sbt.mipt.oop.Action;\n import ru.sbt.mipt.oop.Light;\n import ru.sbt.mipt.oop.SmartHome;\n import ru.sbt.mipt.oop.events.SensorEvent;\n@@ -14,18 +15,19 @@ public LightOffEventHandler(SmartHome smartHome) {\n     }\n \n     @Override\n-    public void handleEvent(SensorEvent event) {\n+    public Action handleEvent(SensorEvent event) {\n         if (event.getType() != LIGHT_OFF)\n-            return;\n-        Light light = smartHome.getLightById(event.getObjectId());\n-        if (light == null) {\n-            throw new IllegalArgumentException(\n-                    \"No light with id \" + event.getObjectId());\n-        }\n-        onLightOff(light);\n+            return null;\n+        return onLightOff(event);\n     }\n \n-    private void onLightOff(Light light) {\n-        light.setOn(false);\n+    private Action onLightOff(SensorEvent event) {\n+        return component -> {\n+            if (! (component instanceof Light))\n+                return;\n+            Light light = (Light) component;\n+            if (event.getObjectId().equals(light.getId()))\n+                light.setOn(false);\n+        };\n     }\n }"
  },
  {
    "sha": "38d64b3396371cc3763722c3b46de2801e795558",
    "filename": "src/main/java/ru/sbt/mipt/oop/events/handlers/LightOnEventHandler.java",
    "status": "modified",
    "additions": 13,
    "deletions": 10,
    "changes": 23,
    "blob_url": "https://github.com/bcskda/smart-home-2021/blob/1448aaa4157f6bd8d01c4245ef40abaaf3c49cd5/src/main/java/ru/sbt/mipt/oop/events/handlers/LightOnEventHandler.java",
    "raw_url": "https://github.com/bcskda/smart-home-2021/raw/1448aaa4157f6bd8d01c4245ef40abaaf3c49cd5/src/main/java/ru/sbt/mipt/oop/events/handlers/LightOnEventHandler.java",
    "contents_url": "https://api.github.com/repos/bcskda/smart-home-2021/contents/src/main/java/ru/sbt/mipt/oop/events/handlers/LightOnEventHandler.java?ref=1448aaa4157f6bd8d01c4245ef40abaaf3c49cd5",
    "patch": "@@ -1,7 +1,9 @@\n package ru.sbt.mipt.oop.events.handlers;\n \n+import ru.sbt.mipt.oop.Action;\n import ru.sbt.mipt.oop.Light;\n import ru.sbt.mipt.oop.SmartHome;\n+import ru.sbt.mipt.oop.commands.SensorCommand;\n import ru.sbt.mipt.oop.events.SensorEvent;\n \n import static ru.sbt.mipt.oop.events.SensorEventType.LIGHT_ON;\n@@ -14,18 +16,19 @@ public LightOnEventHandler(SmartHome smartHome) {\n     }\n \n     @Override\n-    public void handleEvent(SensorEvent event) {\n+    public Action handleEvent(SensorEvent event) {\n         if (event.getType() != LIGHT_ON)\n-            return;\n-        Light light = smartHome.getLightById(event.getObjectId());\n-        if (light == null) {\n-            throw new IllegalArgumentException(\n-                    \"No light with id \" + event.getObjectId());\n-        }\n-        onLightOn(light);\n+            return null;\n+        return onLightOn(event);\n     }\n \n-    private void onLightOn(Light light) {\n-        light.setOn(true);\n+    private Action onLightOn(SensorEvent event) {\n+        return component -> {\n+            if (! (component instanceof Light))\n+                return;\n+            Light light = (Light) component;\n+            if (event.getObjectId().equals(light.getId()))\n+                light.setOn(true);\n+        };\n     }\n }"
  },
  {
    "sha": "cf62b1866d7c78c14f792c494c3520187da70e24",
    "filename": "src/main/java/ru/sbt/mipt/oop/events/handlers/LogEventHandler.java",
    "status": "modified",
    "additions": 3,
    "deletions": 1,
    "changes": 4,
    "blob_url": "https://github.com/bcskda/smart-home-2021/blob/1448aaa4157f6bd8d01c4245ef40abaaf3c49cd5/src/main/java/ru/sbt/mipt/oop/events/handlers/LogEventHandler.java",
    "raw_url": "https://github.com/bcskda/smart-home-2021/raw/1448aaa4157f6bd8d01c4245ef40abaaf3c49cd5/src/main/java/ru/sbt/mipt/oop/events/handlers/LogEventHandler.java",
    "contents_url": "https://api.github.com/repos/bcskda/smart-home-2021/contents/src/main/java/ru/sbt/mipt/oop/events/handlers/LogEventHandler.java?ref=1448aaa4157f6bd8d01c4245ef40abaaf3c49cd5",
    "patch": "@@ -1,10 +1,12 @@\n package ru.sbt.mipt.oop.events.handlers;\n \n+import ru.sbt.mipt.oop.Action;\n import ru.sbt.mipt.oop.events.SensorEvent;\n \n public class LogEventHandler implements SensorEventHandler {\n     @Override\n-    public void handleEvent(SensorEvent event) {\n+    public Action handleEvent(SensorEvent event) {\n         System.err.println(event);\n+        return null;\n     }\n }"
  },
  {
    "sha": "f84274ffb6a770dc5a3d2b1f8a625a6148f9bb27",
    "filename": "src/main/java/ru/sbt/mipt/oop/events/handlers/SensorEventHandler.java",
    "status": "modified",
    "additions": 2,
    "deletions": 1,
    "changes": 3,
    "blob_url": "https://github.com/bcskda/smart-home-2021/blob/1448aaa4157f6bd8d01c4245ef40abaaf3c49cd5/src/main/java/ru/sbt/mipt/oop/events/handlers/SensorEventHandler.java",
    "raw_url": "https://github.com/bcskda/smart-home-2021/raw/1448aaa4157f6bd8d01c4245ef40abaaf3c49cd5/src/main/java/ru/sbt/mipt/oop/events/handlers/SensorEventHandler.java",
    "contents_url": "https://api.github.com/repos/bcskda/smart-home-2021/contents/src/main/java/ru/sbt/mipt/oop/events/handlers/SensorEventHandler.java?ref=1448aaa4157f6bd8d01c4245ef40abaaf3c49cd5",
    "patch": "@@ -1,7 +1,8 @@\n package ru.sbt.mipt.oop.events.handlers;\n \n+import ru.sbt.mipt.oop.Action;\n import ru.sbt.mipt.oop.events.SensorEvent;\n \n public interface SensorEventHandler {\n-    void handleEvent(SensorEvent event);\n+    Action handleEvent(SensorEvent event);\n }"
  },
  {
    "sha": "bf190f7e85dda21faad9ffca804d78b3900acc79",
    "filename": "src/test/java/ru/sbt/mipt/oop/CommandTests.java",
    "status": "added",
    "additions": 41,
    "deletions": 0,
    "changes": 41,
    "blob_url": "https://github.com/bcskda/smart-home-2021/blob/1448aaa4157f6bd8d01c4245ef40abaaf3c49cd5/src/test/java/ru/sbt/mipt/oop/CommandTests.java",
    "raw_url": "https://github.com/bcskda/smart-home-2021/raw/1448aaa4157f6bd8d01c4245ef40abaaf3c49cd5/src/test/java/ru/sbt/mipt/oop/CommandTests.java",
    "contents_url": "https://api.github.com/repos/bcskda/smart-home-2021/contents/src/test/java/ru/sbt/mipt/oop/CommandTests.java?ref=1448aaa4157f6bd8d01c4245ef40abaaf3c49cd5",
    "patch": "@@ -0,0 +1,41 @@\n+package ru.sbt.mipt.oop;\n+\n+import org.junit.Assert;\n+import org.junit.Before;\n+import org.junit.Test;\n+import ru.sbt.mipt.oop.commands.CommandType;\n+import ru.sbt.mipt.oop.commands.SensorCommand;\n+import ru.sbt.mipt.oop.commands.handlers.LightOffCommandHandler;\n+import ru.sbt.mipt.oop.commands.handlers.SensorCommandHandler;\n+\n+import java.io.InputStream;\n+\n+public class CommandTests {\n+    SmartHome smartHome;\n+\n+    @Before\n+    public void setUp() {\n+        InputStream stream = getClass().getResourceAsStream(\"test-smart-home.json\");\n+        smartHome = new JsonConfigurationReader(stream).readSmartHome();\n+    }\n+\n+    @Test\n+    public void lightOffWorks() {\n+        smartHome.execute(new LightCheck(\"2\", true));\n+        SensorCommandHandler handler = new LightOffCommandHandler(smartHome);\n+        smartHome.execute(handler.handleCommand(\n+                new SensorCommand(CommandType.LIGHT_OFF, \"2\")));\n+        smartHome.execute(new LightCheck(\"2\", false));\n+    }\n+\n+    @Test\n+    public void lightOffIsTargeted() {\n+        smartHome.execute(new LightCheck(\"2\", true));\n+        smartHome.execute(new LightCheck(\"3\", true));\n+        SensorCommandHandler handler = new LightOffCommandHandler(smartHome);\n+        smartHome.execute(handler.handleCommand(\n+                new SensorCommand(CommandType.LIGHT_OFF, \"2\")));\n+        smartHome.execute(new LightCheck(\"2\", false));\n+        smartHome.execute(new LightCheck(\"3\", true));\n+    }\n+}"
  },
  {
    "sha": "bb41a070dced2ab1ed4224ae5c8bbcd029f61040",
    "filename": "src/test/java/ru/sbt/mipt/oop/DoorCheck.java",
    "status": "added",
    "additions": 22,
    "deletions": 0,
    "changes": 22,
    "blob_url": "https://github.com/bcskda/smart-home-2021/blob/1448aaa4157f6bd8d01c4245ef40abaaf3c49cd5/src/test/java/ru/sbt/mipt/oop/DoorCheck.java",
    "raw_url": "https://github.com/bcskda/smart-home-2021/raw/1448aaa4157f6bd8d01c4245ef40abaaf3c49cd5/src/test/java/ru/sbt/mipt/oop/DoorCheck.java",
    "contents_url": "https://api.github.com/repos/bcskda/smart-home-2021/contents/src/test/java/ru/sbt/mipt/oop/DoorCheck.java?ref=1448aaa4157f6bd8d01c4245ef40abaaf3c49cd5",
    "patch": "@@ -0,0 +1,22 @@\n+package ru.sbt.mipt.oop;\n+\n+import org.junit.Assert;\n+\n+public class DoorCheck implements Action {\n+    final String doorId;\n+    final boolean isOpenExpected;\n+\n+    public DoorCheck(String doorId, boolean isOpen) {\n+        this.doorId = doorId;\n+        this.isOpenExpected = isOpen;\n+    }\n+\n+    @Override\n+    public void execute(HomeComponent component) {\n+        if (! (component instanceof Door))\n+            return;\n+        Door door = (Door) component;\n+        if (doorId.equals(door.getId()))\n+            Assert.assertEquals(isOpenExpected, door.isOpen());\n+    }\n+}\n\\ No newline at end of file"
  },
  {
    "sha": "fd9b9b346763a378f84a65156489e46ee69a600e",
    "filename": "src/test/java/ru/sbt/mipt/oop/DoorEventTests.java",
    "status": "added",
    "additions": 88,
    "deletions": 0,
    "changes": 88,
    "blob_url": "https://github.com/bcskda/smart-home-2021/blob/1448aaa4157f6bd8d01c4245ef40abaaf3c49cd5/src/test/java/ru/sbt/mipt/oop/DoorEventTests.java",
    "raw_url": "https://github.com/bcskda/smart-home-2021/raw/1448aaa4157f6bd8d01c4245ef40abaaf3c49cd5/src/test/java/ru/sbt/mipt/oop/DoorEventTests.java",
    "contents_url": "https://api.github.com/repos/bcskda/smart-home-2021/contents/src/test/java/ru/sbt/mipt/oop/DoorEventTests.java?ref=1448aaa4157f6bd8d01c4245ef40abaaf3c49cd5",
    "patch": "@@ -0,0 +1,88 @@\n+package ru.sbt.mipt.oop;\n+\n+import org.junit.Assert;\n+import org.junit.Before;\n+import org.junit.Test;\n+import ru.sbt.mipt.oop.commands.handlers.LightOffCommandHandler;\n+import ru.sbt.mipt.oop.events.SensorEvent;\n+import ru.sbt.mipt.oop.events.SensorEventType;\n+import ru.sbt.mipt.oop.events.handlers.DoorClosedEventHandler;\n+import ru.sbt.mipt.oop.events.handlers.DoorOpenEventHandler;\n+import ru.sbt.mipt.oop.events.handlers.HallDoorClosedThenLightsOffHandler;\n+import ru.sbt.mipt.oop.events.handlers.SensorEventHandler;\n+\n+import java.io.InputStream;\n+import java.lang.reflect.ParameterizedType;\n+import java.util.Arrays;\n+import java.util.Collections;\n+\n+public class DoorEventTests {\n+    SmartHome smartHome;\n+    CommandSender controller;\n+\n+    @Before\n+    public void setUp() {\n+        InputStream stream = getClass().getResourceAsStream(\"test-smart-home.json\");\n+        smartHome = new JsonConfigurationReader(stream).readSmartHome();\n+        controller = new CommandSenderImpl(smartHome, Collections.singletonList(\n+                new LightOffCommandHandler(smartHome)\n+        ));\n+    }\n+\n+    @Test\n+    public void closeWorks() {\n+        smartHome.execute(new DoorCheck(\"3\", true));\n+        SensorEventHandler handler = new DoorClosedEventHandler(smartHome);\n+        smartHome.execute(handler.handleEvent(\n+                new SensorEvent(SensorEventType.DOOR_CLOSED, \"3\")));\n+        smartHome.execute(new DoorCheck(\"3\", false));\n+    }\n+\n+    @Test\n+    public void closeIsTargeted() {\n+        smartHome.execute(new DoorCheck(\"3\", true));\n+        smartHome.execute(new DoorCheck(\"1\", true));\n+        SensorEventHandler handler = new DoorClosedEventHandler(smartHome);\n+        smartHome.execute(handler.handleEvent(\n+                new SensorEvent(SensorEventType.DOOR_CLOSED, \"3\")));\n+        smartHome.execute(new DoorCheck(\"3\", false));\n+        smartHome.execute(new DoorCheck(\"1\", true));\n+    }\n+\n+    @Test\n+    public void closeHallDoor() {\n+        // Close hall door\n+        SensorEventHandler handler = new HallDoorClosedThenLightsOffHandler(\n+                controller, smartHome);\n+        smartHome.execute(handler.handleEvent(\n+                new SensorEvent(SensorEventType.DOOR_CLOSED, \"4\")));\n+\n+        // Check all lights turned off\n+        smartHome.execute(component -> {\n+            if (! (component instanceof Light))\n+                return;\n+            Light light = (Light) component;\n+            Assert.assertFalse(light.isOn());\n+        });\n+    }\n+\n+    @Test\n+    public void openWorks() {\n+        smartHome.execute(new DoorCheck(\"2\", false));\n+        SensorEventHandler handler = new DoorOpenEventHandler(smartHome);\n+        smartHome.execute(handler.handleEvent(\n+                new SensorEvent(SensorEventType.DOOR_OPEN, \"2\")));\n+        smartHome.execute(new DoorCheck(\"2\", true));\n+    }\n+\n+    @Test\n+    public void openIsTargeted() {\n+        smartHome.execute(new DoorCheck(\"2\", false));\n+        smartHome.execute(new DoorCheck(\"4\", false));\n+        SensorEventHandler handler = new DoorOpenEventHandler(smartHome);\n+        smartHome.execute(handler.handleEvent(\n+                new SensorEvent(SensorEventType.DOOR_OPEN, \"2\")));\n+        smartHome.execute(new DoorCheck(\"2\", true));\n+        smartHome.execute(new DoorCheck(\"4\", false));\n+    }\n+}"
  },
  {
    "sha": "f9371dd6a622b9abf290b0d3c6188fdca7bfd3b2",
    "filename": "src/test/java/ru/sbt/mipt/oop/LightCheck.java",
    "status": "added",
    "additions": 22,
    "deletions": 0,
    "changes": 22,
    "blob_url": "https://github.com/bcskda/smart-home-2021/blob/1448aaa4157f6bd8d01c4245ef40abaaf3c49cd5/src/test/java/ru/sbt/mipt/oop/LightCheck.java",
    "raw_url": "https://github.com/bcskda/smart-home-2021/raw/1448aaa4157f6bd8d01c4245ef40abaaf3c49cd5/src/test/java/ru/sbt/mipt/oop/LightCheck.java",
    "contents_url": "https://api.github.com/repos/bcskda/smart-home-2021/contents/src/test/java/ru/sbt/mipt/oop/LightCheck.java?ref=1448aaa4157f6bd8d01c4245ef40abaaf3c49cd5",
    "patch": "@@ -0,0 +1,22 @@\n+package ru.sbt.mipt.oop;\n+\n+import org.junit.Assert;\n+\n+public class LightCheck implements Action {\n+    final String lightId;\n+    final boolean isOnExpected;\n+\n+    public LightCheck(String lightId, boolean isOnExpected) {\n+        this.lightId = lightId;\n+        this.isOnExpected = isOnExpected;\n+    }\n+\n+    @Override\n+    public void execute(HomeComponent component) {\n+        if (! (component instanceof Light))\n+            return;\n+        Light light = (Light) component;\n+        if (lightId.equals(light.getId()))\n+            Assert.assertEquals(isOnExpected, light.isOn());\n+    }\n+}"
  },
  {
    "sha": "e9736b9accb7601abbe608231de82409a1de8cb6",
    "filename": "src/test/resources/ru/sbt/mipt/oop/test-smart-home.json",
    "status": "added",
    "additions": 84,
    "deletions": 0,
    "changes": 84,
    "blob_url": "https://github.com/bcskda/smart-home-2021/blob/1448aaa4157f6bd8d01c4245ef40abaaf3c49cd5/src/test/resources/ru/sbt/mipt/oop/test-smart-home.json",
    "raw_url": "https://github.com/bcskda/smart-home-2021/raw/1448aaa4157f6bd8d01c4245ef40abaaf3c49cd5/src/test/resources/ru/sbt/mipt/oop/test-smart-home.json",
    "contents_url": "https://api.github.com/repos/bcskda/smart-home-2021/contents/src/test/resources/ru/sbt/mipt/oop/test-smart-home.json?ref=1448aaa4157f6bd8d01c4245ef40abaaf3c49cd5",
    "patch": "@@ -0,0 +1,84 @@\n+{\n+  \"rooms\": [\n+    {\n+      \"lights\": [\n+        {\n+          \"isOn\": false,\n+          \"id\": \"1\"\n+        },\n+        {\n+          \"isOn\": true,\n+          \"id\": \"2\"\n+        }\n+      ],\n+      \"doors\": [\n+        {\n+          \"id\": \"1\",\n+          \"isOpen\": true\n+        }\n+      ],\n+      \"name\": \"kitchen\"\n+    },\n+    {\n+      \"lights\": [\n+        {\n+          \"isOn\": true,\n+          \"id\": \"3\"\n+        }\n+      ],\n+      \"doors\": [\n+        {\n+          \"id\": \"2\",\n+          \"isOpen\": false\n+        }\n+      ],\n+      \"name\": \"bathroom\"\n+    },\n+    {\n+      \"lights\": [\n+        {\n+          \"isOn\": false,\n+          \"id\": \"4\"\n+        },\n+        {\n+          \"isOn\": false,\n+          \"id\": \"5\"\n+        },\n+        {\n+          \"isOn\": false,\n+          \"id\": \"6\"\n+        }\n+      ],\n+      \"doors\": [\n+        {\n+          \"id\": \"3\",\n+          \"isOpen\": true\n+        }\n+      ],\n+      \"name\": \"bedroom\"\n+    },\n+    {\n+      \"lights\": [\n+        {\n+          \"isOn\": false,\n+          \"id\": \"7\"\n+        },\n+        {\n+          \"isOn\": false,\n+          \"id\": \"8\"\n+        },\n+        {\n+          \"isOn\": false,\n+          \"id\": \"9\"\n+        }\n+      ],\n+      \"doors\": [\n+        {\n+          \"id\": \"4\",\n+          \"isOpen\": false\n+        }\n+      ],\n+      \"name\": \"hall\"\n+    }\n+  ]\n+}\n\\ No newline at end of file"
  }
]

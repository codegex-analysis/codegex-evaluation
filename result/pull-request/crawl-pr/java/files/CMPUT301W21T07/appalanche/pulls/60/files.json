[
  {
    "sha": "59a1e9dfd644e2edb43c67f5bd20ecb79b47ae8a",
    "filename": "app/src/main/java/com/team007/appalanche/User/User.java",
    "status": "modified",
    "additions": 6,
    "deletions": 2,
    "changes": 8,
    "blob_url": "https://github.com/CMPUT301W21T07/appalanche/blob/ae440c9a487d07c98666caddde50a25a2e591553/app/src/main/java/com/team007/appalanche/User/User.java",
    "raw_url": "https://github.com/CMPUT301W21T07/appalanche/raw/ae440c9a487d07c98666caddde50a25a2e591553/app/src/main/java/com/team007/appalanche/User/User.java",
    "contents_url": "https://api.github.com/repos/CMPUT301W21T07/appalanche/contents/app/src/main/java/com/team007/appalanche/User/User.java?ref=ae440c9a487d07c98666caddde50a25a2e591553",
    "patch": "@@ -8,8 +8,8 @@\n public class User implements Serializable {\n     private String ID;\n     private Profile profile;\n-    private ArrayList<Experiment> subscribedExperiments;\n-    private ArrayList<Experiment> ownedExperiments;\n+    private ArrayList<Experiment> subscribedExperiments = new ArrayList<Experiment>();\n+    private ArrayList<Experiment> ownedExperiments=  new ArrayList<Experiment>();\n \n     public User() {}\n \n@@ -36,6 +36,10 @@ public User(String ID) {\n      */\n     public String getId() { return ID; }\n \n+    public void setID(String ID) {\n+        this.ID = ID;\n+    }\n+\n     /**\n      * set the profile of the user\n      * @param profile"
  },
  {
    "sha": "46774231c9adf4e5a3ef8914f442516d429a8981",
    "filename": "app/src/main/java/com/team007/appalanche/User/UserDocument.java",
    "status": "added",
    "additions": 9,
    "deletions": 0,
    "changes": 9,
    "blob_url": "https://github.com/CMPUT301W21T07/appalanche/blob/ae440c9a487d07c98666caddde50a25a2e591553/app/src/main/java/com/team007/appalanche/User/UserDocument.java",
    "raw_url": "https://github.com/CMPUT301W21T07/appalanche/raw/ae440c9a487d07c98666caddde50a25a2e591553/app/src/main/java/com/team007/appalanche/User/UserDocument.java",
    "contents_url": "https://api.github.com/repos/CMPUT301W21T07/appalanche/contents/app/src/main/java/com/team007/appalanche/User/UserDocument.java?ref=ae440c9a487d07c98666caddde50a25a2e591553",
    "patch": "@@ -0,0 +1,9 @@\n+package com.team007.appalanche.User;\n+\n+import com.team007.appalanche.Experiment.Experiment;\n+\n+import java.util.ArrayList;\n+\n+public class UserDocument {\n+    public ArrayList<Experiment> users;\n+}"
  },
  {
    "sha": "2c845613516833efa29a262196dc33d174dc8730",
    "filename": "app/src/main/java/com/team007/appalanche/controller/ExperimentController.java",
    "status": "modified",
    "additions": 33,
    "deletions": 22,
    "changes": 55,
    "blob_url": "https://github.com/CMPUT301W21T07/appalanche/blob/ae440c9a487d07c98666caddde50a25a2e591553/app/src/main/java/com/team007/appalanche/controller/ExperimentController.java",
    "raw_url": "https://github.com/CMPUT301W21T07/appalanche/raw/ae440c9a487d07c98666caddde50a25a2e591553/app/src/main/java/com/team007/appalanche/controller/ExperimentController.java",
    "contents_url": "https://api.github.com/repos/CMPUT301W21T07/appalanche/contents/app/src/main/java/com/team007/appalanche/controller/ExperimentController.java?ref=ae440c9a487d07c98666caddde50a25a2e591553",
    "patch": "@@ -1,34 +1,17 @@\n package com.team007.appalanche.controller;\n \n-import android.content.Context;\n-import android.content.SharedPreferences;\n-import android.util.Log;\n-\n-import androidx.annotation.NonNull;\n-import androidx.arch.core.util.Function;\n-import androidx.lifecycle.LifecycleOwner;\n-import androidx.lifecycle.LiveData;\n import androidx.lifecycle.MutableLiveData;\n-import androidx.lifecycle.Observer;\n-import androidx.lifecycle.Transformations;\n import androidx.lifecycle.ViewModel;\n \n-import com.google.android.gms.tasks.OnCompleteListener;\n import com.google.android.gms.tasks.OnSuccessListener;\n-import com.google.android.gms.tasks.Task;\n import com.google.firebase.firestore.DocumentReference;\n import com.google.firebase.firestore.DocumentSnapshot;\n import com.google.firebase.firestore.FirebaseFirestore;\n import com.team007.appalanche.Experiment.Experiment;\n-import com.team007.appalanche.R;\n-import com.team007.appalanche.User.Profile;\n import com.team007.appalanche.User.User;\n-import com.team007.appalanche.view.MainActivity;\n+import com.team007.appalanche.User.UserDocument;\n \n import java.util.ArrayList;\n-import java.util.List;\n-\n-import static android.content.ContentValues.TAG;\n \n /**\n  * This view model maps the type of experiment to display (owned or subscribed) based on the index\n@@ -62,21 +45,49 @@ public void loadExperiments() {\n         DocumentReference userDoc = db.collection(\"Users\").document(currentUserKey);\n         final User[] currentUser = new User[1];\n \n+//        userDoc.addSnapshotListener(new EventListener<QuerySnapshot>() {\n+//            @Override\n+//            public void onEvent(@Nullable QuerySnapshot queryDocumentSnapshots, @Nullable FirebaseFirestoreException e) {\n+//                // clear the old list\n+//                ownedExperiments.clear();\n+//                subscribedExperiments.clear();\n+//                for (QueryDocumentSnapshot doc : queryDocumentSnapshots) {\n+//                    Log.d(TAG, String.valueOf(doc.getData().get(\"user_posted_question\")));\n+//                    ownedExperiments =  (ArrayList<Experiment>) userDoc.get(\"ownedExperiments\");\n+//                    subscribedExperiments = (ArrayList<Experiment>) userDoc.get(\"subsribedExperiments\");\n+//\n+//                    questionList.addQuestion(new Question(question, new User(user, null), new Date()));\n+//                }\n+//            }});\n+        userDoc.get().addOnCompleteListener(task -> {\n+            if (task.isSuccessful()) {\n+                DocumentSnapshot document = task.getResult();\n+                if (document.exists()) {\n+                    ownedExperiments = document.toObject(UserDocument.class).users;\n+                    //subscribedExperiments = document.toObject(UserDocument.class).users;\n+                }\n+            }\n+        });\n+\n+\n         userDoc.get().addOnSuccessListener(new OnSuccessListener<DocumentSnapshot>() {\n             @Override\n             public void onSuccess(DocumentSnapshot documentSnapshot) {\n                 currentUser[0] = documentSnapshot.toObject(User.class);\n+//                //ADDED THIS\n+                currentUser[0].setID(currentUserKey);\n+\n             }\n         });\n \n         if (currentUser[0] != null) {\n-            ownedExperiments = currentUser[0].getOwnedExperiments();\n-            subscribedExperiments = currentUser[0].getSubscribedExperiments();\n+            ownedExperiments = (ArrayList<Experiment>) currentUser[0].getOwnedExperiments();\n+            subscribedExperiments = (ArrayList<Experiment>) currentUser[0].getSubscribedExperiments();\n         }\n-    }\n \n+    }\n     public void setCurrentUser(String userKey) {\n-        currentUserKey = userKey;\n+        this.currentUserKey = userKey;\n     }\n \n     public void addExperiment(Experiment experiment) {"
  },
  {
    "sha": "72f712eb23b4435c438e1313fcde73f732cb7459",
    "filename": "app/src/main/java/com/team007/appalanche/view/MainActivity.java",
    "status": "modified",
    "additions": 30,
    "deletions": 39,
    "changes": 69,
    "blob_url": "https://github.com/CMPUT301W21T07/appalanche/blob/ae440c9a487d07c98666caddde50a25a2e591553/app/src/main/java/com/team007/appalanche/view/MainActivity.java",
    "raw_url": "https://github.com/CMPUT301W21T07/appalanche/raw/ae440c9a487d07c98666caddde50a25a2e591553/app/src/main/java/com/team007/appalanche/view/MainActivity.java",
    "contents_url": "https://api.github.com/repos/CMPUT301W21T07/appalanche/contents/app/src/main/java/com/team007/appalanche/view/MainActivity.java?ref=ae440c9a487d07c98666caddde50a25a2e591553",
    "patch": "@@ -1,53 +1,39 @@\n package com.team007.appalanche.view;\n \n-import android.accounts.Account;\n-import android.accounts.AccountManager;\n import android.content.Context;\n import android.content.DialogInterface;\n import android.content.Intent;\n import android.content.SharedPreferences;\n import android.os.Bundle;\n-\n-import com.google.android.gms.tasks.OnFailureListener;\n-import com.google.android.gms.tasks.OnSuccessListener;\n-import com.google.android.material.floatingactionbutton.FloatingActionButton;\n-import com.google.android.material.snackbar.Snackbar;\n-import com.google.android.material.tabs.TabLayout;\n-\n-import androidx.annotation.NonNull;\n-import androidx.annotation.Nullable;\n-import androidx.appcompat.app.AlertDialog;\n-import androidx.viewpager.widget.ViewPager;\n-import androidx.appcompat.app.AppCompatActivity;\n-\n import android.util.Log;\n import android.view.Menu;\n import android.view.MenuInflater;\n import android.view.MenuItem;\n import android.view.View;\n-import android.widget.AdapterView;\n-import android.widget.ArrayAdapter;\n-import android.widget.Button;\n-import android.widget.ListView;\n import android.widget.Toast;\n \n+import androidx.annotation.NonNull;\n+import androidx.annotation.Nullable;\n+import androidx.appcompat.app.AlertDialog;\n+import androidx.appcompat.app.AppCompatActivity;\n+import androidx.viewpager.widget.ViewPager;\n \n-import com.google.firebase.firestore.CollectionReference;\n+import com.google.android.gms.tasks.OnFailureListener;\n+import com.google.android.gms.tasks.OnSuccessListener;\n+import com.google.android.material.floatingactionbutton.FloatingActionButton;\n+import com.google.android.material.snackbar.Snackbar;\n+import com.google.android.material.tabs.TabLayout;\n import com.google.firebase.firestore.DocumentReference;\n-import com.google.firebase.firestore.DocumentSnapshot;\n import com.google.firebase.firestore.FirebaseFirestore;\n import com.google.gson.Gson;\n import com.google.zxing.integration.android.IntentIntegrator;\n import com.google.zxing.integration.android.IntentResult;\n-import com.team007.appalanche.Experiment.Experiment;\n import com.team007.appalanche.R;\n import com.team007.appalanche.User.Profile;\n import com.team007.appalanche.User.User;\n import com.team007.appalanche.scannableCode.ScannableCode;\n import com.team007.appalanche.view.ui.main.SectionsPagerAdapter;\n \n-import java.util.HashMap;\n-\n public class MainActivity extends AppCompatActivity {\n     FirebaseFirestore db;\n     private static DocumentReference currentUser;\n@@ -108,27 +94,32 @@ public void onFailure(@NonNull Exception e) {\n             editor.apply();\n         } else {\n             currentUser = db.collection(\"Users\").document(userKey);\n+            //Toast.makeText(MainActivity.this, userKey, Toast.LENGTH_LONG).show();\n         }\n \n //        Toast.makeText(MainActivity.this, userKey, Toast.LENGTH_LONG).show();\n \n-        AccountManager am = AccountManager.get(this); // \"this\" references the current Context\n \n-        Account[] accounts = am.getAccountsByType(\"com.google\");\n+//        /// TESTTTT\n+//        final User[] us = new User[1];\n+//        currentUser.get().addOnSuccessListener(new OnSuccessListener<DocumentSnapshot>() {\n+//            @Override\n+//            public void onSuccess(DocumentSnapshot documentSnapshot) {\n+//                // WE NEVER SET THE ID FOR THE USER INSIDE us[0] because the default constructor was called inside us[0] = (User) (documentSnapshot.toObject(User.class));\n+//                us[0] = (documentSnapshot.toObject(User.class));\n+//                // SO WE NEED TO USE A SETTER TO SET THAT\n+//                us[0].setID(currentUser.getId());\n+//                if ( us[0].getId() == null)\n+//                Toast.makeText(MainActivity.this, \"true\", Toast.LENGTH_LONG).show();\n+//                //String ExpUserID = us[0].getId();\n+//                Experiment newExp = new Experiment(\"How many jelly beans can I fit in my mouth?\",\n+//                        \"Alberta\", \"NonNegTrial\",2, false, true, us[0].getId());\n+//                //Toast.makeText(MainActivity.this, us[0].getId(), Toast.LENGTH_LONG).show();\n+//                us[0].addOwnedExperiment(newExp);\n+//                currentUser.set(us[0]);\n+//            }\n+//        });\n \n-        /// TESTTTT\n-        final User[] us = new User[1];\n-        currentUser.get().addOnSuccessListener(new OnSuccessListener<DocumentSnapshot>() {\n-            @Override\n-            public void onSuccess(DocumentSnapshot documentSnapshot) {\n-                us[0] = documentSnapshot.toObject(User.class);\n-                Experiment newExp = new Experiment(\"How many jelly beans can I fit in my mouth?\",\n-                        \"Alberta\", \"NonNegTrial\",2, false, true, us[0].getId());\n-                Toast.makeText(MainActivity.this, us[0].getId(), Toast.LENGTH_LONG).show();\n-                us[0].addOwnedExperiment(newExp);\n-                currentUser.set(us[0]);\n-            }\n-        });\n \n         addExperimentButton.setOnClickListener(new View.OnClickListener() {\n             @Override"
  },
  {
    "sha": "fdb41b61473fc5b82c7d0d7281e27df5ce898eaf",
    "filename": "app/src/main/java/com/team007/appalanche/view/ui/main/MainTabFragment.java",
    "status": "modified",
    "additions": 6,
    "deletions": 2,
    "changes": 8,
    "blob_url": "https://github.com/CMPUT301W21T07/appalanche/blob/ae440c9a487d07c98666caddde50a25a2e591553/app/src/main/java/com/team007/appalanche/view/ui/main/MainTabFragment.java",
    "raw_url": "https://github.com/CMPUT301W21T07/appalanche/raw/ae440c9a487d07c98666caddde50a25a2e591553/app/src/main/java/com/team007/appalanche/view/ui/main/MainTabFragment.java",
    "contents_url": "https://api.github.com/repos/CMPUT301W21T07/appalanche/contents/app/src/main/java/com/team007/appalanche/view/ui/main/MainTabFragment.java?ref=ae440c9a487d07c98666caddde50a25a2e591553",
    "patch": "@@ -10,6 +10,7 @@\n import android.widget.AdapterView;\n import android.widget.ArrayAdapter;\n import android.widget.ListView;\n+import android.widget.Toast;\n \n import androidx.annotation.NonNull;\n import androidx.fragment.app.Fragment;\n@@ -54,11 +55,13 @@ public void onCreate(Bundle savedInstanceState) {\n         }\n \n         SharedPreferences sharedPref = getActivity().getPreferences(Context.MODE_PRIVATE);\n-        String userKey = getResources().getString(R.string.saved_user_key);\n+        //String userKey = getResources().getString(R.string.saved_user_key);\n+        String userKey = sharedPref.getString(\"com.team007.Appalanche.user_key\", null);\n \n         experimentController.setCurrentUser(userKey);\n         experimentController.setExperimentType(index);\n         experimentController.loadExperiments();\n+\n     }\n \n     @Override\n@@ -72,7 +75,8 @@ public View onCreateView(\n \n         // Load the experiments\n         ExperimentDataList = experimentController.getExperiments();\n-\n+        String context = ExperimentDataList.get(0).getDescription();\n+        Toast.makeText(getActivity(), context, Toast.LENGTH_LONG).show();\n         // Set up the adapter for Experiment List View\n         expAdapter = new CustomList(this.getActivity(), ExperimentDataList);\n         expList.setAdapter(expAdapter);"
  },
  {
    "sha": "facba24c3ea7a67824c396f6e18d570e25d5c579",
    "filename": "app/src/main/res/drawable-anydpi/ignore.xml",
    "status": "added",
    "additions": 16,
    "deletions": 0,
    "changes": 16,
    "blob_url": "https://github.com/CMPUT301W21T07/appalanche/blob/ae440c9a487d07c98666caddde50a25a2e591553/app/src/main/res/drawable-anydpi/ignore.xml",
    "raw_url": "https://github.com/CMPUT301W21T07/appalanche/raw/ae440c9a487d07c98666caddde50a25a2e591553/app/src/main/res/drawable-anydpi/ignore.xml",
    "contents_url": "https://api.github.com/repos/CMPUT301W21T07/appalanche/contents/app/src/main/res/drawable-anydpi/ignore.xml?ref=ae440c9a487d07c98666caddde50a25a2e591553",
    "patch": "@@ -0,0 +1,16 @@\n+<vector xmlns:android=\"http://schemas.android.com/apk/res/android\"\n+    android:width=\"24dp\"\n+    android:height=\"24dp\"\n+    android:viewportWidth=\"24\"\n+    android:viewportHeight=\"24\"\n+    android:tint=\"#E51919\"\n+    android:alpha=\"0.8\">\n+  <group android:scaleX=\"1.25\"\n+      android:scaleY=\"1.25\"\n+      android:translateX=\"-3\"\n+      android:translateY=\"-3\">\n+    <path\n+        android:fillColor=\"@android:color/white\"\n+        android:pathData=\"M11,15h2v2h-2zM11,7h2v6h-2zM11.99,2C6.47,2 2,6.48 2,12s4.47,10 9.99,10C17.52,22 22,17.52 22,12S17.52,2 11.99,2zM12,20c-4.42,0 -8,-3.58 -8,-8s3.58,-8 8,-8 8,3.58 8,8 -3.58,8 -8,8z\"/>\n+  </group>\n+</vector>"
  },
  {
    "sha": "3e7802796bad8c13ba682958a93ff8df31f32ebc",
    "filename": "app/src/main/res/layout/content_trial.xml",
    "status": "added",
    "additions": 59,
    "deletions": 0,
    "changes": 59,
    "blob_url": "https://github.com/CMPUT301W21T07/appalanche/blob/ae440c9a487d07c98666caddde50a25a2e591553/app/src/main/res/layout/content_trial.xml",
    "raw_url": "https://github.com/CMPUT301W21T07/appalanche/raw/ae440c9a487d07c98666caddde50a25a2e591553/app/src/main/res/layout/content_trial.xml",
    "contents_url": "https://api.github.com/repos/CMPUT301W21T07/appalanche/contents/app/src/main/res/layout/content_trial.xml?ref=ae440c9a487d07c98666caddde50a25a2e591553",
    "patch": "@@ -0,0 +1,59 @@\n+<?xml version=\"1.0\" encoding=\"utf-8\"?>\n+<LinearLayout\n+    xmlns:android=\"http://schemas.android.com/apk/res/android\"\n+    android:orientation=\"horizontal\"\n+    android:layout_width=\"match_parent\"\n+    android:layout_height=\"match_parent\"\n+    android:background=\"#ffe4b5\">\n+\n+    <TextView\n+        android:layout_width=\"wrap_content\"\n+        android:layout_height=\"wrap_content\"\n+        android:id=\"@+id/numbOfTrials\"\n+        android:text=\"Number of Trials\"\n+        android:paddingRight=\"100dp\"\n+        android:paddingBottom=\"12dp\"\n+        android:paddingLeft=\"10dp\"\n+        />\n+\n+    <LinearLayout\n+        android:layout_width=\"match_parent\"\n+        android:layout_height=\"wrap_content\"\n+        android:orientation=\"horizontal\"\n+         >\n+        <LinearLayout\n+            android:layout_width=\"wrap_content\"\n+            android:layout_height=\"match_parent\"\n+            android:orientation=\"vertical\"\n+            >\n+            <TextView\n+                android:layout_width=\"wrap_content\"\n+                android:layout_height=\"wrap_content\"\n+                android:text=\"Date\"\n+                >\n+            </TextView>\n+\n+            <LinearLayout\n+                android:layout_width=\"wrap_content\"\n+                android:layout_height=\"wrap_content\"\n+                android:orientation=\"horizontal\"\n+                >\n+            <TextView\n+                android:layout_width=\"wrap_content\"\n+                android:layout_height=\"wrap_content\"\n+                android:id=\"@+id/userID\"\n+                android:text=\"User's ID\"\n+                android:paddingRight=\"70dp\"\n+                android:layout_weight=\"1\"\n+                />\n+                <ImageView\n+                    android:id=\"@+id/ignoreUser\"\n+                    android:layout_width=\"wrap_content\"\n+                    android:layout_height=\"wrap_content\"\n+                    android:src=\"@drawable/ignore\" />\n+            </LinearLayout>\n+        </LinearLayout>\n+\n+    </LinearLayout>\n+\n+</LinearLayout>\n\\ No newline at end of file"
  }
]

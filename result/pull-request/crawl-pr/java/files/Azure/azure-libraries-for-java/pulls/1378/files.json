[
  {
    "sha": "8dff56a88865afb5eae54704853b0fc6cd527cea",
    "filename": "azure-mgmt-resources/src/main/java/com/microsoft/azure/management/resources/GenericResources.java",
    "status": "modified",
    "additions": 92,
    "deletions": 6,
    "changes": 98,
    "blob_url": "https://github.com/Azure/azure-libraries-for-java/blob/3c7eebf06eb18429be644abfef75566b22b77964/azure-mgmt-resources/src/main/java/com/microsoft/azure/management/resources/GenericResources.java",
    "raw_url": "https://github.com/Azure/azure-libraries-for-java/raw/3c7eebf06eb18429be644abfef75566b22b77964/azure-mgmt-resources/src/main/java/com/microsoft/azure/management/resources/GenericResources.java",
    "contents_url": "https://api.github.com/repos/Azure/azure-libraries-for-java/contents/azure-mgmt-resources/src/main/java/com/microsoft/azure/management/resources/GenericResources.java?ref=3c7eebf06eb18429be644abfef75566b22b77964",
    "patch": "@@ -18,6 +18,7 @@\n import com.microsoft.rest.ServiceCallback;\n import com.microsoft.rest.ServiceFuture;\n import rx.Completable;\n+import rx.Observable;\n \n import java.util.List;\n \n@@ -33,6 +34,80 @@\n         SupportsCreating<GenericResource.DefinitionStages.Blank>,\n         SupportsDeletingById,\n         HasManager<ResourceManager> {\n+    /**\n+     * Deletes a resource from Azure, identifying it by its resource ID.\n+     *\n+     * For consistency across service versions, please use {@link #deleteById(String, String)} instead.\n+     *\n+     * @param id the resource ID of the resource to delete\n+     */\n+    void deleteById(String id);\n+\n+    /**\n+     * Asynchronously delete a resource from Azure, identifying it by its resource ID.\n+     *\n+     * For consistency across service versions, please use {@link #deleteByIdAsync(String, String)} instead.\n+     *\n+     * @param id the resource ID of the resource to delete\n+     * @return a representation of the deferred computation of this call\n+     */\n+    Completable deleteByIdAsync(String id);\n+\n+    /**\n+     * Gets the information about a resource from Azure based on the resource id.\n+     *\n+     * For consistency across service versions, please use {@link #getById(String, String)} instead.\n+     *\n+     * @param id the id of the resource.\n+     * @return an immutable representation of the resource\n+     */\n+    GenericResource getById(String id);\n+\n+    /**\n+     * Gets the information about a resource from Azure based on the resource id.\n+     *\n+     * For consistency across service versions, please use {@link #getByIdAsync(String, String)} instead.\n+     *\n+     * @param id the id of the resource.\n+     * @return an immutable representation of the resource\n+     */\n+    Observable<GenericResource> getByIdAsync(String id);\n+\n+    /**\n+     * Deletes a resource from Azure, identifying it by its resource ID.\n+     *\n+     * @param id the resource ID of the resource to delete\n+     * @param apiVersion the API version\n+     */\n+    void deleteById(String id, String apiVersion);\n+\n+    /**\n+     * Asynchronously delete a resource from Azure, identifying it by its resource ID.\n+     *\n+     * @param id the resource ID of the resource to delete\n+     * @param apiVersion the API version\n+     * @return a representation of the deferred computation of this call\n+     */\n+    Completable deleteByIdAsync(String id, String apiVersion);\n+\n+    /**\n+     * Gets the information about a resource from Azure based on the resource id.\n+     *\n+     * @param id the id of the resource.\n+     * @param apiVersion the API version\n+     * @return an immutable representation of the resource\n+     */\n+    GenericResource getById(String id, String apiVersion);\n+\n+    /**\n+     * Gets the information about a resource from Azure based on the resource id.\n+     *\n+     * @param id the id of the resource.\n+     * @param apiVersion the API version\n+     * @return an immutable representation of the resource\n+     */\n+    Observable<GenericResource> getByIdAsync(String id, String apiVersion);\n+\n     /**\n      * Checks if a resource exists in a resource group.\n      *\n@@ -55,11 +130,22 @@ boolean checkExistence(\n     /**\n      * Checks if a resource exists.\n      *\n+     * For consistency across service versions, please use {@link #checkExistenceById(String, String)} instead.\n+     *\n      * @param id the ID of the resource.\n      * @return true if the resource exists; false otherwise\n      */\n     boolean checkExistenceById(String id);\n \n+    /**\n+     * Checks if a resource exists.\n+     *\n+     * @param id the ID of the resource.\n+     * @param apiVersion the API version\n+     * @return true if the resource exists; false otherwise\n+     */\n+    boolean checkExistenceById(String id, String apiVersion);\n+\n     /**\n      * Returns a resource belonging to a resource group.\n      *\n@@ -68,7 +154,7 @@ boolean checkExistence(\n      * @param parentResourcePath Resource identity.\n      * @param resourceType Resource identity.\n      * @param resourceName Resource identity.\n-     * @param apiVersion the String value\n+     * @param apiVersion the API version\n      * @return the generic resource\n      */\n     GenericResource get(\n@@ -133,7 +219,7 @@ GenericResource get(\n      * @param parentResourcePath Resource identity.\n      * @param resourceType Resource identity.\n      * @param resourceName Resource identity.\n-     * @param apiVersion the String value\n+     * @param apiVersion the API version\n      */\n     void delete(String resourceGroupName, String resourceProviderNamespace, String parentResourcePath, String resourceType, String resourceName, String apiVersion);\n \n@@ -146,7 +232,7 @@ GenericResource get(\n      * @param parentResourcePath Resource identity.\n      * @param resourceType Resource identity.\n      * @param resourceName Resource identity.\n-     * @param apiVersion the String value\n+     * @param apiVersion the API version\n      * @return a representation of the deferred computation of this call\n      */\n     Completable deleteAsync(String resourceGroupName, String resourceProviderNamespace, String parentResourcePath, String resourceType, String resourceName, String apiVersion);\n@@ -176,7 +262,7 @@ GenericResource get(\n      * @param parentResourcePath Resource identity.\n      * @param resourceType Resource identity.\n      * @param resourceName Resource identity.\n-     * @param apiVersion the String value\n+     * @param apiVersion the API version\n      * @param forceDeletion the force delete parameter\n      */\n     void delete(String resourceGroupName, String resourceProviderNamespace, String parentResourcePath, String resourceType, String resourceName, String apiVersion, boolean forceDeletion);\n@@ -191,7 +277,7 @@ GenericResource get(\n      * @param parentResourcePath Resource identity.\n      * @param resourceType Resource identity.\n      * @param resourceName Resource identity.\n-     * @param apiVersion the String value\n+     * @param apiVersion the API version\n      * @param forceDeletion the force delete parameter\n      * @return a representation of the deferred computation of this call\n      */\n@@ -207,7 +293,7 @@ GenericResource get(\n      * @param parentResourcePath Resource identity.\n      * @param resourceType Resource identity.\n      * @param resourceName Resource identity.\n-     * @param apiVersion the String value\n+     * @param apiVersion the API version\n      * @param forceDeletion the force delete parameter\n      * @param callback the callback to call on success or failure\n      *"
  },
  {
    "sha": "87a1415e510dfcaab7e9666e633e9dc810baad39",
    "filename": "azure-mgmt-resources/src/main/java/com/microsoft/azure/management/resources/fluentcore/arm/ResourceUtils.java",
    "status": "modified",
    "additions": 16,
    "deletions": 2,
    "changes": 18,
    "blob_url": "https://github.com/Azure/azure-libraries-for-java/blob/3c7eebf06eb18429be644abfef75566b22b77964/azure-mgmt-resources/src/main/java/com/microsoft/azure/management/resources/fluentcore/arm/ResourceUtils.java",
    "raw_url": "https://github.com/Azure/azure-libraries-for-java/raw/3c7eebf06eb18429be644abfef75566b22b77964/azure-mgmt-resources/src/main/java/com/microsoft/azure/management/resources/fluentcore/arm/ResourceUtils.java",
    "contents_url": "https://api.github.com/repos/Azure/azure-libraries-for-java/contents/azure-mgmt-resources/src/main/java/com/microsoft/azure/management/resources/fluentcore/arm/ResourceUtils.java?ref=3c7eebf06eb18429be644abfef75566b22b77964",
    "patch": "@@ -9,6 +9,7 @@\n import com.microsoft.azure.management.resources.Provider;\n import com.microsoft.azure.management.resources.ProviderResourceType;\n \n+import java.util.Locale;\n import java.util.regex.Matcher;\n import java.util.regex.Pattern;\n \n@@ -159,10 +160,23 @@ public static String defaultApiVersion(String id, Provider provider) {\n         // Exact match\n         for (ProviderResourceType prt : provider.resourceTypes()) {\n             if (prt.resourceType().equalsIgnoreCase(resourceType)) {\n-                return prt.apiVersions().get(0);\n+                return prt.defaultApiVersion() == null ? prt.apiVersions().get(0) : prt.defaultApiVersion();\n             }\n         }\n-        return defaultApiVersion(parentResourceIdFromResourceId(id), provider);\n+        // child resource, e.g. sites/config\n+        for (ProviderResourceType prt : provider.resourceTypes()) {\n+            if (prt.resourceType().toLowerCase(Locale.ROOT).contains(\"/\" + resourceType)) {\n+                return prt.defaultApiVersion() == null ? prt.apiVersions().get(0) : prt.defaultApiVersion();\n+            }\n+        }\n+        // look for parent\n+        String parentId = parentResourceIdFromResourceId(id);\n+        if (parentId != null) {\n+            return defaultApiVersion(parentId, provider);\n+        } else {\n+            // Fallback: use a random one, not guaranteed to work\n+            return provider.resourceTypes().get(0).apiVersions().get(0);\n+        }\n     }\n \n     /**"
  },
  {
    "sha": "d90690d57c8ed635078c47559a40cd7164386684",
    "filename": "azure-mgmt-resources/src/main/java/com/microsoft/azure/management/resources/fluentcore/arm/collection/implementation/GroupableResourcesImpl.java",
    "status": "modified",
    "additions": 1,
    "deletions": 1,
    "changes": 2,
    "blob_url": "https://github.com/Azure/azure-libraries-for-java/blob/3c7eebf06eb18429be644abfef75566b22b77964/azure-mgmt-resources/src/main/java/com/microsoft/azure/management/resources/fluentcore/arm/collection/implementation/GroupableResourcesImpl.java",
    "raw_url": "https://github.com/Azure/azure-libraries-for-java/raw/3c7eebf06eb18429be644abfef75566b22b77964/azure-mgmt-resources/src/main/java/com/microsoft/azure/management/resources/fluentcore/arm/collection/implementation/GroupableResourcesImpl.java",
    "contents_url": "https://api.github.com/repos/Azure/azure-libraries-for-java/contents/azure-mgmt-resources/src/main/java/com/microsoft/azure/management/resources/fluentcore/arm/collection/implementation/GroupableResourcesImpl.java?ref=3c7eebf06eb18429be644abfef75566b22b77964",
    "patch": "@@ -70,7 +70,7 @@ public T getById(String id) {\n     }\n \n     @Override\n-    public final Observable<T> getByIdAsync(String id) {\n+    public Observable<T> getByIdAsync(String id) {\n         ResourceId resourceId = ResourceId.fromString(id);\n \n         if (resourceId == null) {"
  },
  {
    "sha": "f2b2a23598c814d6bfcd85b6e871493c41318d43",
    "filename": "azure-mgmt-resources/src/main/java/com/microsoft/azure/management/resources/implementation/GenericResourcesImpl.java",
    "status": "modified",
    "additions": 58,
    "deletions": 19,
    "changes": 77,
    "blob_url": "https://github.com/Azure/azure-libraries-for-java/blob/3c7eebf06eb18429be644abfef75566b22b77964/azure-mgmt-resources/src/main/java/com/microsoft/azure/management/resources/implementation/GenericResourcesImpl.java",
    "raw_url": "https://github.com/Azure/azure-libraries-for-java/raw/3c7eebf06eb18429be644abfef75566b22b77964/azure-mgmt-resources/src/main/java/com/microsoft/azure/management/resources/implementation/GenericResourcesImpl.java",
    "contents_url": "https://api.github.com/repos/Azure/azure-libraries-for-java/contents/azure-mgmt-resources/src/main/java/com/microsoft/azure/management/resources/implementation/GenericResourcesImpl.java?ref=3c7eebf06eb18429be644abfef75566b22b77964",
    "patch": "@@ -92,16 +92,67 @@ public boolean checkExistence(String resourceGroupName, String resourceProviderN\n \n     @Override\n     public boolean checkExistenceById(String id) {\n-        String apiVersion = getApiVersionFromId(id).toBlocking().single();\n+        String apiVersion = getApiVersionFromIdAsync(id).toBlocking().single();\n+        return this.checkExistenceById(id, apiVersion);\n+    }\n+\n+    @Override\n+    public boolean checkExistenceById(String id, String apiVersion) {\n         return this.inner().checkExistenceById(id, apiVersion);\n     }\n \n     @Override\n-    public GenericResource getById(String id) {\n-        Provider provider = this.manager().providers().getByName(ResourceUtils.resourceProviderFromResourceId(id));\n-        String apiVersion = ResourceUtils.defaultApiVersion(id, provider);\n-        GenericResourceImpl genericResource = wrapModel(this.inner().getById(id, apiVersion));\n-        return genericResource == null ? null : genericResource.withApiVersion(apiVersion);\n+    public Observable<GenericResource> getByIdAsync(final String id) {\n+        final GenericResourcesImpl self = this;\n+        return this.getApiVersionFromIdAsync(id)\n+                .flatMap(new Func1<String, Observable<GenericResource>>() {\n+                    @Override\n+                    public Observable<GenericResource> call(String s) {\n+                        return self.getByIdAsync(id, s);\n+                    }\n+                });\n+    }\n+\n+    @Override\n+    public Completable deleteByIdAsync(final String id) {\n+        final ResourcesInner inner = this.inner();\n+        return this.getApiVersionFromIdAsync(id)\n+                .flatMap(new Func1<String, Observable<Void>>() {\n+                    @Override\n+                    public Observable<Void> call(String apiVersion) {\n+                        return inner.deleteByIdAsync(id, apiVersion);\n+                    }\n+                }).toCompletable();\n+    }\n+\n+    @Override\n+    public void deleteById(String id, String apiVersion) {\n+        this.deleteByIdAsync(id, apiVersion).await();\n+    }\n+\n+    @Override\n+    public Completable deleteByIdAsync(String id, String apiVersion) {\n+        return this.inner().deleteByIdAsync(id, apiVersion).toCompletable();\n+    }\n+\n+    @Override\n+    public GenericResource getById(String id, String apiVersion) {\n+        return this.getByIdAsync(id, apiVersion).toBlocking().last();\n+    }\n+\n+    @Override\n+    public Observable<GenericResource> getByIdAsync(String id, final String apiVersion) {\n+        return this.inner().getByIdAsync(id, apiVersion)\n+                .map(new Func1<GenericResourceInner, GenericResource>() {\n+                    @Override\n+                    public GenericResource call(GenericResourceInner genericResourceInner) {\n+                        GenericResourceImpl genericResource = wrapModel(genericResourceInner);\n+                        if (genericResource != null) {\n+                            genericResource.withApiVersion(apiVersion);\n+                        }\n+                        return genericResource;\n+                    }\n+                });\n     }\n \n     @Override\n@@ -241,19 +292,7 @@ protected Completable deleteInnerAsync(String resourceGroupName, String name) {\n         throw new UnsupportedOperationException(\"Delete just by resource group and name is not supported. Please use other overloads.\");\n     }\n \n-    @Override\n-    public Completable deleteByIdAsync(final String id) {\n-       final ResourcesInner inner = this.inner();\n-        return getApiVersionFromId(id)\n-                .flatMap(new Func1<String, Observable<Void>>() {\n-                    @Override\n-                    public Observable<Void> call(String apiVersion) {\n-                        return inner.deleteByIdAsync(id, apiVersion);\n-                    }\n-                }).toCompletable();\n-    }\n-\n-    private Observable<String> getApiVersionFromId(final String id) {\n+    private Observable<String> getApiVersionFromIdAsync(final String id) {\n         return this.manager().providers().getByNameAsync(ResourceUtils.resourceProviderFromResourceId(id))\n                 .map(new Func1<Provider, String>() {\n                     @Override"
  },
  {
    "sha": "d6ba507009751d9c448d2c9593bf3f2f89958ca8",
    "filename": "azure/src/test/resources/session-records/testForceDeleteGenericResources.json",
    "status": "modified",
    "additions": 244,
    "deletions": 452,
    "changes": 696,
    "blob_url": "https://github.com/Azure/azure-libraries-for-java/blob/3c7eebf06eb18429be644abfef75566b22b77964/azure/src/test/resources/session-records/testForceDeleteGenericResources.json",
    "raw_url": "https://github.com/Azure/azure-libraries-for-java/raw/3c7eebf06eb18429be644abfef75566b22b77964/azure/src/test/resources/session-records/testForceDeleteGenericResources.json",
    "contents_url": "https://api.github.com/repos/Azure/azure-libraries-for-java/contents/azure/src/test/resources/session-records/testForceDeleteGenericResources.json?ref=3c7eebf06eb18429be644abfef75566b22b77964"
  },
  {
    "sha": "0e226e2201c27a442486246966deaff99c65f208",
    "filename": "azure/src/test/resources/session-records/testGenericResources.json",
    "status": "modified",
    "additions": 95,
    "deletions": 100,
    "changes": 195,
    "blob_url": "https://github.com/Azure/azure-libraries-for-java/blob/3c7eebf06eb18429be644abfef75566b22b77964/azure/src/test/resources/session-records/testGenericResources.json",
    "raw_url": "https://github.com/Azure/azure-libraries-for-java/raw/3c7eebf06eb18429be644abfef75566b22b77964/azure/src/test/resources/session-records/testGenericResources.json",
    "contents_url": "https://api.github.com/repos/Azure/azure-libraries-for-java/contents/azure/src/test/resources/session-records/testGenericResources.json?ref=3c7eebf06eb18429be644abfef75566b22b77964"
  }
]

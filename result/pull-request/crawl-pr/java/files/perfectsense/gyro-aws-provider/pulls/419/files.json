[
  {
    "sha": "8f4f7ef685375c52cbf8f09572cc4ea23c080cbb",
    "filename": "src/main/java/gyro/aws/ec2/LaunchTemplateResource.java",
    "status": "modified",
    "additions": 3,
    "deletions": 5,
    "changes": 8,
    "blob_url": "https://github.com/perfectsense/gyro-aws-provider/blob/0f1e21f150583f6ae7d8a07c121e07b7624f3b6a/src/main/java/gyro/aws/ec2/LaunchTemplateResource.java",
    "raw_url": "https://github.com/perfectsense/gyro-aws-provider/raw/0f1e21f150583f6ae7d8a07c121e07b7624f3b6a/src/main/java/gyro/aws/ec2/LaunchTemplateResource.java",
    "contents_url": "https://api.github.com/repos/perfectsense/gyro-aws-provider/contents/src/main/java/gyro/aws/ec2/LaunchTemplateResource.java?ref=0f1e21f150583f6ae7d8a07c121e07b7624f3b6a",
    "patch": "@@ -127,7 +127,6 @@ public void setName(String name) {\n     /**\n      * The AMI to be used to launch the Instance created by this Template.\n      */\n-    @Required\n     public AmiResource getAmi() {\n         return ami;\n     }\n@@ -197,10 +196,10 @@ public void setConfigureHibernateOption(Boolean configureHibernateOption) {\n     }\n \n     /**\n-     * The shutdown behavior options for an instance. Defaults to Stop. See `Changing the Instance Initiated Shutdown Behavior <https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/terminating-instances.html#Using_ChangingInstanceInitiatedShutdownBehavior/>`_.\n+     * The shutdown behavior options for an instance. See `Changing the Instance Initiated Shutdown Behavior <https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/terminating-instances.html#Using_ChangingInstanceInitiatedShutdownBehavior/>`_.\n      */\n     public String getShutdownBehavior() {\n-        return shutdownBehavior != null ? shutdownBehavior.toLowerCase() : ShutdownBehavior.STOP.toString();\n+        return shutdownBehavior;\n     }\n \n     public void setShutdownBehavior(String shutdownBehavior) {\n@@ -222,7 +221,6 @@ public void setInstanceType(String instanceType) {\n     /**\n      * The launch instance with the key name of an EC2 Key Pair. This is a certificate required to access your instance. See `Amazon EC2 Key Pairs < https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-key-pairs.html/>`_.\n      */\n-    @Required\n     public String getKeyName() {\n         return keyName;\n     }\n@@ -419,7 +417,7 @@ protected void doCreate(GyroUI ui, State state) {\n                         .disableApiTermination(getDisableApiTermination())\n                         .ebsOptimized(getEbsOptimized())\n                         .hibernationOptions(o -> o.configured(getConfigureHibernateOption()))\n-                        .imageId(getAmi().getId())\n+                        .imageId(getAmi() == null ? null : getAmi().getId())\n                         .instanceType(getInstanceType())\n                         .instanceInitiatedShutdownBehavior(getShutdownBehavior())\n                         .keyName(getKeyName())"
  },
  {
    "sha": "da43d4b8042d1678e5cf5f1d7b6d85a2f730ecf5",
    "filename": "src/main/java/gyro/aws/eks/EksLaunchTemplateSpecification.java",
    "status": "added",
    "additions": 51,
    "deletions": 0,
    "changes": 51,
    "blob_url": "https://github.com/perfectsense/gyro-aws-provider/blob/0f1e21f150583f6ae7d8a07c121e07b7624f3b6a/src/main/java/gyro/aws/eks/EksLaunchTemplateSpecification.java",
    "raw_url": "https://github.com/perfectsense/gyro-aws-provider/raw/0f1e21f150583f6ae7d8a07c121e07b7624f3b6a/src/main/java/gyro/aws/eks/EksLaunchTemplateSpecification.java",
    "contents_url": "https://api.github.com/repos/perfectsense/gyro-aws-provider/contents/src/main/java/gyro/aws/eks/EksLaunchTemplateSpecification.java?ref=0f1e21f150583f6ae7d8a07c121e07b7624f3b6a",
    "patch": "@@ -0,0 +1,51 @@\n+package gyro.aws.eks;\n+\n+import gyro.aws.Copyable;\n+import gyro.aws.ec2.LaunchTemplateResource;\n+import gyro.core.resource.Diffable;\n+import gyro.core.resource.Updatable;\n+import software.amazon.awssdk.services.eks.model.LaunchTemplateSpecification;\n+\n+public class EksLaunchTemplateSpecification extends Diffable implements Copyable<LaunchTemplateSpecification> {\n+\n+    private LaunchTemplateResource launchTemplate;\n+    private String version;\n+\n+    /**\n+     * The ID of the launch template.\n+     */\n+    public LaunchTemplateResource getLaunchTemplate() {\n+        return launchTemplate;\n+    }\n+\n+    public void setLaunchTemplate(LaunchTemplateResource launchTemplate) {\n+        this.launchTemplate = launchTemplate;\n+    }\n+\n+    /**\n+     * The version of the launch template to use.\n+     */\n+    @Updatable\n+    public String getVersion() {\n+        return version;\n+    }\n+\n+    public void setVersion(String version) {\n+        this.version = version;\n+    }\n+\n+    @Override\n+    public void copyFrom(LaunchTemplateSpecification model) {\n+        setLaunchTemplate(findById(LaunchTemplateResource.class, model.id()));\n+        setVersion(model.version());\n+    }\n+\n+    @Override\n+    public String primaryKey() {\n+        return \"\";\n+    }\n+\n+    LaunchTemplateSpecification toLaunchTemplateSpecification() {\n+        return LaunchTemplateSpecification.builder().id(getLaunchTemplate().getId()).version(getVersion()).build();\n+    }\n+}"
  },
  {
    "sha": "f4d8e9dccf6d1462ce35527869993ae9504fa4c6",
    "filename": "src/main/java/gyro/aws/eks/EksNodegroupResource.java",
    "status": "modified",
    "additions": 34,
    "deletions": 1,
    "changes": 35,
    "blob_url": "https://github.com/perfectsense/gyro-aws-provider/blob/0f1e21f150583f6ae7d8a07c121e07b7624f3b6a/src/main/java/gyro/aws/eks/EksNodegroupResource.java",
    "raw_url": "https://github.com/perfectsense/gyro-aws-provider/raw/0f1e21f150583f6ae7d8a07c121e07b7624f3b6a/src/main/java/gyro/aws/eks/EksNodegroupResource.java",
    "contents_url": "https://api.github.com/repos/perfectsense/gyro-aws-provider/contents/src/main/java/gyro/aws/eks/EksNodegroupResource.java?ref=0f1e21f150583f6ae7d8a07c121e07b7624f3b6a",
    "patch": "@@ -92,6 +92,7 @@\n     private Map<String, String> labels;\n     private Integer diskSize;\n     private Map<String, String> tags;\n+    private EksLaunchTemplateSpecification launchTemplateSpecification;\n \n     // Read-only\n     private String arn;\n@@ -205,7 +206,7 @@ public void setRemoteAccess(EksNodegroupRemoteAccessConfig remoteAccess) {\n     /**\n      * The Ami type of the node group.\n      */\n-    @ValidStrings({\"AL2_x86_6\", \"AL2_x86_64_GPU\"})\n+    @ValidStrings({\"AL2_x86_64\", \"AL2_x86_64_GPU\", \"AL2_ARM_64\"})\n     public AMITypes getAmiType() {\n         return amiType;\n     }\n@@ -282,6 +283,18 @@ public void setArn(String arn) {\n         this.arn = arn;\n     }\n \n+    /**\n+     * The launch template specification.\n+     */\n+    @Updatable\n+    public EksLaunchTemplateSpecification getLaunchTemplateSpecification() {\n+        return launchTemplateSpecification;\n+    }\n+\n+    public void setLaunchTemplateSpecification(EksLaunchTemplateSpecification launchTemplateSpecification) {\n+        this.launchTemplateSpecification = launchTemplateSpecification;\n+    }\n+\n     @Override\n     public void copyFrom(Nodegroup model) {\n         setArn((model.nodegroupArn()));\n@@ -308,6 +321,12 @@ public void copyFrom(Nodegroup model) {\n             remoteAccessConfig.copyFrom(model.remoteAccess());\n             setRemoteAccess(remoteAccessConfig);\n         }\n+\n+        if (model.launchTemplate() != null) {\n+            EksLaunchTemplateSpecification specification = newSubresource(EksLaunchTemplateSpecification.class);\n+            specification.copyFrom(model.launchTemplate());\n+            setLaunchTemplateSpecification(specification);\n+        }\n     }\n \n     @Override\n@@ -350,6 +369,10 @@ public void create(GyroUI ui, State state) throws Exception {\n             builder = builder.remoteAccess(getRemoteAccess().toRemoteAccessConfig());\n         }\n \n+        if (getLaunchTemplateSpecification() != null) {\n+            builder = builder.launchTemplate(getLaunchTemplateSpecification().toLaunchTemplateSpecification());\n+        }\n+\n         CreateNodegroupResponse response = client.createNodegroup(builder.build());\n \n         copyFrom(response.nodegroup());\n@@ -379,6 +402,16 @@ public void update(\n                     .build());\n         }\n \n+        if (changedFieldNames.contains(\"launch-template-specification\")) {\n+            client.updateNodegroupVersion(UpdateNodegroupVersionRequest.builder()\n+                .clusterName(getCluster().getName())\n+                .launchTemplate(getLaunchTemplateSpecification().toLaunchTemplateSpecification())\n+                .nodegroupName(getName())\n+                .build());\n+\n+            waitForActiveState(client);\n+        }\n+\n         if (changedFieldNames.contains(\"labels\")) {\n             if (!currentResource.getLabels().isEmpty()) {\n                 client.updateNodegroupConfig(UpdateNodegroupConfigRequest.builder()"
  },
  {
    "sha": "3bcdf30fe38f0d467cd15fc51cb65ddce9219332",
    "filename": "src/main/java/gyro/aws/eks/EksNodegroupScalingConfig.java",
    "status": "modified",
    "additions": 2,
    "deletions": 0,
    "changes": 2,
    "blob_url": "https://github.com/perfectsense/gyro-aws-provider/blob/0f1e21f150583f6ae7d8a07c121e07b7624f3b6a/src/main/java/gyro/aws/eks/EksNodegroupScalingConfig.java",
    "raw_url": "https://github.com/perfectsense/gyro-aws-provider/raw/0f1e21f150583f6ae7d8a07c121e07b7624f3b6a/src/main/java/gyro/aws/eks/EksNodegroupScalingConfig.java",
    "contents_url": "https://api.github.com/repos/perfectsense/gyro-aws-provider/contents/src/main/java/gyro/aws/eks/EksNodegroupScalingConfig.java?ref=0f1e21f150583f6ae7d8a07c121e07b7624f3b6a",
    "patch": "@@ -20,6 +20,7 @@\n import gyro.core.resource.Diffable;\n import gyro.core.resource.Updatable;\n import gyro.core.validation.Range;\n+import gyro.core.validation.Required;\n import software.amazon.awssdk.services.eks.model.NodegroupScalingConfig;\n \n public class EksNodegroupScalingConfig extends Diffable implements Copyable<NodegroupScalingConfig> {\n@@ -33,6 +34,7 @@\n      */\n     @Range(min = 1, max = 100)\n     @Updatable\n+    @Required\n     public Integer getDesiredSize() {\n         return desiredSize;\n     }"
  }
]

[
  {
    "sha": "f5a86d075b58e494c0d603335d3649ffb73a55db",
    "filename": ".bumpversion.cfg",
    "status": "modified",
    "additions": 3,
    "deletions": 1,
    "changes": 4,
    "blob_url": "https://github.com/marcosmarxm/airbyte/blob/2a207174757ef99943b50a52f665158cdd6f5d53/.bumpversion.cfg",
    "raw_url": "https://github.com/marcosmarxm/airbyte/raw/2a207174757ef99943b50a52f665158cdd6f5d53/.bumpversion.cfg",
    "contents_url": "https://api.github.com/repos/marcosmarxm/airbyte/contents/.bumpversion.cfg?ref=2a207174757ef99943b50a52f665158cdd6f5d53",
    "patch": "@@ -3,9 +3,11 @@ current_version = 0.17.0-alpha\n commit = True\n tag = False\n parse = (?P<major>\\d+)\\.(?P<minor>\\d+)\\.(?P<patch>\\d+)(\\-[a-z]+)?\n-serialize = \n+serialize =\n \t{major}.{minor}.{patch}-alpha\n \n [bumpversion:file:.bumpversion.cfg]\n \n [bumpversion:file:.env]\n+\n+[bumpversion:file:docs/tutorials/upgrading-airbyte.md]"
  },
  {
    "sha": "d079129f6a881b8ec992395a79682d1a05a190b3",
    "filename": ".github/auto_assign.yml",
    "status": "added",
    "additions": 22,
    "deletions": 0,
    "changes": 22,
    "blob_url": "https://github.com/marcosmarxm/airbyte/blob/2a207174757ef99943b50a52f665158cdd6f5d53/.github/auto_assign.yml",
    "raw_url": "https://github.com/marcosmarxm/airbyte/raw/2a207174757ef99943b50a52f665158cdd6f5d53/.github/auto_assign.yml",
    "contents_url": "https://api.github.com/repos/marcosmarxm/airbyte/contents/.github/auto_assign.yml?ref=2a207174757ef99943b50a52f665158cdd6f5d53",
    "patch": "@@ -0,0 +1,22 @@\n+# Set to true to add reviewers to pull requests\n+addReviewers: true\n+\n+# Set to true to add assignees to pull requests\n+addAssignees: false\n+\n+# A list of reviewers to be added to pull requests (GitHub user name)\n+reviewers:\n+  - cGardens\n+  - ChristopheDuong\n+  - davinchia\n+  - jrhizor\n+  - michel-tricot\n+  - sherifnada\n+\n+# A list of keywords to be skipped the process that add reviewers if pull requests include it\n+skipKeywords:\n+  - dnm\n+\n+# A number of reviewers added to the pull request\n+# Set 0 to add all the reviewers (default: 0)\n+numberOfReviewers: 2"
  },
  {
    "sha": "1f23fc9505273a4ec3d3ff4af383ccdb1adc0ba7",
    "filename": ".github/workflows/publish-command.yml",
    "status": "modified",
    "additions": 2,
    "deletions": 0,
    "changes": 2,
    "blob_url": "https://github.com/marcosmarxm/airbyte/blob/2a207174757ef99943b50a52f665158cdd6f5d53/.github/workflows/publish-command.yml",
    "raw_url": "https://github.com/marcosmarxm/airbyte/raw/2a207174757ef99943b50a52f665158cdd6f5d53/.github/workflows/publish-command.yml",
    "contents_url": "https://api.github.com/repos/marcosmarxm/airbyte/contents/.github/workflows/publish-command.yml?ref=2a207174757ef99943b50a52f665158cdd6f5d53",
    "patch": "@@ -57,9 +57,11 @@ jobs:\n           GOOGLE_ANALYTICS_TEST_CREDS: ${{ secrets.GOOGLE_ANALYTICS_TEST_CREDS }}\n           GOOGLE_ANALYTICS_TEST_TRACKING_ID: ${{ secrets.GOOGLE_ANALYTICS_TEST_TRACKING_ID }}\n           GOOGLE_CLOUD_STORAGE_TEST_CREDS: ${{ secrets.GOOGLE_CLOUD_STORAGE_TEST_CREDS }}\n+          GOOGLE_DIRECTORY_TEST_CREDS: ${{ secrets.GOOGLE_DIRECTORY_TEST_CREDS }}\n           GREENHOUSE_TEST_CREDS: ${{ secrets.GREENHOUSE_TEST_CREDS }}\n           GSHEETS_INTEGRATION_TESTS_CREDS: ${{ secrets.GSHEETS_INTEGRATION_TESTS_CREDS }}\n           HUBSPOT_INTEGRATION_TESTS_CREDS: ${{ secrets.HUBSPOT_INTEGRATION_TESTS_CREDS }}\n+          INSTAGRAM_INTEGRATION_TESTS_CREDS: ${{ secrets.INSTAGRAM_INTEGRATION_TESTS_CREDS }}\n           INTERCOM_INTEGRATION_TEST_CREDS: ${{ secrets.INTERCOM_INTEGRATION_TEST_CREDS }}\n           JIRA_INTEGRATION_TEST_CREDS: ${{ secrets.JIRA_INTEGRATION_TEST_CREDS }}\n           LOOKER_INTEGRATION_TEST_CREDS: ${{ secrets.LOOKER_INTEGRATION_TEST_CREDS }}"
  },
  {
    "sha": "a7fa5da9b22147f13ac1f8a14eef60145896acea",
    "filename": ".github/workflows/test-command.yml",
    "status": "modified",
    "additions": 2,
    "deletions": 0,
    "changes": 2,
    "blob_url": "https://github.com/marcosmarxm/airbyte/blob/2a207174757ef99943b50a52f665158cdd6f5d53/.github/workflows/test-command.yml",
    "raw_url": "https://github.com/marcosmarxm/airbyte/raw/2a207174757ef99943b50a52f665158cdd6f5d53/.github/workflows/test-command.yml",
    "contents_url": "https://api.github.com/repos/marcosmarxm/airbyte/contents/.github/workflows/test-command.yml?ref=2a207174757ef99943b50a52f665158cdd6f5d53",
    "patch": "@@ -57,9 +57,11 @@ jobs:\n           GOOGLE_ANALYTICS_TEST_CREDS: ${{ secrets.GOOGLE_ANALYTICS_TEST_CREDS }}\n           GOOGLE_ANALYTICS_TEST_TRACKING_ID: ${{ secrets.GOOGLE_ANALYTICS_TEST_TRACKING_ID }}\n           GOOGLE_CLOUD_STORAGE_TEST_CREDS: ${{ secrets.GOOGLE_CLOUD_STORAGE_TEST_CREDS }}\n+          GOOGLE_DIRECTORY_TEST_CREDS: ${{ secrets.GOOGLE_DIRECTORY_TEST_CREDS }}\n           GREENHOUSE_TEST_CREDS: ${{ secrets.GREENHOUSE_TEST_CREDS }}\n           GSHEETS_INTEGRATION_TESTS_CREDS: ${{ secrets.GSHEETS_INTEGRATION_TESTS_CREDS }}\n           HUBSPOT_INTEGRATION_TESTS_CREDS: ${{ secrets.HUBSPOT_INTEGRATION_TESTS_CREDS }}\n+          INSTAGRAM_INTEGRATION_TESTS_CREDS: ${{ secrets.INSTAGRAM_INTEGRATION_TESTS_CREDS }}\n           INTERCOM_INTEGRATION_TEST_CREDS: ${{ secrets.INTERCOM_INTEGRATION_TEST_CREDS }}\n           JIRA_INTEGRATION_TEST_CREDS: ${{ secrets.JIRA_INTEGRATION_TEST_CREDS }}\n           LOOKER_INTEGRATION_TEST_CREDS: ${{ secrets.LOOKER_INTEGRATION_TEST_CREDS }}"
  },
  {
    "sha": "4b74bb3ae715eabc9046b4b569993415e538fe12",
    "filename": "airbyte-analytics/src/main/java/io/airbyte/analytics/TrackingClientSingleton.java",
    "status": "modified",
    "additions": 1,
    "deletions": 1,
    "changes": 2,
    "blob_url": "https://github.com/marcosmarxm/airbyte/blob/2a207174757ef99943b50a52f665158cdd6f5d53/airbyte-analytics/src/main/java/io/airbyte/analytics/TrackingClientSingleton.java",
    "raw_url": "https://github.com/marcosmarxm/airbyte/raw/2a207174757ef99943b50a52f665158cdd6f5d53/airbyte-analytics/src/main/java/io/airbyte/analytics/TrackingClientSingleton.java",
    "contents_url": "https://api.github.com/repos/marcosmarxm/airbyte/contents/airbyte-analytics/src/main/java/io/airbyte/analytics/TrackingClientSingleton.java?ref=2a207174757ef99943b50a52f665158cdd6f5d53",
    "patch": "@@ -70,7 +70,7 @@ private static void initialize() {\n   @VisibleForTesting\n   static TrackingIdentity getTrackingIdentity(ConfigRepository configRepository, String airbyteVersion) {\n     try {\n-      final StandardWorkspace workspace = configRepository.getStandardWorkspace(PersistenceConstants.DEFAULT_WORKSPACE_ID);\n+      final StandardWorkspace workspace = configRepository.getStandardWorkspace(PersistenceConstants.DEFAULT_WORKSPACE_ID, true);\n       String email = null;\n       if (workspace.getEmail() != null && workspace.getAnonymousDataCollection() != null && !workspace.getAnonymousDataCollection()) {\n         email = workspace.getEmail();"
  },
  {
    "sha": "f992322f7f157a4e480f4828ebd716dedb40f3c4",
    "filename": "airbyte-analytics/src/test/java/io/airbyte/analytics/TrackingClientSingletonTest.java",
    "status": "modified",
    "additions": 3,
    "deletions": 3,
    "changes": 6,
    "blob_url": "https://github.com/marcosmarxm/airbyte/blob/2a207174757ef99943b50a52f665158cdd6f5d53/airbyte-analytics/src/test/java/io/airbyte/analytics/TrackingClientSingletonTest.java",
    "raw_url": "https://github.com/marcosmarxm/airbyte/raw/2a207174757ef99943b50a52f665158cdd6f5d53/airbyte-analytics/src/test/java/io/airbyte/analytics/TrackingClientSingletonTest.java",
    "contents_url": "https://api.github.com/repos/marcosmarxm/airbyte/contents/airbyte-analytics/src/test/java/io/airbyte/analytics/TrackingClientSingletonTest.java?ref=2a207174757ef99943b50a52f665158cdd6f5d53",
    "patch": "@@ -87,7 +87,7 @@ void testGetUninitialized() {\n   void testGetTrackingIdentityInitialSetupNotComplete() throws JsonValidationException, IOException, ConfigNotFoundException {\n     final StandardWorkspace workspace = new StandardWorkspace().withCustomerId(UUID.randomUUID());\n \n-    when(configRepository.getStandardWorkspace(PersistenceConstants.DEFAULT_WORKSPACE_ID)).thenReturn(workspace);\n+    when(configRepository.getStandardWorkspace(PersistenceConstants.DEFAULT_WORKSPACE_ID, true)).thenReturn(workspace);\n \n     final TrackingIdentity actual = TrackingClientSingleton.getTrackingIdentity(configRepository, AIRBYTE_VERSION);\n     final TrackingIdentity expected = new TrackingIdentity(AIRBYTE_VERSION, workspace.getCustomerId(), null, null, null, null);\n@@ -104,7 +104,7 @@ void testGetTrackingIdentityNonAnonymous() throws JsonValidationException, IOExc\n         .withNews(true)\n         .withSecurityUpdates(true);\n \n-    when(configRepository.getStandardWorkspace(PersistenceConstants.DEFAULT_WORKSPACE_ID)).thenReturn(workspace);\n+    when(configRepository.getStandardWorkspace(PersistenceConstants.DEFAULT_WORKSPACE_ID, true)).thenReturn(workspace);\n \n     final TrackingIdentity actual = TrackingClientSingleton.getTrackingIdentity(configRepository, AIRBYTE_VERSION);\n     final TrackingIdentity expected = new TrackingIdentity(AIRBYTE_VERSION, workspace.getCustomerId(), workspace.getEmail(), false, true, true);\n@@ -121,7 +121,7 @@ void testGetTrackingIdentityAnonymous() throws JsonValidationException, IOExcept\n         .withNews(true)\n         .withSecurityUpdates(true);\n \n-    when(configRepository.getStandardWorkspace(PersistenceConstants.DEFAULT_WORKSPACE_ID)).thenReturn(workspace);\n+    when(configRepository.getStandardWorkspace(PersistenceConstants.DEFAULT_WORKSPACE_ID, true)).thenReturn(workspace);\n \n     final TrackingIdentity actual = TrackingClientSingleton.getTrackingIdentity(configRepository, AIRBYTE_VERSION);\n     final TrackingIdentity expected = new TrackingIdentity(AIRBYTE_VERSION, workspace.getCustomerId(), null, true, true, true);"
  },
  {
    "sha": "77f9f68815b57f1b0ba85dfb740e642cf3794f0d",
    "filename": "airbyte-api/src/main/openapi/config.yaml",
    "status": "modified",
    "additions": 56,
    "deletions": 0,
    "changes": 56,
    "blob_url": "https://github.com/marcosmarxm/airbyte/blob/2a207174757ef99943b50a52f665158cdd6f5d53/airbyte-api/src/main/openapi/config.yaml",
    "raw_url": "https://github.com/marcosmarxm/airbyte/raw/2a207174757ef99943b50a52f665158cdd6f5d53/airbyte-api/src/main/openapi/config.yaml",
    "contents_url": "https://api.github.com/repos/marcosmarxm/airbyte/contents/airbyte-api/src/main/openapi/config.yaml?ref=2a207174757ef99943b50a52f665158cdd6f5d53",
    "patch": "@@ -56,6 +56,46 @@ tags:\n     description: Export/Import Airbyte Configuration and Database resources.\n \n paths:\n+  /v1/workspaces/create:\n+    post:\n+      tags:\n+        - workspace\n+      summary: Creates a workspace\n+      operationId: createWorkspace\n+      requestBody:\n+        content:\n+          application/json:\n+            schema:\n+              $ref: \"#/components/schemas/WorkspaceCreate\"\n+        required: true\n+      responses:\n+        \"200\":\n+          description: Successful operation\n+          content:\n+            application/json:\n+              schema:\n+                $ref: \"#/components/schemas/WorkspaceRead\"\n+        \"422\":\n+          $ref: \"#/components/responses/InvalidInput\"\n+  /v1/workspaces/delete:\n+    post:\n+      tags:\n+        - workspace\n+      summary: Deletes a workspace\n+      operationId: deleteWorkspace\n+      requestBody:\n+        content:\n+          application/json:\n+            schema:\n+              $ref: \"#/components/schemas/WorkspaceIdRequestBody\"\n+        required: true\n+      responses:\n+        \"204\":\n+          description: The resource was deleted successfully.\n+        \"404\":\n+          description: Source not found\n+        \"422\":\n+          $ref: \"#/components/responses/InvalidInput\"\n   /v1/workspaces/get:\n     post:\n       tags:\n@@ -1158,6 +1198,22 @@ components:\n     CustomerId:\n       type: string\n       format: uuid\n+    WorkspaceCreate:\n+      type: object\n+      required:\n+        - name\n+      properties:\n+        email:\n+          type: string\n+          format: email\n+        anonymousDataCollection:\n+          type: boolean\n+        name:\n+          type: string\n+        news:\n+          type: boolean\n+        securityUpdates:\n+          type: boolean\n     WorkspaceIdRequestBody:\n       type: object\n       required:"
  },
  {
    "sha": "32b3388e496856105dd831685f00ca3172b818c2",
    "filename": "airbyte-config/init/src/main/resources/config/STANDARD_SOURCE_DEFINITION/39f092a6-8c87-4f6f-a8d9-5cef45b7dbe1.json",
    "status": "modified",
    "additions": 1,
    "deletions": 1,
    "changes": 2,
    "blob_url": "https://github.com/marcosmarxm/airbyte/blob/2a207174757ef99943b50a52f665158cdd6f5d53/airbyte-config/init/src/main/resources/config/STANDARD_SOURCE_DEFINITION/39f092a6-8c87-4f6f-a8d9-5cef45b7dbe1.json",
    "raw_url": "https://github.com/marcosmarxm/airbyte/raw/2a207174757ef99943b50a52f665158cdd6f5d53/airbyte-config/init/src/main/resources/config/STANDARD_SOURCE_DEFINITION/39f092a6-8c87-4f6f-a8d9-5cef45b7dbe1.json",
    "contents_url": "https://api.github.com/repos/marcosmarxm/airbyte/contents/airbyte-config/init/src/main/resources/config/STANDARD_SOURCE_DEFINITION/39f092a6-8c87-4f6f-a8d9-5cef45b7dbe1.json?ref=2a207174757ef99943b50a52f665158cdd6f5d53",
    "patch": "@@ -2,6 +2,6 @@\n   \"sourceDefinitionId\": \"39f092a6-8c87-4f6f-a8d9-5cef45b7dbe1\",\n   \"name\": \"Google Analytics\",\n   \"dockerRepository\": \"airbyte/source-googleanalytics-singer\",\n-  \"dockerImageTag\": \"0.2.0\",\n+  \"dockerImageTag\": \"0.2.2\",\n   \"documentationUrl\": \"https://hub.docker.com/r/airbyte/source-googleanalytics-singer\"\n }"
  },
  {
    "sha": "f5365a20812266104f9cb1406f18b623e137735e",
    "filename": "airbyte-config/init/src/main/resources/config/STANDARD_SOURCE_DEFINITION/68e63de2-bb83-4c7e-93fa-a8a9051e3993.json",
    "status": "modified",
    "additions": 1,
    "deletions": 1,
    "changes": 2,
    "blob_url": "https://github.com/marcosmarxm/airbyte/blob/2a207174757ef99943b50a52f665158cdd6f5d53/airbyte-config/init/src/main/resources/config/STANDARD_SOURCE_DEFINITION/68e63de2-bb83-4c7e-93fa-a8a9051e3993.json",
    "raw_url": "https://github.com/marcosmarxm/airbyte/raw/2a207174757ef99943b50a52f665158cdd6f5d53/airbyte-config/init/src/main/resources/config/STANDARD_SOURCE_DEFINITION/68e63de2-bb83-4c7e-93fa-a8a9051e3993.json",
    "contents_url": "https://api.github.com/repos/marcosmarxm/airbyte/contents/airbyte-config/init/src/main/resources/config/STANDARD_SOURCE_DEFINITION/68e63de2-bb83-4c7e-93fa-a8a9051e3993.json?ref=2a207174757ef99943b50a52f665158cdd6f5d53",
    "patch": "@@ -2,6 +2,6 @@\n   \"sourceDefinitionId\": \"68e63de2-bb83-4c7e-93fa-a8a9051e3993\",\n   \"name\": \"Jira\",\n   \"dockerRepository\": \"airbyte/source-jira\",\n-  \"dockerImageTag\": \"0.2.0\",\n+  \"dockerImageTag\": \"0.2.1\",\n   \"documentationUrl\": \"https://hub.docker.com/r/airbyte/source-jira\"\n }"
  },
  {
    "sha": "70abfa26999aa36bf82a97f0eda0483249ad257d",
    "filename": "airbyte-config/init/src/main/resources/config/STANDARD_SOURCE_DEFINITION/6acf6b55-4f1e-4fca-944e-1a3caef8aba8.json",
    "status": "added",
    "additions": 7,
    "deletions": 0,
    "changes": 7,
    "blob_url": "https://github.com/marcosmarxm/airbyte/blob/2a207174757ef99943b50a52f665158cdd6f5d53/airbyte-config/init/src/main/resources/config/STANDARD_SOURCE_DEFINITION/6acf6b55-4f1e-4fca-944e-1a3caef8aba8.json",
    "raw_url": "https://github.com/marcosmarxm/airbyte/raw/2a207174757ef99943b50a52f665158cdd6f5d53/airbyte-config/init/src/main/resources/config/STANDARD_SOURCE_DEFINITION/6acf6b55-4f1e-4fca-944e-1a3caef8aba8.json",
    "contents_url": "https://api.github.com/repos/marcosmarxm/airbyte/contents/airbyte-config/init/src/main/resources/config/STANDARD_SOURCE_DEFINITION/6acf6b55-4f1e-4fca-944e-1a3caef8aba8.json?ref=2a207174757ef99943b50a52f665158cdd6f5d53",
    "patch": "@@ -0,0 +1,7 @@\n+{\n+  \"sourceDefinitionId\": \"6acf6b55-4f1e-4fca-944e-1a3caef8aba8\",\n+  \"name\": \"Instagram\",\n+  \"dockerRepository\": \"airbyte/source-instagram\",\n+  \"dockerImageTag\": \"0.1.0\",\n+  \"documentationUrl\": \"https://hub.docker.com/r/airbyte/source-instagram\"\n+}"
  },
  {
    "sha": "41c1eba390c81518e507980a945734a43e285f56",
    "filename": "airbyte-config/init/src/main/resources/config/STANDARD_SOURCE_DEFINITION/d19ae824-e289-4b14-995a-0632eb46d246.json",
    "status": "added",
    "additions": 7,
    "deletions": 0,
    "changes": 7,
    "blob_url": "https://github.com/marcosmarxm/airbyte/blob/2a207174757ef99943b50a52f665158cdd6f5d53/airbyte-config/init/src/main/resources/config/STANDARD_SOURCE_DEFINITION/d19ae824-e289-4b14-995a-0632eb46d246.json",
    "raw_url": "https://github.com/marcosmarxm/airbyte/raw/2a207174757ef99943b50a52f665158cdd6f5d53/airbyte-config/init/src/main/resources/config/STANDARD_SOURCE_DEFINITION/d19ae824-e289-4b14-995a-0632eb46d246.json",
    "contents_url": "https://api.github.com/repos/marcosmarxm/airbyte/contents/airbyte-config/init/src/main/resources/config/STANDARD_SOURCE_DEFINITION/d19ae824-e289-4b14-995a-0632eb46d246.json?ref=2a207174757ef99943b50a52f665158cdd6f5d53",
    "patch": "@@ -0,0 +1,7 @@\n+{\n+  \"sourceDefinitionId\": \"d19ae824-e289-4b14-995a-0632eb46d246\",\n+  \"name\": \"Google Directory\",\n+  \"dockerRepository\": \"airbyte/source-google-directory\",\n+  \"dockerImageTag\": \"0.1.0\",\n+  \"documentationUrl\": \"https://hub.docker.com/r/airbyte/source-google-directory\"\n+}"
  },
  {
    "sha": "a8af060cbcd8f67605d9358b01e0db7224681063",
    "filename": "airbyte-config/init/src/main/resources/config/STANDARD_SOURCE_DEFINITION/e7778cfc-e97c-4458-9ecb-b4f2bba8946c.json",
    "status": "modified",
    "additions": 1,
    "deletions": 1,
    "changes": 2,
    "blob_url": "https://github.com/marcosmarxm/airbyte/blob/2a207174757ef99943b50a52f665158cdd6f5d53/airbyte-config/init/src/main/resources/config/STANDARD_SOURCE_DEFINITION/e7778cfc-e97c-4458-9ecb-b4f2bba8946c.json",
    "raw_url": "https://github.com/marcosmarxm/airbyte/raw/2a207174757ef99943b50a52f665158cdd6f5d53/airbyte-config/init/src/main/resources/config/STANDARD_SOURCE_DEFINITION/e7778cfc-e97c-4458-9ecb-b4f2bba8946c.json",
    "contents_url": "https://api.github.com/repos/marcosmarxm/airbyte/contents/airbyte-config/init/src/main/resources/config/STANDARD_SOURCE_DEFINITION/e7778cfc-e97c-4458-9ecb-b4f2bba8946c.json?ref=2a207174757ef99943b50a52f665158cdd6f5d53",
    "patch": "@@ -2,6 +2,6 @@\n   \"sourceDefinitionId\": \"e7778cfc-e97c-4458-9ecb-b4f2bba8946c\",\n   \"name\": \"Facebook Marketing\",\n   \"dockerRepository\": \"airbyte/source-facebook-marketing\",\n-  \"dockerImageTag\": \"0.2.0\",\n+  \"dockerImageTag\": \"0.2.1\",\n   \"documentationUrl\": \"https://hub.docker.com/r/airbyte/source-facebook-marketing\"\n }"
  },
  {
    "sha": "3596e87a1d40d63f845d4e5b3262165991ef2c11",
    "filename": "airbyte-config/init/src/main/resources/config/STANDARD_WORKSPACE/5ae6b09b-fdec-41af-aaf7-7d94cfc33ef6.json",
    "status": "modified",
    "additions": 2,
    "deletions": 1,
    "changes": 3,
    "blob_url": "https://github.com/marcosmarxm/airbyte/blob/2a207174757ef99943b50a52f665158cdd6f5d53/airbyte-config/init/src/main/resources/config/STANDARD_WORKSPACE/5ae6b09b-fdec-41af-aaf7-7d94cfc33ef6.json",
    "raw_url": "https://github.com/marcosmarxm/airbyte/raw/2a207174757ef99943b50a52f665158cdd6f5d53/airbyte-config/init/src/main/resources/config/STANDARD_WORKSPACE/5ae6b09b-fdec-41af-aaf7-7d94cfc33ef6.json",
    "contents_url": "https://api.github.com/repos/marcosmarxm/airbyte/contents/airbyte-config/init/src/main/resources/config/STANDARD_WORKSPACE/5ae6b09b-fdec-41af-aaf7-7d94cfc33ef6.json?ref=2a207174757ef99943b50a52f665158cdd6f5d53",
    "patch": "@@ -3,5 +3,6 @@\n   \"name\": \"default\",\n   \"slug\": \"default\",\n   \"initialSetupComplete\": false,\n-  \"displaySetupWizard\": true\n+  \"displaySetupWizard\": true,\n+  \"tombstone\": false\n }"
  },
  {
    "sha": "9c6d69b3703ef87b0c69f306d827dcfa7e8c3093",
    "filename": "airbyte-config/init/src/main/resources/seed/source_definitions.yaml",
    "status": "modified",
    "additions": 13,
    "deletions": 3,
    "changes": 16,
    "blob_url": "https://github.com/marcosmarxm/airbyte/blob/2a207174757ef99943b50a52f665158cdd6f5d53/airbyte-config/init/src/main/resources/seed/source_definitions.yaml",
    "raw_url": "https://github.com/marcosmarxm/airbyte/raw/2a207174757ef99943b50a52f665158cdd6f5d53/airbyte-config/init/src/main/resources/seed/source_definitions.yaml",
    "contents_url": "https://api.github.com/repos/marcosmarxm/airbyte/contents/airbyte-config/init/src/main/resources/seed/source_definitions.yaml?ref=2a207174757ef99943b50a52f665158cdd6f5d53",
    "patch": "@@ -71,12 +71,12 @@\n - sourceDefinitionId: 39f092a6-8c87-4f6f-a8d9-5cef45b7dbe1\n   name: Google Analytics\n   dockerRepository: airbyte/source-googleanalytics-singer\n-  dockerImageTag: 0.2.0\n+  dockerImageTag: 0.2.2\n   documentationUrl: https://hub.docker.com/r/airbyte/source-googleanalytics-singer\n - sourceDefinitionId: e7778cfc-e97c-4458-9ecb-b4f2bba8946c\n   name: Facebook Marketing\n   dockerRepository: airbyte/source-facebook-marketing\n-  dockerImageTag: 0.2.0\n+  dockerImageTag: 0.2.1\n   documentationUrl: https://hub.docker.com/r/airbyte/source-facebook-marketing\n - sourceDefinitionId: 57eb1576-8f52-463d-beb6-2e107cdf571d\n   name: Hubspot\n@@ -136,7 +136,7 @@\n - sourceDefinitionId: 68e63de2-bb83-4c7e-93fa-a8a9051e3993\n   name: Jira\n   dockerRepository: airbyte/source-jira\n-  dockerImageTag: 0.2.0\n+  dockerImageTag: 0.2.1\n   documentationUrl: https://hub.docker.com/r/airbyte/source-jira\n - sourceDefinitionId: 859e501d-2b67-471f-91bb-1c801414d28f\n   name: Mixpanel\n@@ -178,3 +178,13 @@\n   dockerRepository: airbyte/source-mongodb\n   dockerImageTag: 0.2.0\n   documentationUrl: https://hub.docker.com/r/airbyte/source-mongodb\n+- sourceDefinitionId: d19ae824-e289-4b14-995a-0632eb46d246\n+  name: Google Directory\n+  dockerRepository: airbyte/source-google-directory\n+  dockerImageTag: 0.1.0\n+  documentationUrl: https://hub.docker.com/r/airbyte/source-google-directory\n+- sourceDefinitionId: 6acf6b55-4f1e-4fca-944e-1a3caef8aba8\n+  name: Instagram\n+  dockerRepository: airbyte/source-instagram\n+  dockerImageTag: 0.1.0\n+  documentationUrl: https://hub.docker.com/r/airbyte/source-instagram"
  },
  {
    "sha": "1ba5e15ce7c8be927e5051936c3b3480343d8426",
    "filename": "airbyte-config/models/src/main/resources/types/StandardWorkspace.yaml",
    "status": "modified",
    "additions": 5,
    "deletions": 0,
    "changes": 5,
    "blob_url": "https://github.com/marcosmarxm/airbyte/blob/2a207174757ef99943b50a52f665158cdd6f5d53/airbyte-config/models/src/main/resources/types/StandardWorkspace.yaml",
    "raw_url": "https://github.com/marcosmarxm/airbyte/raw/2a207174757ef99943b50a52f665158cdd6f5d53/airbyte-config/models/src/main/resources/types/StandardWorkspace.yaml",
    "contents_url": "https://api.github.com/repos/marcosmarxm/airbyte/contents/airbyte-config/models/src/main/resources/types/StandardWorkspace.yaml?ref=2a207174757ef99943b50a52f665158cdd6f5d53",
    "patch": "@@ -34,3 +34,8 @@ properties:\n     type: boolean\n   displaySetupWizard:\n     type: boolean\n+  tombstone:\n+    description:\n+      if not set or false, the configuration is active. if true, then this\n+      configuration is permanently off.\n+    type: boolean"
  },
  {
    "sha": "30697e41db98440be2782cd35cbdd6d54f908c91",
    "filename": "airbyte-config/persistence/src/main/java/io/airbyte/config/persistence/ConfigRepository.java",
    "status": "modified",
    "additions": 36,
    "deletions": 2,
    "changes": 38,
    "blob_url": "https://github.com/marcosmarxm/airbyte/blob/2a207174757ef99943b50a52f665158cdd6f5d53/airbyte-config/persistence/src/main/java/io/airbyte/config/persistence/ConfigRepository.java",
    "raw_url": "https://github.com/marcosmarxm/airbyte/raw/2a207174757ef99943b50a52f665158cdd6f5d53/airbyte-config/persistence/src/main/java/io/airbyte/config/persistence/ConfigRepository.java",
    "contents_url": "https://api.github.com/repos/marcosmarxm/airbyte/contents/airbyte-config/persistence/src/main/java/io/airbyte/config/persistence/ConfigRepository.java?ref=2a207174757ef99943b50a52f665158cdd6f5d53",
    "patch": "@@ -24,6 +24,7 @@\n \n package io.airbyte.config.persistence;\n \n+import io.airbyte.commons.lang.MoreBooleans;\n import io.airbyte.config.ConfigSchema;\n import io.airbyte.config.DestinationConnection;\n import io.airbyte.config.SourceConnection;\n@@ -34,6 +35,7 @@\n import io.airbyte.config.StandardWorkspace;\n import io.airbyte.validation.json.JsonValidationException;\n import java.io.IOException;\n+import java.util.ArrayList;\n import java.util.List;\n import java.util.UUID;\n \n@@ -45,8 +47,40 @@ public ConfigRepository(ConfigPersistence persistence) {\n     this.persistence = persistence;\n   }\n \n-  public StandardWorkspace getStandardWorkspace(final UUID workspaceId) throws JsonValidationException, IOException, ConfigNotFoundException {\n-    return persistence.getConfig(ConfigSchema.STANDARD_WORKSPACE, workspaceId.toString(), StandardWorkspace.class);\n+  public StandardWorkspace getStandardWorkspace(final UUID workspaceId, boolean includeTombstone)\n+      throws JsonValidationException, IOException, ConfigNotFoundException {\n+    StandardWorkspace workspace = persistence.getConfig(ConfigSchema.STANDARD_WORKSPACE, workspaceId.toString(), StandardWorkspace.class);\n+\n+    if (!MoreBooleans.isTruthy(workspace.getTombstone()) || includeTombstone) {\n+      return workspace;\n+    }\n+\n+    throw new ConfigNotFoundException(ConfigSchema.STANDARD_WORKSPACE, workspaceId.toString());\n+  }\n+\n+  public StandardWorkspace getWorkspaceBySlug(String slug, boolean includeTombstone)\n+      throws JsonValidationException, IOException, ConfigNotFoundException {\n+    for (StandardWorkspace workspace : listStandardWorkspaces(includeTombstone)) {\n+      if (workspace.getSlug().equals(slug)) {\n+        return workspace;\n+      }\n+    }\n+\n+    throw new ConfigNotFoundException(ConfigSchema.STANDARD_WORKSPACE, slug);\n+  }\n+\n+  public List<StandardWorkspace> listStandardWorkspaces(boolean includeTombstone)\n+      throws JsonValidationException, IOException {\n+\n+    List<StandardWorkspace> workspaces = new ArrayList<StandardWorkspace>();\n+\n+    for (StandardWorkspace workspace : persistence.listConfigs(ConfigSchema.STANDARD_WORKSPACE, StandardWorkspace.class)) {\n+      if (!MoreBooleans.isTruthy(workspace.getTombstone()) || includeTombstone) {\n+        workspaces.add(workspace);\n+      }\n+    }\n+\n+    return workspaces;\n   }\n \n   public void writeStandardWorkspace(final StandardWorkspace workspace) throws JsonValidationException, IOException {"
  },
  {
    "sha": "fb2be98d07bb901b3082158eaccbf6eaa4e864e1",
    "filename": "airbyte-config/persistence/src/test/java/io/airbyte/config/persistence/ConfigRepositoryTest.java",
    "status": "added",
    "additions": 71,
    "deletions": 0,
    "changes": 71,
    "blob_url": "https://github.com/marcosmarxm/airbyte/blob/2a207174757ef99943b50a52f665158cdd6f5d53/airbyte-config/persistence/src/test/java/io/airbyte/config/persistence/ConfigRepositoryTest.java",
    "raw_url": "https://github.com/marcosmarxm/airbyte/raw/2a207174757ef99943b50a52f665158cdd6f5d53/airbyte-config/persistence/src/test/java/io/airbyte/config/persistence/ConfigRepositoryTest.java",
    "contents_url": "https://api.github.com/repos/marcosmarxm/airbyte/contents/airbyte-config/persistence/src/test/java/io/airbyte/config/persistence/ConfigRepositoryTest.java?ref=2a207174757ef99943b50a52f665158cdd6f5d53",
    "patch": "@@ -0,0 +1,71 @@\n+/*\n+ * MIT License\n+ *\n+ * Copyright (c) 2020 Airbyte\n+ *\n+ * Permission is hereby granted, free of charge, to any person obtaining a copy\n+ * of this software and associated documentation files (the \"Software\"), to deal\n+ * in the Software without restriction, including without limitation the rights\n+ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n+ * copies of the Software, and to permit persons to whom the Software is\n+ * furnished to do so, subject to the following conditions:\n+ *\n+ * The above copyright notice and this permission notice shall be included in all\n+ * copies or substantial portions of the Software.\n+ *\n+ * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n+ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n+ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n+ * SOFTWARE.\n+ */\n+\n+package io.airbyte.config.persistence;\n+\n+import static org.junit.jupiter.api.Assertions.assertEquals;\n+import static org.mockito.Mockito.mock;\n+import static org.mockito.Mockito.when;\n+\n+import io.airbyte.config.ConfigSchema;\n+import io.airbyte.config.StandardWorkspace;\n+import io.airbyte.validation.json.JsonValidationException;\n+import java.io.IOException;\n+import org.junit.jupiter.api.BeforeEach;\n+import org.junit.jupiter.api.Test;\n+\n+class ConfigRepositoryTest {\n+\n+  private ConfigPersistence configPersistence;\n+  private ConfigRepository configRepository;\n+\n+  @BeforeEach\n+  void setup() {\n+    configPersistence = mock(ConfigPersistence.class);\n+    configRepository = new ConfigRepository(configPersistence);\n+  }\n+\n+  @Test\n+  void testWorkspaceWithNullTombstone() throws ConfigNotFoundException, IOException, JsonValidationException {\n+    assertReturnsWorkspace(new StandardWorkspace().withWorkspaceId(PersistenceConstants.DEFAULT_WORKSPACE_ID));\n+  }\n+\n+  @Test\n+  void testWorkspaceWithFalseTombstone() throws ConfigNotFoundException, IOException, JsonValidationException {\n+    assertReturnsWorkspace(new StandardWorkspace().withWorkspaceId(PersistenceConstants.DEFAULT_WORKSPACE_ID).withTombstone(false));\n+  }\n+\n+  @Test\n+  void testWorkspaceWithTrueTombstone() throws ConfigNotFoundException, IOException, JsonValidationException {\n+    assertReturnsWorkspace(new StandardWorkspace().withWorkspaceId(PersistenceConstants.DEFAULT_WORKSPACE_ID).withTombstone(true));\n+  }\n+\n+  void assertReturnsWorkspace(StandardWorkspace workspace) throws ConfigNotFoundException, IOException, JsonValidationException {\n+    when(configPersistence.getConfig(ConfigSchema.STANDARD_WORKSPACE, PersistenceConstants.DEFAULT_WORKSPACE_ID.toString(), StandardWorkspace.class))\n+        .thenReturn(workspace);\n+\n+    assertEquals(workspace, configRepository.getStandardWorkspace(PersistenceConstants.DEFAULT_WORKSPACE_ID, true));\n+  }\n+\n+}"
  },
  {
    "sha": "6dea1b82c9062ae01531b44d3976e351413eeaca",
    "filename": "airbyte-integrations/bases/base-normalization/Dockerfile",
    "status": "modified",
    "additions": 1,
    "deletions": 1,
    "changes": 2,
    "blob_url": "https://github.com/marcosmarxm/airbyte/blob/2a207174757ef99943b50a52f665158cdd6f5d53/airbyte-integrations/bases/base-normalization/Dockerfile",
    "raw_url": "https://github.com/marcosmarxm/airbyte/raw/2a207174757ef99943b50a52f665158cdd6f5d53/airbyte-integrations/bases/base-normalization/Dockerfile",
    "contents_url": "https://api.github.com/repos/marcosmarxm/airbyte/contents/airbyte-integrations/bases/base-normalization/Dockerfile?ref=2a207174757ef99943b50a52f665158cdd6f5d53",
    "patch": "@@ -19,5 +19,5 @@ WORKDIR /airbyte\n \n ENTRYPOINT [\"/airbyte/entrypoint.sh\"]\n \n-LABEL io.airbyte.version=0.1.14\n+LABEL io.airbyte.version=0.1.15\n LABEL io.airbyte.name=airbyte/normalization"
  },
  {
    "sha": "0c9217dbc55b7ce0a25be2711aaa64e14690a793",
    "filename": "airbyte-integrations/bases/base-normalization/normalization/transform_catalog/catalog_processor.py",
    "status": "modified",
    "additions": 54,
    "deletions": 0,
    "changes": 54,
    "blob_url": "https://github.com/marcosmarxm/airbyte/blob/2a207174757ef99943b50a52f665158cdd6f5d53/airbyte-integrations/bases/base-normalization/normalization/transform_catalog/catalog_processor.py",
    "raw_url": "https://github.com/marcosmarxm/airbyte/raw/2a207174757ef99943b50a52f665158cdd6f5d53/airbyte-integrations/bases/base-normalization/normalization/transform_catalog/catalog_processor.py",
    "contents_url": "https://api.github.com/repos/marcosmarxm/airbyte/contents/airbyte-integrations/bases/base-normalization/normalization/transform_catalog/catalog_processor.py?ref=2a207174757ef99943b50a52f665158cdd6f5d53",
    "patch": "@@ -27,6 +27,7 @@\n from typing import Any, Dict, List, Set\n \n import yaml\n+from airbyte_protocol.models.airbyte_protocol import DestinationSyncMode, SyncMode\n from normalization.destination_type import DestinationType\n from normalization.transform_catalog.destination_name_transformer import DestinationNameTransformer\n from normalization.transform_catalog.stream_processor import StreamProcessor\n@@ -110,6 +111,21 @@ def build_stream_processor(\n             stream_name = get_field(stream_config, \"name\", f\"Invalid Stream: 'name' is not defined in stream: {str(stream_config)}\")\n             raw_table_name = name_transformer.normalize_table_name(f\"_airbyte_raw_{stream_name}\", truncate=False)\n \n+            source_sync_mode = get_source_sync_mode(configured_stream, stream_name)\n+            destination_sync_mode = get_destination_sync_mode(configured_stream, stream_name)\n+            cursor_field = []\n+            primary_key = []\n+            if source_sync_mode.value == SyncMode.incremental.value or destination_sync_mode.value in [\n+                # DestinationSyncMode.upsert_dedup.value,\n+                DestinationSyncMode.append_dedup.value,\n+            ]:\n+                cursor_field = get_field(configured_stream, \"cursor_field\", f\"Undefined cursor field for stream {stream_name}\")\n+            if destination_sync_mode.value in [\n+                # DestinationSyncMode.upsert_dedup.value,\n+                DestinationSyncMode.append_dedup.value\n+            ]:\n+                primary_key = get_field(configured_stream, \"primary_key\", f\"Undefined primary key for stream {stream_name}\")\n+\n             message = f\"'json_schema'.'properties' are not defined for stream {stream_name}\"\n             properties = get_field(get_field(stream_config, \"json_schema\", message), \"properties\", message)\n \n@@ -124,6 +140,10 @@ def build_stream_processor(\n                 destination_type=destination_type,\n                 raw_schema=raw_schema_name,\n                 schema=schema_name,\n+                source_sync_mode=source_sync_mode,\n+                destination_sync_mode=destination_sync_mode,\n+                cursor_field=cursor_field,\n+                primary_key=primary_key,\n                 json_column_name=f\"'{json_column_name}'\",\n                 properties=properties,\n                 tables_registry=tables_registry,\n@@ -201,6 +221,40 @@ def get_field(config: Dict, key: str, message: str):\n         raise KeyError(message)\n \n \n+def get_source_sync_mode(stream_config: Dict, stream_name: str) -> SyncMode:\n+    \"\"\"\n+    Read the source sync_mode field from config or return a default value if not found\n+    \"\"\"\n+    if \"sync_mode\" in stream_config:\n+        sync_mode = get_field(stream_config, \"sync_mode\", \"\")\n+    else:\n+        sync_mode = \"\"\n+    try:\n+        result = SyncMode(sync_mode)\n+    except ValueError as e:\n+        # Fallback to default source sync mode value\n+        result = SyncMode.full_refresh\n+        print(f\"WARN: Source sync mode falling back to {result} for {stream_name}: {e}\")\n+    return result\n+\n+\n+def get_destination_sync_mode(stream_config: Dict, stream_name: str) -> DestinationSyncMode:\n+    \"\"\"\n+    Read the destination_sync_mode field from config or return a default value if not found\n+    \"\"\"\n+    if \"destination_sync_mode\" in stream_config:\n+        dest_sync_mode = get_field(stream_config, \"destination_sync_mode\", \"\")\n+    else:\n+        dest_sync_mode = \"\"\n+    try:\n+        result = DestinationSyncMode(dest_sync_mode)\n+    except ValueError as e:\n+        # Fallback to default destination sync mode value\n+        result = DestinationSyncMode.append\n+        print(f\"WARN: Destination sync mode falling back to {result} for {stream_name}: {e}\")\n+    return result\n+\n+\n def add_table_to_sources(schema_to_source_tables: Dict[str, Set[str]], schema_name: str, table_name: str):\n     \"\"\"\n     Keeps track of source tables used in this catalog to build a source.yaml file for DBT"
  },
  {
    "sha": "d53ae53caddf25c380e2f740161ec4ecb0f174a8",
    "filename": "airbyte-integrations/bases/base-normalization/normalization/transform_catalog/stream_processor.py",
    "status": "modified",
    "additions": 143,
    "deletions": 9,
    "changes": 152,
    "blob_url": "https://github.com/marcosmarxm/airbyte/blob/2a207174757ef99943b50a52f665158cdd6f5d53/airbyte-integrations/bases/base-normalization/normalization/transform_catalog/stream_processor.py",
    "raw_url": "https://github.com/marcosmarxm/airbyte/raw/2a207174757ef99943b50a52f665158cdd6f5d53/airbyte-integrations/bases/base-normalization/normalization/transform_catalog/stream_processor.py",
    "contents_url": "https://api.github.com/repos/marcosmarxm/airbyte/contents/airbyte-integrations/bases/base-normalization/normalization/transform_catalog/stream_processor.py?ref=2a207174757ef99943b50a52f665158cdd6f5d53",
    "patch": "@@ -26,6 +26,7 @@\n import os\n from typing import Dict, List, Optional, Set, Tuple\n \n+from airbyte_protocol.models.airbyte_protocol import DestinationSyncMode, SyncMode\n from jinja2 import Template\n from normalization.destination_type import DestinationType\n from normalization.transform_catalog.destination_name_transformer import DestinationNameTransformer\n@@ -73,6 +74,10 @@ def __init__(\n         destination_type: DestinationType,\n         raw_schema: str,\n         schema: str,\n+        source_sync_mode: SyncMode,\n+        destination_sync_mode: DestinationSyncMode,\n+        cursor_field: List[str],\n+        primary_key: List[List[str]],\n         json_column_name: str,\n         properties: Dict,\n         tables_registry: Set[str],\n@@ -85,6 +90,10 @@ def __init__(\n         self.destination_type: DestinationType = destination_type\n         self.raw_schema: str = raw_schema\n         self.schema: str = schema\n+        self.source_sync_mode: SyncMode = source_sync_mode\n+        self.destination_sync_mode: DestinationSyncMode = destination_sync_mode\n+        self.cursor_field: List[str] = cursor_field\n+        self.primary_key: List[List[str]] = primary_key\n         self.json_column_name: str = json_column_name\n         self.properties: Dict = properties\n         self.tables_registry: Set[str] = tables_registry\n@@ -119,6 +128,11 @@ def create_from_parent(\n             destination_type=parent.destination_type,\n             raw_schema=parent.raw_schema,\n             schema=parent.schema,\n+            # Nested Streams don't inherit parents sync modes?\n+            source_sync_mode=SyncMode.full_refresh,\n+            destination_sync_mode=DestinationSyncMode.append,\n+            cursor_field=[],\n+            primary_key=[],\n             json_column_name=json_column_name,\n             properties=properties,\n             tables_registry=parent.tables_registry,\n@@ -135,6 +149,10 @@ def create(\n         destination_type: DestinationType,\n         raw_schema: str,\n         schema: str,\n+        source_sync_mode: SyncMode,\n+        destination_sync_mode: DestinationSyncMode,\n+        cursor_field: List[str],\n+        primary_key: List[List[str]],\n         json_column_name: str,\n         properties: Dict,\n         tables_registry: Set[str],\n@@ -147,6 +165,11 @@ def create(\n         @param raw_schema is the name of the staging intermediate schema where to create internal tables/views\n         @param schema is the name of the schema where to store the final tables where to store the transformed data\n \n+        @param source_sync_mode is describing how source are producing data\n+        @param destination_sync_mode is describing how destination should handle the new data batch\n+        @param cursor_field is the field to use to determine order of records\n+        @param primary_key is a list of fields to use as a (composite) primary key\n+\n         @param json_column_name is the name of the column in the raw data table containing the json column to transform\n         @param properties is the json schema description of this stream\n \n@@ -158,6 +181,10 @@ def create(\n             destination_type,\n             raw_schema,\n             schema,\n+            source_sync_mode,\n+            destination_sync_mode,\n+            cursor_field,\n+            primary_key,\n             json_column_name,\n             properties,\n             tables_registry,\n@@ -181,7 +208,17 @@ def process(self) -> List[\"StreamProcessor\"]:\n         from_table = self.add_to_outputs(self.generate_json_parsing_model(from_table, column_names), is_intermediate=True, suffix=\"ab1\")\n         from_table = self.add_to_outputs(self.generate_column_typing_model(from_table, column_names), is_intermediate=True, suffix=\"ab2\")\n         from_table = self.add_to_outputs(self.generate_id_hashing_model(from_table, column_names), is_intermediate=True, suffix=\"ab3\")\n-        from_table = self.add_to_outputs(self.generate_final_model(from_table, column_names), is_intermediate=False)\n+        if self.destination_sync_mode.value == DestinationSyncMode.append_dedup.value:\n+            from_table = self.add_to_outputs(self.generate_dedup_record_model(from_table, column_names), is_intermediate=True, suffix=\"ab4\")\n+            where_clause = \"\\nwhere _airbyte_row_num = 1\"\n+            from_table = self.add_to_outputs(\n+                self.generate_scd_type_2_model(from_table, column_names) + where_clause, is_intermediate=False, suffix=\"scd\"\n+            )\n+            where_clause = \"\\nwhere _airbyte_active_row = True\"\n+            from_table = self.add_to_outputs(self.generate_final_model(from_table, column_names) + where_clause, is_intermediate=False)\n+            # TODO generate yaml file to dbt test final table where primary keys should be unique\n+        else:\n+            from_table = self.add_to_outputs(self.generate_final_model(from_table, column_names), is_intermediate=False)\n         return self.find_children_streams(from_table, column_names)\n \n     def extract_column_names(self) -> Dict[str, Tuple[str, str]]:\n@@ -192,7 +229,15 @@ def extract_column_names(self) -> Dict[str, Tuple[str, str]]:\n          - the first value is the normalized \"raw\" column name\n          - the second value is the normalized quoted column name to be used in jinja context\n         \"\"\"\n-        fields = [field for field in self.properties.keys() if not is_airbyte_column(field)]\n+        fields = []\n+        for field in self.properties.keys():\n+            if not is_airbyte_column(field):\n+                fields.append(field)\n+            if self.destination_sync_mode.value == DestinationSyncMode.append_dedup.value:\n+                # When deduping, some airbyte columns could be used as special cursor or primary key columns\n+                if field in self.cursor_field[0] or field in [f[0] for f in self.primary_key if len(f) == 1]:\n+                    if field not in fields:\n+                        fields.append(field)\n         result = {}\n         field_names = set()\n         for field in fields:\n@@ -227,7 +272,6 @@ def find_children_streams(self, from_table: str, column_names: Dict[str, Tuple[s\n                 # properties without 'type' field are treated like properties with 'type' = 'object'\n                 children_properties = find_properties_object([], field, properties[field])\n                 is_nested_array = False\n-                # json_column_name = f\"'{field}'\"\n                 json_column_name = column_names[field][1]\n             elif is_array(properties[field][\"type\"]) and \"items\" in properties[field]:\n                 quoted_field = column_names[field][1]\n@@ -250,6 +294,7 @@ def find_children_streams(self, from_table: str, column_names: Dict[str, Tuple[s\n     def generate_json_parsing_model(self, from_table: str, column_names: Dict[str, Tuple[str, str]]) -> str:\n         template = Template(\n             \"\"\"\n+-- SQL model to parse JSON blob stored in a single column and extract into separated field columns as described by the JSON Schema\n {{ unnesting_before_query }}\n select\n   {%- if parent_hash_id %}\n@@ -296,6 +341,7 @@ def extract_json_column(property_name: str, json_column_name: str, definition: D\n     def generate_column_typing_model(self, from_table: str, column_names: Dict[str, Tuple[str, str]]) -> str:\n         template = Template(\n             \"\"\"\n+-- SQL model to cast each column to its adequate SQL type converted from the JSON schema type\n select\n   {%- if parent_hash_id %}\n     {{ parent_hash_id }},\n@@ -328,13 +374,14 @@ def cast_property_type(self, property_name: str, column_name: str, jinja_column:\n             return self.cast_property_type_as_array(property_name, column_name)\n         elif is_object(definition[\"type\"]):\n             sql_type = self.cast_property_type_as_object(property_name, column_name)\n-        elif is_integer(definition[\"type\"]):\n-            sql_type = jinja_call(\"dbt_utils.type_int()\")\n-        elif is_number(definition[\"type\"]):\n-            sql_type = jinja_call(\"dbt_utils.type_float()\")\n+        # Treat simple types from narrower to wider scope type: boolean < integer < number < string\n         elif is_boolean(definition[\"type\"]):\n             cast_operation = jinja_call(f\"cast_to_boolean({jinja_column})\")\n             return f\"{cast_operation} as {column_name}\"\n+        elif is_integer(definition[\"type\"]):\n+            sql_type = jinja_call(\"dbt_utils.type_bigint()\")\n+        elif is_number(definition[\"type\"]):\n+            sql_type = jinja_call(\"dbt_utils.type_float()\")\n         elif is_string(definition[\"type\"]):\n             sql_type = jinja_call(\"dbt_utils.type_string()\")\n         else:\n@@ -357,6 +404,7 @@ def cast_property_type_as_object(self, property_name: str, column_name: str) ->\n     def generate_id_hashing_model(self, from_table: str, column_names: Dict[str, Tuple[str, str]]) -> str:\n         template = Template(\n             \"\"\"\n+-- SQL model to build a hash column based on the values of this record\n select\n     *,\n     {{ '{{' }} dbt_utils.surrogate_key([\n@@ -394,9 +442,92 @@ def safe_cast_to_string(property_name: str, definition: Dict, column_name: str)\n         else:\n             return column_name\n \n+    def generate_dedup_record_model(self, from_table: str, column_names: Dict[str, Tuple[str, str]]) -> str:\n+        template = Template(\n+            \"\"\"\n+-- SQL model to prepare for deduplicating records based on the hash record column\n+select\n+  *,\n+  row_number() over (\n+    partition by {{ hash_id }}\n+    order by _airbyte_emitted_at asc\n+  ) as _airbyte_row_num\n+from {{ from_table }}\n+{{ sql_table_comment }}\n+        \"\"\"\n+        )\n+        sql = template.render(\n+            hash_id=self.hash_id(),\n+            from_table=jinja_call(from_table),\n+            sql_table_comment=self.sql_table_comment(include_from_table=True),\n+        )\n+        return sql\n+\n+    def generate_scd_type_2_model(self, from_table: str, column_names: Dict[str, Tuple[str, str]]) -> str:\n+        template = Template(\n+            \"\"\"\n+-- SQL model to build a Type 2 Slowly Changing Dimension (SCD) table for each record identified by their primary key\n+select\n+  {%- if parent_hash_id %}\n+    {{ parent_hash_id }},\n+  {%- endif %}\n+  {%- for field in fields %}\n+    {{ field }},\n+  {%- endfor %}\n+    {{ cursor_field }} as _airbyte_start_at,\n+    lag({{ cursor_field }}) over (\n+        partition by {{ primary_key }}\n+        order by {{ cursor_field }} desc, _airbyte_emitted_at desc\n+    ) as _airbyte_end_at,\n+    lag({{ cursor_field }}) over (\n+        partition by {{ primary_key }}\n+        order by {{ cursor_field }} desc, _airbyte_emitted_at desc\n+    ) is null as _airbyte_active_row,\n+    _airbyte_emitted_at,\n+    {{ hash_id }}\n+from {{ from_table }}\n+{{ sql_table_comment }}\n+        \"\"\"\n+        )\n+        sql = template.render(\n+            parent_hash_id=self.parent_hash_id(),\n+            fields=self.list_fields(column_names),\n+            cursor_field=self.get_cursor_field(column_names),\n+            primary_key=self.get_primary_key(column_names),\n+            hash_id=self.hash_id(),\n+            from_table=jinja_call(from_table),\n+            sql_table_comment=self.sql_table_comment(include_from_table=True),\n+        )\n+        return sql\n+\n+    def get_cursor_field(self, column_names: Dict[str, Tuple[str, str]]) -> str:\n+        if self.cursor_field and len(self.cursor_field) == 1:\n+            return column_names[self.cursor_field[0]][0]\n+        else:\n+            if self.cursor_field:\n+                raise ValueError(f\"Unsupported nested cursor field {'.'.join(self.cursor_field)} for stream {self.stream_name}\")\n+            else:\n+                raise ValueError(f\"No cursor field specified for stream {self.stream_name}\")\n+\n+    def get_primary_key(self, column_names: Dict[str, Tuple[str, str]]) -> str:\n+        if self.primary_key and len(self.primary_key) > 0:\n+            return \", \".join([self.get_primary_key_from_path(column_names, path) for path in self.primary_key])\n+        else:\n+            raise ValueError(f\"No primary key specified for stream {self.stream_name}\")\n+\n+    def get_primary_key_from_path(self, column_names: Dict[str, Tuple[str, str]], path: List[str]) -> str:\n+        if path and len(path) == 1:\n+            return column_names[path[0]][0]\n+        else:\n+            if path:\n+                raise ValueError(f\"Unsupported nested path {'.'.join(path)} for stream {self.stream_name}\")\n+            else:\n+                raise ValueError(f\"No path specified for stream {self.stream_name}\")\n+\n     def generate_final_model(self, from_table: str, column_names: Dict[str, Tuple[str, str]]) -> str:\n         template = Template(\n             \"\"\"\n+-- Final base SQL model\n select\n   {%- if parent_hash_id %}\n     {{ parent_hash_id }},\n@@ -460,17 +591,20 @@ def generate_new_table_name(self, is_intermediate: bool, suffix: str) -> str:\n         tables_registry = self.tables_registry.union(self.local_registry)\n         new_table_name = self.normalized_stream_name()\n         if not is_intermediate and self.parent is None:\n+            if suffix:\n+                norm_suffix = suffix if not suffix or suffix.startswith(\"_\") else f\"_{suffix}\"\n+                new_table_name = new_table_name + norm_suffix\n             # Top-level stream has priority on table_names\n             if new_table_name in tables_registry:\n                 # TODO handle collisions between different schemas (dbt works with only one schema for ref()?)\n                 # so filenames should always be different for dbt but the final table can be same as long as schemas are different:\n                 # see alias in dbt: https://docs.getdbt.com/docs/building-a-dbt-project/building-models/using-custom-aliases/\n-                pass\n-            pass\n+                raise ValueError(f\"Conflict: Table name {new_table_name} already exists!\")\n         elif not self.parent:\n             new_table_name = get_table_name(self.name_transformer, \"\", new_table_name, suffix, self.json_path)\n         else:\n             new_table_name = get_table_name(self.name_transformer, \"_\".join(self.json_path[:-1]), new_table_name, suffix, self.json_path)\n+        new_table_name = self.name_transformer.normalize_table_name(new_table_name, False, False)\n         if not is_intermediate:\n             self.final_table_name = new_table_name\n         return new_table_name"
  },
  {
    "sha": "e71537346ae3605ece29b5873a07ba2b477d5b83",
    "filename": "airbyte-integrations/bases/base-normalization/normalization/transform_catalog/utils.py",
    "status": "modified",
    "additions": 13,
    "deletions": 4,
    "changes": 17,
    "blob_url": "https://github.com/marcosmarxm/airbyte/blob/2a207174757ef99943b50a52f665158cdd6f5d53/airbyte-integrations/bases/base-normalization/normalization/transform_catalog/utils.py",
    "raw_url": "https://github.com/marcosmarxm/airbyte/raw/2a207174757ef99943b50a52f665158cdd6f5d53/airbyte-integrations/bases/base-normalization/normalization/transform_catalog/utils.py",
    "contents_url": "https://api.github.com/repos/marcosmarxm/airbyte/contents/airbyte-integrations/bases/base-normalization/normalization/transform_catalog/utils.py?ref=2a207174757ef99943b50a52f665158cdd6f5d53",
    "patch": "@@ -33,15 +33,24 @@ def is_string(property_type) -> bool:\n     return property_type == \"string\" or \"string\" in property_type\n \n \n-def is_integer(property_type) -> bool:\n-    return property_type == \"integer\" or \"integer\" in property_type\n-\n-\n def is_number(property_type) -> bool:\n+    if is_string(property_type):\n+        # Handle union type, give priority to wider scope types\n+        return False\n     return property_type == \"number\" or \"number\" in property_type\n \n \n+def is_integer(property_type) -> bool:\n+    if is_string(property_type) or is_number(property_type):\n+        # Handle union type, give priority to wider scope types\n+        return False\n+    return property_type == \"integer\" or \"integer\" in property_type\n+\n+\n def is_boolean(property_type) -> bool:\n+    if is_string(property_type) or is_number(property_type) or is_integer(property_type):\n+        # Handle union type, give priority to wider scope types\n+        return False\n     return property_type == \"boolean\" or \"boolean\" in property_type\n \n "
  },
  {
    "sha": "f21c3d3811384e9357755240aef347bef8a18063",
    "filename": "airbyte-integrations/bases/base-normalization/unit_tests/resources/facebook_catalog.json",
    "status": "modified",
    "additions": 3,
    "deletions": 1,
    "changes": 4,
    "blob_url": "https://github.com/marcosmarxm/airbyte/blob/2a207174757ef99943b50a52f665158cdd6f5d53/airbyte-integrations/bases/base-normalization/unit_tests/resources/facebook_catalog.json",
    "raw_url": "https://github.com/marcosmarxm/airbyte/raw/2a207174757ef99943b50a52f665158cdd6f5d53/airbyte-integrations/bases/base-normalization/unit_tests/resources/facebook_catalog.json",
    "contents_url": "https://api.github.com/repos/marcosmarxm/airbyte/contents/airbyte-integrations/bases/base-normalization/unit_tests/resources/facebook_catalog.json?ref=2a207174757ef99943b50a52f665158cdd6f5d53",
    "patch": "@@ -2647,7 +2647,9 @@\n         \"default_cursor_field\": []\n       },\n       \"sync_mode\": \"incremental\",\n-      \"cursor_field\": []\n+      \"cursor_field\": [\"updated_time\"],\n+      \"destination_sync_mode\": \"append_dedup\",\n+      \"primary_key\": [[\"id\"]]\n     },\n     {\n       \"stream\": {"
  },
  {
    "sha": "039cc287776b2b381bd9c75d64f12b186b854456",
    "filename": "airbyte-integrations/bases/base-normalization/unit_tests/resources/facebook_catalog_expected_nested_snowflake.json",
    "status": "modified",
    "additions": 1052,
    "deletions": 1064,
    "changes": 2116,
    "blob_url": "https://github.com/marcosmarxm/airbyte/blob/2a207174757ef99943b50a52f665158cdd6f5d53/airbyte-integrations/bases/base-normalization/unit_tests/resources/facebook_catalog_expected_nested_snowflake.json",
    "raw_url": "https://github.com/marcosmarxm/airbyte/raw/2a207174757ef99943b50a52f665158cdd6f5d53/airbyte-integrations/bases/base-normalization/unit_tests/resources/facebook_catalog_expected_nested_snowflake.json",
    "contents_url": "https://api.github.com/repos/marcosmarxm/airbyte/contents/airbyte-integrations/bases/base-normalization/unit_tests/resources/facebook_catalog_expected_nested_snowflake.json?ref=2a207174757ef99943b50a52f665158cdd6f5d53"
  },
  {
    "sha": "939f3a18b8d3a828896b9e14acaaf645ab004840",
    "filename": "airbyte-integrations/bases/base-normalization/unit_tests/resources/facebook_catalog_expected_top_level.json",
    "status": "modified",
    "additions": 2,
    "deletions": 0,
    "changes": 2,
    "blob_url": "https://github.com/marcosmarxm/airbyte/blob/2a207174757ef99943b50a52f665158cdd6f5d53/airbyte-integrations/bases/base-normalization/unit_tests/resources/facebook_catalog_expected_top_level.json",
    "raw_url": "https://github.com/marcosmarxm/airbyte/raw/2a207174757ef99943b50a52f665158cdd6f5d53/airbyte-integrations/bases/base-normalization/unit_tests/resources/facebook_catalog_expected_top_level.json",
    "contents_url": "https://api.github.com/repos/marcosmarxm/airbyte/contents/airbyte-integrations/bases/base-normalization/unit_tests/resources/facebook_catalog_expected_top_level.json?ref=2a207174757ef99943b50a52f665158cdd6f5d53",
    "patch": "@@ -8,6 +8,8 @@\n     \"ads_ab1\",\n     \"ads_ab2\",\n     \"ads_ab3\",\n+    \"ads_ab4\",\n+    \"ads_scd\",\n     \"adsets\",\n     \"adsets_ab1\",\n     \"adsets_ab2\","
  },
  {
    "sha": "09d63cfc505d811325466236c874a1a57500722e",
    "filename": "airbyte-integrations/bases/base-normalization/unit_tests/resources/hubspot_catalog_expected_nested_snowflake.json",
    "status": "modified",
    "additions": 3964,
    "deletions": 4003,
    "changes": 7967,
    "blob_url": "https://github.com/marcosmarxm/airbyte/blob/2a207174757ef99943b50a52f665158cdd6f5d53/airbyte-integrations/bases/base-normalization/unit_tests/resources/hubspot_catalog_expected_nested_snowflake.json",
    "raw_url": "https://github.com/marcosmarxm/airbyte/raw/2a207174757ef99943b50a52f665158cdd6f5d53/airbyte-integrations/bases/base-normalization/unit_tests/resources/hubspot_catalog_expected_nested_snowflake.json",
    "contents_url": "https://api.github.com/repos/marcosmarxm/airbyte/contents/airbyte-integrations/bases/base-normalization/unit_tests/resources/hubspot_catalog_expected_nested_snowflake.json?ref=2a207174757ef99943b50a52f665158cdd6f5d53"
  },
  {
    "sha": "2d46776f3a2d1d36827e8ce59c0a8cc5d2782b40",
    "filename": "airbyte-integrations/bases/base-normalization/unit_tests/resources/stripe_catalog.json",
    "status": "modified",
    "additions": 3,
    "deletions": 1,
    "changes": 4,
    "blob_url": "https://github.com/marcosmarxm/airbyte/blob/2a207174757ef99943b50a52f665158cdd6f5d53/airbyte-integrations/bases/base-normalization/unit_tests/resources/stripe_catalog.json",
    "raw_url": "https://github.com/marcosmarxm/airbyte/raw/2a207174757ef99943b50a52f665158cdd6f5d53/airbyte-integrations/bases/base-normalization/unit_tests/resources/stripe_catalog.json",
    "contents_url": "https://api.github.com/repos/marcosmarxm/airbyte/contents/airbyte-integrations/bases/base-normalization/unit_tests/resources/stripe_catalog.json?ref=2a207174757ef99943b50a52f665158cdd6f5d53",
    "patch": "@@ -511,7 +511,9 @@\n         \"default_cursor_field\": [\"created\"]\n       },\n       \"sync_mode\": \"incremental\",\n-      \"cursor_field\": [\"created\"]\n+      \"cursor_field\": [\"created\"],\n+      \"destination_sync_mode\": \"append_dedup\",\n+      \"primary_key\": [[\"id\"]]\n     },\n     {\n       \"stream\": {"
  },
  {
    "sha": "1b6bab020673ef2b45cbfe51b1144b22dad8fe97",
    "filename": "airbyte-integrations/bases/base-normalization/unit_tests/resources/stripe_catalog_expected_nested_snowflake.json",
    "status": "modified",
    "additions": 228,
    "deletions": 276,
    "changes": 504,
    "blob_url": "https://github.com/marcosmarxm/airbyte/blob/2a207174757ef99943b50a52f665158cdd6f5d53/airbyte-integrations/bases/base-normalization/unit_tests/resources/stripe_catalog_expected_nested_snowflake.json",
    "raw_url": "https://github.com/marcosmarxm/airbyte/raw/2a207174757ef99943b50a52f665158cdd6f5d53/airbyte-integrations/bases/base-normalization/unit_tests/resources/stripe_catalog_expected_nested_snowflake.json",
    "contents_url": "https://api.github.com/repos/marcosmarxm/airbyte/contents/airbyte-integrations/bases/base-normalization/unit_tests/resources/stripe_catalog_expected_nested_snowflake.json?ref=2a207174757ef99943b50a52f665158cdd6f5d53",
    "patch": "@@ -1,296 +1,248 @@\n {\n   \"tables\": [\n-    \"BALANCE_TRANSACTIONS_ab1\",\n-    \"BALANCE_TRANSACTIONS_ab2\",\n-    \"BALANCE_TRANSACTIONS_ab3\",\n-    \"BALANCE_TRANSACTIONS_caa_FEE_DETAILS\",\n-    \"BALANCE_TRANSACTIONS_caa_FEE_DETAILS_ab1\",\n-    \"BALANCE_TRANSACTIONS_caa_FEE_DETAILS_ab2\",\n-    \"BALANCE_TRANSACTIONS_caa_FEE_DETAILS_ab3\",\n-    \"CHARGES_0b2_CARD\",\n-    \"CHARGES_0b2_CARD_ab1\",\n-    \"CHARGES_0b2_CARD_ab2\",\n-    \"CHARGES_0b2_CARD_ab3\",\n-    \"CHARGES_10c_OUTCOME\",\n-    \"CHARGES_10c_OUTCOME_ab1\",\n-    \"CHARGES_10c_OUTCOME_ab2\",\n-    \"CHARGES_10c_OUTCOME_ab3\",\n-    \"CHARGES_3a5_SOURCE\",\n-    \"CHARGES_3a5_SOURCE_ab1\",\n-    \"CHARGES_3a5_SOURCE_ab2\",\n-    \"CHARGES_3a5_SOURCE_ab3\",\n+    \"BALANCE_TRANSACTIONS_CAA_FEE_DETAILS\",\n+    \"BALANCE_TRANSACTIONS_CAA_FEE_DETAILS_AB1\",\n+    \"BALANCE_TRANSACTIONS_CAA_FEE_DETAILS_AB2\",\n+    \"BALANCE_TRANSACTIONS_CAA_FEE_DETAILS_AB3\",\n+    \"CHARGES_0B2_CARD\",\n+    \"CHARGES_0B2_CARD_AB1\",\n+    \"CHARGES_0B2_CARD_AB2\",\n+    \"CHARGES_0B2_CARD_AB3\",\n+    \"CHARGES_10C_OUTCOME\",\n+    \"CHARGES_10C_OUTCOME_AB1\",\n+    \"CHARGES_10C_OUTCOME_AB2\",\n+    \"CHARGES_10C_OUTCOME_AB3\",\n+    \"CHARGES_3A5_SOURCE\",\n+    \"CHARGES_3A5_SOURCE_AB1\",\n+    \"CHARGES_3A5_SOURCE_AB2\",\n+    \"CHARGES_3A5_SOURCE_AB3\",\n     \"CHARGES_542_PAYMENT_METHOD_DETAILS\",\n-    \"CHARGES_542_PAYMENT_METHOD_DETAILS_ab1\",\n-    \"CHARGES_542_PAYMENT_METHOD_DETAILS_ab2\",\n-    \"CHARGES_542_PAYMENT_METHOD_DETAILS_ab3\",\n+    \"CHARGES_542_PAYMENT_METHOD_DETAILS_AB1\",\n+    \"CHARGES_542_PAYMENT_METHOD_DETAILS_AB2\",\n+    \"CHARGES_542_PAYMENT_METHOD_DETAILS_AB3\",\n+    \"CHARGES_BF0_FRAUD_DETAILS\",\n+    \"CHARGES_BF0_FRAUD_DETAILS_AB1\",\n+    \"CHARGES_BF0_FRAUD_DETAILS_AB2\",\n+    \"CHARGES_BF0_FRAUD_DETAILS_AB3\",\n     \"CHARGES_PAYMENT_METHOD_DETAILS_398_BANCONTACT\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_398_BANCONTACT_ab1\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_398_BANCONTACT_ab2\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_398_BANCONTACT_ab3\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_71a_ACH_DEBIT\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_71a_ACH_DEBIT_ab1\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_71a_ACH_DEBIT_ab2\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_71a_ACH_DEBIT_ab3\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_7da_ACH_CREDIT_TRANSFER\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_7da_ACH_CREDIT_TRANSFER_ab1\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_7da_ACH_CREDIT_TRANSFER_ab2\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_7da_ACH_CREDIT_TRANSFER_ab3\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_398_BANCONTACT_AB1\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_398_BANCONTACT_AB2\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_398_BANCONTACT_AB3\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_71A_ACH_DEBIT\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_71A_ACH_DEBIT_AB1\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_71A_ACH_DEBIT_AB2\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_71A_ACH_DEBIT_AB3\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_7DA_ACH_CREDIT_TRANSFER\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_7DA_ACH_CREDIT_TRANSFER_AB1\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_7DA_ACH_CREDIT_TRANSFER_AB2\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_7DA_ACH_CREDIT_TRANSFER_AB3\",\n     \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_155_CHECKS\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_155_CHECKS_ab1\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_155_CHECKS_ab2\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_155_CHECKS_ab3\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_155_CHECKS_AB1\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_155_CHECKS_AB2\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_155_CHECKS_AB3\",\n     \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_173_SEPA_DEBIT\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_173_SEPA_DEBIT_ab1\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_173_SEPA_DEBIT_ab2\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_173_SEPA_DEBIT_ab3\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_2d9_MULTIBANCO\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_2d9_MULTIBANCO_ab1\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_2d9_MULTIBANCO_ab2\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_2d9_MULTIBANCO_ab3\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_173_SEPA_DEBIT_AB1\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_173_SEPA_DEBIT_AB2\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_173_SEPA_DEBIT_AB3\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_2D9_MULTIBANCO\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_2D9_MULTIBANCO_AB1\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_2D9_MULTIBANCO_AB2\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_2D9_MULTIBANCO_AB3\",\n     \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_308_INSTALLMENTS\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_308_INSTALLMENTS_ab1\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_308_INSTALLMENTS_ab2\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_308_INSTALLMENTS_ab3\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_308_INSTALLMENTS_AB1\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_308_INSTALLMENTS_AB2\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_308_INSTALLMENTS_AB3\",\n     \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_330_THREE_D_SECURE\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_330_THREE_D_SECURE_ab1\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_330_THREE_D_SECURE_ab2\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_330_THREE_D_SECURE_ab3\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_330_THREE_D_SECURE_AB1\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_330_THREE_D_SECURE_AB2\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_330_THREE_D_SECURE_AB3\",\n     \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_436_IDEAL\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_436_IDEAL_ab1\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_436_IDEAL_ab2\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_436_IDEAL_ab3\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_436_IDEAL_AB1\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_436_IDEAL_AB2\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_436_IDEAL_AB3\",\n     \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_617_P24\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_617_P24_ab1\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_617_P24_ab2\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_617_P24_ab3\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_617_P24_AB1\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_617_P24_AB2\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_617_P24_AB3\",\n     \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_956_WALLET\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_956_WALLET_ab1\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_956_WALLET_ab2\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_956_WALLET_ab3\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_CARD_PRESENT_b08_RECEIPT\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_CARD_PRESENT_b08_RECEIPT_ab1\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_CARD_PRESENT_b08_RECEIPT_ab2\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_CARD_PRESENT_b08_RECEIPT_ab3\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_INSTALLMENTS_b12_PLAN\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_INSTALLMENTS_b12_PLAN_ab1\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_INSTALLMENTS_b12_PLAN_ab2\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_INSTALLMENTS_b12_PLAN_ab3\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_956_WALLET_AB1\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_956_WALLET_AB2\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_956_WALLET_AB3\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_B34_EPS\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_B34_EPS_AB1\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_B34_EPS_AB2\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_B34_EPS_AB3\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_C88_CARD_PRESENT\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_C88_CARD_PRESENT_AB1\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_C88_CARD_PRESENT_AB2\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_C88_CARD_PRESENT_AB3\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_CARD_PRESENT_B08_RECEIPT\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_CARD_PRESENT_B08_RECEIPT_AB1\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_CARD_PRESENT_B08_RECEIPT_AB2\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_CARD_PRESENT_B08_RECEIPT_AB3\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_EA6_SOFORT\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_EA6_SOFORT_AB1\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_EA6_SOFORT_AB2\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_EA6_SOFORT_AB3\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_F64_GIROPAY\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_F64_GIROPAY_AB1\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_F64_GIROPAY_AB2\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_F64_GIROPAY_AB3\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_INSTALLMENTS_B12_PLAN\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_INSTALLMENTS_B12_PLAN_AB1\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_INSTALLMENTS_B12_PLAN_AB2\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_INSTALLMENTS_B12_PLAN_AB3\",\n     \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_WALLET_435_MASTERPASS\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_WALLET_435_MASTERPASS_ab1\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_WALLET_435_MASTERPASS_ab2\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_WALLET_435_MASTERPASS_ab3\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_WALLET_MASTERPASS_4e4_BILLING_ADDRESS\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_WALLET_MASTERPASS_4e4_BILLING_ADDRESS_ab1\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_WALLET_MASTERPASS_4e4_BILLING_ADDRESS_ab2\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_WALLET_MASTERPASS_4e4_BILLING_ADDRESS_ab3\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_WALLET_MASTERPASS_7d5_SHIPPING_ADDRESS\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_WALLET_MASTERPASS_7d5_SHIPPING_ADDRESS_ab1\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_WALLET_MASTERPASS_7d5_SHIPPING_ADDRESS_ab2\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_WALLET_MASTERPASS_7d5_SHIPPING_ADDRESS_ab3\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_WALLET_VISA_CHECKOUT_cac_SHIPPING_ADDRESS\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_WALLET_VISA_CHECKOUT_cac_SHIPPING_ADDRESS_ab1\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_WALLET_VISA_CHECKOUT_cac_SHIPPING_ADDRESS_ab2\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_WALLET_VISA_CHECKOUT_cac_SHIPPING_ADDRESS_ab3\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_WALLET_VISA_CHECKOUT_ed0_BILLING_ADDRESS\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_WALLET_VISA_CHECKOUT_ed0_BILLING_ADDRESS_ab1\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_WALLET_VISA_CHECKOUT_ed0_BILLING_ADDRESS_ab2\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_WALLET_VISA_CHECKOUT_ed0_BILLING_ADDRESS_ab3\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_WALLET_c24_VISA_CHECKOUT\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_WALLET_c24_VISA_CHECKOUT_ab1\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_WALLET_c24_VISA_CHECKOUT_ab2\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_WALLET_c24_VISA_CHECKOUT_ab3\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_b34_EPS\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_b34_EPS_ab1\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_b34_EPS_ab2\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_b34_EPS_ab3\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_c88_CARD_PRESENT\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_c88_CARD_PRESENT_ab1\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_c88_CARD_PRESENT_ab2\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_c88_CARD_PRESENT_ab3\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_ea6_SOFORT\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_ea6_SOFORT_ab1\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_ea6_SOFORT_ab2\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_ea6_SOFORT_ab3\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_f64_GIROPAY\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_f64_GIROPAY_ab1\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_f64_GIROPAY_ab2\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_f64_GIROPAY_ab3\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_da6_CARD\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_da6_CARD_ab1\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_da6_CARD_ab2\",\n-    \"CHARGES_PAYMENT_METHOD_DETAILS_da6_CARD_ab3\",\n-    \"CHARGES_SOURCE_34b_CARD\",\n-    \"CHARGES_SOURCE_34b_CARD_ab1\",\n-    \"CHARGES_SOURCE_34b_CARD_ab2\",\n-    \"CHARGES_SOURCE_34b_CARD_ab3\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_WALLET_435_MASTERPASS_AB1\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_WALLET_435_MASTERPASS_AB2\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_WALLET_435_MASTERPASS_AB3\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_WALLET_C24_VISA_CHECKOUT\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_WALLET_C24_VISA_CHECKOUT_AB1\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_WALLET_C24_VISA_CHECKOUT_AB2\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_WALLET_C24_VISA_CHECKOUT_AB3\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_WALLET_MASTERPASS_4E4_BILLING_ADDRESS\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_WALLET_MASTERPASS_4E4_BILLING_ADDRESS_AB1\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_WALLET_MASTERPASS_4E4_BILLING_ADDRESS_AB2\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_WALLET_MASTERPASS_4E4_BILLING_ADDRESS_AB3\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_WALLET_MASTERPASS_7D5_SHIPPING_ADDRESS\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_WALLET_MASTERPASS_7D5_SHIPPING_ADDRESS_AB1\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_WALLET_MASTERPASS_7D5_SHIPPING_ADDRESS_AB2\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_WALLET_MASTERPASS_7D5_SHIPPING_ADDRESS_AB3\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_WALLET_VISA_CHECKOUT_CAC_SHIPPING_ADDRESS\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_WALLET_VISA_CHECKOUT_CAC_SHIPPING_ADDRESS_AB1\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_WALLET_VISA_CHECKOUT_CAC_SHIPPING_ADDRESS_AB2\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_WALLET_VISA_CHECKOUT_CAC_SHIPPING_ADDRESS_AB3\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_WALLET_VISA_CHECKOUT_ED0_BILLING_ADDRESS\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_WALLET_VISA_CHECKOUT_ED0_BILLING_ADDRESS_AB1\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_WALLET_VISA_CHECKOUT_ED0_BILLING_ADDRESS_AB2\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_CARD_WALLET_VISA_CHECKOUT_ED0_BILLING_ADDRESS_AB3\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_DA6_CARD\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_DA6_CARD_AB1\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_DA6_CARD_AB2\",\n+    \"CHARGES_PAYMENT_METHOD_DETAILS_DA6_CARD_AB3\",\n+    \"CHARGES_SOURCE_34B_CARD\",\n+    \"CHARGES_SOURCE_34B_CARD_AB1\",\n+    \"CHARGES_SOURCE_34B_CARD_AB2\",\n+    \"CHARGES_SOURCE_34B_CARD_AB3\",\n     \"CHARGES_SOURCE_360_REDIRECT\",\n-    \"CHARGES_SOURCE_360_REDIRECT_ab1\",\n-    \"CHARGES_SOURCE_360_REDIRECT_ab2\",\n-    \"CHARGES_SOURCE_360_REDIRECT_ab3\",\n-    \"CHARGES_SOURCE_56c_ACH_CREDIT_TRANSFER\",\n-    \"CHARGES_SOURCE_56c_ACH_CREDIT_TRANSFER_ab1\",\n-    \"CHARGES_SOURCE_56c_ACH_CREDIT_TRANSFER_ab2\",\n-    \"CHARGES_SOURCE_56c_ACH_CREDIT_TRANSFER_ab3\",\n-    \"CHARGES_SOURCE_9d6_RECEIVER\",\n-    \"CHARGES_SOURCE_9d6_RECEIVER_ab1\",\n-    \"CHARGES_SOURCE_9d6_RECEIVER_ab2\",\n-    \"CHARGES_SOURCE_9d6_RECEIVER_ab3\",\n+    \"CHARGES_SOURCE_360_REDIRECT_AB1\",\n+    \"CHARGES_SOURCE_360_REDIRECT_AB2\",\n+    \"CHARGES_SOURCE_360_REDIRECT_AB3\",\n+    \"CHARGES_SOURCE_56C_ACH_CREDIT_TRANSFER\",\n+    \"CHARGES_SOURCE_56C_ACH_CREDIT_TRANSFER_AB1\",\n+    \"CHARGES_SOURCE_56C_ACH_CREDIT_TRANSFER_AB2\",\n+    \"CHARGES_SOURCE_56C_ACH_CREDIT_TRANSFER_AB3\",\n+    \"CHARGES_SOURCE_9D6_RECEIVER\",\n+    \"CHARGES_SOURCE_9D6_RECEIVER_AB1\",\n+    \"CHARGES_SOURCE_9D6_RECEIVER_AB2\",\n+    \"CHARGES_SOURCE_9D6_RECEIVER_AB3\",\n+    \"CHARGES_SOURCE_B24_OWNER\",\n+    \"CHARGES_SOURCE_B24_OWNER_AB1\",\n+    \"CHARGES_SOURCE_B24_OWNER_AB2\",\n+    \"CHARGES_SOURCE_B24_OWNER_AB3\",\n     \"CHARGES_SOURCE_OWNER_755_ADDRESS\",\n-    \"CHARGES_SOURCE_OWNER_755_ADDRESS_ab1\",\n-    \"CHARGES_SOURCE_OWNER_755_ADDRESS_ab2\",\n-    \"CHARGES_SOURCE_OWNER_755_ADDRESS_ab3\",\n-    \"CHARGES_SOURCE_b24_OWNER\",\n-    \"CHARGES_SOURCE_b24_OWNER_ab1\",\n-    \"CHARGES_SOURCE_b24_OWNER_ab2\",\n-    \"CHARGES_SOURCE_b24_OWNER_ab3\",\n-    \"CHARGES_ab1\",\n-    \"CHARGES_ab2\",\n-    \"CHARGES_ab3\",\n-    \"CHARGES_bf0_FRAUD_DETAILS\",\n-    \"CHARGES_bf0_FRAUD_DETAILS_ab1\",\n-    \"CHARGES_bf0_FRAUD_DETAILS_ab2\",\n-    \"CHARGES_bf0_FRAUD_DETAILS_ab3\",\n-    \"COUPONS_ab1\",\n-    \"COUPONS_ab2\",\n-    \"COUPONS_ab3\",\n-    \"CUSTOMERS_4d8_DISCOUNT\",\n-    \"CUSTOMERS_4d8_DISCOUNT_ab1\",\n-    \"CUSTOMERS_4d8_DISCOUNT_ab2\",\n-    \"CUSTOMERS_4d8_DISCOUNT_ab3\",\n-    \"CUSTOMERS_5a2_SHIPPING\",\n-    \"CUSTOMERS_5a2_SHIPPING_ab1\",\n-    \"CUSTOMERS_5a2_SHIPPING_ab2\",\n-    \"CUSTOMERS_5a2_SHIPPING_ab3\",\n-    \"CUSTOMERS_94e_CARDS\",\n-    \"CUSTOMERS_94e_CARDS_ab1\",\n-    \"CUSTOMERS_94e_CARDS_ab2\",\n-    \"CUSTOMERS_94e_CARDS_ab3\",\n-    \"CUSTOMERS_DISCOUNT_9ac_COUPON\",\n-    \"CUSTOMERS_DISCOUNT_9ac_COUPON_ab1\",\n-    \"CUSTOMERS_DISCOUNT_9ac_COUPON_ab2\",\n-    \"CUSTOMERS_DISCOUNT_9ac_COUPON_ab3\",\n-    \"CUSTOMERS_SHIPPING_c70_ADDRESS\",\n-    \"CUSTOMERS_SHIPPING_c70_ADDRESS_ab1\",\n-    \"CUSTOMERS_SHIPPING_c70_ADDRESS_ab2\",\n-    \"CUSTOMERS_SHIPPING_c70_ADDRESS_ab3\",\n-    \"CUSTOMERS_ab1\",\n-    \"CUSTOMERS_ab2\",\n-    \"CUSTOMERS_ab3\",\n+    \"CHARGES_SOURCE_OWNER_755_ADDRESS_AB1\",\n+    \"CHARGES_SOURCE_OWNER_755_ADDRESS_AB2\",\n+    \"CHARGES_SOURCE_OWNER_755_ADDRESS_AB3\",\n+    \"CUSTOMERS_4D8_DISCOUNT\",\n+    \"CUSTOMERS_4D8_DISCOUNT_AB1\",\n+    \"CUSTOMERS_4D8_DISCOUNT_AB2\",\n+    \"CUSTOMERS_4D8_DISCOUNT_AB3\",\n+    \"CUSTOMERS_5A2_SHIPPING\",\n+    \"CUSTOMERS_5A2_SHIPPING_AB1\",\n+    \"CUSTOMERS_5A2_SHIPPING_AB2\",\n+    \"CUSTOMERS_5A2_SHIPPING_AB3\",\n+    \"CUSTOMERS_94E_CARDS\",\n+    \"CUSTOMERS_94E_CARDS_AB1\",\n+    \"CUSTOMERS_94E_CARDS_AB2\",\n+    \"CUSTOMERS_94E_CARDS_AB3\",\n+    \"CUSTOMERS_DISCOUNT_9AC_COUPON\",\n+    \"CUSTOMERS_DISCOUNT_9AC_COUPON_AB1\",\n+    \"CUSTOMERS_DISCOUNT_9AC_COUPON_AB2\",\n+    \"CUSTOMERS_DISCOUNT_9AC_COUPON_AB3\",\n+    \"CUSTOMERS_SHIPPING_C70_ADDRESS\",\n+    \"CUSTOMERS_SHIPPING_C70_ADDRESS_AB1\",\n+    \"CUSTOMERS_SHIPPING_C70_ADDRESS_AB2\",\n+    \"CUSTOMERS_SHIPPING_C70_ADDRESS_AB3\",\n     \"DISPUTES_682_EVIDENCE\",\n-    \"DISPUTES_682_EVIDENCE_ab1\",\n-    \"DISPUTES_682_EVIDENCE_ab2\",\n-    \"DISPUTES_682_EVIDENCE_ab3\",\n-    \"DISPUTES_ab1\",\n-    \"DISPUTES_ab2\",\n-    \"DISPUTES_ab3\",\n-    \"DISPUTES_b7c_EVIDENCE_DETAILS\",\n-    \"DISPUTES_b7c_EVIDENCE_DETAILS_ab1\",\n-    \"DISPUTES_b7c_EVIDENCE_DETAILS_ab2\",\n-    \"DISPUTES_b7c_EVIDENCE_DETAILS_ab3\",\n-    \"DISPUTES_e74_BALANCE_TRANSACTIONS\",\n-    \"DISPUTES_e74_BALANCE_TRANSACTIONS_ab1\",\n-    \"DISPUTES_e74_BALANCE_TRANSACTIONS_ab2\",\n-    \"DISPUTES_e74_BALANCE_TRANSACTIONS_ab3\",\n-    \"EVENTS_ab1\",\n-    \"EVENTS_ab2\",\n-    \"EVENTS_ab3\",\n+    \"DISPUTES_682_EVIDENCE_AB1\",\n+    \"DISPUTES_682_EVIDENCE_AB2\",\n+    \"DISPUTES_682_EVIDENCE_AB3\",\n+    \"DISPUTES_B7C_EVIDENCE_DETAILS\",\n+    \"DISPUTES_B7C_EVIDENCE_DETAILS_AB1\",\n+    \"DISPUTES_B7C_EVIDENCE_DETAILS_AB2\",\n+    \"DISPUTES_B7C_EVIDENCE_DETAILS_AB3\",\n+    \"DISPUTES_E74_BALANCE_TRANSACTIONS\",\n+    \"DISPUTES_E74_BALANCE_TRANSACTIONS_AB1\",\n+    \"DISPUTES_E74_BALANCE_TRANSACTIONS_AB2\",\n+    \"DISPUTES_E74_BALANCE_TRANSACTIONS_AB3\",\n     \"INVOICES_270_DISCOUNT\",\n-    \"INVOICES_270_DISCOUNT_ab1\",\n-    \"INVOICES_270_DISCOUNT_ab2\",\n-    \"INVOICES_270_DISCOUNT_ab3\",\n-    \"INVOICES_DISCOUNT_71c_COUPON\",\n-    \"INVOICES_DISCOUNT_71c_COUPON_ab1\",\n-    \"INVOICES_DISCOUNT_71c_COUPON_ab2\",\n-    \"INVOICES_DISCOUNT_71c_COUPON_ab3\",\n-    \"INVOICES_ab1\",\n-    \"INVOICES_ab2\",\n-    \"INVOICES_ab3\",\n-    \"INVOICE_ITEMS_3ee_PERIOD\",\n-    \"INVOICE_ITEMS_3ee_PERIOD_ab1\",\n-    \"INVOICE_ITEMS_3ee_PERIOD_ab2\",\n-    \"INVOICE_ITEMS_3ee_PERIOD_ab3\",\n+    \"INVOICES_270_DISCOUNT_AB1\",\n+    \"INVOICES_270_DISCOUNT_AB2\",\n+    \"INVOICES_270_DISCOUNT_AB3\",\n+    \"INVOICES_DISCOUNT_71C_COUPON\",\n+    \"INVOICES_DISCOUNT_71C_COUPON_AB1\",\n+    \"INVOICES_DISCOUNT_71C_COUPON_AB2\",\n+    \"INVOICES_DISCOUNT_71C_COUPON_AB3\",\n+    \"INVOICE_ITEMS_3EE_PERIOD\",\n+    \"INVOICE_ITEMS_3EE_PERIOD_AB1\",\n+    \"INVOICE_ITEMS_3EE_PERIOD_AB2\",\n+    \"INVOICE_ITEMS_3EE_PERIOD_AB3\",\n     \"INVOICE_ITEMS_462_PLAN\",\n-    \"INVOICE_ITEMS_462_PLAN_ab1\",\n-    \"INVOICE_ITEMS_462_PLAN_ab2\",\n-    \"INVOICE_ITEMS_462_PLAN_ab3\",\n-    \"INVOICE_ITEMS_PLAN_9f5_TIERS\",\n-    \"INVOICE_ITEMS_PLAN_9f5_TIERS_ab1\",\n-    \"INVOICE_ITEMS_PLAN_9f5_TIERS_ab2\",\n-    \"INVOICE_ITEMS_PLAN_9f5_TIERS_ab3\",\n-    \"INVOICE_ITEMS_ab1\",\n-    \"INVOICE_ITEMS_ab2\",\n-    \"INVOICE_ITEMS_ab3\",\n-    \"INVOICE_LINE_ITEMS_81e_PLAN\",\n-    \"INVOICE_LINE_ITEMS_81e_PLAN_ab1\",\n-    \"INVOICE_LINE_ITEMS_81e_PLAN_ab2\",\n-    \"INVOICE_LINE_ITEMS_81e_PLAN_ab3\",\n-    \"INVOICE_LINE_ITEMS_PLAN_a4c_TIERS\",\n-    \"INVOICE_LINE_ITEMS_PLAN_a4c_TIERS_ab1\",\n-    \"INVOICE_LINE_ITEMS_PLAN_a4c_TIERS_ab2\",\n-    \"INVOICE_LINE_ITEMS_PLAN_a4c_TIERS_ab3\",\n-    \"INVOICE_LINE_ITEMS_ab1\",\n-    \"INVOICE_LINE_ITEMS_ab2\",\n-    \"INVOICE_LINE_ITEMS_ab3\",\n-    \"INVOICE_LINE_ITEMS_abc_PERIOD\",\n-    \"INVOICE_LINE_ITEMS_abc_PERIOD_ab1\",\n-    \"INVOICE_LINE_ITEMS_abc_PERIOD_ab2\",\n-    \"INVOICE_LINE_ITEMS_abc_PERIOD_ab3\",\n-    \"PAYOUTS_ab1\",\n-    \"PAYOUTS_ab2\",\n-    \"PAYOUTS_ab3\",\n-    \"PAYOUTS_cb2_BANK_ACCOUNT\",\n-    \"PAYOUTS_cb2_BANK_ACCOUNT_ab1\",\n-    \"PAYOUTS_cb2_BANK_ACCOUNT_ab2\",\n-    \"PAYOUTS_cb2_BANK_ACCOUNT_ab3\",\n-    \"PAYOUT_TRANSACTIONS_ab1\",\n-    \"PAYOUT_TRANSACTIONS_ab2\",\n-    \"PAYOUT_TRANSACTIONS_ab3\",\n-    \"PLANS_94b_TIERS\",\n-    \"PLANS_94b_TIERS_ab1\",\n-    \"PLANS_94b_TIERS_ab2\",\n-    \"PLANS_94b_TIERS_ab3\",\n-    \"PLANS_ab1\",\n-    \"PLANS_ab2\",\n-    \"PLANS_ab3\",\n-    \"PRODUCTS_ab1\",\n-    \"PRODUCTS_ab2\",\n-    \"PRODUCTS_ab3\",\n-    \"PRODUCTS_f2d_PACKAGE_DIMENSIONS\",\n-    \"PRODUCTS_f2d_PACKAGE_DIMENSIONS_ab1\",\n-    \"PRODUCTS_f2d_PACKAGE_DIMENSIONS_ab2\",\n-    \"PRODUCTS_f2d_PACKAGE_DIMENSIONS_ab3\",\n-    \"SUBSCRIPTIONS_8c7_DISCOUNT\",\n-    \"SUBSCRIPTIONS_8c7_DISCOUNT_ab1\",\n-    \"SUBSCRIPTIONS_8c7_DISCOUNT_ab2\",\n-    \"SUBSCRIPTIONS_8c7_DISCOUNT_ab3\",\n+    \"INVOICE_ITEMS_462_PLAN_AB1\",\n+    \"INVOICE_ITEMS_462_PLAN_AB2\",\n+    \"INVOICE_ITEMS_462_PLAN_AB3\",\n+    \"INVOICE_ITEMS_PLAN_9F5_TIERS\",\n+    \"INVOICE_ITEMS_PLAN_9F5_TIERS_AB1\",\n+    \"INVOICE_ITEMS_PLAN_9F5_TIERS_AB2\",\n+    \"INVOICE_ITEMS_PLAN_9F5_TIERS_AB3\",\n+    \"INVOICE_LINE_ITEMS_81E_PLAN\",\n+    \"INVOICE_LINE_ITEMS_81E_PLAN_AB1\",\n+    \"INVOICE_LINE_ITEMS_81E_PLAN_AB2\",\n+    \"INVOICE_LINE_ITEMS_81E_PLAN_AB3\",\n+    \"INVOICE_LINE_ITEMS_ABC_PERIOD\",\n+    \"INVOICE_LINE_ITEMS_ABC_PERIOD_AB1\",\n+    \"INVOICE_LINE_ITEMS_ABC_PERIOD_AB2\",\n+    \"INVOICE_LINE_ITEMS_ABC_PERIOD_AB3\",\n+    \"INVOICE_LINE_ITEMS_PLAN_A4C_TIERS\",\n+    \"INVOICE_LINE_ITEMS_PLAN_A4C_TIERS_AB1\",\n+    \"INVOICE_LINE_ITEMS_PLAN_A4C_TIERS_AB2\",\n+    \"INVOICE_LINE_ITEMS_PLAN_A4C_TIERS_AB3\",\n+    \"PAYOUTS_CB2_BANK_ACCOUNT\",\n+    \"PAYOUTS_CB2_BANK_ACCOUNT_AB1\",\n+    \"PAYOUTS_CB2_BANK_ACCOUNT_AB2\",\n+    \"PAYOUTS_CB2_BANK_ACCOUNT_AB3\",\n+    \"PLANS_94B_TIERS\",\n+    \"PLANS_94B_TIERS_AB1\",\n+    \"PLANS_94B_TIERS_AB2\",\n+    \"PLANS_94B_TIERS_AB3\",\n+    \"PRODUCTS_F2D_PACKAGE_DIMENSIONS\",\n+    \"PRODUCTS_F2D_PACKAGE_DIMENSIONS_AB1\",\n+    \"PRODUCTS_F2D_PACKAGE_DIMENSIONS_AB2\",\n+    \"PRODUCTS_F2D_PACKAGE_DIMENSIONS_AB3\",\n+    \"SUBSCRIPTIONS_8C7_DISCOUNT\",\n+    \"SUBSCRIPTIONS_8C7_DISCOUNT_AB1\",\n+    \"SUBSCRIPTIONS_8C7_DISCOUNT_AB2\",\n+    \"SUBSCRIPTIONS_8C7_DISCOUNT_AB3\",\n     \"SUBSCRIPTIONS_DISCOUNT_643_COUPON\",\n-    \"SUBSCRIPTIONS_DISCOUNT_643_COUPON_ab1\",\n-    \"SUBSCRIPTIONS_DISCOUNT_643_COUPON_ab2\",\n-    \"SUBSCRIPTIONS_DISCOUNT_643_COUPON_ab3\",\n-    \"SUBSCRIPTIONS_PLAN_1b5_TIERS\",\n-    \"SUBSCRIPTIONS_PLAN_1b5_TIERS_ab1\",\n-    \"SUBSCRIPTIONS_PLAN_1b5_TIERS_ab2\",\n-    \"SUBSCRIPTIONS_PLAN_1b5_TIERS_ab3\",\n-    \"SUBSCRIPTIONS_ab1\",\n-    \"SUBSCRIPTIONS_ab2\",\n-    \"SUBSCRIPTIONS_ab3\",\n-    \"SUBSCRIPTIONS_ebc_PLAN\",\n-    \"SUBSCRIPTIONS_ebc_PLAN_ab1\",\n-    \"SUBSCRIPTIONS_ebc_PLAN_ab2\",\n-    \"SUBSCRIPTIONS_ebc_PLAN_ab3\",\n-    \"SUBSCRIPTION_ITEMS_31a_PLAN\",\n-    \"SUBSCRIPTION_ITEMS_31a_PLAN_ab1\",\n-    \"SUBSCRIPTION_ITEMS_31a_PLAN_ab2\",\n-    \"SUBSCRIPTION_ITEMS_31a_PLAN_ab3\",\n-    \"SUBSCRIPTION_ITEMS_PLAN_d14_TIERS\",\n-    \"SUBSCRIPTION_ITEMS_PLAN_d14_TIERS_ab1\",\n-    \"SUBSCRIPTION_ITEMS_PLAN_d14_TIERS_ab2\",\n-    \"SUBSCRIPTION_ITEMS_PLAN_d14_TIERS_ab3\",\n-    \"SUBSCRIPTION_ITEMS_ab1\",\n-    \"SUBSCRIPTION_ITEMS_ab2\",\n-    \"SUBSCRIPTION_ITEMS_ab3\",\n-    \"TRANSFERS_ab1\",\n-    \"TRANSFERS_ab2\",\n-    \"TRANSFERS_ab3\"\n+    \"SUBSCRIPTIONS_DISCOUNT_643_COUPON_AB1\",\n+    \"SUBSCRIPTIONS_DISCOUNT_643_COUPON_AB2\",\n+    \"SUBSCRIPTIONS_DISCOUNT_643_COUPON_AB3\",\n+    \"SUBSCRIPTIONS_EBC_PLAN\",\n+    \"SUBSCRIPTIONS_EBC_PLAN_AB1\",\n+    \"SUBSCRIPTIONS_EBC_PLAN_AB2\",\n+    \"SUBSCRIPTIONS_EBC_PLAN_AB3\",\n+    \"SUBSCRIPTIONS_PLAN_1B5_TIERS\",\n+    \"SUBSCRIPTIONS_PLAN_1B5_TIERS_AB1\",\n+    \"SUBSCRIPTIONS_PLAN_1B5_TIERS_AB2\",\n+    \"SUBSCRIPTIONS_PLAN_1B5_TIERS_AB3\",\n+    \"SUBSCRIPTION_ITEMS_31A_PLAN\",\n+    \"SUBSCRIPTION_ITEMS_31A_PLAN_AB1\",\n+    \"SUBSCRIPTION_ITEMS_31A_PLAN_AB2\",\n+    \"SUBSCRIPTION_ITEMS_31A_PLAN_AB3\",\n+    \"SUBSCRIPTION_ITEMS_PLAN_D14_TIERS\",\n+    \"SUBSCRIPTION_ITEMS_PLAN_D14_TIERS_AB1\",\n+    \"SUBSCRIPTION_ITEMS_PLAN_D14_TIERS_AB2\",\n+    \"SUBSCRIPTION_ITEMS_PLAN_D14_TIERS_AB3\"\n   ]\n }"
  },
  {
    "sha": "ab3c718fa6a806187ceb4b275fa6fa29b8c9b16a",
    "filename": "airbyte-integrations/bases/base-normalization/unit_tests/resources/stripe_catalog_expected_top_level.json",
    "status": "modified",
    "additions": 2,
    "deletions": 0,
    "changes": 2,
    "blob_url": "https://github.com/marcosmarxm/airbyte/blob/2a207174757ef99943b50a52f665158cdd6f5d53/airbyte-integrations/bases/base-normalization/unit_tests/resources/stripe_catalog_expected_top_level.json",
    "raw_url": "https://github.com/marcosmarxm/airbyte/raw/2a207174757ef99943b50a52f665158cdd6f5d53/airbyte-integrations/bases/base-normalization/unit_tests/resources/stripe_catalog_expected_top_level.json",
    "contents_url": "https://api.github.com/repos/marcosmarxm/airbyte/contents/airbyte-integrations/bases/base-normalization/unit_tests/resources/stripe_catalog_expected_top_level.json?ref=2a207174757ef99943b50a52f665158cdd6f5d53",
    "patch": "@@ -8,6 +8,8 @@\n     \"charges_ab1\",\n     \"charges_ab2\",\n     \"charges_ab3\",\n+    \"charges_ab4\",\n+    \"charges_scd\",\n     \"coupons\",\n     \"coupons_ab1\",\n     \"coupons_ab2\","
  },
  {
    "sha": "4e3c72bdb0419cff82e4d902fca66c150e9e9c73",
    "filename": "airbyte-integrations/bases/base-normalization/unit_tests/test_stream_processor.py",
    "status": "modified",
    "additions": 68,
    "deletions": 1,
    "changes": 69,
    "blob_url": "https://github.com/marcosmarxm/airbyte/blob/2a207174757ef99943b50a52f665158cdd6f5d53/airbyte-integrations/bases/base-normalization/unit_tests/test_stream_processor.py",
    "raw_url": "https://github.com/marcosmarxm/airbyte/raw/2a207174757ef99943b50a52f665158cdd6f5d53/airbyte-integrations/bases/base-normalization/unit_tests/test_stream_processor.py",
    "contents_url": "https://api.github.com/repos/marcosmarxm/airbyte/contents/airbyte-integrations/bases/base-normalization/unit_tests/test_stream_processor.py?ref=2a207174757ef99943b50a52f665158cdd6f5d53",
    "patch": "@@ -26,10 +26,11 @@\n import re\n \n import pytest\n+from airbyte_protocol.models.airbyte_protocol import DestinationSyncMode, SyncMode\n from normalization.destination_type import DestinationType\n from normalization.transform_catalog.catalog_processor import CatalogProcessor, add_table_to_registry, read_json\n from normalization.transform_catalog.destination_name_transformer import DestinationNameTransformer\n-from normalization.transform_catalog.stream_processor import get_table_name\n+from normalization.transform_catalog.stream_processor import StreamProcessor, get_table_name\n \n \n @pytest.fixture\n@@ -142,3 +143,69 @@ def test_get_table_name(root_table: str, base_table_name: str, suffix: str, expe\n     name = get_table_name(name_transformer, root_table, base_table_name, suffix, [\"json\", \"path\"])\n     assert name == expected\n     assert len(name) <= 43  # explicitly check for our max postgres length in case tests are changed in the future\n+\n+\n+@pytest.mark.parametrize(\n+    \"stream_name, is_intermediate, suffix, expected, expected_final_name\",\n+    [\n+        (\"stream_name\", False, \"\", \"stream_name\", \"stream_name\"),\n+        (\"stream_name\", False, \"suffix\", \"stream_name_suffix\", \"stream_name_suffix\"),\n+        (\"stream_name\", False, \"_suffix\", \"stream_name_suffix\", \"stream_name_suffix\"),\n+        (\"stream_name\", True, \"suffix\", \"stream_name_suffix\", \"\"),\n+        (\"stream_name\", True, \"_suffix\", \"stream_name_suffix\", \"\"),\n+    ],\n+)\n+def test_generate_new_table_name(stream_name: str, is_intermediate: bool, suffix: str, expected: str, expected_final_name: str):\n+    stream_processor = StreamProcessor.create(\n+        stream_name=stream_name,\n+        destination_type=DestinationType.POSTGRES,\n+        raw_schema=\"raw_schema\",\n+        schema=\"schema_name\",\n+        source_sync_mode=SyncMode.full_refresh,\n+        destination_sync_mode=DestinationSyncMode.append_dedup,\n+        cursor_field=[],\n+        primary_key=[],\n+        json_column_name=\"json_column_name\",\n+        properties=[],\n+        tables_registry=set(),\n+        from_table=\"\",\n+    )\n+    assert stream_processor.generate_new_table_name(is_intermediate=is_intermediate, suffix=suffix) == expected\n+    assert stream_processor.final_table_name == expected_final_name\n+\n+\n+@pytest.mark.parametrize(\n+    \"stream_name, is_intermediate, suffix, expected, expected_final_name\",\n+    [\n+        (\"stream_name\", False, \"\", \"stream_name_b00_child_stream\", \"stream_name_b00_child_stream\"),\n+        (\"stream_name\", False, \"suffix\", \"stream_name_b00_child_stream_suffix\", \"stream_name_b00_child_stream_suffix\"),\n+        (\"stream_name\", False, \"_suffix\", \"stream_name_b00_child_stream_suffix\", \"stream_name_b00_child_stream_suffix\"),\n+        (\"stream_name\", True, \"suffix\", \"stream_name_b00_child_stream_suffix\", \"\"),\n+        (\"stream_name\", True, \"_suffix\", \"stream_name_b00_child_stream_suffix\", \"\"),\n+    ],\n+)\n+def test_nested_generate_new_table_name(stream_name: str, is_intermediate: bool, suffix: str, expected: str, expected_final_name: str):\n+    stream_processor = StreamProcessor.create(\n+        stream_name=stream_name,\n+        destination_type=DestinationType.POSTGRES,\n+        raw_schema=\"raw_schema\",\n+        schema=\"schema_name\",\n+        source_sync_mode=SyncMode.full_refresh,\n+        destination_sync_mode=DestinationSyncMode.append_dedup,\n+        cursor_field=[],\n+        primary_key=[],\n+        json_column_name=\"json_column_name\",\n+        properties=[],\n+        tables_registry=set(),\n+        from_table=\"\",\n+    )\n+    nested_stream_processor = StreamProcessor.create_from_parent(\n+        parent=stream_processor,\n+        child_name=\"child_stream\",\n+        json_column_name=\"json_column_name\",\n+        properties=[],\n+        is_nested_array=False,\n+        from_table=\"\",\n+    )\n+    assert nested_stream_processor.generate_new_table_name(is_intermediate=is_intermediate, suffix=suffix) == expected\n+    assert nested_stream_processor.final_table_name == expected_final_name"
  },
  {
    "sha": "284f34550404515933f8a551a6e25757548477ac",
    "filename": "airbyte-integrations/connectors/source-facebook-marketing/Dockerfile",
    "status": "modified",
    "additions": 1,
    "deletions": 1,
    "changes": 2,
    "blob_url": "https://github.com/marcosmarxm/airbyte/blob/2a207174757ef99943b50a52f665158cdd6f5d53/airbyte-integrations/connectors/source-facebook-marketing/Dockerfile",
    "raw_url": "https://github.com/marcosmarxm/airbyte/raw/2a207174757ef99943b50a52f665158cdd6f5d53/airbyte-integrations/connectors/source-facebook-marketing/Dockerfile",
    "contents_url": "https://api.github.com/repos/marcosmarxm/airbyte/contents/airbyte-integrations/connectors/source-facebook-marketing/Dockerfile?ref=2a207174757ef99943b50a52f665158cdd6f5d53",
    "patch": "@@ -12,5 +12,5 @@ COPY $CODE_PATH ./$CODE_PATH\n COPY setup.py ./\n RUN pip install .\n \n-LABEL io.airbyte.version=0.2.0\n+LABEL io.airbyte.version=0.2.1\n LABEL io.airbyte.name=airbyte/source-facebook-marketing"
  }
]

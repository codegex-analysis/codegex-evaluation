[
  {
    "sha": "3882263b56aaf2bbbad9b5e4c9b1f9769ed1efde",
    "filename": ".github/workflows/maven.yml",
    "status": "modified",
    "additions": 1,
    "deletions": 1,
    "changes": 2,
    "blob_url": "https://github.com/kyngs/HerBot/blob/d61df78a83e128b690284eba59772b9b9bc16b59/.github/workflows/maven.yml",
    "raw_url": "https://github.com/kyngs/HerBot/raw/d61df78a83e128b690284eba59772b9b9bc16b59/.github/workflows/maven.yml",
    "contents_url": "https://api.github.com/repos/kyngs/HerBot/contents/.github/workflows/maven.yml?ref=d61df78a83e128b690284eba59772b9b9bc16b59",
    "patch": "@@ -16,7 +16,7 @@ jobs:\n \n     steps:\n     - uses: actions/checkout@v2\n-    - name: Set up JDK 1.8\n+    - name: Set up JDK 15\n       uses: actions/setup-java@v1\n       with:\n         java-version: 15"
  },
  {
    "sha": "d971ae97a4c8cb51e990110b85793eecc4316552",
    "filename": "pom.xml",
    "status": "modified",
    "additions": 1,
    "deletions": 1,
    "changes": 2,
    "blob_url": "https://github.com/kyngs/HerBot/blob/d61df78a83e128b690284eba59772b9b9bc16b59/pom.xml",
    "raw_url": "https://github.com/kyngs/HerBot/raw/d61df78a83e128b690284eba59772b9b9bc16b59/pom.xml",
    "contents_url": "https://api.github.com/repos/kyngs/HerBot/contents/pom.xml?ref=d61df78a83e128b690284eba59772b9b9bc16b59",
    "patch": "@@ -80,7 +80,7 @@\n         <dependency>\n             <groupId>com.github.kyngs</groupId>\n             <artifactId>EasyMySQL</artifactId>\n-            <version>1.2-SNAPSHOT</version>\n+            <version>e50cb394b6</version>\n         </dependency>\n         <dependency>\n             <groupId>net.dv8tion</groupId>"
  },
  {
    "sha": "4af783b087667a633476f46e3c476f63232abbeb",
    "filename": "src/main/java/xyz/kyngs/herbot/HerBot.java",
    "status": "modified",
    "additions": 29,
    "deletions": 6,
    "changes": 35,
    "blob_url": "https://github.com/kyngs/HerBot/blob/d61df78a83e128b690284eba59772b9b9bc16b59/src/main/java/xyz/kyngs/herbot/HerBot.java",
    "raw_url": "https://github.com/kyngs/HerBot/raw/d61df78a83e128b690284eba59772b9b9bc16b59/src/main/java/xyz/kyngs/herbot/HerBot.java",
    "contents_url": "https://api.github.com/repos/kyngs/HerBot/contents/src/main/java/xyz/kyngs/herbot/HerBot.java?ref=d61df78a83e128b690284eba59772b9b9bc16b59",
    "patch": "@@ -2,20 +2,32 @@\n \n import net.dv8tion.jda.api.JDA;\n import net.dv8tion.jda.api.JDABuilder;\n+import net.dv8tion.jda.api.requests.GatewayIntent;\n import org.jetbrains.annotations.NotNull;\n import org.simpleyaml.configuration.Configuration;\n import xyz.kyngs.herbot.database.DatabaseManager;\n import xyz.kyngs.herbot.handlers.AntiDuplicationHandler;\n import xyz.kyngs.herbot.handlers.InfoMessageHandler;\n import xyz.kyngs.herbot.handlers.ThrowableHandler;\n import xyz.kyngs.herbot.handlers.command.CommandHandler;\n-import xyz.kyngs.herbot.handlers.command.commands.*;\n+import xyz.kyngs.herbot.handlers.command.commands.admin.PermissionCommand;\n+import xyz.kyngs.herbot.handlers.command.commands.animal.CatCommand;\n+import xyz.kyngs.herbot.handlers.command.commands.animal.DogCommand;\n+import xyz.kyngs.herbot.handlers.command.commands.animal.DuckCommand;\n+import xyz.kyngs.herbot.handlers.command.commands.economy.BalanceCommand;\n+import xyz.kyngs.herbot.handlers.command.commands.economy.DailyCommand;\n+import xyz.kyngs.herbot.handlers.command.commands.economy.GambleCommand;\n+import xyz.kyngs.herbot.handlers.command.commands.economy.PayCommand;\n+import xyz.kyngs.herbot.handlers.command.commands.info.HelpCommand;\n+import xyz.kyngs.herbot.handlers.command.commands.info.InfoCommand;\n+import xyz.kyngs.herbot.handlers.user.UserHandler;\n import xyz.kyngs.herbot.util.AnimalUtil;\n import xyz.kyngs.logger.LogBuilder;\n import xyz.kyngs.logger.Logger;\n \n import javax.security.auth.login.LoginException;\n import java.sql.SQLException;\n+import java.util.List;\n import java.util.concurrent.ExecutorService;\n import java.util.concurrent.Executors;\n import java.util.regex.Pattern;\n@@ -40,6 +52,7 @@\n     private final CommandHandler commandHandler;\n     private final AnimalUtil animalUtil;\n     private final ThrowableHandler throwableHandler;\n+    private final UserHandler userHandler;\n \n     public HerBot(Configuration configuration) {\n         this.configuration = configuration;\n@@ -53,7 +66,7 @@ public HerBot(Configuration configuration) {\n         }\n \n         try {\n-            jda = JDABuilder.createDefault(configuration.getString(\"token\"))\n+            jda = JDABuilder.createDefault(configuration.getString(\"token\"), List.of(GatewayIntent.values()))\n                     .setEnableShutdownHook(false)\n                     .build();\n             jda.awaitReady();\n@@ -68,20 +81,26 @@ public HerBot(Configuration configuration) {\n         commandHandler = new CommandHandler(this);\n         animalUtil = new AnimalUtil(this);\n         throwableHandler = new ThrowableHandler(this);\n+        userHandler = new UserHandler(this);\n \n         commandHandler.registerCommand(new CatCommand(this, \"Pošle obrázek kočičky\"), \"cat\", \"číča\", \"kočička\", \"čiči\", \"kočka\");\n-        commandHandler.registerCommand(new DuckCommand(this, \"Pošle obrázek kachinčky\"), \"duck\", \"ducc\", \"kachnička\");\n+        commandHandler.registerCommand(new DuckCommand(this, \"Pošle obrázek kachničky\"), \"duck\", \"ducc\", \"kachnička\");\n         commandHandler.registerCommand(new HelpCommand(this, \"Ukáže seznam všech příkazů\"), \"help\", \"pomoc\", \"sos\");\n-        commandHandler.registerCommand(new DogCommand(this, \"Pošle obrázek pejska.\"), \"dog\", \"haf\", \"pejsek\", \"pes\");\n-        commandHandler.registerCommand(new InfoCommand(this, \"Zobrazí informace o botovi a kontakty.\"), \"info\", \"kontakty\");\n+        commandHandler.registerCommand(new DogCommand(this, \"Pošle obrázek pejska\"), \"dog\", \"haf\", \"pejsek\", \"pes\");\n+        commandHandler.registerCommand(new InfoCommand(this, \"Zobrazí informace o botovi a kontakty\"), \"info\", \"kontakty\");\n+        commandHandler.registerCommand(new DailyCommand(this, \"Dá ti dnešní odměnu\"), \"daily\");\n+        commandHandler.registerCommand(new PermissionCommand(this, \"Přidá nebo odebere oprávnění\"), \"perm\");\n+        commandHandler.registerCommand(new BalanceCommand(this, \"Zobrazí zůstatek na tvém účtu\"), \"bal\", \"balance\");\n+        commandHandler.registerCommand(new PayCommand(this, \"Pošle peníze jiným uživatelům\"), \"pay\", \"zaplatit\");\n+        commandHandler.registerCommand(new GambleCommand(this, \"Pomůže ti získat více peněz\"), \"gamble\", \"sazka\");\n \n         jda.addEventListener(new EventListener(this));\n \n         for (Thread thread : Thread.getAllStackTraces().keySet()) {\n             thread.setUncaughtExceptionHandler((t, e) -> throwableHandler.reportThrowable(e));\n         }\n \n-        Runtime.getRuntime().addShutdownHook(new Thread(this::shutdown, \"Shutdown Handler\"));\n+        Runtime.getRuntime().addShutdownHook(new Thread(this::shutdown, \"Shutdown Thread\"));\n \n     }\n \n@@ -139,4 +158,8 @@ public InfoMessageHandler getInfoMessageHandler() {\n     public AntiDuplicationHandler getAntiDuplicationHandler() {\n         return antiDuplicationHandler;\n     }\n+\n+    public UserHandler getUserHandler() {\n+        return userHandler;\n+    }\n }"
  },
  {
    "sha": "9eaabbcf775021cee6e98b5a04027193a0b80334",
    "filename": "src/main/java/xyz/kyngs/herbot/database/DatabaseManager.java",
    "status": "modified",
    "additions": 1,
    "deletions": 0,
    "changes": 1,
    "blob_url": "https://github.com/kyngs/HerBot/blob/d61df78a83e128b690284eba59772b9b9bc16b59/src/main/java/xyz/kyngs/herbot/database/DatabaseManager.java",
    "raw_url": "https://github.com/kyngs/HerBot/raw/d61df78a83e128b690284eba59772b9b9bc16b59/src/main/java/xyz/kyngs/herbot/database/DatabaseManager.java",
    "contents_url": "https://api.github.com/repos/kyngs/HerBot/contents/src/main/java/xyz/kyngs/herbot/database/DatabaseManager.java?ref=d61df78a83e128b690284eba59772b9b9bc16b59",
    "patch": "@@ -34,6 +34,7 @@ private void prepareTables() {\n         mySQL.sync().schedule(connection -> {\n             connection.prepareStatement(\"CREATE TABLE IF NOT EXISTS info_messages (id INT NOT NULL AUTO_INCREMENT PRIMARY KEY, channel_id VARCHAR(256) NOT NULL, message TEXT NOT NULL)\").execute();\n             connection.prepareStatement(\"CREATE TABLE IF NOT EXISTS anti_duplication (id BIGINT NOT NULL AUTO_INCREMENT PRIMARY KEY, channel_id VARCHAR(256) NOT NULL, link TEXT NOT NULL)\").execute();\n+            connection.prepareStatement(\"CREATE TABLE IF NOT EXISTS user_data (coins BIGINT NOT NULL, user_id VARCHAR(256) NOT NULL PRIMARY KEY, xp BIGINT NOT NULL, daily_streak INT NOT NULL, last_daily_claim DATE NOT NULL, permissions TEXT NOT NULL);\").execute();\n         });\n     }\n "
  },
  {
    "sha": "b1e3ca92f3f5de4070affad2f076d1c5d83edde0",
    "filename": "src/main/java/xyz/kyngs/herbot/handlers/command/AbstractCommand.java",
    "status": "modified",
    "additions": 108,
    "deletions": 1,
    "changes": 109,
    "blob_url": "https://github.com/kyngs/HerBot/blob/d61df78a83e128b690284eba59772b9b9bc16b59/src/main/java/xyz/kyngs/herbot/handlers/command/AbstractCommand.java",
    "raw_url": "https://github.com/kyngs/HerBot/raw/d61df78a83e128b690284eba59772b9b9bc16b59/src/main/java/xyz/kyngs/herbot/handlers/command/AbstractCommand.java",
    "contents_url": "https://api.github.com/repos/kyngs/HerBot/contents/src/main/java/xyz/kyngs/herbot/handlers/command/AbstractCommand.java?ref=d61df78a83e128b690284eba59772b9b9bc16b59",
    "patch": "@@ -1,17 +1,124 @@\n package xyz.kyngs.herbot.handlers.command;\n \n+import net.dv8tion.jda.api.EmbedBuilder;\n+import net.dv8tion.jda.api.entities.Guild;\n+import net.dv8tion.jda.api.entities.Message;\n+import net.dv8tion.jda.api.entities.TextChannel;\n+import net.dv8tion.jda.api.entities.User;\n+import net.dv8tion.jda.api.events.message.guild.GuildMessageReceivedEvent;\n import xyz.kyngs.herbot.HerBot;\n+import xyz.kyngs.herbot.handlers.user.UserProfile;\n+import xyz.kyngs.herbot.util.Argument;\n+import xyz.kyngs.herbot.util.ClassUtil;\n+\n+import java.awt.*;\n+import java.util.ArrayList;\n+import java.util.List;\n+\n+import static xyz.kyngs.herbot.util.ExceptionUtil.completedExceptionally;\n \n public abstract class AbstractCommand implements CommandExecutor {\n \n     protected final HerBot herBot;\n     protected final String description;\n+    @SuppressWarnings(\"rawtypes\")\n+    private final List<Argument> args;\n+    private final String permission;\n \n-    public AbstractCommand(HerBot herBot, String description) {\n+    public AbstractCommand(HerBot herBot, String description, String permission) {\n         this.herBot = herBot;\n         this.description = description;\n+        this.permission = permission;\n+        args = new ArrayList<>();\n+    }\n+\n+    public <T> void addArg(Class<T> type, String... names) {\n+        args.add(new Argument<T>(type, names));\n     }\n \n+    @Override\n+    public void onCommand(User author, Guild guild, TextChannel channel, Message message, String[] args, UserProfile profile, GuildMessageReceivedEvent event) {\n+        if (everythingOK(message, args, profile)) return;\n+\n+        exec(author, guild, channel, message, args, profile, event);\n+\n+    }\n+\n+    private boolean everythingOK(Message message, String[] args, UserProfile profile) {\n+        if (!profile.hasPermission(permission)) {\n+            var builder = new EmbedBuilder();\n+            builder.setColor(Color.RED);\n+            builder.setTitle(\"Tuto akci nemůžeš provést\");\n+            builder.setDescription(\"Na tuto akci nemáš dostatečné oprávnění\");\n+            message.reply(builder.build()).mentionRepliedUser(false).queue();\n+            return false;\n+        }\n+        if (args.length < this.args.size()) {\n+            var builder = new EmbedBuilder();\n+            builder.setTitle(\"Špatný počet argumentů\");\n+            builder.setDescription(\"Chybí ti argumenty: \");\n+            builder.setColor(Color.RED);\n+            this.args.listIterator(args.length).forEachRemaining(argument -> {\n+                var type = argument.getType();\n+                String typeName = ClassUtil.classify(type).getName();\n+\n+                var nameBuilder = new StringBuilder();\n+\n+                for (String option : argument.getOptions()) {\n+                    nameBuilder.append(option);\n+                    nameBuilder.append(\"|\");\n+                }\n+\n+                nameBuilder.deleteCharAt(nameBuilder.length() - 1);\n+\n+                builder.addField(nameBuilder.toString(), typeName, true);\n+            });\n+            message.reply(builder.build()).mentionRepliedUser(false).queue();\n+            return false;\n+        }\n+\n+        boolean good = true;\n+        var builder = new EmbedBuilder();\n+\n+        builder.setTitle(\"Špatné argumenty\");\n+        builder.setDescription(\"Tyto argumenty máš špatně:\");\n+        builder.setColor(Color.RED);\n+\n+        for (int i = 0; i < this.args.size(); i++) {\n+            var argument = this.args.get(i);\n+            var arg = args[i];\n+            var type = ClassUtil.classify(argument.getType());\n+\n+            var lookingGood = switch (type) {\n+                case TEXT, UNKNOWN -> true;\n+                case NUMBER -> !completedExceptionally(() -> Integer.parseInt(arg));\n+            };\n+\n+            if (good) good = lookingGood;\n+\n+            if (!lookingGood) {\n+                var nameBuilder = new StringBuilder();\n+\n+                for (String option : argument.getOptions()) {\n+                    nameBuilder.append(option);\n+                    nameBuilder.append(\"|\");\n+                }\n+\n+                nameBuilder.deleteCharAt(nameBuilder.length() - 1);\n+                builder.addField(nameBuilder.toString(), String.format(\"Musí být %s\", type.getName()), true);\n+            }\n+\n+        }\n+\n+        if (!good) {\n+            message.reply(builder.build()).mentionRepliedUser(false).queue();\n+            return false;\n+        }\n+        return true;\n+    }\n+\n+    public abstract void exec(User author, Guild guild, TextChannel channel, Message message, String[] args, UserProfile profile, GuildMessageReceivedEvent event);\n+\n     public String getDescription() {\n         return description;\n     }"
  },
  {
    "sha": "5e4189de9bce0dda5a57ffa82aef61de862b2c25",
    "filename": "src/main/java/xyz/kyngs/herbot/handlers/command/CommandExecutor.java",
    "status": "modified",
    "additions": 2,
    "deletions": 1,
    "changes": 3,
    "blob_url": "https://github.com/kyngs/HerBot/blob/d61df78a83e128b690284eba59772b9b9bc16b59/src/main/java/xyz/kyngs/herbot/handlers/command/CommandExecutor.java",
    "raw_url": "https://github.com/kyngs/HerBot/raw/d61df78a83e128b690284eba59772b9b9bc16b59/src/main/java/xyz/kyngs/herbot/handlers/command/CommandExecutor.java",
    "contents_url": "https://api.github.com/repos/kyngs/HerBot/contents/src/main/java/xyz/kyngs/herbot/handlers/command/CommandExecutor.java?ref=d61df78a83e128b690284eba59772b9b9bc16b59",
    "patch": "@@ -5,9 +5,10 @@\n import net.dv8tion.jda.api.entities.TextChannel;\n import net.dv8tion.jda.api.entities.User;\n import net.dv8tion.jda.api.events.message.guild.GuildMessageReceivedEvent;\n+import xyz.kyngs.herbot.handlers.user.UserProfile;\n \n public interface CommandExecutor {\n \n-    void onCommand(User author, Guild guild, TextChannel channel, Message message, String[] args, GuildMessageReceivedEvent event);\n+    void onCommand(User author, Guild guild, TextChannel channel, Message message, String[] args, UserProfile profile, GuildMessageReceivedEvent event);\n \n }"
  },
  {
    "sha": "d6f50e489876213ce62ae0ed92905205da4426a7",
    "filename": "src/main/java/xyz/kyngs/herbot/handlers/command/CommandHandler.java",
    "status": "modified",
    "additions": 5,
    "deletions": 1,
    "changes": 6,
    "blob_url": "https://github.com/kyngs/HerBot/blob/d61df78a83e128b690284eba59772b9b9bc16b59/src/main/java/xyz/kyngs/herbot/handlers/command/CommandHandler.java",
    "raw_url": "https://github.com/kyngs/HerBot/raw/d61df78a83e128b690284eba59772b9b9bc16b59/src/main/java/xyz/kyngs/herbot/handlers/command/CommandHandler.java",
    "contents_url": "https://api.github.com/repos/kyngs/HerBot/contents/src/main/java/xyz/kyngs/herbot/handlers/command/CommandHandler.java?ref=d61df78a83e128b690284eba59772b9b9bc16b59",
    "patch": "@@ -79,7 +79,11 @@ public void processNewMessage(GuildMessageReceivedEvent event) {\n         }\n \n         try {\n-            command.onCommand(event.getAuthor(), event.getGuild(), event.getChannel(), message, Arrays.copyOfRange(args, 1, args.length), event);\n+            var userHandler = herBot.getUserHandler();\n+            var userID = event.getAuthor().getId();\n+            var profile = userHandler.getUser(userID);\n+            command.onCommand(event.getAuthor(), event.getGuild(), event.getChannel(), message, Arrays.copyOfRange(args, 1, args.length), profile, event);\n+            userHandler.saveUser(profile, userID);\n         } catch (Exception e) {\n             event.getChannel().sendMessage(new EmbedBuilder()\n                     .setColor(Color.RED)"
  },
  {
    "sha": "c3aa5e43c3ca8b3520dc1086b3b48e9aea689afe",
    "filename": "src/main/java/xyz/kyngs/herbot/handlers/command/commands/admin/PermissionCommand.java",
    "status": "added",
    "additions": 45,
    "deletions": 0,
    "changes": 45,
    "blob_url": "https://github.com/kyngs/HerBot/blob/d61df78a83e128b690284eba59772b9b9bc16b59/src/main/java/xyz/kyngs/herbot/handlers/command/commands/admin/PermissionCommand.java",
    "raw_url": "https://github.com/kyngs/HerBot/raw/d61df78a83e128b690284eba59772b9b9bc16b59/src/main/java/xyz/kyngs/herbot/handlers/command/commands/admin/PermissionCommand.java",
    "contents_url": "https://api.github.com/repos/kyngs/HerBot/contents/src/main/java/xyz/kyngs/herbot/handlers/command/commands/admin/PermissionCommand.java?ref=d61df78a83e128b690284eba59772b9b9bc16b59",
    "patch": "@@ -0,0 +1,45 @@\n+package xyz.kyngs.herbot.handlers.command.commands.admin;\n+\n+import net.dv8tion.jda.api.EmbedBuilder;\n+import net.dv8tion.jda.api.entities.Guild;\n+import net.dv8tion.jda.api.entities.Message;\n+import net.dv8tion.jda.api.entities.TextChannel;\n+import net.dv8tion.jda.api.entities.User;\n+import net.dv8tion.jda.api.events.message.guild.GuildMessageReceivedEvent;\n+import xyz.kyngs.herbot.HerBot;\n+import xyz.kyngs.herbot.handlers.command.AbstractCommand;\n+import xyz.kyngs.herbot.handlers.user.UserProfile;\n+import xyz.kyngs.herbot.util.MemberUtil;\n+\n+import java.awt.*;\n+\n+public class PermissionCommand extends AbstractCommand {\n+\n+    public PermissionCommand(HerBot herBot, String description) {\n+        super(herBot, description, \"permissions\");\n+        addArg(String.class, \"give\", \"take\");\n+        addArg(String.class, \"uživatel\");\n+        addArg(String.class, \"oprávnění\");\n+    }\n+\n+    @Override\n+    public void exec(User author, Guild guild, TextChannel channel, Message message, String[] args, UserProfile profile, GuildMessageReceivedEvent event) {\n+        User user = MemberUtil.getUser(args[1], herBot.getJda());\n+        if (user == null) {\n+            message.reply(\"Uživatel nenalezen!\").mentionRepliedUser(false).queue();\n+            return;\n+        }\n+        var targetProfile = herBot.getUserHandler().getUser(user.getId());\n+        if (args[0].contentEquals(\"give\")) {\n+            targetProfile.allowPermission(args[2]);\n+        } else {\n+            targetProfile.declinePermission(args[2]);\n+        }\n+        herBot.getUserHandler().saveUser(targetProfile, user.getId());\n+        var builder = new EmbedBuilder();\n+        builder.setColor(Color.GREEN);\n+        builder.setTitle(\"Úspěch\");\n+        builder.setDescription(\"Oprávnění úspěšně aktualizováno\");\n+        message.reply(builder.build()).mentionRepliedUser(false).queue();\n+    }\n+}"
  },
  {
    "sha": "bcb92df537f7f6a5ab2bea0912e432bfa441ed81",
    "filename": "src/main/java/xyz/kyngs/herbot/handlers/command/commands/animal/CatCommand.java",
    "status": "renamed",
    "additions": 4,
    "deletions": 3,
    "changes": 7,
    "blob_url": "https://github.com/kyngs/HerBot/blob/d61df78a83e128b690284eba59772b9b9bc16b59/src/main/java/xyz/kyngs/herbot/handlers/command/commands/animal/CatCommand.java",
    "raw_url": "https://github.com/kyngs/HerBot/raw/d61df78a83e128b690284eba59772b9b9bc16b59/src/main/java/xyz/kyngs/herbot/handlers/command/commands/animal/CatCommand.java",
    "contents_url": "https://api.github.com/repos/kyngs/HerBot/contents/src/main/java/xyz/kyngs/herbot/handlers/command/commands/animal/CatCommand.java?ref=d61df78a83e128b690284eba59772b9b9bc16b59",
    "patch": "@@ -1,4 +1,4 @@\n-package xyz.kyngs.herbot.handlers.command.commands;\n+package xyz.kyngs.herbot.handlers.command.commands.animal;\n \n import net.dv8tion.jda.api.entities.Guild;\n import net.dv8tion.jda.api.entities.Message;\n@@ -7,16 +7,17 @@\n import net.dv8tion.jda.api.events.message.guild.GuildMessageReceivedEvent;\n import xyz.kyngs.herbot.HerBot;\n import xyz.kyngs.herbot.handlers.command.AbstractCommand;\n+import xyz.kyngs.herbot.handlers.user.UserProfile;\n import xyz.kyngs.herbot.util.MessageUtil;\n \n public class CatCommand extends AbstractCommand {\n \n     public CatCommand(HerBot herBot, String description) {\n-        super(herBot, description);\n+        super(herBot, description, \"\");\n     }\n \n     @Override\n-    public void onCommand(User author, Guild guild, TextChannel channel, Message message, String[] args, GuildMessageReceivedEvent event) {\n+    public void exec(User author, Guild guild, TextChannel channel, Message message, String[] args, UserProfile profile, GuildMessageReceivedEvent event) {\n         MessageUtil.replyWhenArrive(herBot.getAnimalUtil().readJsonURL(\"https://api.thecatapi.com/api/images/get?format=json\", \"OOF! Nepodařilo se načíst kočičku :(\"), message, \"Načítání kočičky <:PauseChamp:811729611079024731>\");\n     }\n }",
    "previous_filename": "src/main/java/xyz/kyngs/herbot/handlers/command/commands/CatCommand.java"
  },
  {
    "sha": "71f29c5cd9bd5bef78041b9e8398214c9fb87dcd",
    "filename": "src/main/java/xyz/kyngs/herbot/handlers/command/commands/animal/DogCommand.java",
    "status": "renamed",
    "additions": 4,
    "deletions": 3,
    "changes": 7,
    "blob_url": "https://github.com/kyngs/HerBot/blob/d61df78a83e128b690284eba59772b9b9bc16b59/src/main/java/xyz/kyngs/herbot/handlers/command/commands/animal/DogCommand.java",
    "raw_url": "https://github.com/kyngs/HerBot/raw/d61df78a83e128b690284eba59772b9b9bc16b59/src/main/java/xyz/kyngs/herbot/handlers/command/commands/animal/DogCommand.java",
    "contents_url": "https://api.github.com/repos/kyngs/HerBot/contents/src/main/java/xyz/kyngs/herbot/handlers/command/commands/animal/DogCommand.java?ref=d61df78a83e128b690284eba59772b9b9bc16b59",
    "patch": "@@ -1,4 +1,4 @@\n-package xyz.kyngs.herbot.handlers.command.commands;\n+package xyz.kyngs.herbot.handlers.command.commands.animal;\n \n import net.dv8tion.jda.api.entities.Guild;\n import net.dv8tion.jda.api.entities.Message;\n@@ -7,15 +7,16 @@\n import net.dv8tion.jda.api.events.message.guild.GuildMessageReceivedEvent;\n import xyz.kyngs.herbot.HerBot;\n import xyz.kyngs.herbot.handlers.command.AbstractCommand;\n+import xyz.kyngs.herbot.handlers.user.UserProfile;\n import xyz.kyngs.herbot.util.MessageUtil;\n \n public class DogCommand extends AbstractCommand {\n     public DogCommand(HerBot herBot, String description) {\n-        super(herBot, description);\n+        super(herBot, description, \"\");\n     }\n \n     @Override\n-    public void onCommand(User author, Guild guild, TextChannel channel, Message message, String[] args, GuildMessageReceivedEvent event) {\n+    public void exec(User author, Guild guild, TextChannel channel, Message message, String[] args, UserProfile profile, GuildMessageReceivedEvent event) {\n         MessageUtil.replyWhenArrive(herBot.getAnimalUtil().readJsonURL(\"https://random.dog/woof.json\", \"OOF! Nepodařilo se načíst pejska :(\"), message, \"Načítání pejska <:PauseChamp:811729611079024731>\");\n     }\n }",
    "previous_filename": "src/main/java/xyz/kyngs/herbot/handlers/command/commands/DogCommand.java"
  },
  {
    "sha": "8651cde1947a9f7b20538fb194be24f8557cb20b",
    "filename": "src/main/java/xyz/kyngs/herbot/handlers/command/commands/animal/DuckCommand.java",
    "status": "renamed",
    "additions": 4,
    "deletions": 3,
    "changes": 7,
    "blob_url": "https://github.com/kyngs/HerBot/blob/d61df78a83e128b690284eba59772b9b9bc16b59/src/main/java/xyz/kyngs/herbot/handlers/command/commands/animal/DuckCommand.java",
    "raw_url": "https://github.com/kyngs/HerBot/raw/d61df78a83e128b690284eba59772b9b9bc16b59/src/main/java/xyz/kyngs/herbot/handlers/command/commands/animal/DuckCommand.java",
    "contents_url": "https://api.github.com/repos/kyngs/HerBot/contents/src/main/java/xyz/kyngs/herbot/handlers/command/commands/animal/DuckCommand.java?ref=d61df78a83e128b690284eba59772b9b9bc16b59",
    "patch": "@@ -1,4 +1,4 @@\n-package xyz.kyngs.herbot.handlers.command.commands;\n+package xyz.kyngs.herbot.handlers.command.commands.animal;\n \n import net.dv8tion.jda.api.entities.Guild;\n import net.dv8tion.jda.api.entities.Message;\n@@ -7,16 +7,17 @@\n import net.dv8tion.jda.api.events.message.guild.GuildMessageReceivedEvent;\n import xyz.kyngs.herbot.HerBot;\n import xyz.kyngs.herbot.handlers.command.AbstractCommand;\n+import xyz.kyngs.herbot.handlers.user.UserProfile;\n import xyz.kyngs.herbot.util.MessageUtil;\n \n public class DuckCommand extends AbstractCommand {\n \n     public DuckCommand(HerBot herBot, String description) {\n-        super(herBot, description);\n+        super(herBot, description, \"\");\n     }\n \n     @Override\n-    public void onCommand(User author, Guild guild, TextChannel channel, Message message, String[] args, GuildMessageReceivedEvent event) {\n+    public void exec(User author, Guild guild, TextChannel channel, Message message, String[] args, UserProfile profile, GuildMessageReceivedEvent event) {\n         MessageUtil.replyWhenArrive(herBot.getAnimalUtil().readJsonURL(\"https://random-d.uk/api/v2/random\", \"OOF! Nepodařilo se načíst kachničku :(\"), message, \"Načítání kachničky <:PauseChamp:811729611079024731>\");\n     }\n }",
    "previous_filename": "src/main/java/xyz/kyngs/herbot/handlers/command/commands/DuckCommand.java"
  },
  {
    "sha": "5a2a759aed24aafbf8c35405be5e25dbfce925b0",
    "filename": "src/main/java/xyz/kyngs/herbot/handlers/command/commands/economy/BalanceCommand.java",
    "status": "added",
    "additions": 27,
    "deletions": 0,
    "changes": 27,
    "blob_url": "https://github.com/kyngs/HerBot/blob/d61df78a83e128b690284eba59772b9b9bc16b59/src/main/java/xyz/kyngs/herbot/handlers/command/commands/economy/BalanceCommand.java",
    "raw_url": "https://github.com/kyngs/HerBot/raw/d61df78a83e128b690284eba59772b9b9bc16b59/src/main/java/xyz/kyngs/herbot/handlers/command/commands/economy/BalanceCommand.java",
    "contents_url": "https://api.github.com/repos/kyngs/HerBot/contents/src/main/java/xyz/kyngs/herbot/handlers/command/commands/economy/BalanceCommand.java?ref=d61df78a83e128b690284eba59772b9b9bc16b59",
    "patch": "@@ -0,0 +1,27 @@\n+package xyz.kyngs.herbot.handlers.command.commands.economy;\n+\n+import net.dv8tion.jda.api.EmbedBuilder;\n+import net.dv8tion.jda.api.entities.Guild;\n+import net.dv8tion.jda.api.entities.Message;\n+import net.dv8tion.jda.api.entities.TextChannel;\n+import net.dv8tion.jda.api.entities.User;\n+import net.dv8tion.jda.api.events.message.guild.GuildMessageReceivedEvent;\n+import xyz.kyngs.herbot.HerBot;\n+import xyz.kyngs.herbot.handlers.command.AbstractCommand;\n+import xyz.kyngs.herbot.handlers.user.UserProfile;\n+\n+import java.awt.*;\n+\n+public class BalanceCommand extends AbstractCommand {\n+    public BalanceCommand(HerBot herBot, String description) {\n+        super(herBot, description, \"\");\n+    }\n+\n+    @Override\n+    public void exec(User author, Guild guild, TextChannel channel, Message message, String[] args, UserProfile profile, GuildMessageReceivedEvent event) {\n+        var builder = new EmbedBuilder();\n+        builder.setColor(Color.GREEN);\n+        builder.setTitle(String.format(\"Na účtě máš %s coinů\", profile.getCoins()));\n+        message.reply(builder.build()).mentionRepliedUser(false).queue();\n+    }\n+}"
  },
  {
    "sha": "9456c69af2e5519a6db2af4fefcdda12b8812f1e",
    "filename": "src/main/java/xyz/kyngs/herbot/handlers/command/commands/economy/DailyCommand.java",
    "status": "added",
    "additions": 65,
    "deletions": 0,
    "changes": 65,
    "blob_url": "https://github.com/kyngs/HerBot/blob/d61df78a83e128b690284eba59772b9b9bc16b59/src/main/java/xyz/kyngs/herbot/handlers/command/commands/economy/DailyCommand.java",
    "raw_url": "https://github.com/kyngs/HerBot/raw/d61df78a83e128b690284eba59772b9b9bc16b59/src/main/java/xyz/kyngs/herbot/handlers/command/commands/economy/DailyCommand.java",
    "contents_url": "https://api.github.com/repos/kyngs/HerBot/contents/src/main/java/xyz/kyngs/herbot/handlers/command/commands/economy/DailyCommand.java?ref=d61df78a83e128b690284eba59772b9b9bc16b59",
    "patch": "@@ -0,0 +1,65 @@\n+package xyz.kyngs.herbot.handlers.command.commands.economy;\n+\n+import net.dv8tion.jda.api.EmbedBuilder;\n+import net.dv8tion.jda.api.entities.Guild;\n+import net.dv8tion.jda.api.entities.Message;\n+import net.dv8tion.jda.api.entities.TextChannel;\n+import net.dv8tion.jda.api.entities.User;\n+import net.dv8tion.jda.api.events.message.guild.GuildMessageReceivedEvent;\n+import xyz.kyngs.herbot.HerBot;\n+import xyz.kyngs.herbot.handlers.command.AbstractCommand;\n+import xyz.kyngs.herbot.handlers.user.UserProfile;\n+\n+import java.awt.*;\n+import java.time.LocalDate;\n+import java.time.Period;\n+\n+public class DailyCommand extends AbstractCommand {\n+\n+    public DailyCommand(HerBot herBot, String description) {\n+        super(herBot, description, \"\");\n+    }\n+\n+    @Override\n+    public void exec(User author, Guild guild, TextChannel channel, Message message, String[] args, UserProfile profile, GuildMessageReceivedEvent event) {\n+\n+        var today = LocalDate.now();\n+        var period = Period.between(today, profile.getLastDailyClaim());\n+        var days = Math.abs(period.getDays());\n+\n+        var builder = new EmbedBuilder();\n+\n+        if (days == 0) {\n+\n+            builder.setColor(Color.RED);\n+            builder.setTitle(\"Woah zpomal\");\n+\n+            builder.setDescription(\"Dnešní daily sis už vyzvedl, přijď zítra!\");\n+\n+        } else {\n+\n+            builder.setColor(Color.GREEN);\n+\n+            builder.setTitle(\"Tady máš coiny\");\n+\n+            var toAdd = 2000;\n+\n+            if (days >= 2) {\n+                profile.setDailyStreak(0);\n+            } else {\n+                profile.setDailyStreak(profile.getDailyStreak() + 1);\n+            }\n+\n+            toAdd += profile.getDailyStreak() * 200;\n+\n+            builder.setDescription(String.format(\"Přičteno %s coinů na tvůj účet!\", toAdd));\n+            builder.setFooter(String.format(\"Streak %s dnů (+%s coinů)\", profile.getDailyStreak(), profile.getDailyStreak() * 200));\n+            profile.setLastDailyClaim(LocalDate.now());\n+            profile.addCoins(toAdd);\n+\n+        }\n+        message.reply(builder.build()).mentionRepliedUser(false).queue();\n+\n+\n+    }\n+}"
  },
  {
    "sha": "6d951412bf5bd005d6c98489daf7c14e611cb9e5",
    "filename": "src/main/java/xyz/kyngs/herbot/handlers/command/commands/economy/GambleCommand.java",
    "status": "added",
    "additions": 63,
    "deletions": 0,
    "changes": 63,
    "blob_url": "https://github.com/kyngs/HerBot/blob/d61df78a83e128b690284eba59772b9b9bc16b59/src/main/java/xyz/kyngs/herbot/handlers/command/commands/economy/GambleCommand.java",
    "raw_url": "https://github.com/kyngs/HerBot/raw/d61df78a83e128b690284eba59772b9b9bc16b59/src/main/java/xyz/kyngs/herbot/handlers/command/commands/economy/GambleCommand.java",
    "contents_url": "https://api.github.com/repos/kyngs/HerBot/contents/src/main/java/xyz/kyngs/herbot/handlers/command/commands/economy/GambleCommand.java?ref=d61df78a83e128b690284eba59772b9b9bc16b59",
    "patch": "@@ -0,0 +1,63 @@\n+package xyz.kyngs.herbot.handlers.command.commands.economy;\n+\n+import net.dv8tion.jda.api.EmbedBuilder;\n+import net.dv8tion.jda.api.entities.Guild;\n+import net.dv8tion.jda.api.entities.Message;\n+import net.dv8tion.jda.api.entities.TextChannel;\n+import net.dv8tion.jda.api.entities.User;\n+import net.dv8tion.jda.api.events.message.guild.GuildMessageReceivedEvent;\n+import xyz.kyngs.herbot.HerBot;\n+import xyz.kyngs.herbot.handlers.command.AbstractCommand;\n+import xyz.kyngs.herbot.handlers.user.UserProfile;\n+\n+import java.awt.*;\n+import java.util.concurrent.ThreadLocalRandom;\n+\n+public class GambleCommand extends AbstractCommand {\n+\n+    public GambleCommand(HerBot herBot, String description) {\n+        super(herBot, description, \"\");\n+        addArg(Integer.class, \"sázka\");\n+    }\n+\n+    @Override\n+    public void exec(User author, Guild guild, TextChannel channel, Message message, String[] args, UserProfile profile, GuildMessageReceivedEvent event) {\n+        var random = ThreadLocalRandom.current();\n+\n+        var amount = Integer.parseInt(args[0]);\n+\n+        if (amount < 0) {\n+            var builder = new EmbedBuilder();\n+            builder.setTitle(\"Sázka nemůže být negativní\");\n+            builder.setColor(Color.RED);\n+            message.reply(builder.build()).mentionRepliedUser(false).queue();\n+            return;\n+        }\n+\n+        if (amount > profile.getCoins()) {\n+            var builder = new EmbedBuilder();\n+            builder.setTitle(\"Na tuto akci nemáš dostatek prostředků\");\n+            builder.setColor(Color.RED);\n+            message.reply(builder.build()).mentionRepliedUser(false).queue();\n+            return;\n+        }\n+\n+        boolean win = random.nextInt(100) > 50;\n+        var builder = new EmbedBuilder();\n+\n+        if (win) {\n+            builder.setColor(Color.GREEN);\n+            builder.setTitle(\"Výhra\");\n+            builder.setDescription(String.format(\"Na účet ti bylo přidáno %s coinů\", amount));\n+            profile.addCoins(amount);\n+        } else {\n+            builder.setColor(Color.RED);\n+            builder.setTitle(\"Prohra\");\n+            builder.setDescription(String.format(\"Z účtu ti bylo odebráno %s coinů\", amount));\n+            profile.removeCoins(amount);\n+        }\n+\n+        message.reply(builder.build()).mentionRepliedUser(false).queue();\n+\n+    }\n+}"
  },
  {
    "sha": "0c8821443ab48e7cc26cd91c4780ed666f311654",
    "filename": "src/main/java/xyz/kyngs/herbot/handlers/command/commands/economy/PayCommand.java",
    "status": "added",
    "additions": 61,
    "deletions": 0,
    "changes": 61,
    "blob_url": "https://github.com/kyngs/HerBot/blob/d61df78a83e128b690284eba59772b9b9bc16b59/src/main/java/xyz/kyngs/herbot/handlers/command/commands/economy/PayCommand.java",
    "raw_url": "https://github.com/kyngs/HerBot/raw/d61df78a83e128b690284eba59772b9b9bc16b59/src/main/java/xyz/kyngs/herbot/handlers/command/commands/economy/PayCommand.java",
    "contents_url": "https://api.github.com/repos/kyngs/HerBot/contents/src/main/java/xyz/kyngs/herbot/handlers/command/commands/economy/PayCommand.java?ref=d61df78a83e128b690284eba59772b9b9bc16b59",
    "patch": "@@ -0,0 +1,61 @@\n+package xyz.kyngs.herbot.handlers.command.commands.economy;\n+\n+import net.dv8tion.jda.api.EmbedBuilder;\n+import net.dv8tion.jda.api.entities.Guild;\n+import net.dv8tion.jda.api.entities.Message;\n+import net.dv8tion.jda.api.entities.TextChannel;\n+import net.dv8tion.jda.api.entities.User;\n+import net.dv8tion.jda.api.events.message.guild.GuildMessageReceivedEvent;\n+import xyz.kyngs.herbot.HerBot;\n+import xyz.kyngs.herbot.handlers.command.AbstractCommand;\n+import xyz.kyngs.herbot.handlers.user.UserProfile;\n+import xyz.kyngs.herbot.util.MemberUtil;\n+\n+import java.awt.*;\n+\n+public class PayCommand extends AbstractCommand {\n+\n+    public PayCommand(HerBot herBot, String description) {\n+        super(herBot, description, \"\");\n+        addArg(String.class, \"uživatel\");\n+        addArg(Integer.class, \"částka\");\n+    }\n+\n+    @Override\n+    public void exec(User author, Guild guild, TextChannel channel, Message message, String[] args, UserProfile profile, GuildMessageReceivedEvent event) {\n+        var user = MemberUtil.getUser(args[0], herBot.getJda());\n+        if (user == null) {\n+            message.reply(\"Uživatel nenalezen!\").mentionRepliedUser(false).queue();\n+            return;\n+        }\n+        var amount = Integer.parseInt(args[1]);\n+\n+        if (amount < 0) {\n+            var builder = new EmbedBuilder();\n+            builder.setTitle(\"Hodnota nemůže být negativní\");\n+            builder.setColor(Color.RED);\n+            message.reply(builder.build()).mentionRepliedUser(false).queue();\n+            return;\n+        }\n+\n+        if (amount > profile.getCoins()) {\n+            var builder = new EmbedBuilder();\n+            builder.setTitle(\"Na tuto akci nemáš dostatek prostředků\");\n+            builder.setColor(Color.RED);\n+            message.reply(builder.build()).mentionRepliedUser(false).queue();\n+            return;\n+        }\n+\n+        var targetProfile = herBot.getUserHandler().getUser(user.getId());\n+        profile.removeCoins(amount);\n+        targetProfile.addCoins(amount);\n+\n+        var builder = new EmbedBuilder();\n+\n+        builder.setColor(Color.GREEN);\n+        builder.setTitle(\"Úspěch\");\n+        builder.setDescription(\"Coiny odeslány\");\n+\n+        message.reply(builder.build()).mentionRepliedUser(false).queue();\n+    }\n+}"
  },
  {
    "sha": "2c19672c1f1f6bf61cdb646090ee452653454b54",
    "filename": "src/main/java/xyz/kyngs/herbot/handlers/command/commands/info/HelpCommand.java",
    "status": "renamed",
    "additions": 4,
    "deletions": 3,
    "changes": 7,
    "blob_url": "https://github.com/kyngs/HerBot/blob/d61df78a83e128b690284eba59772b9b9bc16b59/src/main/java/xyz/kyngs/herbot/handlers/command/commands/info/HelpCommand.java",
    "raw_url": "https://github.com/kyngs/HerBot/raw/d61df78a83e128b690284eba59772b9b9bc16b59/src/main/java/xyz/kyngs/herbot/handlers/command/commands/info/HelpCommand.java",
    "contents_url": "https://api.github.com/repos/kyngs/HerBot/contents/src/main/java/xyz/kyngs/herbot/handlers/command/commands/info/HelpCommand.java?ref=d61df78a83e128b690284eba59772b9b9bc16b59",
    "patch": "@@ -1,4 +1,4 @@\n-package xyz.kyngs.herbot.handlers.command.commands;\n+package xyz.kyngs.herbot.handlers.command.commands.info;\n \n import net.dv8tion.jda.api.EmbedBuilder;\n import net.dv8tion.jda.api.MessageBuilder;\n@@ -9,6 +9,7 @@\n import net.dv8tion.jda.api.events.message.guild.GuildMessageReceivedEvent;\n import xyz.kyngs.herbot.HerBot;\n import xyz.kyngs.herbot.handlers.command.AbstractCommand;\n+import xyz.kyngs.herbot.handlers.user.UserProfile;\n \n import java.awt.*;\n import java.util.ArrayList;\n@@ -19,11 +20,11 @@\n public class HelpCommand extends AbstractCommand {\n \n     public HelpCommand(HerBot herBot, String description) {\n-        super(herBot, description);\n+        super(herBot, description, \"\");\n     }\n \n     @Override\n-    public void onCommand(User author, Guild guild, TextChannel channel, Message message, String[] args, GuildMessageReceivedEvent event) {\n+    public void exec(User author, Guild guild, TextChannel channel, Message message, String[] args, UserProfile profile, GuildMessageReceivedEvent event) {\n         var commandHandler = herBot.getCommandHandler();\n \n         var out = new MessageBuilder();",
    "previous_filename": "src/main/java/xyz/kyngs/herbot/handlers/command/commands/HelpCommand.java"
  },
  {
    "sha": "814aca4cdcee5d5e0d452c43604e22d27c1b201f",
    "filename": "src/main/java/xyz/kyngs/herbot/handlers/command/commands/info/InfoCommand.java",
    "status": "renamed",
    "additions": 6,
    "deletions": 5,
    "changes": 11,
    "blob_url": "https://github.com/kyngs/HerBot/blob/d61df78a83e128b690284eba59772b9b9bc16b59/src/main/java/xyz/kyngs/herbot/handlers/command/commands/info/InfoCommand.java",
    "raw_url": "https://github.com/kyngs/HerBot/raw/d61df78a83e128b690284eba59772b9b9bc16b59/src/main/java/xyz/kyngs/herbot/handlers/command/commands/info/InfoCommand.java",
    "contents_url": "https://api.github.com/repos/kyngs/HerBot/contents/src/main/java/xyz/kyngs/herbot/handlers/command/commands/info/InfoCommand.java?ref=d61df78a83e128b690284eba59772b9b9bc16b59",
    "patch": "@@ -1,4 +1,4 @@\n-package xyz.kyngs.herbot.handlers.command.commands;\n+package xyz.kyngs.herbot.handlers.command.commands.info;\n \n import net.dv8tion.jda.api.EmbedBuilder;\n import net.dv8tion.jda.api.entities.Guild;\n@@ -8,21 +8,22 @@\n import net.dv8tion.jda.api.events.message.guild.GuildMessageReceivedEvent;\n import xyz.kyngs.herbot.HerBot;\n import xyz.kyngs.herbot.handlers.command.AbstractCommand;\n+import xyz.kyngs.herbot.handlers.user.UserProfile;\n \n import java.awt.*;\n \n public class InfoCommand extends AbstractCommand {\n     public InfoCommand(HerBot herBot, String description) {\n-        super(herBot, description);\n+        super(herBot, description, \"\");\n     }\n \n     @Override\n-    public void onCommand(User author, Guild guild, TextChannel channel, Message message, String[] args, GuildMessageReceivedEvent event) {\n+    public void exec(User author, Guild guild, TextChannel channel, Message message, String[] args, UserProfile profile, GuildMessageReceivedEvent event) {\n         var builder = new EmbedBuilder();\n \n         builder.setTitle(\"Informace\");\n-        builder.addField(\"Verze:\", \"1.1\", false);\n-        builder.addField(\"Sestavení:\", \"3\", false);\n+        builder.addField(\"Verze:\", \"1.2\", false);\n+        builder.addField(\"Sestavení:\", \"4\", false);\n         builder.addField(\"Máš nějaký dotaz k botovi, nebo jsi našel chybu? Zkontaktuj mě.\", \"Discord: kyngs#0666 Twitch: kyngskyngs\", false);\n         builder.setColor(Color.GREEN);\n ",
    "previous_filename": "src/main/java/xyz/kyngs/herbot/handlers/command/commands/InfoCommand.java"
  },
  {
    "sha": "91d675569a1c169b3bb887ab27495bb9b7a866d8",
    "filename": "src/main/java/xyz/kyngs/herbot/handlers/user/UserHandler.java",
    "status": "added",
    "additions": 64,
    "deletions": 0,
    "changes": 64,
    "blob_url": "https://github.com/kyngs/HerBot/blob/d61df78a83e128b690284eba59772b9b9bc16b59/src/main/java/xyz/kyngs/herbot/handlers/user/UserHandler.java",
    "raw_url": "https://github.com/kyngs/HerBot/raw/d61df78a83e128b690284eba59772b9b9bc16b59/src/main/java/xyz/kyngs/herbot/handlers/user/UserHandler.java",
    "contents_url": "https://api.github.com/repos/kyngs/HerBot/contents/src/main/java/xyz/kyngs/herbot/handlers/user/UserHandler.java?ref=d61df78a83e128b690284eba59772b9b9bc16b59",
    "patch": "@@ -0,0 +1,64 @@\n+package xyz.kyngs.herbot.handlers.user;\n+\n+import xyz.kyngs.herbot.HerBot;\n+import xyz.kyngs.herbot.handlers.AbstractHandler;\n+import xyz.kyngs.herbot.util.ListUtil;\n+\n+import java.sql.Date;\n+import java.time.LocalDate;\n+import java.util.ArrayList;\n+import java.util.HashMap;\n+import java.util.Map;\n+import java.util.concurrent.CompletableFuture;\n+\n+public class UserHandler extends AbstractHandler {\n+\n+    private final Map<String, UserProfile> cache;\n+\n+    public UserHandler(HerBot herBot) {\n+        super(herBot);\n+        cache = new HashMap<>();\n+    }\n+\n+    public UserProfile getUser(String userID) {\n+        return cache.computeIfAbsent(userID, k -> {\n+            var databaseManager = herBot.getDatabaseManager();\n+            var future = new CompletableFuture<UserProfile>();\n+            databaseManager.getMySQL().sync().schedule(connection -> {\n+                var ps = connection.prepareStatement(\"SELECT coins, xp, daily_streak, last_daily_claim, permissions FROM user_data WHERE user_id=?\");\n+                ps.setString(1, userID);\n+                var rs = ps.executeQuery();\n+\n+                if (!rs.next()) {\n+                    var user = new UserProfile(5000, 0, -1, LocalDate.now().minusDays(1), new ArrayList<>());\n+                    saveUser(user, userID);\n+                    future.complete(user);\n+                    return;\n+                }\n+\n+                var user = new UserProfile(rs.getLong(\"coins\"), rs.getLong(\"xp\"), rs.getInt(\"daily_streak\"), rs.getDate(\"last_daily_claim\").toLocalDate(), ListUtil.deserializeList(rs.getString(\"permissions\")));\n+\n+                future.complete(user);\n+\n+            });\n+            return future.getNow(null);\n+        });\n+    }\n+\n+    public void saveUser(UserProfile userProfile, String userID) {\n+        herBot.getDatabaseManager().getMySQL().sync().schedule(connection -> {\n+            var ps = connection.prepareStatement(\"REPLACE user_data(coins, user_id, xp, daily_streak, last_daily_claim, permissions) VALUES (?, ?, ?, ?, ?, ?) \");\n+\n+            ps.setLong(1, userProfile.getCoins());\n+            ps.setString(2, userID);\n+            ps.setLong(3, userProfile.getXp());\n+            ps.setInt(4, userProfile.getDailyStreak());\n+            ps.setDate(5, Date.valueOf(userProfile.getLastDailyClaim()));\n+            ps.setString(6, ListUtil.serializeList(userProfile.getPerms()));\n+\n+            ps.execute();\n+\n+        });\n+    }\n+\n+}"
  },
  {
    "sha": "4551c4b83ca953cdf436452220176ed7a1e54f0f",
    "filename": "src/main/java/xyz/kyngs/herbot/handlers/user/UserProfile.java",
    "status": "added",
    "additions": 77,
    "deletions": 0,
    "changes": 77,
    "blob_url": "https://github.com/kyngs/HerBot/blob/d61df78a83e128b690284eba59772b9b9bc16b59/src/main/java/xyz/kyngs/herbot/handlers/user/UserProfile.java",
    "raw_url": "https://github.com/kyngs/HerBot/raw/d61df78a83e128b690284eba59772b9b9bc16b59/src/main/java/xyz/kyngs/herbot/handlers/user/UserProfile.java",
    "contents_url": "https://api.github.com/repos/kyngs/HerBot/contents/src/main/java/xyz/kyngs/herbot/handlers/user/UserProfile.java?ref=d61df78a83e128b690284eba59772b9b9bc16b59",
    "patch": "@@ -0,0 +1,77 @@\n+package xyz.kyngs.herbot.handlers.user;\n+\n+import java.time.LocalDate;\n+import java.util.List;\n+\n+public class UserProfile {\n+\n+    private final List<String> perms;\n+    private long coins;\n+    private long xp;\n+    private int dailyStreak;\n+    private LocalDate lastDailyClaim;\n+\n+    public UserProfile(long coins, long xp, int dailyStreak, LocalDate lastDailyClaim, List<String> perms) {\n+        this.coins = coins;\n+        this.xp = xp;\n+        this.dailyStreak = dailyStreak;\n+        this.lastDailyClaim = lastDailyClaim;\n+        this.perms = perms;\n+    }\n+\n+    public boolean hasPermission(String perm) {\n+        return perm.contentEquals(\"\") || perms.contains(\"*\") || perms.contains(perm);\n+    }\n+\n+    public long getCoins() {\n+        return coins;\n+    }\n+\n+    public void setCoins(long coins) {\n+        this.coins = coins;\n+    }\n+\n+    public long getXp() {\n+        return xp;\n+    }\n+\n+    public void setXp(long xp) {\n+        this.xp = xp;\n+    }\n+\n+    public int getDailyStreak() {\n+        return dailyStreak;\n+    }\n+\n+    public void setDailyStreak(int dailyStreak) {\n+        this.dailyStreak = dailyStreak;\n+    }\n+\n+    public LocalDate getLastDailyClaim() {\n+        return lastDailyClaim;\n+    }\n+\n+    public void setLastDailyClaim(LocalDate lastDailyClaim) {\n+        this.lastDailyClaim = lastDailyClaim;\n+    }\n+\n+    public List<String> getPerms() {\n+        return perms;\n+    }\n+\n+    public void allowPermission(String perm) {\n+        perms.add(perm);\n+    }\n+\n+    public void declinePermission(String perm) {\n+        perms.remove(perm);\n+    }\n+\n+    public void addCoins(int toAdd) {\n+        coins += toAdd;\n+    }\n+\n+    public void removeCoins(int toRemove) {\n+        coins -= toRemove;\n+    }\n+}"
  },
  {
    "sha": "cdeb601fc9880c96e98b62bd6bb01ecd3885deed",
    "filename": "src/main/java/xyz/kyngs/herbot/util/Argument.java",
    "status": "added",
    "additions": 20,
    "deletions": 0,
    "changes": 20,
    "blob_url": "https://github.com/kyngs/HerBot/blob/d61df78a83e128b690284eba59772b9b9bc16b59/src/main/java/xyz/kyngs/herbot/util/Argument.java",
    "raw_url": "https://github.com/kyngs/HerBot/raw/d61df78a83e128b690284eba59772b9b9bc16b59/src/main/java/xyz/kyngs/herbot/util/Argument.java",
    "contents_url": "https://api.github.com/repos/kyngs/HerBot/contents/src/main/java/xyz/kyngs/herbot/util/Argument.java?ref=d61df78a83e128b690284eba59772b9b9bc16b59",
    "patch": "@@ -0,0 +1,20 @@\n+package xyz.kyngs.herbot.util;\n+\n+public class Argument<T> {\n+\n+    private final Class<T> type;\n+    private final String[] options;\n+\n+    public Argument(Class<T> type, String... options) {\n+        this.type = type;\n+        this.options = options;\n+    }\n+\n+    public Class<T> getType() {\n+        return type;\n+    }\n+\n+    public String[] getOptions() {\n+        return options;\n+    }\n+}"
  },
  {
    "sha": "f4d2a83677c63fab72d32e058492bcb1a92a6b68",
    "filename": "src/main/java/xyz/kyngs/herbot/util/ClassType.java",
    "status": "added",
    "additions": 16,
    "deletions": 0,
    "changes": 16,
    "blob_url": "https://github.com/kyngs/HerBot/blob/d61df78a83e128b690284eba59772b9b9bc16b59/src/main/java/xyz/kyngs/herbot/util/ClassType.java",
    "raw_url": "https://github.com/kyngs/HerBot/raw/d61df78a83e128b690284eba59772b9b9bc16b59/src/main/java/xyz/kyngs/herbot/util/ClassType.java",
    "contents_url": "https://api.github.com/repos/kyngs/HerBot/contents/src/main/java/xyz/kyngs/herbot/util/ClassType.java?ref=d61df78a83e128b690284eba59772b9b9bc16b59",
    "patch": "@@ -0,0 +1,16 @@\n+package xyz.kyngs.herbot.util;\n+\n+public enum ClassType {\n+\n+    NUMBER(\"číslo\"), TEXT(\"text\"), UNKNOWN(\"cokoliv\");\n+\n+    private final String name;\n+\n+    ClassType(String name) {\n+        this.name = name;\n+    }\n+\n+    public String getName() {\n+        return name;\n+    }\n+}"
  },
  {
    "sha": "bab8b83fd4e4725a5ee6f17231be2e8faaf584dc",
    "filename": "src/main/java/xyz/kyngs/herbot/util/ClassUtil.java",
    "status": "added",
    "additions": 20,
    "deletions": 0,
    "changes": 20,
    "blob_url": "https://github.com/kyngs/HerBot/blob/d61df78a83e128b690284eba59772b9b9bc16b59/src/main/java/xyz/kyngs/herbot/util/ClassUtil.java",
    "raw_url": "https://github.com/kyngs/HerBot/raw/d61df78a83e128b690284eba59772b9b9bc16b59/src/main/java/xyz/kyngs/herbot/util/ClassUtil.java",
    "contents_url": "https://api.github.com/repos/kyngs/HerBot/contents/src/main/java/xyz/kyngs/herbot/util/ClassUtil.java?ref=d61df78a83e128b690284eba59772b9b9bc16b59",
    "patch": "@@ -0,0 +1,20 @@\n+package xyz.kyngs.herbot.util;\n+\n+import static xyz.kyngs.herbot.util.ClassType.*;\n+\n+public class ClassUtil {\n+\n+    public static <T> ClassType classify(Class source) {\n+        if (classify(source, String.class)) {\n+            return TEXT;\n+        } else if (classify(source, Integer.class) || classify(source, Long.class)) {\n+            return NUMBER;\n+        }\n+        return UNKNOWN;\n+    }\n+\n+    private static <T> boolean classify(Class source, Class<T> target) {\n+        return source.equals(target);\n+    }\n+\n+}"
  },
  {
    "sha": "463a39ba244eab57dfcb19dc87ba50e3696c88fc",
    "filename": "src/main/java/xyz/kyngs/herbot/util/ExceptionUtil.java",
    "status": "added",
    "additions": 14,
    "deletions": 0,
    "changes": 14,
    "blob_url": "https://github.com/kyngs/HerBot/blob/d61df78a83e128b690284eba59772b9b9bc16b59/src/main/java/xyz/kyngs/herbot/util/ExceptionUtil.java",
    "raw_url": "https://github.com/kyngs/HerBot/raw/d61df78a83e128b690284eba59772b9b9bc16b59/src/main/java/xyz/kyngs/herbot/util/ExceptionUtil.java",
    "contents_url": "https://api.github.com/repos/kyngs/HerBot/contents/src/main/java/xyz/kyngs/herbot/util/ExceptionUtil.java?ref=d61df78a83e128b690284eba59772b9b9bc16b59",
    "patch": "@@ -0,0 +1,14 @@\n+package xyz.kyngs.herbot.util;\n+\n+public class ExceptionUtil {\n+\n+    public static boolean completedExceptionally(Runnable action) {\n+        try {\n+            action.run();\n+            return false;\n+        } catch (Exception e) {\n+            return true;\n+        }\n+    }\n+\n+}"
  },
  {
    "sha": "3c60e0cad2199771fc9342780351220dbc31582e",
    "filename": "src/main/java/xyz/kyngs/herbot/util/ListUtil.java",
    "status": "added",
    "additions": 19,
    "deletions": 0,
    "changes": 19,
    "blob_url": "https://github.com/kyngs/HerBot/blob/d61df78a83e128b690284eba59772b9b9bc16b59/src/main/java/xyz/kyngs/herbot/util/ListUtil.java",
    "raw_url": "https://github.com/kyngs/HerBot/raw/d61df78a83e128b690284eba59772b9b9bc16b59/src/main/java/xyz/kyngs/herbot/util/ListUtil.java",
    "contents_url": "https://api.github.com/repos/kyngs/HerBot/contents/src/main/java/xyz/kyngs/herbot/util/ListUtil.java?ref=d61df78a83e128b690284eba59772b9b9bc16b59",
    "patch": "@@ -0,0 +1,19 @@\n+package xyz.kyngs.herbot.util;\n+\n+import java.util.ArrayList;\n+import java.util.Arrays;\n+import java.util.List;\n+\n+import static java.lang.String.join;\n+\n+public class ListUtil {\n+\n+    public static String serializeList(List<? extends CharSequence> list) {\n+        return join(\",\", list);\n+    }\n+\n+    public static List<String> deserializeList(String string) {\n+        return new ArrayList<>(Arrays.asList(string.split(\",\")));\n+    }\n+\n+}"
  },
  {
    "sha": "2d8e08e3fc0ae428a1d23d9f834824714a174699",
    "filename": "src/main/java/xyz/kyngs/herbot/util/MemberUtil.java",
    "status": "added",
    "additions": 28,
    "deletions": 0,
    "changes": 28,
    "blob_url": "https://github.com/kyngs/HerBot/blob/d61df78a83e128b690284eba59772b9b9bc16b59/src/main/java/xyz/kyngs/herbot/util/MemberUtil.java",
    "raw_url": "https://github.com/kyngs/HerBot/raw/d61df78a83e128b690284eba59772b9b9bc16b59/src/main/java/xyz/kyngs/herbot/util/MemberUtil.java",
    "contents_url": "https://api.github.com/repos/kyngs/HerBot/contents/src/main/java/xyz/kyngs/herbot/util/MemberUtil.java?ref=d61df78a83e128b690284eba59772b9b9bc16b59",
    "patch": "@@ -0,0 +1,28 @@\n+package xyz.kyngs.herbot.util;\n+\n+import net.dv8tion.jda.api.JDA;\n+import net.dv8tion.jda.api.entities.User;\n+\n+public class MemberUtil {\n+\n+    public static User getUser(String name, JDA jda) {\n+        try {\n+            User byID = jda.getUserById(name);\n+            if (byID != null) return byID;\n+        } catch (Exception ignored) {\n+        }\n+        try {\n+            User byTag = jda.getUserByTag(name);\n+            if (byTag != null) return byTag;\n+        } catch (Exception ignored) {\n+        }\n+\n+        var list = jda.getUsersByName(name, false);\n+\n+        if (list.size() == 1) return list.get(0);\n+\n+        return null;\n+\n+    }\n+\n+}"
  }
]

[
  {
    "sha": "019a88cb2ff66ba1be146ea6ec1d56a4ffca87c9",
    "filename": "src/main/java/com/example/volunteer/Controller/SwiperContorller.java",
    "status": "modified",
    "additions": 9,
    "deletions": 5,
    "changes": 14,
    "blob_url": "https://github.com/zwh1314/volunteer/blob/55b6ad63b58bdb675bd6cc7dce20d71435ef2b8a/src/main/java/com/example/volunteer/Controller/SwiperContorller.java",
    "raw_url": "https://github.com/zwh1314/volunteer/raw/55b6ad63b58bdb675bd6cc7dce20d71435ef2b8a/src/main/java/com/example/volunteer/Controller/SwiperContorller.java",
    "contents_url": "https://api.github.com/repos/zwh1314/volunteer/contents/src/main/java/com/example/volunteer/Controller/SwiperContorller.java?ref=55b6ad63b58bdb675bd6cc7dce20d71435ef2b8a",
    "patch": "@@ -76,20 +76,24 @@\n \n     @PostMapping(\"/addSwiper\")\n     @ApiOperation(\"添加轮播图\")\n-    public Response<Boolean> addSwiper(@RequestParam(\"newsId\") long newsId, @RequestParam(\"file\") MultipartFile uploadFile) {\n+    @ApiImplicitParams({\n+            @ApiImplicitParam(name = \"newsId\", value = \"新闻id\", paramType = \"query\", dataType = \"long\"),\n+            @ApiImplicitParam(name = \"swiper_picture\", value = \"轮播图图片\", paramType = \"query\", dataType = \"MultipartFile\"),\n+    })\n+    public Response<Boolean> addSwiper(@RequestParam(\"newsId\") long newsId, @RequestParam(\"swiper_picture\") MultipartFile swiper_picture) {\n         Response<Boolean> response = new Response<>();\n         try {\n-            return swiperService.addSwiper(newsId,uploadFile);\n+            return swiperService.addSwiper(newsId,swiper_picture);\n         } catch (IllegalArgumentException e) {\n-            logger.warn(\"[addSwiper Illegal Argument], uploadFile: {}\", uploadFile.getOriginalFilename(), e);\n+            logger.warn(\"[addSwiper Illegal Argument], swiper_picture: {}\", swiper_picture.getOriginalFilename(), e);\n             response.setFail(ResponseEnum.ILLEGAL_PARAM);\n             return response;\n         } catch (VolunteerRuntimeException e) {\n-            logger.error(\"[addSwiper Runtime Exception], uploadFile: {}\", uploadFile.getOriginalFilename(), e);\n+            logger.error(\"[addSwiper Runtime Exception], swiper_picture: {}\", swiper_picture.getOriginalFilename(), e);\n             response.setFail(e.getExceptionCode(), e.getMessage());\n             return response;\n         }  catch (Exception e) {\n-            logger.error(\"[addSwiper Exception], uploadFile: {}\", uploadFile.getOriginalFilename(), e);\n+            logger.error(\"[addSwiper Exception], swiper_picture: {}\", swiper_picture.getOriginalFilename(), e);\n             response.setFail(ResponseEnum.SERVER_ERROR);\n             return response;\n         }"
  },
  {
    "sha": "05e4c261e63364ee2fb743b60dc6395586fb3d78",
    "filename": "src/main/java/com/example/volunteer/Controller/UserInfoController.java",
    "status": "modified",
    "additions": 27,
    "deletions": 0,
    "changes": 27,
    "blob_url": "https://github.com/zwh1314/volunteer/blob/55b6ad63b58bdb675bd6cc7dce20d71435ef2b8a/src/main/java/com/example/volunteer/Controller/UserInfoController.java",
    "raw_url": "https://github.com/zwh1314/volunteer/raw/55b6ad63b58bdb675bd6cc7dce20d71435ef2b8a/src/main/java/com/example/volunteer/Controller/UserInfoController.java",
    "contents_url": "https://api.github.com/repos/zwh1314/volunteer/contents/src/main/java/com/example/volunteer/Controller/UserInfoController.java?ref=55b6ad63b58bdb675bd6cc7dce20d71435ef2b8a",
    "patch": "@@ -16,6 +16,7 @@\n import org.slf4j.LoggerFactory;\n import org.springframework.beans.factory.annotation.Autowired;\n import org.springframework.web.bind.annotation.*;\n+import org.springframework.web.multipart.MultipartFile;\n \n @Api(tags = \"用户信息Controller\")\n @RestController\n@@ -73,6 +74,32 @@\n         }\n     }\n \n+    @PostMapping(\"/updateHeadPicture\")\n+    @ApiOperation(\"更新个人头像\")\n+    @ApiImplicitParams({\n+            @ApiImplicitParam(name = \"headPicture\", value = \"个人头像图片\", paramType = \"query\", dataType = \"MultipartFile\"),\n+    })\n+    public Response<String> updateHeadPicture(@RequestParam(\"headPicture\") MultipartFile headPicture) {\n+        Response<String> response = new Response<>();\n+        long userId = getUserId();\n+        try {\n+            validateUserId(userId);\n+            return userInfoService.updateHeadPicture(userId,headPicture);\n+        } catch (IllegalArgumentException e) {\n+            logger.warn(\"[updateHeadPicture Illegal Argument], headPicture: {}\", headPicture, e);\n+            response.setFail(ResponseEnum.ILLEGAL_PARAM);\n+            return response;\n+        } catch (VolunteerRuntimeException e) {\n+            logger.error(\"[updateHeadPicture Runtime Exception], headPicture: {}\", headPicture, e);\n+            response.setFail(e.getExceptionCode(), e.getMessage());\n+            return response;\n+        }  catch (Exception e) {\n+            logger.error(\"[updateHeadPicture Exception], headPicture: {}\", headPicture, e);\n+            response.setFail(ResponseEnum.SERVER_ERROR);\n+            return response;\n+        }\n+    }\n+\n     @PostMapping(\"/updateUserInfoByUserId\")\n     @ApiOperation(\"更新用户信息By userId\")\n     public Response<Boolean> updateUserInfoByUserId(@RequestBody UserInfoRequest userInfoRequest) {"
  },
  {
    "sha": "b0b0c90d0843cce5fe7b3e89ad7855f04f1930cb",
    "filename": "src/main/java/com/example/volunteer/Controller/VideoController.java",
    "status": "modified",
    "additions": 14,
    "deletions": 6,
    "changes": 20,
    "blob_url": "https://github.com/zwh1314/volunteer/blob/55b6ad63b58bdb675bd6cc7dce20d71435ef2b8a/src/main/java/com/example/volunteer/Controller/VideoController.java",
    "raw_url": "https://github.com/zwh1314/volunteer/raw/55b6ad63b58bdb675bd6cc7dce20d71435ef2b8a/src/main/java/com/example/volunteer/Controller/VideoController.java",
    "contents_url": "https://api.github.com/repos/zwh1314/volunteer/contents/src/main/java/com/example/volunteer/Controller/VideoController.java?ref=55b6ad63b58bdb675bd6cc7dce20d71435ef2b8a",
    "patch": "@@ -5,7 +5,6 @@\n import com.example.volunteer.Exception.VolunteerRuntimeException;\n \n import com.example.volunteer.RedisService.VideoRedisService;\n-import com.example.volunteer.Request.VideoRequest;\n import com.example.volunteer.Response.Response;\n import com.example.volunteer.Service.VideoService;\n import com.example.volunteer.enums.ResponseEnum;\n@@ -17,6 +16,7 @@\n import org.slf4j.LoggerFactory;\n import org.springframework.beans.factory.annotation.Autowired;\n import org.springframework.web.bind.annotation.*;\n+import org.springframework.web.multipart.MultipartFile;\n \n import java.util.List;\n \n@@ -99,20 +99,28 @@\n \n     @PostMapping(\"/addVideo\")\n     @ApiOperation(\"添加视频\")\n-    public Response<Boolean> addVideo(@RequestBody VideoRequest videoRequest) {\n+    public Response<Boolean> addVideo(@RequestParam(\"videoTitle\")String videoTitle, @RequestParam(\"videoText\")String videoText,\n+                                      @RequestParam(\"video_mp4\")MultipartFile video_mp4) {\n         Response<Boolean> response = new Response<>();\n+        long userId = getUserId();\n         try {\n-            return videoService.addVideo(videoRequest);\n+            Video video = new Video();\n+            video.setVideoTitle(videoTitle);\n+            video.setVideoText(videoText);\n+            video.setVideoPublisher(userId);\n+            video.setVideoLike(0);\n+            video.setVideoPlayNum(0);\n+            return videoService.addVideo(video,video_mp4);\n         } catch (IllegalArgumentException e) {\n-            logger.warn(\"[addVideo Illegal Argument], videoRequest: {}\", videoRequest, e);\n+            logger.warn(\"[addVideo Illegal Argument], video_mp4: {}\", video_mp4, e);\n             response.setFail(ResponseEnum.ILLEGAL_PARAM);\n             return response;\n         } catch (VolunteerRuntimeException e) {\n-            logger.error(\"[addVideo Runtime Exception], videoRequest: {}\", videoRequest, e);\n+            logger.error(\"[addVideo Runtime Exception], video_mp4: {}\", video_mp4, e);\n             response.setFail(e.getExceptionCode(), e.getMessage());\n             return response;\n         }  catch (Exception e) {\n-            logger.error(\"[addVideo Exception], videoRequest: {}\", videoRequest, e);\n+            logger.error(\"[addVideo Exception], video_mp4: {}\", video_mp4, e);\n             response.setFail(ResponseEnum.SERVER_ERROR);\n             return response;\n         }"
  },
  {
    "sha": "b6a5356a181be8271efeedb384a2c09d6d836120",
    "filename": "src/main/java/com/example/volunteer/Dao/UserInfoDao.java",
    "status": "modified",
    "additions": 1,
    "deletions": 1,
    "changes": 2,
    "blob_url": "https://github.com/zwh1314/volunteer/blob/55b6ad63b58bdb675bd6cc7dce20d71435ef2b8a/src/main/java/com/example/volunteer/Dao/UserInfoDao.java",
    "raw_url": "https://github.com/zwh1314/volunteer/raw/55b6ad63b58bdb675bd6cc7dce20d71435ef2b8a/src/main/java/com/example/volunteer/Dao/UserInfoDao.java",
    "contents_url": "https://api.github.com/repos/zwh1314/volunteer/contents/src/main/java/com/example/volunteer/Dao/UserInfoDao.java?ref=55b6ad63b58bdb675bd6cc7dce20d71435ef2b8a",
    "patch": "@@ -32,7 +32,7 @@\n     int updatePriority(@Param(\"userId\") String userId, @Param(\"priority\") String priority);\n \n     @Update(\"UPDATE user_info SET head_picture = #{headPicture} WHERE user_id = #{userId}\")\n-    int updateHeadPicture(@Param(\"userId\") String userId, @Param(\"headPicture\") String headPicture);\n+    int updateHeadPicture(@Param(\"userId\") long userId, @Param(\"headPicture\") String headPicture);\n \n     @Delete(\"DELETE FROM user_info WHERE user_id = #{userId}\")\n     int deleteUserInfoByUserId(@Param(\"userId\")long userId);"
  },
  {
    "sha": "cf50edecc68648801dbea4597f9066757587e3ba",
    "filename": "src/main/java/com/example/volunteer/Dao/VideoDao.java",
    "status": "modified",
    "additions": 11,
    "deletions": 8,
    "changes": 19,
    "blob_url": "https://github.com/zwh1314/volunteer/blob/55b6ad63b58bdb675bd6cc7dce20d71435ef2b8a/src/main/java/com/example/volunteer/Dao/VideoDao.java",
    "raw_url": "https://github.com/zwh1314/volunteer/raw/55b6ad63b58bdb675bd6cc7dce20d71435ef2b8a/src/main/java/com/example/volunteer/Dao/VideoDao.java",
    "contents_url": "https://api.github.com/repos/zwh1314/volunteer/contents/src/main/java/com/example/volunteer/Dao/VideoDao.java?ref=55b6ad63b58bdb675bd6cc7dce20d71435ef2b8a",
    "patch": "@@ -7,31 +7,34 @@\n \n @Mapper\n public interface VideoDao {\n-    @Insert(\"INSERT INTO video(video_url, video_text, video_publisher, video_like, video_date) \" +\n-            \"VALUES(#{videoUrl}, #{videoText}, #{videoPublisher}, #{videoLike}, NOW())\")\n+    @Insert(\"INSERT INTO video(video_url, video_title, video_text, video_publisher, video_play_num, video_like, video_date) \" +\n+            \"VALUES(#{videoUrl}, #{videoTitle}, #{videoText}, #{videoPublisher}, #{videoPlayNum}, #{videoLike}, NOW())\")\n     int addVideo(Video video);\n \n     @Update(\"UPDATE video SET video_text = #{videoText} WHERE video_id = #{videoId}\")\n     int updateVideoText(@Param(\"videoText\")String videoText, @Param(\"videoId\")long videoId);\n \n+    @Update(\"UPDATE video SET video_play_num = #{videoPlayNum} WHERE video_id = #{videoId}\")\n+    int updateVideoPlayNum(@Param(\"videoPlayNum\")long videoPlayNum, @Param(\"videoId\")long videoId);\n+\n     @Update(\"UPDATE video SET video_like = #{videoLike} WHERE video_id = #{videoId}\")\n     int updateVideoLike(@Param(\"videoLike\")long videoLike, @Param(\"videoId\")long videoId);\n \n     @ResultType(Video.class)\n-    @Select(\"SELECT video_id as videoId, video_url as videoUrl, video_text as videoText, \" +\n-            \"video_publisher as videoPublisher, video_like as videoLike, video_date as videoDate \" +\n+    @Select(\"SELECT video_id as videoId, video_url as videoUrl, video_title as videoTitle, video_text as videoText, \" +\n+            \"video_publisher as videoPublisher, video_play_num as videoPlayNum, video_like as videoLike, video_date as videoDate \" +\n             \"FROM video WHERE video_publisher = #{userId}\")\n     List<Video> findVideoByUser(@Param(\"userId\")long userId);\n \n     @ResultType(Video.class)\n-    @Select(\"SELECT video_id as videoId, video_url as videoUrl, video_text as videoText, \" +\n-            \"video_publisher as videoPublisher, video_like as videoLike, video_date as videoDate \" +\n+    @Select(\"SELECT video_id as videoId, video_url as videoUrl, video_title as videoTitle, video_text as videoText, \" +\n+            \"video_publisher as videoPublisher, video_play_num as videoPlayNum, video_like as videoLike, video_date as videoDate \" +\n             \"FROM video WHERE video_text LIKE CONCAT('%',#{textInclude},'%')\")\n     List<Video> findVideoByText(@Param(\"textInclude\")String textInclude);\n \n     @ResultType(Video.class)\n-    @Select(\"SELECT video_id as videoId, video_url as videoUrl, video_text as videoText, \" +\n-            \"video_publisher as videoPublisher, video_like as videoLike, video_date as videoDate \" +\n+    @Select(\"SELECT video_id as videoId, video_url as videoUrl, video_title as videoTitle, video_text as videoText, \" +\n+            \"video_publisher as videoPublisher, video_play_num as videoPlayNum, video_like as videoLike, video_date as videoDate \" +\n             \"FROM video WHERE TO_DAYS(NOW()) - TO_DAYS(video_date) <= 7\")\n     List<Video> findVideoInOneWeek();\n "
  },
  {
    "sha": "0004a3a0ffbb4648b73aca28f8821b731e4b356b",
    "filename": "src/main/java/com/example/volunteer/Entity/Video.java",
    "status": "modified",
    "additions": 8,
    "deletions": 0,
    "changes": 8,
    "blob_url": "https://github.com/zwh1314/volunteer/blob/55b6ad63b58bdb675bd6cc7dce20d71435ef2b8a/src/main/java/com/example/volunteer/Entity/Video.java",
    "raw_url": "https://github.com/zwh1314/volunteer/raw/55b6ad63b58bdb675bd6cc7dce20d71435ef2b8a/src/main/java/com/example/volunteer/Entity/Video.java",
    "contents_url": "https://api.github.com/repos/zwh1314/volunteer/contents/src/main/java/com/example/volunteer/Entity/Video.java?ref=55b6ad63b58bdb675bd6cc7dce20d71435ef2b8a",
    "patch": "@@ -20,10 +20,18 @@\n     @ApiModelProperty(value = \"视频URL\")\n     private String videoUrl;\n \n+    @Column(name = \"video_title\")\n+    @ApiModelProperty(value = \"视频标题\")\n+    private String videoTitle;\n+\n     @Column(name = \"video_text\")\n     @ApiModelProperty(value = \"视频文本\")\n     private String videoText;\n \n+    @Column(name = \"video_play_num\")\n+    @ApiModelProperty(value = \"视频播放量\")\n+    private long videoPlayNum;\n+\n     @Column(name = \"video_like\")\n     @ApiModelProperty(value = \"视频赞数\")\n     private long videoLike;"
  },
  {
    "sha": "6b25bda03816f9b5c05782752ca92a3c21039a0c",
    "filename": "src/main/java/com/example/volunteer/Response/Response.java",
    "status": "modified",
    "additions": 1,
    "deletions": 11,
    "changes": 12,
    "blob_url": "https://github.com/zwh1314/volunteer/blob/55b6ad63b58bdb675bd6cc7dce20d71435ef2b8a/src/main/java/com/example/volunteer/Response/Response.java",
    "raw_url": "https://github.com/zwh1314/volunteer/raw/55b6ad63b58bdb675bd6cc7dce20d71435ef2b8a/src/main/java/com/example/volunteer/Response/Response.java",
    "contents_url": "https://api.github.com/repos/zwh1314/volunteer/contents/src/main/java/com/example/volunteer/Response/Response.java?ref=55b6ad63b58bdb675bd6cc7dce20d71435ef2b8a",
    "patch": "@@ -6,11 +6,7 @@\n import lombok.Data;\n import lombok.ToString;\n \n-/**\n- * @param: none\n- * @description:\n- * @author: KingJ\n- **/\n+\n @Api(\"请求通用返回数据模型\")\n @Data\n @ToString\n@@ -28,12 +24,6 @@\n     @ApiModelProperty(\"返回数据格式\")\n     private T result;\n \n-    public void setSuc(String msg) {\n-        setSuccess(true);\n-        setCode(ResponseEnum.SUCCESS.getCode());\n-        setMsg(msg);\n-    }\n-\n     public void setSuc(T data) {\n         setSuccess(true);\n         setCode(ResponseEnum.SUCCESS.getCode());"
  },
  {
    "sha": "acea4e4600f59792f40e7e96e82e6928c7e5d02c",
    "filename": "src/main/java/com/example/volunteer/Service/ServiceImpl/SwiperServiceImpl.java",
    "status": "modified",
    "additions": 4,
    "deletions": 4,
    "changes": 8,
    "blob_url": "https://github.com/zwh1314/volunteer/blob/55b6ad63b58bdb675bd6cc7dce20d71435ef2b8a/src/main/java/com/example/volunteer/Service/ServiceImpl/SwiperServiceImpl.java",
    "raw_url": "https://github.com/zwh1314/volunteer/raw/55b6ad63b58bdb675bd6cc7dce20d71435ef2b8a/src/main/java/com/example/volunteer/Service/ServiceImpl/SwiperServiceImpl.java",
    "contents_url": "https://api.github.com/repos/zwh1314/volunteer/contents/src/main/java/com/example/volunteer/Service/ServiceImpl/SwiperServiceImpl.java?ref=55b6ad63b58bdb675bd6cc7dce20d71435ef2b8a",
    "patch": "@@ -27,14 +27,14 @@\n     private OSSUtil ossUtil;\n \n     @Override\n-    public Response<Boolean> addSwiper(long newsId, MultipartFile uploadFile){\n+    public Response<Boolean> addSwiper(long newsId, MultipartFile swiper_picture){\n         Response<Boolean> response=new Response<>();\n \n         String bucketName = \"swiper-picture\";\n-        String filename = \"news\"+newsId+\"/\"+uploadFile.getOriginalFilename();\n-        String url = ossUtil.uploadFile(bucketName,uploadFile,filename);\n+        String filename = \"news_\"+newsId+\"/\"+swiper_picture.getOriginalFilename();\n+        String url = ossUtil.uploadFile(bucketName,swiper_picture,filename);\n         if(StringUtils.isBlank(url)){\n-            logger.error(\"[uploadSwiper Fail], uploadFile: {}\", SerialUtil.toJsonStr(uploadFile.getName()));\n+            logger.error(\"[uploadSwiper Fail], swiper_picture: {}\", SerialUtil.toJsonStr(swiper_picture.getOriginalFilename()));\n             response.setFail(ResponseEnum.UPLOAD_OSS_FAILURE);\n             return response;\n         }"
  },
  {
    "sha": "62f0cfda23b52f13022ceffa5691453f436dc216",
    "filename": "src/main/java/com/example/volunteer/Service/ServiceImpl/UserInfoServiceImpl.java",
    "status": "modified",
    "additions": 28,
    "deletions": 0,
    "changes": 28,
    "blob_url": "https://github.com/zwh1314/volunteer/blob/55b6ad63b58bdb675bd6cc7dce20d71435ef2b8a/src/main/java/com/example/volunteer/Service/ServiceImpl/UserInfoServiceImpl.java",
    "raw_url": "https://github.com/zwh1314/volunteer/raw/55b6ad63b58bdb675bd6cc7dce20d71435ef2b8a/src/main/java/com/example/volunteer/Service/ServiceImpl/UserInfoServiceImpl.java",
    "contents_url": "https://api.github.com/repos/zwh1314/volunteer/contents/src/main/java/com/example/volunteer/Service/ServiceImpl/UserInfoServiceImpl.java?ref=55b6ad63b58bdb675bd6cc7dce20d71435ef2b8a",
    "patch": "@@ -7,11 +7,14 @@\n import com.example.volunteer.enums.ResponseEnum;\n import com.example.volunteer.Request.UserInfoRequest;\n import com.example.volunteer.Service.UserInfoService;\n+import com.example.volunteer.utils.OSSUtil;\n import com.example.volunteer.utils.SerialUtil;\n+import org.apache.commons.lang3.StringUtils;\n import org.slf4j.Logger;\n import org.slf4j.LoggerFactory;\n import org.springframework.beans.factory.annotation.Autowired;\n import org.springframework.stereotype.Service;\n+import org.springframework.web.multipart.MultipartFile;\n \n @Service\n public class UserInfoServiceImpl implements UserInfoService {\n@@ -20,6 +23,9 @@\n     @Autowired\n     private UserInfoDao userInfoDao;\n \n+    @Autowired\n+    private OSSUtil ossUtil;\n+\n     @Override\n     public Response<UserInfoDTO> getUserInfoByUserId(long userId){\n         Response<UserInfoDTO> response=new Response<>();\n@@ -51,6 +57,28 @@\n         return response;\n     }\n \n+    @Override\n+    public Response<String> updateHeadPicture(long userId, MultipartFile headPicture){\n+        Response<String> response = new Response<>();\n+\n+        String bucketName = \"head-picture\";\n+        String filename = \"user_\"+userId+\"/\"+headPicture.getOriginalFilename();\n+        String url = ossUtil.uploadFile(bucketName,headPicture,filename);\n+        if(StringUtils.isBlank(url)){\n+            logger.error(\"[updateHeadPicture Fail], headPicture: {}\", SerialUtil.toJsonStr(headPicture.getOriginalFilename()));\n+            response.setFail(ResponseEnum.UPLOAD_OSS_FAILURE);\n+            return response;\n+        }\n+\n+        boolean result = userInfoDao.updateHeadPicture(userId, url) > 0;\n+        if (!result) {\n+            response.setFail(ResponseEnum.OPERATE_DATABASE_FAIL);\n+            return response;\n+        }\n+        response.setSuc(url);\n+        return response;\n+    }\n+\n     @Override\n     public Response<Boolean> updateUserInfo(UserInfoRequest userInfoRequest){\n         Response<Boolean> response=new Response<>();"
  },
  {
    "sha": "34cc383676d667fc4ba8e35419d9e1c322a2566d",
    "filename": "src/main/java/com/example/volunteer/Service/ServiceImpl/VideoServiceImpl.java",
    "status": "modified",
    "additions": 24,
    "deletions": 10,
    "changes": 34,
    "blob_url": "https://github.com/zwh1314/volunteer/blob/55b6ad63b58bdb675bd6cc7dce20d71435ef2b8a/src/main/java/com/example/volunteer/Service/ServiceImpl/VideoServiceImpl.java",
    "raw_url": "https://github.com/zwh1314/volunteer/raw/55b6ad63b58bdb675bd6cc7dce20d71435ef2b8a/src/main/java/com/example/volunteer/Service/ServiceImpl/VideoServiceImpl.java",
    "contents_url": "https://api.github.com/repos/zwh1314/volunteer/contents/src/main/java/com/example/volunteer/Service/ServiceImpl/VideoServiceImpl.java?ref=55b6ad63b58bdb675bd6cc7dce20d71435ef2b8a",
    "patch": "@@ -2,15 +2,17 @@\n \n import com.example.volunteer.Dao.VideoDao;\n import com.example.volunteer.Entity.Video;\n-import com.example.volunteer.Request.VideoRequest;\n import com.example.volunteer.Response.Response;\n import com.example.volunteer.Service.VideoService;\n import com.example.volunteer.enums.ResponseEnum;\n+import com.example.volunteer.utils.OSSUtil;\n import com.example.volunteer.utils.SerialUtil;\n+import org.apache.commons.lang3.StringUtils;\n import org.slf4j.Logger;\n import org.slf4j.LoggerFactory;\n import org.springframework.beans.factory.annotation.Autowired;\n import org.springframework.stereotype.Service;\n+import org.springframework.web.multipart.MultipartFile;\n \n import java.util.List;\n \n@@ -21,19 +23,31 @@\n     @Autowired\n     private VideoDao videoDao;\n \n+    @Autowired\n+    private OSSUtil ossUtil;\n+\n     @Override\n-    public Response<Boolean> addVideo(VideoRequest videoRequest){\n+    public Response<Boolean> addVideo(Video video, MultipartFile video_mp4){\n         Response<Boolean> response=new Response<>();\n \n-        for(Video video:videoRequest.getVideoList()) {\n-            boolean result = videoDao.addVideo(video) > 0;\n-            if (!result) {\n-                logger.error(\"[addVideo Fail], request: {}\", SerialUtil.toJsonStr(videoRequest));\n-                response.setFail(ResponseEnum.OPERATE_DATABASE_FAIL);\n-                return response;\n-            }\n+        String bucketName = \"video-mp4\";\n+        String filename = \"videoPublisher_\"+video.getVideoPublisher()+\"/\"+video_mp4.getOriginalFilename();\n+        String url = ossUtil.uploadFile(bucketName,video_mp4,filename);\n+        if(StringUtils.isBlank(url)){\n+            logger.error(\"[addVideo Fail], video_mp4: {}\", SerialUtil.toJsonStr(video_mp4.getOriginalFilename()));\n+            response.setFail(ResponseEnum.UPLOAD_OSS_FAILURE);\n+            return response;\n+        }\n+        video.setVideoUrl(url);\n+\n+        boolean result = videoDao.addVideo(video) > 0;\n+        if (!result) {\n+            logger.error(\"[addVideo Fail], video_mp4: {}\", SerialUtil.toJsonStr(video_mp4));\n+            response.setFail(ResponseEnum.OPERATE_DATABASE_FAIL);\n+        }\n+        else {\n+            response.setSuc(true);\n         }\n-        response.setSuc(true);\n         return response;\n     }\n "
  },
  {
    "sha": "117e249df2efde8537b03d96810827bc50db3bc8",
    "filename": "src/main/java/com/example/volunteer/Service/SwiperService.java",
    "status": "modified",
    "additions": 1,
    "deletions": 1,
    "changes": 2,
    "blob_url": "https://github.com/zwh1314/volunteer/blob/55b6ad63b58bdb675bd6cc7dce20d71435ef2b8a/src/main/java/com/example/volunteer/Service/SwiperService.java",
    "raw_url": "https://github.com/zwh1314/volunteer/raw/55b6ad63b58bdb675bd6cc7dce20d71435ef2b8a/src/main/java/com/example/volunteer/Service/SwiperService.java",
    "contents_url": "https://api.github.com/repos/zwh1314/volunteer/contents/src/main/java/com/example/volunteer/Service/SwiperService.java?ref=55b6ad63b58bdb675bd6cc7dce20d71435ef2b8a",
    "patch": "@@ -7,7 +7,7 @@\n import java.util.List;\n \n public interface SwiperService {\n-    Response<Boolean> addSwiper(long newsId, MultipartFile uploadFile);\n+    Response<Boolean> addSwiper(long newsId, MultipartFile swiper_picture);\n \n     Response<Boolean> updateSwiperPriority(String newSwiperPriority, long swiperId);\n "
  },
  {
    "sha": "93f92741e48dc278799116c61e8a117dc7dd1715",
    "filename": "src/main/java/com/example/volunteer/Service/UserInfoService.java",
    "status": "modified",
    "additions": 3,
    "deletions": 0,
    "changes": 3,
    "blob_url": "https://github.com/zwh1314/volunteer/blob/55b6ad63b58bdb675bd6cc7dce20d71435ef2b8a/src/main/java/com/example/volunteer/Service/UserInfoService.java",
    "raw_url": "https://github.com/zwh1314/volunteer/raw/55b6ad63b58bdb675bd6cc7dce20d71435ef2b8a/src/main/java/com/example/volunteer/Service/UserInfoService.java",
    "contents_url": "https://api.github.com/repos/zwh1314/volunteer/contents/src/main/java/com/example/volunteer/Service/UserInfoService.java?ref=55b6ad63b58bdb675bd6cc7dce20d71435ef2b8a",
    "patch": "@@ -3,12 +3,15 @@\n import com.example.volunteer.DTO.UserInfoDTO;\n import com.example.volunteer.Request.UserInfoRequest;\n import com.example.volunteer.Response.Response;\n+import org.springframework.web.multipart.MultipartFile;\n \n public interface UserInfoService {\n     Response<UserInfoDTO> getUserInfoByUserId(long userId);\n \n     Response<Boolean> addUserInfo(UserInfoRequest userInfoRequest);\n \n+    Response<String> updateHeadPicture(long userId, MultipartFile headPicture);\n+\n     Response<Boolean> updateUserInfo(UserInfoRequest userInfoRequest);\n \n     Response<Boolean> deleteUserInfoByUserId(long userId);"
  },
  {
    "sha": "2e86e3b13ba8e5f8eea0ebfc0d3f3d8e7797d423",
    "filename": "src/main/java/com/example/volunteer/Service/VideoService.java",
    "status": "modified",
    "additions": 2,
    "deletions": 2,
    "changes": 4,
    "blob_url": "https://github.com/zwh1314/volunteer/blob/55b6ad63b58bdb675bd6cc7dce20d71435ef2b8a/src/main/java/com/example/volunteer/Service/VideoService.java",
    "raw_url": "https://github.com/zwh1314/volunteer/raw/55b6ad63b58bdb675bd6cc7dce20d71435ef2b8a/src/main/java/com/example/volunteer/Service/VideoService.java",
    "contents_url": "https://api.github.com/repos/zwh1314/volunteer/contents/src/main/java/com/example/volunteer/Service/VideoService.java?ref=55b6ad63b58bdb675bd6cc7dce20d71435ef2b8a",
    "patch": "@@ -1,13 +1,13 @@\n package com.example.volunteer.Service;\n \n import com.example.volunteer.Entity.Video;\n-import com.example.volunteer.Request.VideoRequest;\n import com.example.volunteer.Response.Response;\n+import org.springframework.web.multipart.MultipartFile;\n \n import java.util.List;\n \n public interface VideoService {\n-  Response<Boolean> addVideo(VideoRequest videoRequest);\n+  Response<Boolean> addVideo(Video video, MultipartFile video_mp4);\n \n   Response<Boolean> updateVideoTextContent(String textContent, long videoId);\n "
  },
  {
    "sha": "7f61d3d0458fea4826d4235504a000932a086b13",
    "filename": "src/test/java/com/example/volunteer/test/VideoTest.java",
    "status": "modified",
    "additions": 1,
    "deletions": 1,
    "changes": 2,
    "blob_url": "https://github.com/zwh1314/volunteer/blob/55b6ad63b58bdb675bd6cc7dce20d71435ef2b8a/src/test/java/com/example/volunteer/test/VideoTest.java",
    "raw_url": "https://github.com/zwh1314/volunteer/raw/55b6ad63b58bdb675bd6cc7dce20d71435ef2b8a/src/test/java/com/example/volunteer/test/VideoTest.java",
    "contents_url": "https://api.github.com/repos/zwh1314/volunteer/contents/src/test/java/com/example/volunteer/test/VideoTest.java?ref=55b6ad63b58bdb675bd6cc7dce20d71435ef2b8a",
    "patch": "@@ -36,7 +36,7 @@ public void videoTest(){\n         videoList.add(video);\n         videoList.add(video1);\n         videoRequest.setVideoList(videoList);\n-        videoService.addVideo(videoRequest);\n+//        videoService.addVideo(videoRequest);\n \n         System.out.println(videoService.getVideoByPublisherId(1));\n         System.out.println(videoService.getVideoByRelativeText(\"太阳\"));"
  }
]

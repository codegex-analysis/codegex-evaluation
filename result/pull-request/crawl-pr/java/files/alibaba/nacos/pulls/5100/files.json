[
  {
    "sha": "43299477dae9026d92925d0cc1a1e864e492d78c",
    "filename": "client/src/main/java/com/alibaba/nacos/client/config/NacosConfigService.java",
    "status": "modified",
    "additions": 5,
    "deletions": 5,
    "changes": 10,
    "blob_url": "https://github.com/alibaba/nacos/blob/9202d216638c8928d01e95bcf4651f0e10228d24/client/src/main/java/com/alibaba/nacos/client/config/NacosConfigService.java",
    "raw_url": "https://github.com/alibaba/nacos/raw/9202d216638c8928d01e95bcf4651f0e10228d24/client/src/main/java/com/alibaba/nacos/client/config/NacosConfigService.java",
    "contents_url": "https://api.github.com/repos/alibaba/nacos/contents/client/src/main/java/com/alibaba/nacos/client/config/NacosConfigService.java?ref=9202d216638c8928d01e95bcf4651f0e10228d24",
    "patch": "@@ -132,7 +132,7 @@ public void removeListener(String dataId, String group, Listener listener) {\n     }\n     \n     private String getConfigInner(String tenant, String dataId, String group, long timeoutMs) throws NacosException {\n-        group = null2defaultGroup(group);\n+        group = blank2defaultGroup(group);\n         ParamUtils.checkKeyParam(dataId, group);\n         ConfigResponse cr = new ConfigResponse();\n         \n@@ -176,12 +176,12 @@ private String getConfigInner(String tenant, String dataId, String group, long t\n         return content;\n     }\n     \n-    private String null2defaultGroup(String group) {\n-        return (null == group) ? Constants.DEFAULT_GROUP : group.trim();\n+    private String blank2defaultGroup(String group) {\n+        return (StringUtils.isBlank(group)) ? Constants.DEFAULT_GROUP : group.trim();\n     }\n     \n     private boolean removeConfigInner(String tenant, String dataId, String group, String tag) throws NacosException {\n-        group = null2defaultGroup(group);\n+        group = blank2defaultGroup(group);\n         ParamUtils.checkKeyParam(dataId, group);\n         String url = Constants.CONFIG_CONTROLLER_PATH;\n         Map<String, String> params = new HashMap<String, String>(4);\n@@ -218,7 +218,7 @@ private boolean removeConfigInner(String tenant, String dataId, String group, St\n     \n     private boolean publishConfigInner(String tenant, String dataId, String group, String tag, String appName,\n             String betaIps, String content, String type) throws NacosException {\n-        group = null2defaultGroup(group);\n+        group = blank2defaultGroup(group);\n         ParamUtils.checkParam(dataId, group, content);\n         \n         ConfigRequest cr = new ConfigRequest();"
  },
  {
    "sha": "bb606ed5b2b59fbf74b42bad628e872c454ca1c3",
    "filename": "client/src/main/java/com/alibaba/nacos/client/config/common/GroupKey.java",
    "status": "modified",
    "additions": 13,
    "deletions": 7,
    "changes": 20,
    "blob_url": "https://github.com/alibaba/nacos/blob/9202d216638c8928d01e95bcf4651f0e10228d24/client/src/main/java/com/alibaba/nacos/client/config/common/GroupKey.java",
    "raw_url": "https://github.com/alibaba/nacos/raw/9202d216638c8928d01e95bcf4651f0e10228d24/client/src/main/java/com/alibaba/nacos/client/config/common/GroupKey.java",
    "contents_url": "https://api.github.com/repos/alibaba/nacos/contents/client/src/main/java/com/alibaba/nacos/client/config/common/GroupKey.java?ref=9202d216638c8928d01e95bcf4651f0e10228d24",
    "patch": "@@ -38,6 +38,12 @@ public static String getKeyTenant(String dataId, String group, String tenant) {\n     }\n     \n     private static String doGetKey(String dataId, String group, String datumStr) {\n+        if (StringUtils.isBlank(dataId)) {\n+            throw new IllegalArgumentException(\"invalid dataId\");\n+        }\n+        if (StringUtils.isBlank(group)) {\n+            throw new IllegalArgumentException(\"invalid group\");\n+        }\n         StringBuilder sb = new StringBuilder();\n         urlEncode(dataId, sb);\n         sb.append('+');\n@@ -89,18 +95,18 @@ private static String doGetKey(String dataId, String group, String datumStr) {\n             }\n         }\n         \n-        if (StringUtils.isBlank(group)) {\n+        if (group == null) {\n             group = sb.toString();\n-            if (group.length() == 0) {\n-                throw new IllegalArgumentException(\"invalid groupkey:\" + groupKey);\n-            }\n         } else {\n             tenant = sb.toString();\n-            if (group.length() == 0) {\n-                throw new IllegalArgumentException(\"invalid groupkey:\" + groupKey);\n-            }\n         }\n         \n+        if (StringUtils.isBlank(dataId)) {\n+            throw new IllegalArgumentException(\"invalid dataId\");\n+        }\n+        if (StringUtils.isBlank(group)) {\n+            throw new IllegalArgumentException(\"invalid group\");\n+        }\n         return new String[] {dataId, group, tenant};\n     }\n     "
  },
  {
    "sha": "4eb0fcf5804e123a804284a55b5c93b3d28adf6b",
    "filename": "client/src/main/java/com/alibaba/nacos/client/config/impl/ClientWorker.java",
    "status": "modified",
    "additions": 10,
    "deletions": 10,
    "changes": 20,
    "blob_url": "https://github.com/alibaba/nacos/blob/9202d216638c8928d01e95bcf4651f0e10228d24/client/src/main/java/com/alibaba/nacos/client/config/impl/ClientWorker.java",
    "raw_url": "https://github.com/alibaba/nacos/raw/9202d216638c8928d01e95bcf4651f0e10228d24/client/src/main/java/com/alibaba/nacos/client/config/impl/ClientWorker.java",
    "contents_url": "https://api.github.com/repos/alibaba/nacos/contents/client/src/main/java/com/alibaba/nacos/client/config/impl/ClientWorker.java?ref=9202d216638c8928d01e95bcf4651f0e10228d24",
    "patch": "@@ -76,7 +76,7 @@\n      * @param listeners listeners\n      */\n     public void addListeners(String dataId, String group, List<? extends Listener> listeners) {\n-        group = null2defaultGroup(group);\n+        group = blank2defaultGroup(group);\n         CacheData cache = addCacheDataIfAbsent(dataId, group);\n         for (Listener listener : listeners) {\n             cache.addListener(listener);\n@@ -91,7 +91,7 @@ public void addListeners(String dataId, String group, List<? extends Listener> l\n      * @param listener listener\n      */\n     public void removeListener(String dataId, String group, Listener listener) {\n-        group = null2defaultGroup(group);\n+        group = blank2defaultGroup(group);\n         CacheData cache = getCache(dataId, group);\n         if (null != cache) {\n             cache.removeListener(listener);\n@@ -111,7 +111,7 @@ public void removeListener(String dataId, String group, Listener listener) {\n      */\n     public void addTenantListeners(String dataId, String group, List<? extends Listener> listeners)\n             throws NacosException {\n-        group = null2defaultGroup(group);\n+        group = blank2defaultGroup(group);\n         String tenant = agent.getTenant();\n         CacheData cache = addCacheDataIfAbsent(dataId, group, tenant);\n         for (Listener listener : listeners) {\n@@ -130,7 +130,7 @@ public void addTenantListeners(String dataId, String group, List<? extends Liste\n      */\n     public void addTenantListenersWithContent(String dataId, String group, String content,\n             List<? extends Listener> listeners) throws NacosException {\n-        group = null2defaultGroup(group);\n+        group = blank2defaultGroup(group);\n         String tenant = agent.getTenant();\n         CacheData cache = addCacheDataIfAbsent(dataId, group, tenant);\n         cache.setContent(content);\n@@ -147,7 +147,7 @@ public void addTenantListenersWithContent(String dataId, String group, String co\n      * @param listener listener\n      */\n     public void removeTenantListener(String dataId, String group, Listener listener) {\n-        group = null2defaultGroup(group);\n+        group = blank2defaultGroup(group);\n         String tenant = agent.getTenant();\n         CacheData cache = getCache(dataId, group, tenant);\n         if (null != cache) {\n@@ -197,9 +197,9 @@ public CacheData addCacheDataIfAbsent(String dataId, String group) {\n         }\n         // reset so that server not hang this check\n         lastCacheData.setInitializing(true);\n-    \n+        \n         LOGGER.info(\"[{}] [subscribe] {}\", this.agent.getName(), key);\n-    \n+        \n         MetricsMonitor.getListenConfigCountMonitor().set(cacheMap.size());\n         return lastCacheData;\n     }\n@@ -218,7 +218,7 @@ public CacheData addCacheDataIfAbsent(String dataId, String group, String tenant\n         if (cacheData != null) {\n             return cacheData;\n         }\n-    \n+        \n         cacheData = new CacheData(configFilterChainManager, agent.getName(), dataId, group, tenant);\n         // multiple listeners on the same dataid+group and race condition\n         CacheData lastCacheData = cacheMap.putIfAbsent(key, cacheData);\n@@ -356,8 +356,8 @@ private void checkLocalConfig(CacheData cacheData) {\n         }\n     }\n     \n-    private String null2defaultGroup(String group) {\n-        return (null == group) ? Constants.DEFAULT_GROUP : group.trim();\n+    private String blank2defaultGroup(String group) {\n+        return StringUtils.isBlank(group) ? Constants.DEFAULT_GROUP : group.trim();\n     }\n     \n     /**"
  },
  {
    "sha": "4303c6b961dd44237d7edf85f6f944b3cef2ae76",
    "filename": "client/src/test/java/com/alibaba/nacos/client/config/common/GroupKeyTest.java",
    "status": "modified",
    "additions": 20,
    "deletions": 2,
    "changes": 22,
    "blob_url": "https://github.com/alibaba/nacos/blob/9202d216638c8928d01e95bcf4651f0e10228d24/client/src/test/java/com/alibaba/nacos/client/config/common/GroupKeyTest.java",
    "raw_url": "https://github.com/alibaba/nacos/raw/9202d216638c8928d01e95bcf4651f0e10228d24/client/src/test/java/com/alibaba/nacos/client/config/common/GroupKeyTest.java",
    "contents_url": "https://api.github.com/repos/alibaba/nacos/contents/client/src/test/java/com/alibaba/nacos/client/config/common/GroupKeyTest.java?ref=9202d216638c8928d01e95bcf4651f0e10228d24",
    "patch": "@@ -40,8 +40,8 @@ public void testGetKeyTenant() {\n     \n     @Test\n     public void testParseKey() {\n-        Assert.assertArrayEquals(new String[] {null, \"f+oo\", null}, GroupKey.parseKey(\"f%2Boo\"));\n-        Assert.assertArrayEquals(new String[] {null, \"f%oo\", null}, GroupKey.parseKey(\"f%25oo\"));\n+        Assert.assertArrayEquals(new String[] {\"a\", \"f+oo\", null}, GroupKey.parseKey(\"a+f%2Boo\"));\n+        Assert.assertArrayEquals(new String[] {\"b\", \"f%oo\", null}, GroupKey.parseKey(\"b+f%25oo\"));\n     }\n     \n     @Test\n@@ -61,4 +61,22 @@ public void testParseKeyIllegalArgumentException3() {\n         thrown.expect(IllegalArgumentException.class);\n         GroupKey.parseKey(\"f+o+o+bar\");\n     }\n+    \n+    @Test\n+    public void testParseKeyIllegalArgumentException4() {\n+        thrown.expect(IllegalArgumentException.class);\n+        GroupKey.parseKey(\"f++bar\");\n+    }\n+    \n+    @Test\n+    public void testGetKeyDatIdParam() {\n+        thrown.expect(IllegalArgumentException.class);\n+        GroupKey.getKey(\"\", \"a\");\n+    }\n+    \n+    @Test\n+    public void testGetKeyGroupParam() {\n+        thrown.expect(IllegalArgumentException.class);\n+        GroupKey.getKey(\"a\", \"\");\n+    }\n }"
  }
]

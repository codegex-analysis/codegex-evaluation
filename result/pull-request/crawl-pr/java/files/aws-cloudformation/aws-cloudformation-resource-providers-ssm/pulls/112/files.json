[
  {
    "sha": "9f11434646aa41b74cbd6ec4899b6b492d34d778",
    "filename": "aws-ssm-document/src/main/java/com/amazonaws/ssm/document/DocumentModelTranslator.java",
    "status": "modified",
    "additions": 5,
    "deletions": 22,
    "changes": 27,
    "blob_url": "https://github.com/aws-cloudformation/aws-cloudformation-resource-providers-ssm/blob/aa729be18c86852f3694d4ed920fc70957bebfbb/aws-ssm-document/src/main/java/com/amazonaws/ssm/document/DocumentModelTranslator.java",
    "raw_url": "https://github.com/aws-cloudformation/aws-cloudformation-resource-providers-ssm/raw/aa729be18c86852f3694d4ed920fc70957bebfbb/aws-ssm-document/src/main/java/com/amazonaws/ssm/document/DocumentModelTranslator.java",
    "contents_url": "https://api.github.com/repos/aws-cloudformation/aws-cloudformation-resource-providers-ssm/contents/aws-ssm-document/src/main/java/com/amazonaws/ssm/document/DocumentModelTranslator.java?ref=aa729be18c86852f3694d4ed920fc70957bebfbb",
    "patch": "@@ -30,10 +30,8 @@\n  */\n class DocumentModelTranslator {\n \n-    private static final List<String> AWS_SSM_DOCUMENT_RESERVED_PREFIXES = ImmutableList.of(\n-        \"aws-\", \"amazon\", \"amzn\"\n-    );\n     private static final String DEFAULT_DOCUMENT_NAME_PREFIX = \"document\";\n+    private static final String EMPTY_STACK_NAME = \"\";\n     private static final int DOCUMENT_NAME_MAX_LENGTH = 128;\n     private static final String DOCUMENT_NAME_DELIMITER = \"-\";\n     private static final String LATEST_DOCUMENT_VERSION = \"$LATEST\";\n@@ -127,8 +125,10 @@ ListDocumentsRequest generateListDocumentsRequest() {\n     private String generateName(final Map<String, String> systemTags, final String requestToken) {\n         final StringBuilder identifierPrefix = new StringBuilder();\n \n-        final Optional<String> stackNameOptional = getStackName(systemTags);\n-        stackNameOptional.ifPresent(stackName -> identifierPrefix.append(stackName).append(DOCUMENT_NAME_DELIMITER));\n+        final String stackName = MapUtils.isNotEmpty(systemTags) ?\n+                systemTags.get(\"aws:cloudformation:stack-name\") + DOCUMENT_NAME_DELIMITER :\n+                EMPTY_STACK_NAME;\n+        identifierPrefix.append(stackName);\n \n         identifierPrefix.append(DEFAULT_DOCUMENT_NAME_PREFIX);\n \n@@ -139,23 +139,6 @@ private String generateName(final Map<String, String> systemTags, final String r\n                 DOCUMENT_NAME_MAX_LENGTH);\n     }\n \n-    private Optional<String> getStackName(final Map<String, String> systemTags) {\n-        if (MapUtils.isEmpty(systemTags)) {\n-            return Optional.empty();\n-        }\n-\n-        final String stackName = systemTags.get(\"aws:cloudformation:stack-name\");\n-\n-        final boolean stackNameMatchesReservedPrefix =\n-            AWS_SSM_DOCUMENT_RESERVED_PREFIXES.stream().anyMatch(prefix -> stackName.toLowerCase().startsWith(prefix));\n-\n-        if (stackNameMatchesReservedPrefix) {\n-            return Optional.empty();\n-        }\n-\n-        return Optional.of(stackName);\n-    }\n-\n     private String processDocumentContent(final Object content) {\n         if (content instanceof Map) {\n             try {"
  },
  {
    "sha": "bf0731468925a717b4529f08c9117a216e7dab46",
    "filename": "aws-ssm-document/src/test/java/com/amazonaws/ssm/document/DocumentModelTranslatorTest.java",
    "status": "modified",
    "additions": 0,
    "deletions": 33,
    "changes": 33,
    "blob_url": "https://github.com/aws-cloudformation/aws-cloudformation-resource-providers-ssm/blob/aa729be18c86852f3694d4ed920fc70957bebfbb/aws-ssm-document/src/test/java/com/amazonaws/ssm/document/DocumentModelTranslatorTest.java",
    "raw_url": "https://github.com/aws-cloudformation/aws-cloudformation-resource-providers-ssm/raw/aa729be18c86852f3694d4ed920fc70957bebfbb/aws-ssm-document/src/test/java/com/amazonaws/ssm/document/DocumentModelTranslatorTest.java",
    "contents_url": "https://api.github.com/repos/aws-cloudformation/aws-cloudformation-resource-providers-ssm/contents/aws-ssm-document/src/test/java/com/amazonaws/ssm/document/DocumentModelTranslatorTest.java?ref=aa729be18c86852f3694d4ed920fc70957bebfbb",
    "patch": "@@ -123,39 +123,6 @@ public void testGenerateCreateDocumentRequest_DocumentNameIsNotProvided_verifyRe\n         Assertions.assertEquals(expectedRequest.requires(), request.requires());\n     }\n \n-    @Test\n-    public void testGenerateCreateDocumentRequest_DocumentNameIsNotProvided_StackNameStartsWithReservedPrefix_verifyResult() {\n-        final Map<String, String> systemTags = ImmutableMap.of(\"aws:cloudformation:stack-name\", \"AWS-test-stack\");\n-\n-        final ResourceModel resourceModel = createResourceModel();\n-        resourceModel.setName(null);\n-\n-        final CreateDocumentRequest expectedRequest = CreateDocumentRequest.builder()\n-            .name(SAMPLE_DOCUMENT_NAME)\n-            .content(SAMPLE_DOCUMENT_CONTENT)\n-            .versionName(SAMPLE_VERSION_NAME)\n-            .documentFormat(SAMPLE_DOCUMENT_FORMAT)\n-            .documentType(SAMPLE_DOCUMENT_TYPE)\n-            .targetType(SAMPLE_TARGET_TYPE)\n-            .attachments(SAMPLE_CREATE_REQUEST_ATTACHMENTS)\n-            .tags(SAMPLE_CREATE_REQUEST_TAGS)\n-            .requires(SAMPLE_CREATE_REQUEST_REQUIRES)\n-            .build();\n-\n-        final CreateDocumentRequest request =\n-            unitUnderTest.generateCreateDocumentRequest(resourceModel, systemTags, SAMPLE_RESOURCE_REQUEST_TAGS, SAMPLE_REQUEST_TOKEN);\n-\n-        Assertions.assertTrue(request.name().startsWith(\"document\"));\n-        Assertions.assertEquals(expectedRequest.versionName(), request.versionName());\n-        Assertions.assertEquals(expectedRequest.content(), request.content());\n-        Assertions.assertEquals(expectedRequest.documentFormat(), request.documentFormat());\n-        Assertions.assertEquals(expectedRequest.documentType(), request.documentType());\n-        Assertions.assertEquals(expectedRequest.targetType(), request.targetType());\n-        Assertions.assertEquals(expectedRequest.attachments(), request.attachments());\n-        Assertions.assertEquals(expectedRequest.tags(), request.tags());\n-        Assertions.assertEquals(expectedRequest.requires(), request.requires());\n-    }\n-\n     @Test\n     public void testGenerateCreateDocumentRequest_DocumentNameIsNotProvided_SystemTagsIsNull_verifyResult() {\n         final ResourceModel resourceModel = createResourceModel();"
  }
]

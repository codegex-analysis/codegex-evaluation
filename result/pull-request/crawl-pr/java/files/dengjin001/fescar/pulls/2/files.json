[
  {
    "sha": "c484bbfc9cd20e2b98149cba4549a6a8d21ce8b7",
    "filename": "changes/1.5.0.md",
    "status": "modified",
    "additions": 1,
    "deletions": 0,
    "changes": 1,
    "blob_url": "https://github.com/dengjin001/fescar/blob/d28274d4f29ce58d62aac37d87296446feb5ae4b/changes/1.5.0.md",
    "raw_url": "https://github.com/dengjin001/fescar/raw/d28274d4f29ce58d62aac37d87296446feb5ae4b/changes/1.5.0.md",
    "contents_url": "https://api.github.com/repos/dengjin001/fescar/contents/changes/1.5.0.md?ref=d28274d4f29ce58d62aac37d87296446feb5ae4b",
    "patch": "@@ -72,6 +72,7 @@ Seata 是一款开源的分布式事务解决方案，提供高性能和简单\n   - [[#3533](https://github.com/seata/seata/pull/3533)] 添加获取当前对应事务角色接口\n   - [[#3436](https://github.com/seata/seata/pull/3436)] 优化SQLType类中的错别字\n   - [[#3439](https://github.com/seata/seata/pull/3439)] 调整springApplicationContextProvider的顺序以使得他可以在xml的bean之前被调用\n+  - [[#3248](https://github.com/seata/seata/pull/3248)] 优化负载均衡配置迁移到client节点下\n   - [[#3156](https://github.com/seata/seata/pull/3156)] 优化SpringProxyUtils.findTargetClass的逻辑\n   - [[#3441](https://github.com/seata/seata/pull/3441)] 优化starter的自动配置处理\n   - [[#3466](https://github.com/seata/seata/pull/3466)] 优化ExecuteTemplateXA类中判断XA不是最终状态的比较方式"
  },
  {
    "sha": "056305e0db90a7fdeb48ed699cf7e5162c523d83",
    "filename": "changes/en-us/1.5.0.md",
    "status": "modified",
    "additions": 1,
    "deletions": 0,
    "changes": 1,
    "blob_url": "https://github.com/dengjin001/fescar/blob/d28274d4f29ce58d62aac37d87296446feb5ae4b/changes/en-us/1.5.0.md",
    "raw_url": "https://github.com/dengjin001/fescar/raw/d28274d4f29ce58d62aac37d87296446feb5ae4b/changes/en-us/1.5.0.md",
    "contents_url": "https://api.github.com/repos/dengjin001/fescar/contents/changes/en-us/1.5.0.md?ref=d28274d4f29ce58d62aac37d87296446feb5ae4b",
    "patch": "@@ -169,6 +169,7 @@\n   - [[#3533](https://github.com/seata/seata/pull/3533)] added interface to get current transaction role\n   - [[#3436](https://github.com/seata/seata/pull/3436)] optimize typo in SQLType class \t\n   - [[#3439](https://github.com/seata/seata/pull/3439)] adjust the order of springApplicationContextProvider\n+  - [[#3248](https://github.com/seata/seata/pull/3248)] optimize the config of load-balance migration to belong the client node\n   - [[#3156](https://github.com/seata/seata/pull/3156)] optimize the logic of SpringProxyUtils.findTargetClass\n   - [[#3441](https://github.com/seata/seata/pull/3441)] optimize the auto-configuration processing of starter\n   - [[#3466](https://github.com/seata/seata/pull/3466)] optimize the comparison in the ExecuteTemplateXa class to determine that XA is not the final state"
  },
  {
    "sha": "b371c46d153817a47445b4f7831d9b643ef5c88a",
    "filename": "config/seata-config-core/src/main/resources/registry.conf",
    "status": "modified",
    "additions": 0,
    "deletions": 2,
    "changes": 2,
    "blob_url": "https://github.com/dengjin001/fescar/blob/d28274d4f29ce58d62aac37d87296446feb5ae4b/config/seata-config-core/src/main/resources/registry.conf",
    "raw_url": "https://github.com/dengjin001/fescar/raw/d28274d4f29ce58d62aac37d87296446feb5ae4b/config/seata-config-core/src/main/resources/registry.conf",
    "contents_url": "https://api.github.com/repos/dengjin001/fescar/contents/config/seata-config-core/src/main/resources/registry.conf?ref=d28274d4f29ce58d62aac37d87296446feb5ae4b",
    "patch": "@@ -1,8 +1,6 @@\n registry {\n   # file 、nacos 、eureka、redis、zk、consul、etcd3、sofa\n   type = \"file\"\n-  loadBalance = \"RandomLoadBalance\"\n-  loadBalanceVirtualNodes = 10\n \n   nacos {\n     application = \"seata-server\""
  },
  {
    "sha": "0a9bfecd757db725f2da9436cf3af522bf5d0390",
    "filename": "config/seata-config-core/src/test/resources/registry.conf",
    "status": "modified",
    "additions": 0,
    "deletions": 2,
    "changes": 2,
    "blob_url": "https://github.com/dengjin001/fescar/blob/d28274d4f29ce58d62aac37d87296446feb5ae4b/config/seata-config-core/src/test/resources/registry.conf",
    "raw_url": "https://github.com/dengjin001/fescar/raw/d28274d4f29ce58d62aac37d87296446feb5ae4b/config/seata-config-core/src/test/resources/registry.conf",
    "contents_url": "https://api.github.com/repos/dengjin001/fescar/contents/config/seata-config-core/src/test/resources/registry.conf?ref=d28274d4f29ce58d62aac37d87296446feb5ae4b",
    "patch": "@@ -1,8 +1,6 @@\n registry {\n   # file 、nacos 、eureka、redis、zk、consul、etcd3、sofa\n   type = \"file\"\n-  loadBalance = \"RandomLoadBalance\"\n-  loadBalanceVirtualNodes = 10\n \n   nacos {\n     serverAddr = \"localhost\""
  },
  {
    "sha": "28b24619eb1122ffb6aa784001b12543486ca16d",
    "filename": "discovery/seata-discovery-core/src/main/java/io/seata/discovery/loadbalance/ConsistentHashLoadBalance.java",
    "status": "modified",
    "additions": 9,
    "deletions": 5,
    "changes": 14,
    "blob_url": "https://github.com/dengjin001/fescar/blob/d28274d4f29ce58d62aac37d87296446feb5ae4b/discovery/seata-discovery-core/src/main/java/io/seata/discovery/loadbalance/ConsistentHashLoadBalance.java",
    "raw_url": "https://github.com/dengjin001/fescar/raw/d28274d4f29ce58d62aac37d87296446feb5ae4b/discovery/seata-discovery-core/src/main/java/io/seata/discovery/loadbalance/ConsistentHashLoadBalance.java",
    "contents_url": "https://api.github.com/repos/dengjin001/fescar/contents/discovery/seata-discovery-core/src/main/java/io/seata/discovery/loadbalance/ConsistentHashLoadBalance.java?ref=d28274d4f29ce58d62aac37d87296446feb5ae4b",
    "patch": "@@ -24,11 +24,9 @@\n import io.seata.common.loader.LoadLevel;\n import io.seata.config.ConfigurationFactory;\n \n-import static io.seata.config.ConfigurationKeys.FILE_CONFIG_SPLIT_CHAR;\n-import static io.seata.config.ConfigurationKeys.FILE_ROOT_REGISTRY;\n import static io.seata.common.DefaultValues.VIRTUAL_NODES_DEFAULT;\n import static io.seata.discovery.loadbalance.LoadBalanceFactory.CONSISTENT_HASH_LOAD_BALANCE;\n-\n+import static io.seata.discovery.loadbalance.LoadBalanceFactory.LOAD_BALANCE_PREFIX;\n /**\n  * The type consistent hash load balance.\n  *\n@@ -37,8 +35,14 @@\n @LoadLevel(name = CONSISTENT_HASH_LOAD_BALANCE)\n public class ConsistentHashLoadBalance extends AbstractLoadBalance {\n \n-    private static final String VIRTUAL_NODES = FILE_ROOT_REGISTRY + FILE_CONFIG_SPLIT_CHAR + \"loadBalanceVirtualNodes\";\n-    private static final int VIRTUAL_NODES_NUM = ConfigurationFactory.CURRENT_FILE_INSTANCE.getInt(VIRTUAL_NODES, VIRTUAL_NODES_DEFAULT);\n+    /**\n+     * The constant LOAD_BALANCE_CONSISTENT_HASH_VISUAL_NODES.\n+     */\n+    public static final String LOAD_BALANCE_CONSISTENT_HASH_VISUAL_NODES = LOAD_BALANCE_PREFIX + \"visualNodes\";\n+    /**\n+     * The constant VIRTUAL_NODES_NUM.\n+     */\n+    private static final int VIRTUAL_NODES_NUM = ConfigurationFactory.getInstance().getInt(LOAD_BALANCE_CONSISTENT_HASH_VISUAL_NODES, VIRTUAL_NODES_DEFAULT);\n \n     @Override\n     protected <T> T doSelect(List<T> invokers, String xid) {"
  },
  {
    "sha": "d9489c32fa1a13ba6e4c584e47ce716e49338050",
    "filename": "discovery/seata-discovery-core/src/main/java/io/seata/discovery/loadbalance/LoadBalanceFactory.java",
    "status": "modified",
    "additions": 7,
    "deletions": 5,
    "changes": 12,
    "blob_url": "https://github.com/dengjin001/fescar/blob/d28274d4f29ce58d62aac37d87296446feb5ae4b/discovery/seata-discovery-core/src/main/java/io/seata/discovery/loadbalance/LoadBalanceFactory.java",
    "raw_url": "https://github.com/dengjin001/fescar/raw/d28274d4f29ce58d62aac37d87296446feb5ae4b/discovery/seata-discovery-core/src/main/java/io/seata/discovery/loadbalance/LoadBalanceFactory.java",
    "contents_url": "https://api.github.com/repos/dengjin001/fescar/contents/discovery/seata-discovery-core/src/main/java/io/seata/discovery/loadbalance/LoadBalanceFactory.java?ref=d28274d4f29ce58d62aac37d87296446feb5ae4b",
    "patch": "@@ -18,8 +18,6 @@\n import io.seata.common.loader.EnhancedServiceLoader;\n import io.seata.config.ConfigurationFactory;\n \n-import static io.seata.config.ConfigurationKeys.FILE_CONFIG_SPLIT_CHAR;\n-import static io.seata.config.ConfigurationKeys.FILE_ROOT_REGISTRY;\n import static io.seata.common.DefaultValues.DEFAULT_LOAD_BALANCE;\n \n /**\n@@ -29,10 +27,13 @@\n  */\n public class LoadBalanceFactory {\n \n+    private static final String CLIENT_PREFIX = \"client.\";\n     /**\n-     * The constant LOAD_BALANCE.\n+     * The constant LOAD_BALANCE_PREFIX.\n      */\n-    private static final String LOAD_BALANCE = FILE_ROOT_REGISTRY + FILE_CONFIG_SPLIT_CHAR + \"loadBalance\";\n+    public static final String LOAD_BALANCE_PREFIX = CLIENT_PREFIX + \"loadBalance.\";\n+\n+    public static final String LOAD_BALANCE_TYPE = LOAD_BALANCE_PREFIX + \"type\";\n \n     public static final String RANDOM_LOAD_BALANCE = DEFAULT_LOAD_BALANCE;\n \n@@ -49,6 +50,7 @@\n      * @return the instance\n      */\n     public static LoadBalance getInstance() {\n-        return EnhancedServiceLoader.load(LoadBalance.class, ConfigurationFactory.CURRENT_FILE_INSTANCE.getConfig(LOAD_BALANCE, DEFAULT_LOAD_BALANCE));\n+        String config = ConfigurationFactory.getInstance().getConfig(LOAD_BALANCE_TYPE, DEFAULT_LOAD_BALANCE);\n+        return EnhancedServiceLoader.load(LoadBalance.class, config);\n     }\n }"
  },
  {
    "sha": "2e26179202f90acb4a7a01ba388fcfaca0a7e17e",
    "filename": "discovery/seata-discovery-core/src/test/java/io/seata/config/ConfigurationFactoryTest.java",
    "status": "modified",
    "additions": 13,
    "deletions": 0,
    "changes": 13,
    "blob_url": "https://github.com/dengjin001/fescar/blob/d28274d4f29ce58d62aac37d87296446feb5ae4b/discovery/seata-discovery-core/src/test/java/io/seata/config/ConfigurationFactoryTest.java",
    "raw_url": "https://github.com/dengjin001/fescar/raw/d28274d4f29ce58d62aac37d87296446feb5ae4b/discovery/seata-discovery-core/src/test/java/io/seata/config/ConfigurationFactoryTest.java",
    "contents_url": "https://api.github.com/repos/dengjin001/fescar/contents/discovery/seata-discovery-core/src/test/java/io/seata/config/ConfigurationFactoryTest.java?ref=d28274d4f29ce58d62aac37d87296446feb5ae4b",
    "patch": "@@ -15,6 +15,8 @@\n  */\n package io.seata.config;\n \n+import io.seata.discovery.loadbalance.ConsistentHashLoadBalance;\n+import io.seata.discovery.loadbalance.LoadBalanceFactory;\n import org.junit.jupiter.api.Assertions;\n import org.junit.jupiter.api.Test;\n \n@@ -29,4 +31,15 @@ void getInstance() {\n         // check singleton\n         Assertions.assertEquals(configuration.getClass().getName(), ConfigurationFactory.getInstance().getClass().getName());\n     }\n+\n+\n+    @Test\n+    void getLoadBalance() {\n+        Configuration configuration = ConfigurationFactory.getInstance();\n+        String loadBalanceType = configuration.getConfig(LoadBalanceFactory.LOAD_BALANCE_TYPE);\n+        int visualNode = configuration.getInt(ConsistentHashLoadBalance.LOAD_BALANCE_CONSISTENT_HASH_VISUAL_NODES);\n+        Assertions.assertEquals(\"RandomLoadBalance\", loadBalanceType);\n+        Assertions.assertEquals(10,visualNode);\n+    }\n+\n }\n\\ No newline at end of file"
  },
  {
    "sha": "41a88e3bfea37ed9ffab37dcc9f2a879c29b634d",
    "filename": "discovery/seata-discovery-core/src/test/java/io/seata/discovery/loadbalance/LoadBalanceTest.java",
    "status": "modified",
    "additions": 2,
    "deletions": 1,
    "changes": 3,
    "blob_url": "https://github.com/dengjin001/fescar/blob/d28274d4f29ce58d62aac37d87296446feb5ae4b/discovery/seata-discovery-core/src/test/java/io/seata/discovery/loadbalance/LoadBalanceTest.java",
    "raw_url": "https://github.com/dengjin001/fescar/raw/d28274d4f29ce58d62aac37d87296446feb5ae4b/discovery/seata-discovery-core/src/test/java/io/seata/discovery/loadbalance/LoadBalanceTest.java",
    "contents_url": "https://api.github.com/repos/dengjin001/fescar/contents/discovery/seata-discovery-core/src/test/java/io/seata/discovery/loadbalance/LoadBalanceTest.java?ref=d28274d4f29ce58d62aac37d87296446feb5ae4b",
    "patch": "@@ -77,7 +77,8 @@ public void testRoundRobinLoadBalance_select(List<InetSocketAddress> addresses)\n     public void testConsistentHashLoadBalance_select(List<InetSocketAddress> addresses) {\n         int runs = 10000;\n         int selected = 0;\n-        Map<InetSocketAddress, AtomicLong> counter = getSelectedCounter(runs, addresses, new ConsistentHashLoadBalance());\n+        ConsistentHashLoadBalance loadBalance = new ConsistentHashLoadBalance();\n+        Map<InetSocketAddress, AtomicLong> counter = getSelectedCounter(runs, addresses, loadBalance);\n         for (InetSocketAddress address : counter.keySet()) {\n             if (counter.get(address).get() > 0) {\n                 selected++;"
  },
  {
    "sha": "12e134002bad0f3da3ed6037aee6fe06dae135d8",
    "filename": "discovery/seata-discovery-core/src/test/resources/file.conf",
    "status": "added",
    "additions": 23,
    "deletions": 0,
    "changes": 23,
    "blob_url": "https://github.com/dengjin001/fescar/blob/d28274d4f29ce58d62aac37d87296446feb5ae4b/discovery/seata-discovery-core/src/test/resources/file.conf",
    "raw_url": "https://github.com/dengjin001/fescar/raw/d28274d4f29ce58d62aac37d87296446feb5ae4b/discovery/seata-discovery-core/src/test/resources/file.conf",
    "contents_url": "https://api.github.com/repos/dengjin001/fescar/contents/discovery/seata-discovery-core/src/test/resources/file.conf?ref=d28274d4f29ce58d62aac37d87296446feb5ae4b",
    "patch": "@@ -0,0 +1,23 @@\n+#\n+#  Copyright 1999-2019 Seata.io Group.\n+#\n+#  Licensed under the Apache License, Version 2.0 (the \"License\");\n+#  you may not use this file except in compliance with the License.\n+#  You may obtain a copy of the License at\n+#\n+#       http://www.apache.org/licenses/LICENSE-2.0\n+#\n+#  Unless required by applicable law or agreed to in writing, software\n+#  distributed under the License is distributed on an \"AS IS\" BASIS,\n+#  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+#  See the License for the specific language governing permissions and\n+#  limitations under the License.\n+#\n+\n+#loadBalance config\n+client {\n+    loadBalance {\n+        type = \"RandomLoadBalance\"\n+        visualNodes = 10\n+    }\n+}\n\\ No newline at end of file"
  },
  {
    "sha": "22496b30e940ce445ce077d8aafa7c3410a73878",
    "filename": "script/client/conf/file.conf",
    "status": "modified",
    "additions": 4,
    "deletions": 0,
    "changes": 4,
    "blob_url": "https://github.com/dengjin001/fescar/blob/d28274d4f29ce58d62aac37d87296446feb5ae4b/script/client/conf/file.conf",
    "raw_url": "https://github.com/dengjin001/fescar/raw/d28274d4f29ce58d62aac37d87296446feb5ae4b/script/client/conf/file.conf",
    "contents_url": "https://api.github.com/repos/dengjin001/fescar/contents/script/client/conf/file.conf?ref=d28274d4f29ce58d62aac37d87296446feb5ae4b",
    "patch": "@@ -78,6 +78,10 @@ client {\n       threshold = 64k\n     }\n   }\n+  loadBalance {\n+      type = \"RandomLoadBalance\"\n+      virtualNodes = 10\n+  }\n }\n log {\n   exceptionRate = 100"
  },
  {
    "sha": "26121bcfd5c49d8ef3da926e07105c500b3ce725",
    "filename": "script/client/conf/registry.conf",
    "status": "modified",
    "additions": 0,
    "deletions": 2,
    "changes": 2,
    "blob_url": "https://github.com/dengjin001/fescar/blob/d28274d4f29ce58d62aac37d87296446feb5ae4b/script/client/conf/registry.conf",
    "raw_url": "https://github.com/dengjin001/fescar/raw/d28274d4f29ce58d62aac37d87296446feb5ae4b/script/client/conf/registry.conf",
    "contents_url": "https://api.github.com/repos/dengjin001/fescar/contents/script/client/conf/registry.conf?ref=d28274d4f29ce58d62aac37d87296446feb5ae4b",
    "patch": "@@ -1,8 +1,6 @@\n registry {\n   # file 、nacos 、eureka、redis、zk、consul、etcd3、sofa、custom\n   type = \"file\"\n-  loadBalance = \"RandomLoadBalance\"\n-  loadBalanceVirtualNodes = 10\n \n   nacos {\n     application = \"seata-server\""
  },
  {
    "sha": "9e16dd58ed4afbb85b4e3eb53195a27b9c24a923",
    "filename": "script/client/spring/application.properties",
    "status": "modified",
    "additions": 3,
    "deletions": 4,
    "changes": 7,
    "blob_url": "https://github.com/dengjin001/fescar/blob/d28274d4f29ce58d62aac37d87296446feb5ae4b/script/client/spring/application.properties",
    "raw_url": "https://github.com/dengjin001/fescar/raw/d28274d4f29ce58d62aac37d87296446feb5ae4b/script/client/spring/application.properties",
    "contents_url": "https://api.github.com/repos/dengjin001/fescar/contents/script/client/spring/application.properties?ref=d28274d4f29ce58d62aac37d87296446feb5ae4b",
    "patch": "@@ -45,6 +45,8 @@ seata.client.undo.log-table=undo_log\n seata.client.undo.compress.enable=true\n seata.client.undo.compress.type=zip\n seata.client.undo.compress.threshold=64k\n+seata.client.load-balance.type=RandomLoadBalance\n+seata.client.load-balance.virtual-nodes=10\n seata.log.exception-rate=100\n seata.service.vgroup-mapping.my_test_tx_group=default\n seata.service.grouplist.default=127.0.0.1:8091\n@@ -127,7 +129,4 @@ seata.registry.zk.connect-timeout=2000\n seata.registry.zk.username=\n seata.registry.zk.password=\n \n-seata.registry.custom.name=\n-\n-seata.registry.load-balance=RandomLoadBalance\n-seata.registry.load-balance-virtual-nodes=10\n\\ No newline at end of file\n+seata.registry.custom.name=\n\\ No newline at end of file"
  },
  {
    "sha": "e9ff6ecd3adedc847cc5667f0cea098528c828dd",
    "filename": "script/client/spring/application.yml",
    "status": "modified",
    "additions": 3,
    "deletions": 2,
    "changes": 5,
    "blob_url": "https://github.com/dengjin001/fescar/blob/d28274d4f29ce58d62aac37d87296446feb5ae4b/script/client/spring/application.yml",
    "raw_url": "https://github.com/dengjin001/fescar/raw/d28274d4f29ce58d62aac37d87296446feb5ae4b/script/client/spring/application.yml",
    "contents_url": "https://api.github.com/repos/dengjin001/fescar/contents/script/client/spring/application.yml?ref=d28274d4f29ce58d62aac37d87296446feb5ae4b",
    "patch": "@@ -36,6 +36,9 @@ seata:\n         enable: true\n         type: zip\n         threshold: 64k\n+    load-balance:\n+      type: RandomLoadBalance\n+      virtual-nodes: 10\n   service:\n     vgroup-mapping:\n       my_test_tx_group: default\n@@ -89,8 +92,6 @@ seata:\n       name: \"\"\n   registry:\n     type: file\n-    load-balance: RandomLoadBalance\n-    load-balance-virtual-nodes: 10\n     file:\n       name: file.conf\n     consul:"
  },
  {
    "sha": "1cb9b5c8623aa1fd0f98adfc5e7dd308b86c7f6e",
    "filename": "script/server/config/registry.conf",
    "status": "modified",
    "additions": 0,
    "deletions": 2,
    "changes": 2,
    "blob_url": "https://github.com/dengjin001/fescar/blob/d28274d4f29ce58d62aac37d87296446feb5ae4b/script/server/config/registry.conf",
    "raw_url": "https://github.com/dengjin001/fescar/raw/d28274d4f29ce58d62aac37d87296446feb5ae4b/script/server/config/registry.conf",
    "contents_url": "https://api.github.com/repos/dengjin001/fescar/contents/script/server/config/registry.conf?ref=d28274d4f29ce58d62aac37d87296446feb5ae4b",
    "patch": "@@ -1,8 +1,6 @@\n registry {\n   # file,nacos,eureka,redis,zk,consul,etcd3,sofa\n   type = \"file\"\n-  loadBalance = \"RandomLoadBalance\"\n-  loadBalanceVirtualNodes = 10\n \n   nacos {\n     application = \"seata-server\""
  },
  {
    "sha": "2de211b33b8e7d8f03865fbeacd350da7c901916",
    "filename": "script/server/config/registry.properties",
    "status": "modified",
    "additions": 0,
    "deletions": 2,
    "changes": 2,
    "blob_url": "https://github.com/dengjin001/fescar/blob/d28274d4f29ce58d62aac37d87296446feb5ae4b/script/server/config/registry.properties",
    "raw_url": "https://github.com/dengjin001/fescar/raw/d28274d4f29ce58d62aac37d87296446feb5ae4b/script/server/config/registry.properties",
    "contents_url": "https://api.github.com/repos/dengjin001/fescar/contents/script/server/config/registry.properties?ref=d28274d4f29ce58d62aac37d87296446feb5ae4b",
    "patch": "@@ -1,6 +1,4 @@\n registry.type=file\n-registry.loadBalance=RandomLoadBalance\n-registry.loadBalanceVirtualNodes=10\n registry.nacos.application=seata-server\n registry.nacos.serverAddr=127.0.0.1:8848\n registry.nacos.group=SEATA_GROUP"
  },
  {
    "sha": "915f282f7e9808e4249b5b77b2e6340212c540e4",
    "filename": "script/server/config/registry.yml",
    "status": "modified",
    "additions": 0,
    "deletions": 2,
    "changes": 2,
    "blob_url": "https://github.com/dengjin001/fescar/blob/d28274d4f29ce58d62aac37d87296446feb5ae4b/script/server/config/registry.yml",
    "raw_url": "https://github.com/dengjin001/fescar/raw/d28274d4f29ce58d62aac37d87296446feb5ae4b/script/server/config/registry.yml",
    "contents_url": "https://api.github.com/repos/dengjin001/fescar/contents/script/server/config/registry.yml?ref=d28274d4f29ce58d62aac37d87296446feb5ae4b",
    "patch": "@@ -1,8 +1,6 @@\n registry:\n   # file,nacos,eureka,redis,zk,consul,etcd3,sofa\n   type: file\n-  loadBalance: RandomLoadBalance\n-  loadBalanceVirtualNodes: 10\n \n   nacos:\n     application: seata-server"
  },
  {
    "sha": "ac8d7a08851c73814c663a265ceec0dac923e6d6",
    "filename": "seata-spring-boot-starter/src/main/java/io/seata/spring/boot/autoconfigure/SeataPropertiesAutoConfiguration.java",
    "status": "modified",
    "additions": 3,
    "deletions": 0,
    "changes": 3,
    "blob_url": "https://github.com/dengjin001/fescar/blob/d28274d4f29ce58d62aac37d87296446feb5ae4b/seata-spring-boot-starter/src/main/java/io/seata/spring/boot/autoconfigure/SeataPropertiesAutoConfiguration.java",
    "raw_url": "https://github.com/dengjin001/fescar/raw/d28274d4f29ce58d62aac37d87296446feb5ae4b/seata-spring-boot-starter/src/main/java/io/seata/spring/boot/autoconfigure/SeataPropertiesAutoConfiguration.java",
    "contents_url": "https://api.github.com/repos/dengjin001/fescar/contents/seata-spring-boot-starter/src/main/java/io/seata/spring/boot/autoconfigure/SeataPropertiesAutoConfiguration.java?ref=d28274d4f29ce58d62aac37d87296446feb5ae4b",
    "patch": "@@ -44,6 +44,7 @@\n import io.seata.spring.boot.autoconfigure.properties.registry.RegistryRedisProperties;\n import io.seata.spring.boot.autoconfigure.properties.registry.RegistrySofaProperties;\n import io.seata.spring.boot.autoconfigure.properties.registry.RegistryZooKeeperProperties;\n+import io.seata.spring.boot.autoconfigure.properties.registry.LoadBalanceProperties;\n import org.springframework.boot.autoconfigure.AutoConfigureBefore;\n import org.springframework.boot.autoconfigure.condition.ConditionalOnMissingBean;\n import org.springframework.boot.autoconfigure.condition.ConditionalOnProperty;\n@@ -80,6 +81,7 @@\n import static io.seata.spring.boot.autoconfigure.StarterConstants.THREAD_FACTORY_PREFIX;\n import static io.seata.spring.boot.autoconfigure.StarterConstants.TRANSPORT_PREFIX;\n import static io.seata.spring.boot.autoconfigure.StarterConstants.UNDO_PREFIX;\n+import static io.seata.spring.boot.autoconfigure.StarterConstants.LOAD_BALANCE_PREFIX;\n \n /**\n  * The type Seata properties auto configuration\n@@ -107,6 +109,7 @@\n         PROPERTY_BEAN_MAP.put(CONFIG_PREFIX, ConfigProperties.class);\n         PROPERTY_BEAN_MAP.put(CONFIG_FILE_PREFIX, ConfigFileProperties.class);\n         PROPERTY_BEAN_MAP.put(REGISTRY_PREFIX, RegistryProperties.class);\n+        PROPERTY_BEAN_MAP.put(LOAD_BALANCE_PREFIX, LoadBalanceProperties.class);\n \n         PROPERTY_BEAN_MAP.put(CONFIG_NACOS_PREFIX, ConfigNacosProperties.class);\n         PROPERTY_BEAN_MAP.put(CONFIG_CONSUL_PREFIX, ConfigConsulProperties.class);"
  },
  {
    "sha": "2ce2a16d0f3f61241a846c004d4f2fbeedeb14a4",
    "filename": "seata-spring-boot-starter/src/main/java/io/seata/spring/boot/autoconfigure/StarterConstants.java",
    "status": "modified",
    "additions": 1,
    "deletions": 0,
    "changes": 1,
    "blob_url": "https://github.com/dengjin001/fescar/blob/d28274d4f29ce58d62aac37d87296446feb5ae4b/seata-spring-boot-starter/src/main/java/io/seata/spring/boot/autoconfigure/StarterConstants.java",
    "raw_url": "https://github.com/dengjin001/fescar/raw/d28274d4f29ce58d62aac37d87296446feb5ae4b/seata-spring-boot-starter/src/main/java/io/seata/spring/boot/autoconfigure/StarterConstants.java",
    "contents_url": "https://api.github.com/repos/dengjin001/fescar/contents/seata-spring-boot-starter/src/main/java/io/seata/spring/boot/autoconfigure/StarterConstants.java?ref=d28274d4f29ce58d62aac37d87296446feb5ae4b",
    "patch": "@@ -33,6 +33,7 @@\n     String CLIENT_TM_PREFIX = CLIENT_PREFIX + \".tm\";\n     String LOCK_PREFIX = CLIENT_RM_PREFIX + \".lock\";\n     String UNDO_PREFIX = CLIENT_PREFIX + \".undo\";\n+    String LOAD_BALANCE_PREFIX = CLIENT_PREFIX + \".loadBalance\";\n     String LOG_PREFIX = SEATA_PREFIX + \".log\";\n     String COMPRESS_PREFIX = UNDO_PREFIX + \".compress\";\n "
  },
  {
    "sha": "e5d46ec1a6b22fe1080f93fd759846eb73997058",
    "filename": "seata-spring-boot-starter/src/main/java/io/seata/spring/boot/autoconfigure/properties/registry/LoadBalanceProperties.java",
    "status": "added",
    "additions": 58,
    "deletions": 0,
    "changes": 58,
    "blob_url": "https://github.com/dengjin001/fescar/blob/d28274d4f29ce58d62aac37d87296446feb5ae4b/seata-spring-boot-starter/src/main/java/io/seata/spring/boot/autoconfigure/properties/registry/LoadBalanceProperties.java",
    "raw_url": "https://github.com/dengjin001/fescar/raw/d28274d4f29ce58d62aac37d87296446feb5ae4b/seata-spring-boot-starter/src/main/java/io/seata/spring/boot/autoconfigure/properties/registry/LoadBalanceProperties.java",
    "contents_url": "https://api.github.com/repos/dengjin001/fescar/contents/seata-spring-boot-starter/src/main/java/io/seata/spring/boot/autoconfigure/properties/registry/LoadBalanceProperties.java?ref=d28274d4f29ce58d62aac37d87296446feb5ae4b",
    "patch": "@@ -0,0 +1,58 @@\n+/*\n+ *  Copyright 1999-2019 Seata.io Group.\n+ *\n+ *  Licensed under the Apache License, Version 2.0 (the \"License\");\n+ *  you may not use this file except in compliance with the License.\n+ *  You may obtain a copy of the License at\n+ *\n+ *       http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *  Unless required by applicable law or agreed to in writing, software\n+ *  distributed under the License is distributed on an \"AS IS\" BASIS,\n+ *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ *  See the License for the specific language governing permissions and\n+ *  limitations under the License.\n+ */\n+package io.seata.spring.boot.autoconfigure.properties.registry;\n+\n+import org.springframework.boot.context.properties.ConfigurationProperties;\n+import org.springframework.stereotype.Component;\n+\n+import static io.seata.common.DefaultValues.DEFAULT_LOAD_BALANCE;\n+import static io.seata.common.DefaultValues.VIRTUAL_NODES_DEFAULT;\n+import static io.seata.spring.boot.autoconfigure.StarterConstants.LOAD_BALANCE_PREFIX;\n+\n+/**\n+ * @author ls9527\n+ */\n+@Component\n+@ConfigurationProperties(prefix = LOAD_BALANCE_PREFIX)\n+public class LoadBalanceProperties {\n+    /**\n+     * the load balance\n+     */\n+    private String type = DEFAULT_LOAD_BALANCE;\n+    /**\n+     * the load balance virtual nodes\n+     */\n+    private int virtualNodes = VIRTUAL_NODES_DEFAULT;\n+\n+\n+    public String getType() {\n+        return type;\n+    }\n+\n+    public LoadBalanceProperties setType(String type) {\n+        this.type = type;\n+        return this;\n+    }\n+\n+    public int getVirtualNodes() {\n+        return virtualNodes;\n+    }\n+\n+    public LoadBalanceProperties setVirtualNodes(int virtualNodes) {\n+        this.virtualNodes = virtualNodes;\n+        return this;\n+    }\n+}"
  },
  {
    "sha": "1eea19fe017934037076de1e79050be904ce2f61",
    "filename": "seata-spring-boot-starter/src/main/java/io/seata/spring/boot/autoconfigure/properties/registry/RegistryProperties.java",
    "status": "modified",
    "additions": 0,
    "deletions": 27,
    "changes": 27,
    "blob_url": "https://github.com/dengjin001/fescar/blob/d28274d4f29ce58d62aac37d87296446feb5ae4b/seata-spring-boot-starter/src/main/java/io/seata/spring/boot/autoconfigure/properties/registry/RegistryProperties.java",
    "raw_url": "https://github.com/dengjin001/fescar/raw/d28274d4f29ce58d62aac37d87296446feb5ae4b/seata-spring-boot-starter/src/main/java/io/seata/spring/boot/autoconfigure/properties/registry/RegistryProperties.java",
    "contents_url": "https://api.github.com/repos/dengjin001/fescar/contents/seata-spring-boot-starter/src/main/java/io/seata/spring/boot/autoconfigure/properties/registry/RegistryProperties.java?ref=d28274d4f29ce58d62aac37d87296446feb5ae4b",
    "patch": "@@ -18,8 +18,6 @@\n import org.springframework.boot.context.properties.ConfigurationProperties;\n import org.springframework.stereotype.Component;\n \n-import static io.seata.common.DefaultValues.DEFAULT_LOAD_BALANCE;\n-import static io.seata.common.DefaultValues.VIRTUAL_NODES_DEFAULT;\n import static io.seata.spring.boot.autoconfigure.StarterConstants.REGISTRY_PREFIX;\n \n /**\n@@ -32,14 +30,6 @@\n      * file, nacos, eureka, redis, zk, consul, etcd3, sofa\n      */\n     private String type = \"file\";\n-    /**\n-     * the load balance\n-     */\n-    private String loadBalance = DEFAULT_LOAD_BALANCE;\n-    /**\n-     * the load balance virtual nodes\n-     */\n-    private int loadBalanceVirtualNodes = VIRTUAL_NODES_DEFAULT;\n \n     public String getType() {\n         return type;\n@@ -50,21 +40,4 @@ public RegistryProperties setType(String type) {\n         return this;\n     }\n \n-    public String getLoadBalance() {\n-        return loadBalance;\n-    }\n-\n-    public RegistryProperties setLoadBalance(String loadBalance) {\n-        this.loadBalance = loadBalance;\n-        return this;\n-    }\n-\n-    public int getLoadBalanceVirtualNodes() {\n-        return loadBalanceVirtualNodes;\n-    }\n-\n-    public RegistryProperties setLoadBalanceVirtualNodes(int loadBalanceVirtualNodes) {\n-        this.loadBalanceVirtualNodes = loadBalanceVirtualNodes;\n-        return this;\n-    }\n }"
  },
  {
    "sha": "0b766172970fe18802f3a7a01471543010361745",
    "filename": "seata-spring-boot-starter/src/main/resources/META-INF/additional-spring-configuration-metadata.json",
    "status": "modified",
    "additions": 4,
    "deletions": 4,
    "changes": 8,
    "blob_url": "https://github.com/dengjin001/fescar/blob/d28274d4f29ce58d62aac37d87296446feb5ae4b/seata-spring-boot-starter/src/main/resources/META-INF/additional-spring-configuration-metadata.json",
    "raw_url": "https://github.com/dengjin001/fescar/raw/d28274d4f29ce58d62aac37d87296446feb5ae4b/seata-spring-boot-starter/src/main/resources/META-INF/additional-spring-configuration-metadata.json",
    "contents_url": "https://api.github.com/repos/dengjin001/fescar/contents/seata-spring-boot-starter/src/main/resources/META-INF/additional-spring-configuration-metadata.json?ref=d28274d4f29ce58d62aac37d87296446feb5ae4b",
    "patch": "@@ -269,15 +269,15 @@\n       \"defaultValue\": 1\n     },\n     {\n-      \"name\": \"seata.registry.load-balance\",\n+      \"name\": \"seata.client.load-balance.type\",\n       \"type\": \"java.lang.String\",\n-      \"sourceType\": \"io.seata.spring.boot.autoconfigure.properties.registry.RegistryProperties\",\n+      \"sourceType\": \"io.seata.spring.boot.autoconfigure.properties.registry.LoadBalanceProperties\",\n       \"defaultValue\": \"RandomLoadBalance\"\n     },\n     {\n-      \"name\": \"seata.registry.load-balance-virtual-nodes\",\n+      \"name\": \"seata.client.load-balance.virtual-nodes\",\n       \"type\": \"java.lang.Integer\",\n-      \"sourceType\": \"io.seata.spring.boot.autoconfigure.properties.registry.RegistryProperties\",\n+      \"sourceType\": \"io.seata.spring.boot.autoconfigure.properties.registry.LoadBalanceProperties\",\n       \"defaultValue\": 10\n     }\n   ],"
  },
  {
    "sha": "02244979536d703ba086ca4bb7fe3d191cd9eda2",
    "filename": "seata-spring-boot-starter/src/test/java/io/seata/spring/boot/autoconfigure/PropertiesTest.java",
    "status": "modified",
    "additions": 8,
    "deletions": 2,
    "changes": 10,
    "blob_url": "https://github.com/dengjin001/fescar/blob/d28274d4f29ce58d62aac37d87296446feb5ae4b/seata-spring-boot-starter/src/test/java/io/seata/spring/boot/autoconfigure/PropertiesTest.java",
    "raw_url": "https://github.com/dengjin001/fescar/raw/d28274d4f29ce58d62aac37d87296446feb5ae4b/seata-spring-boot-starter/src/test/java/io/seata/spring/boot/autoconfigure/PropertiesTest.java",
    "contents_url": "https://api.github.com/repos/dengjin001/fescar/contents/seata-spring-boot-starter/src/test/java/io/seata/spring/boot/autoconfigure/PropertiesTest.java?ref=d28274d4f29ce58d62aac37d87296446feb5ae4b",
    "patch": "@@ -36,6 +36,7 @@\n import io.seata.spring.boot.autoconfigure.properties.config.ConfigNacosProperties;\n import io.seata.spring.boot.autoconfigure.properties.config.ConfigProperties;\n import io.seata.spring.boot.autoconfigure.properties.config.ConfigZooKeeperProperties;\n+import io.seata.spring.boot.autoconfigure.properties.registry.LoadBalanceProperties;\n import io.seata.spring.boot.autoconfigure.properties.registry.RegistryConsulProperties;\n import io.seata.spring.boot.autoconfigure.properties.registry.RegistryCustomProperties;\n import io.seata.spring.boot.autoconfigure.properties.registry.RegistryEtcd3Properties;\n@@ -226,8 +227,13 @@ public void testRegistryNacosProperties() {\n     @Test\n     public void testRegistryProperties() {\n         assertEquals(\"file\", context.getBean(RegistryProperties.class).getType());\n-        assertEquals(\"RandomLoadBalance\", context.getBean(RegistryProperties.class).getLoadBalance());\n-        assertEquals(10, context.getBean(RegistryProperties.class).getLoadBalanceVirtualNodes());\n+    }\n+\n+\n+    @Test\n+    public void testLoadBalanceProperties() {\n+        assertEquals(\"RandomLoadBalance\", context.getBean(LoadBalanceProperties.class).getType());\n+        assertEquals(10, context.getBean(LoadBalanceProperties.class).getVirtualNodes());\n     }\n \n     @Test"
  },
  {
    "sha": "ed7b37965ba4fc67e052b3e3ebce30aaca25b7c0",
    "filename": "serializer/seata-serializer-seata/src/test/resources/registry.conf",
    "status": "modified",
    "additions": 0,
    "deletions": 2,
    "changes": 2,
    "blob_url": "https://github.com/dengjin001/fescar/blob/d28274d4f29ce58d62aac37d87296446feb5ae4b/serializer/seata-serializer-seata/src/test/resources/registry.conf",
    "raw_url": "https://github.com/dengjin001/fescar/raw/d28274d4f29ce58d62aac37d87296446feb5ae4b/serializer/seata-serializer-seata/src/test/resources/registry.conf",
    "contents_url": "https://api.github.com/repos/dengjin001/fescar/contents/serializer/seata-serializer-seata/src/test/resources/registry.conf?ref=d28274d4f29ce58d62aac37d87296446feb5ae4b",
    "patch": "@@ -1,8 +1,6 @@\n registry {\n   # file 、nacos 、eureka、redis、zk、consul、etcd3、sofa\n   type = \"file\"\n-  loadBalance = \"RandomLoadBalance\"\n-  loadBalanceVirtualNodes = 10\n \n   nacos {\n     serverAddr = \"localhost\""
  },
  {
    "sha": "8fb49b27a59f3830132faff53aff0d2ab70e5234",
    "filename": "server/src/main/resources/registry.conf",
    "status": "modified",
    "additions": 0,
    "deletions": 2,
    "changes": 2,
    "blob_url": "https://github.com/dengjin001/fescar/blob/d28274d4f29ce58d62aac37d87296446feb5ae4b/server/src/main/resources/registry.conf",
    "raw_url": "https://github.com/dengjin001/fescar/raw/d28274d4f29ce58d62aac37d87296446feb5ae4b/server/src/main/resources/registry.conf",
    "contents_url": "https://api.github.com/repos/dengjin001/fescar/contents/server/src/main/resources/registry.conf?ref=d28274d4f29ce58d62aac37d87296446feb5ae4b",
    "patch": "@@ -1,8 +1,6 @@\n registry {\n   # file 、nacos 、eureka、redis、zk、consul、etcd3、sofa\n   type = \"file\"\n-  loadBalance = \"RandomLoadBalance\"\n-  loadBalanceVirtualNodes = 10\n \n   nacos {\n     application = \"seata-server\""
  },
  {
    "sha": "eb2f98d58cebef33a9b5297085c7c26ff0ea5950",
    "filename": "test/src/test/resources/file.conf",
    "status": "modified",
    "additions": 4,
    "deletions": 0,
    "changes": 4,
    "blob_url": "https://github.com/dengjin001/fescar/blob/d28274d4f29ce58d62aac37d87296446feb5ae4b/test/src/test/resources/file.conf",
    "raw_url": "https://github.com/dengjin001/fescar/raw/d28274d4f29ce58d62aac37d87296446feb5ae4b/test/src/test/resources/file.conf",
    "contents_url": "https://api.github.com/repos/dengjin001/fescar/contents/test/src/test/resources/file.conf?ref=d28274d4f29ce58d62aac37d87296446feb5ae4b",
    "patch": "@@ -15,4 +15,8 @@ client {\n     sagaRetryPersistModeUpdate = false\n     sagaCompensatePersistModeUpdate = false\n   }\n+  loadBalance {\n+      type = \"RandomLoadBalance\"\n+      virtualNodes = 10\n+  }\n }\n\\ No newline at end of file"
  },
  {
    "sha": "0a9bfecd757db725f2da9436cf3af522bf5d0390",
    "filename": "test/src/test/resources/registry.conf",
    "status": "modified",
    "additions": 0,
    "deletions": 2,
    "changes": 2,
    "blob_url": "https://github.com/dengjin001/fescar/blob/d28274d4f29ce58d62aac37d87296446feb5ae4b/test/src/test/resources/registry.conf",
    "raw_url": "https://github.com/dengjin001/fescar/raw/d28274d4f29ce58d62aac37d87296446feb5ae4b/test/src/test/resources/registry.conf",
    "contents_url": "https://api.github.com/repos/dengjin001/fescar/contents/test/src/test/resources/registry.conf?ref=d28274d4f29ce58d62aac37d87296446feb5ae4b",
    "patch": "@@ -1,8 +1,6 @@\n registry {\n   # file 、nacos 、eureka、redis、zk、consul、etcd3、sofa\n   type = \"file\"\n-  loadBalance = \"RandomLoadBalance\"\n-  loadBalanceVirtualNodes = 10\n \n   nacos {\n     serverAddr = \"localhost\""
  }
]

[
  {
    "sha": "bf6edc03a5e45be53d529b13a3b2a01fd3a4564f",
    "filename": ".github/badges/jacoco.svg",
    "status": "added",
    "additions": 1,
    "deletions": 0,
    "changes": 1,
    "blob_url": "https://github.com/yagosupro/tgnotifier/blob/0d64c1885387ad3f6302c707bca6ae27ebebe2fa/.github/badges/jacoco.svg",
    "raw_url": "https://github.com/yagosupro/tgnotifier/raw/0d64c1885387ad3f6302c707bca6ae27ebebe2fa/.github/badges/jacoco.svg",
    "contents_url": "https://api.github.com/repos/yagosupro/tgnotifier/contents/.github/badges/jacoco.svg?ref=0d64c1885387ad3f6302c707bca6ae27ebebe2fa",
    "patch": "@@ -0,0 +1 @@\n+<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"104\" height=\"20\" role=\"img\" aria-label=\"coverage: 47.2%\"><linearGradient id=\"s\" x2=\"0\" y2=\"100%\"><stop offset=\"0\" stop-color=\"#bbb\" stop-opacity=\".1\"/><stop offset=\"1\" stop-opacity=\".1\"/></linearGradient><clipPath id=\"r\"><rect width=\"104\" height=\"20\" rx=\"3\" fill=\"#fff\"/></clipPath><g clip-path=\"url(#r)\"><rect width=\"61\" height=\"20\" fill=\"#555\"/><rect x=\"61\" width=\"43\" height=\"20\" fill=\"#e05d44\"/><rect width=\"104\" height=\"20\" fill=\"url(#s)\"/></g><g fill=\"#fff\" text-anchor=\"middle\" font-family=\"Verdana,Geneva,DejaVu Sans,sans-serif\" text-rendering=\"geometricPrecision\" font-size=\"110\"><text aria-hidden=\"true\" x=\"315\" y=\"150\" fill=\"#010101\" fill-opacity=\".3\" transform=\"scale(.1)\" textLength=\"510\">coverage</text><text x=\"315\" y=\"140\" transform=\"scale(.1)\" fill=\"#fff\" textLength=\"510\">coverage</text><text aria-hidden=\"true\" x=\"815\" y=\"150\" fill=\"#010101\" fill-opacity=\".3\" transform=\"scale(.1)\" textLength=\"330\">47.2%</text><text x=\"815\" y=\"140\" transform=\"scale(.1)\" fill=\"#fff\" textLength=\"330\">47.2%</text></g></svg>\n\\ No newline at end of file"
  },
  {
    "sha": "19297567fc8d08a1005bdfb251d01c75889afb0e",
    "filename": ".github/workflows/maven.yml",
    "status": "added",
    "additions": 63,
    "deletions": 0,
    "changes": 63,
    "blob_url": "https://github.com/yagosupro/tgnotifier/blob/0d64c1885387ad3f6302c707bca6ae27ebebe2fa/.github/workflows/maven.yml",
    "raw_url": "https://github.com/yagosupro/tgnotifier/raw/0d64c1885387ad3f6302c707bca6ae27ebebe2fa/.github/workflows/maven.yml",
    "contents_url": "https://api.github.com/repos/yagosupro/tgnotifier/contents/.github/workflows/maven.yml?ref=0d64c1885387ad3f6302c707bca6ae27ebebe2fa",
    "patch": "@@ -0,0 +1,63 @@\n+# This workflow will build a Java project with Maven\n+# For more information see: https://help.github.com/actions/language-and-framework-guides/building-and-testing-java-with-maven\n+\n+name: Java CI with Maven\n+\n+on:\n+  push:\n+    branches: [ master ]\n+  pull_request:\n+    branches: [ master ]\n+\n+jobs:\n+  build:\n+\n+    runs-on: ubuntu-latest\n+\n+    services:\n+      mysql:\n+        image: mysql:8.0.17\n+        env:\n+          MYSQL_ROOT_PASSWORD: root\n+          MYSQL_USER: harvest\n+          MYSQL_PASSWORD: harvest\n+          MYSQL_DATABASE: harvest\n+        ports:\n+          - 3306:3306\n+        options:\n+          --health-cmd=\"mysqladmin ping\" --health-interval=10s --health-timeout=5s --health-retries=3\n+\n+\n+    steps:\n+      - uses: actions/checkout@v2\n+      - name: Set up JDK 1.11\n+        uses: actions/setup-java@v1\n+        with:\n+          java-version: 1.11\n+      - name: Build with Maven\n+        run: mvn -Dtgnotifier.telegramToken=\"${{secrets.TELEGRAM_TOKEN}}\" -Dtgnotifier.wsUrl=\"https://ethparser-staging.herokuapp.com/stomp\" -Dspring.datasource.url=jdbc:mysql://localhost:3306/harvest -Dspring.datasource.username=harvest -Dspring.datasource.password=harvest -B package -ff -T 1 --file pom.xml\n+\n+      - name: Generate JaCoCo Badge\n+        id: jacoco\n+        uses: cicirello/jacoco-badge-generator@v2.0.1\n+\n+      - name: Log coverage percentage\n+        run: |\n+          echo \"coverage = ${{ steps.jacoco.outputs.coverage }}\"\n+          echo \"branch coverage = ${{ steps.jacoco.outputs.branches }}\"\n+\n+      - name: Commit the badge (if it changed)\n+        run: |\n+          if [[ `git status --porcelain` ]]; then\n+            git config --global user.name 'codecoverage'\n+            git config --global user.email 'codecoverage@users.noreply.github.com'\n+            git add -A\n+            git commit -m \"Autogenerated JaCoCo coverage badge\"\n+            git push\n+          fi\n+\n+      - name: Upload JaCoCo coverage report\n+        uses: actions/upload-artifact@v2\n+        with:\n+          name: jacoco-report\n+          path: target/site/jacoco/\n\\ No newline at end of file"
  },
  {
    "sha": "b1446a404be01714998c0c05a51ddbe7889f2ca3",
    "filename": "README.md",
    "status": "added",
    "additions": 3,
    "deletions": 0,
    "changes": 3,
    "blob_url": "https://github.com/yagosupro/tgnotifier/blob/0d64c1885387ad3f6302c707bca6ae27ebebe2fa/README.md",
    "raw_url": "https://github.com/yagosupro/tgnotifier/raw/0d64c1885387ad3f6302c707bca6ae27ebebe2fa/README.md",
    "contents_url": "https://api.github.com/repos/yagosupro/tgnotifier/contents/README.md?ref=0d64c1885387ad3f6302c707bca6ae27ebebe2fa",
    "patch": "@@ -0,0 +1,3 @@\n+# TelegramBot backend\n+\n+![Code Coverage](.github/badges/jacoco.svg)\n\\ No newline at end of file"
  },
  {
    "sha": "febef387b3e06c6842a98e825477c42e7434d007",
    "filename": "pom.xml",
    "status": "modified",
    "additions": 20,
    "deletions": 0,
    "changes": 20,
    "blob_url": "https://github.com/yagosupro/tgnotifier/blob/0d64c1885387ad3f6302c707bca6ae27ebebe2fa/pom.xml",
    "raw_url": "https://github.com/yagosupro/tgnotifier/raw/0d64c1885387ad3f6302c707bca6ae27ebebe2fa/pom.xml",
    "contents_url": "https://api.github.com/repos/yagosupro/tgnotifier/contents/pom.xml?ref=0d64c1885387ad3f6302c707bca6ae27ebebe2fa",
    "patch": "@@ -143,6 +143,26 @@\n         </executions>\n       </plugin>\n \n+      <plugin>\n+        <groupId>org.jacoco</groupId>\n+        <artifactId>jacoco-maven-plugin</artifactId>\n+        <version>0.8.6</version>\n+        <executions>\n+          <execution>\n+            <goals>\n+              <goal>prepare-agent</goal>\n+            </goals>\n+          </execution>\n+          <execution>\n+            <id>generate-code-coverage-report</id>\n+            <phase>test</phase>\n+            <goals>\n+              <goal>report</goal>\n+            </goals>\n+          </execution>\n+        </executions>\n+      </plugin>\n+\n     </plugins>\n   </build>\n "
  },
  {
    "sha": "e19d68426ad63d9a25ef67297e210c58714d0ab9",
    "filename": "src/test/java/pro/belbix/tgnotifier/ApplicationTest.java",
    "status": "modified",
    "additions": 14,
    "deletions": 11,
    "changes": 25,
    "blob_url": "https://github.com/yagosupro/tgnotifier/blob/0d64c1885387ad3f6302c707bca6ae27ebebe2fa/src/test/java/pro/belbix/tgnotifier/ApplicationTest.java",
    "raw_url": "https://github.com/yagosupro/tgnotifier/raw/0d64c1885387ad3f6302c707bca6ae27ebebe2fa/src/test/java/pro/belbix/tgnotifier/ApplicationTest.java",
    "contents_url": "https://api.github.com/repos/yagosupro/tgnotifier/contents/src/test/java/pro/belbix/tgnotifier/ApplicationTest.java?ref=0d64c1885387ad3f6302c707bca6ae27ebebe2fa",
    "patch": "@@ -9,22 +9,25 @@\n import pro.belbix.tgnotifier.tg.TelegramBotService;\n import pro.belbix.tgnotifier.ws.WebSocketService;\n \n+import static pro.belbix.tgnotifier.properties.ConstantsTest.REPEAT_TIME;\n+\n @RunWith(SpringRunner.class)\n @SpringBootTest(classes = Application.class)\n @ActiveProfiles(\"test\")\n public class ApplicationTest {\n \n-  @Autowired\n-  private WebSocketService webSocketService;\n-  @Autowired\n-  private TelegramBotService telegramBotService;\n+    @Autowired\n+    private WebSocketService webSocketService;\n+    @Autowired\n+    private TelegramBotService telegramBotService;\n+\n+    @Test\n+    public void main() throws InterruptedException {\n+        webSocketService.start();\n+        telegramBotService.init();\n \n-  @Test\n-  public void main() throws InterruptedException {\n-    webSocketService.start();\n-    telegramBotService.init();\n-    while (true) {\n-      Thread.sleep(100);\n+        for (int i = 0; i < REPEAT_TIME; i++) {\n+            Thread.sleep(100);\n+        }\n     }\n-  }\n }"
  },
  {
    "sha": "7badb2325af542224a03c865c5a78db4c6effc64",
    "filename": "src/test/java/pro/belbix/tgnotifier/properties/ConstantsTest.java",
    "status": "added",
    "additions": 7,
    "deletions": 0,
    "changes": 7,
    "blob_url": "https://github.com/yagosupro/tgnotifier/blob/0d64c1885387ad3f6302c707bca6ae27ebebe2fa/src/test/java/pro/belbix/tgnotifier/properties/ConstantsTest.java",
    "raw_url": "https://github.com/yagosupro/tgnotifier/raw/0d64c1885387ad3f6302c707bca6ae27ebebe2fa/src/test/java/pro/belbix/tgnotifier/properties/ConstantsTest.java",
    "contents_url": "https://api.github.com/repos/yagosupro/tgnotifier/contents/src/test/java/pro/belbix/tgnotifier/properties/ConstantsTest.java?ref=0d64c1885387ad3f6302c707bca6ae27ebebe2fa",
    "patch": "@@ -0,0 +1,7 @@\n+package pro.belbix.tgnotifier.properties;\n+\n+public class ConstantsTest {\n+\n+  public static final int REPEAT_TIME = 20;\n+\n+}"
  },
  {
    "sha": "898614a4a18e2c0ec1bf7ea7c0d3801e9442cbfa",
    "filename": "src/test/java/pro/belbix/tgnotifier/tg/TelegramBotServiceTest.java",
    "status": "modified",
    "additions": 4,
    "deletions": 1,
    "changes": 5,
    "blob_url": "https://github.com/yagosupro/tgnotifier/blob/0d64c1885387ad3f6302c707bca6ae27ebebe2fa/src/test/java/pro/belbix/tgnotifier/tg/TelegramBotServiceTest.java",
    "raw_url": "https://github.com/yagosupro/tgnotifier/raw/0d64c1885387ad3f6302c707bca6ae27ebebe2fa/src/test/java/pro/belbix/tgnotifier/tg/TelegramBotServiceTest.java",
    "contents_url": "https://api.github.com/repos/yagosupro/tgnotifier/contents/src/test/java/pro/belbix/tgnotifier/tg/TelegramBotServiceTest.java?ref=0d64c1885387ad3f6302c707bca6ae27ebebe2fa",
    "patch": "@@ -1,5 +1,7 @@\n package pro.belbix.tgnotifier.tg;\n \n+import static pro.belbix.tgnotifier.properties.ConstantsTest.REPEAT_TIME;\n+\n import org.junit.Test;\n import org.junit.runner.RunWith;\n import org.springframework.beans.factory.annotation.Autowired;\n@@ -21,7 +23,8 @@ public void startTestTelegram() throws InterruptedException {\n     telegramBotService.init();\n \n     telegramBotService.sendMessage(0, \"test\", null, false);\n-    while (true) {\n+\n+    for (int i = 0; i < REPEAT_TIME; i++) {\n       Thread.sleep(100);\n     }\n   }"
  },
  {
    "sha": "cdb1cd6770d7dca9091538903a294e37af558680",
    "filename": "src/test/java/pro/belbix/tgnotifier/ws/WebSocketServiceTest.java",
    "status": "modified",
    "additions": 3,
    "deletions": 1,
    "changes": 4,
    "blob_url": "https://github.com/yagosupro/tgnotifier/blob/0d64c1885387ad3f6302c707bca6ae27ebebe2fa/src/test/java/pro/belbix/tgnotifier/ws/WebSocketServiceTest.java",
    "raw_url": "https://github.com/yagosupro/tgnotifier/raw/0d64c1885387ad3f6302c707bca6ae27ebebe2fa/src/test/java/pro/belbix/tgnotifier/ws/WebSocketServiceTest.java",
    "contents_url": "https://api.github.com/repos/yagosupro/tgnotifier/contents/src/test/java/pro/belbix/tgnotifier/ws/WebSocketServiceTest.java?ref=0d64c1885387ad3f6302c707bca6ae27ebebe2fa",
    "patch": "@@ -1,5 +1,7 @@\n package pro.belbix.tgnotifier.ws;\n \n+import static pro.belbix.tgnotifier.properties.ConstantsTest.REPEAT_TIME;\n+\n import org.junit.Test;\n import org.junit.runner.RunWith;\n import org.springframework.beans.factory.annotation.Autowired;\n@@ -19,7 +21,7 @@\n   @Test\n   public void startWsTest() throws InterruptedException {\n     webSocketService.start();\n-    while (true) {\n+    for (int i = 0; i < REPEAT_TIME; i++) {\n       Thread.sleep(100);\n     }\n   }"
  }
]

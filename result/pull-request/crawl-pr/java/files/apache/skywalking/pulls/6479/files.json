[
  {
    "sha": "d97e176af815cfe3d5789a68fff249831532aa6e",
    "filename": "CHANGES.md",
    "status": "modified",
    "additions": 1,
    "deletions": 0,
    "changes": 1,
    "blob_url": "https://github.com/apache/skywalking/blob/21760afe8c0aa5daf10a5460a5fe8f14a9812a69/CHANGES.md",
    "raw_url": "https://github.com/apache/skywalking/raw/21760afe8c0aa5daf10a5460a5fe8f14a9812a69/CHANGES.md",
    "contents_url": "https://api.github.com/repos/apache/skywalking/contents/CHANGES.md?ref=21760afe8c0aa5daf10a5460a5fe8f14a9812a69",
    "patch": "@@ -40,6 +40,7 @@ Release Notes.\n * Fix `DatabaseSlowStatementBuilder` statement maybe null.\n * Remove fields of parent entity in the relation sources. \n * Save Envoy http access logs when error occurs.\n+* Support k8s cluster monitoring, the global information.\n \n #### UI\n * Update selector scroller to show in all pages."
  },
  {
    "sha": "d660b8be5dc1c6e603f049498a5dfd9836f4c779",
    "filename": "docs/en/setup/backend/backend-receivers.md",
    "status": "modified",
    "additions": 1,
    "deletions": 1,
    "changes": 2,
    "blob_url": "https://github.com/apache/skywalking/blob/21760afe8c0aa5daf10a5460a5fe8f14a9812a69/docs/en/setup/backend/backend-receivers.md",
    "raw_url": "https://github.com/apache/skywalking/raw/21760afe8c0aa5daf10a5460a5fe8f14a9812a69/docs/en/setup/backend/backend-receivers.md",
    "contents_url": "https://api.github.com/repos/apache/skywalking/contents/docs/en/setup/backend/backend-receivers.md?ref=21760afe8c0aa5daf10a5460a5fe8f14a9812a69",
    "patch": "@@ -132,7 +132,7 @@ to be the identification of the metric data.\n |istio-controlplane| Metrics of Istio control panel | otel-oc-rules/istio-controlplane.yaml | Istio Control Panel -> OpenTelemetry Collector --OC format--> SkyWalking OAP Server |\n |oap| Metrics of SkyWalking OAP server itself | otel-oc-rules/oap.yaml | SkyWalking OAP Server(SelfObservability) -> OpenTelemetry Collector --OC format--> SkyWalking OAP Server |\n |vm| Metrics of VMs | otel-oc-rules/vm.yaml | Prometheus node-exporter(VMs) -> OpenTelemetry Collector --OC format--> SkyWalking OAP Server |\n-\n+|k8s-cluster| Metrics of K8s cluster | otel-oc-rules/k8s-cluster.yaml | K8s kube-state-metrics -> OpenTelemetry Collector --OC format--> SkyWalking OAP Server |\n ## Meter receiver\n \n Meter receiver supports accept the metrics into the meter-system. OAP can load the configuration at bootstrap. "
  },
  {
    "sha": "2c9d2083a1e273c4ea470ef22bc1400eb64409e2",
    "filename": "oap-server/server-bootstrap/src/main/resources/otel-oc-rules/k8s-cluster.yaml",
    "status": "added",
    "additions": 90,
    "deletions": 0,
    "changes": 90,
    "blob_url": "https://github.com/apache/skywalking/blob/21760afe8c0aa5daf10a5460a5fe8f14a9812a69/oap-server/server-bootstrap/src/main/resources/otel-oc-rules/k8s-cluster.yaml",
    "raw_url": "https://github.com/apache/skywalking/raw/21760afe8c0aa5daf10a5460a5fe8f14a9812a69/oap-server/server-bootstrap/src/main/resources/otel-oc-rules/k8s-cluster.yaml",
    "contents_url": "https://api.github.com/repos/apache/skywalking/contents/oap-server/server-bootstrap/src/main/resources/otel-oc-rules/k8s-cluster.yaml?ref=21760afe8c0aa5daf10a5460a5fe8f14a9812a69",
    "patch": "@@ -0,0 +1,90 @@\n+# Licensed to the Apache Software Foundation (ASF) under one or more\n+# contributor license agreements.  See the NOTICE file distributed with\n+# this work for additional information regarding copyright ownership.\n+# The ASF licenses this file to You under the Apache License, Version 2.0\n+# (the \"License\"); you may not use this file except in compliance with\n+# the License.  You may obtain a copy of the License at\n+#\n+#     http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# See the License for the specific language governing permissions and\n+# limitations under the License.\n+\n+# This will parse a textual representation of a duration. The formats\n+# accepted are based on the ISO-8601 duration format {@code PnDTnHnMn.nS}\n+# with days considered to be exactly 24 hours.\n+# <p>\n+# Examples:\n+# <pre>\n+#    \"PT20.345S\" -- parses as \"20.345 seconds\"\n+#    \"PT15M\"     -- parses as \"15 minutes\" (where a minute is 60 seconds)\n+#    \"PT10H\"     -- parses as \"10 hours\" (where an hour is 3600 seconds)\n+#    \"P2D\"       -- parses as \"2 days\" (where a day is 24 hours or 86400 seconds)\n+#    \"P2DT3H4M\"  -- parses as \"2 days, 3 hours and 4 minutes\"\n+#    \"P-6H3M\"    -- parses as \"-6 hours and +3 minutes\"\n+#    \"-P6H3M\"    -- parses as \"-6 hours and -3 minutes\"\n+#    \"-P-6H+3M\"  -- parses as \"+6 hours and -3 minutes\"\n+# </pre>\n+expSuffix: tag({tags -> tags.cluster = 'k8s-cluster::' + tags.cluster}).service(['cluster'])\n+metricPrefix: k8s_cluster\n+metricsRules:\n+\n+\n+  - name: cpu_cores\n+    exp: (kube_node_status_capacity * 100).tagEqual('resource' , 'cpu').sum(['cluster'])\n+  - name: cpu_cores_allocatable\n+    exp: (kube_node_status_allocatable * 100).tagEqual('resource' , 'cpu').sum(['cluster'])\n+  - name: cpu_cores_requests\n+    exp: (kube_pod_container_resource_requests * 100).tagEqual('resource' , 'cpu').sum(['cluster'])\n+  - name: cpu_cores_limits\n+    exp: (kube_pod_container_resource_limits * 100).tagEqual('resource' , 'cpu').sum(['cluster'])\n+\n+  - name: memory_total\n+    exp: kube_node_status_capacity.tagEqual('resource' , 'memory').sum(['cluster'])\n+  - name: memory_allocatable\n+    exp: kube_node_status_allocatable.tagEqual('resource' , 'memory').sum(['cluster'])\n+  - name: memory_requests\n+    exp: kube_pod_container_resource_requests.tagEqual('resource' , 'memory').sum(['cluster'])\n+  - name: memory_limits\n+    exp: kube_pod_container_resource_limits.tagEqual('resource' , 'memory').sum(['cluster'])\n+\n+  - name: disk_total\n+    exp: kube_node_status_capacity.tagEqual('resource' , 'ephemeral_storage').sum(['cluster'])\n+  - name: disk_allocatable\n+    exp: kube_node_status_allocatable.tagEqual('resource' , 'ephemeral_storage').sum(['cluster'])\n+\n+  - name: node_count\n+    exp: kube_node_info.sum(['cluster'])\n+  - name: node_status\n+    exp: kube_node_status_condition.tagMatch('status' , 'true|unknown').sum(['cluster' , 'node' ,'condition'])\n+\n+  - name: namespace_count\n+    exp: kube_namespace_labels.sum(['cluster' , 'namespace'])\n+\n+  - name: deployment_count\n+    exp: kube_deployment_labels.sum(['cluster' , 'deployment'])\n+  - name: deployment_status\n+    exp: kube_deployment_status_condition.tagMatch('status' , 'true').sum(['cluster' , 'deployment' ,'condition'])\n+  - name: deployment_spec_replicas\n+    exp: kube_deployment_spec_replicas.sum(['cluster' , 'deployment'])\n+\n+\n+  - name: service_count\n+    exp: kube_service_info.sum(['cluster' , 'service'])\n+  - name: container_count\n+    exp: kube_pod_container_info.sum(['cluster' , 'container'])\n+  - name: container_status_waiting\n+    exp: kube_pod_container_status_waiting.sum(['cluster' , 'container'])\n+  - name: container_status_terminated\n+    exp: kube_pod_container_status_terminated.sum(['cluster' , 'container'])\n+\n+\n+  - name: pod_count\n+    exp: kube_pod_info.sum(['cluster'])\n+  - name: pod_status_running\n+    exp: kube_pod_status_phase.tagMatch('phase' , 'Running').sum(['cluster' , 'pod'])\n+  - name: pod_status_not_running\n+    exp: kube_pod_status_phase.tagNotMatch('phase' , 'Running').sum(['cluster' , 'pod'])"
  },
  {
    "sha": "0827c038f3d4f5c20af836e3ccafacaac45ad014",
    "filename": "oap-server/server-bootstrap/src/main/resources/ui-initialized-templates/k8s.yml",
    "status": "added",
    "additions": 229,
    "deletions": 0,
    "changes": 229,
    "blob_url": "https://github.com/apache/skywalking/blob/21760afe8c0aa5daf10a5460a5fe8f14a9812a69/oap-server/server-bootstrap/src/main/resources/ui-initialized-templates/k8s.yml",
    "raw_url": "https://github.com/apache/skywalking/raw/21760afe8c0aa5daf10a5460a5fe8f14a9812a69/oap-server/server-bootstrap/src/main/resources/ui-initialized-templates/k8s.yml",
    "contents_url": "https://api.github.com/repos/apache/skywalking/contents/oap-server/server-bootstrap/src/main/resources/ui-initialized-templates/k8s.yml?ref=21760afe8c0aa5daf10a5460a5fe8f14a9812a69",
    "patch": "@@ -0,0 +1,229 @@\n+# Licensed to the Apache Software Foundation (ASF) under one or more\n+# contributor license agreements.  See the NOTICE file distributed with\n+# this work for additional information regarding copyright ownership.\n+# The ASF licenses this file to You under the Apache License, Version 2.0\n+# (the \"License\"); you may not use this file except in compliance with\n+# the License.  You may obtain a copy of the License at\n+#\n+#     http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# See the License for the specific language governing permissions and\n+# limitations under the License.\n+\n+# UI templates initialized file includes the default template when the SkyWalking OAP starts up at the first time.\n+#\n+# Also, SkyWalking would detect the existing templates in the database, once they are missing, all templates in this file\n+# could be added automatically.\n+\n+templates:\n+  - name: \"K8s\"\n+    # The type includes DASHBOARD, TOPOLOGY_INSTANCE, TOPOLOGY_ENDPOINT.\n+    # DASHBOARD type templates could have multiple definitions, by using different names.\n+    # TOPOLOGY_INSTANCE, TOPOLOGY_ENDPOINT type templates should be defined once, as they are used in the topology page only.\n+    type: \"DASHBOARD\"\n+    # Configuration could be defined through UI, and use `export` to format in the standard JSON.\n+    configuration: |-\n+      [\n+          {\n+              \"name\": \"K8s\",\n+              \"type\": \"service\",\n+              \"serviceGroup\": \"k8s-cluster\",\n+              \"children\": [\n+                  {\n+                      \"name\": \"Cluster\",\n+                      \"children\": [\n+                          {\n+                              \"width\": \"4\",\n+                              \"title\": \"CPU Cores\",\n+                              \"height\": 350,\n+                              \"entityType\": \"Service\",\n+                              \"independentSelector\": false,\n+                              \"metricType\": \"REGULAR_VALUE\",\n+                              \"metricName\": \"k8s_cluster_cpu_cores,k8s_cluster_cpu_cores_requests,k8s_cluster_cpu_cores_limits,k8s_cluster_cpu_cores_allocatable\",\n+                              \"queryMetricType\": \"readMetricsValues\",\n+                              \"chartType\": \"ChartArea\",\n+                              \"aggregation\": \"/\",\n+                              \"aggregationNum\": \"100\"\n+                          },\n+                          {\n+                              \"width\": \"4\",\n+                              \"title\": \"Memory (GB)\",\n+                              \"height\": 350,\n+                              \"entityType\": \"Service\",\n+                              \"independentSelector\": false,\n+                              \"metricType\": \"REGULAR_VALUE\",\n+                              \"metricName\": \"k8s_cluster_memory_total,k8s_cluster_memory_requests,k8s_cluster_memory_limits,k8s_cluster_memory_allocatable\",\n+                              \"queryMetricType\": \"readMetricsValues\",\n+                              \"chartType\": \"ChartArea\",\n+                              \"aggregation\": \"/\",\n+                              \"aggregationNum\": \"1073741824\"\n+                          },\n+                          {\n+                              \"width\": \"4\",\n+                              \"title\": \"Ephemeral Storage (GB)\",\n+                              \"height\": 350,\n+                              \"entityType\": \"Service\",\n+                              \"independentSelector\": false,\n+                              \"metricType\": \"REGULAR_VALUE\",\n+                              \"metricName\": \"k8s_cluster_disk_total,k8s_cluster_disk_allocatable\",\n+                              \"queryMetricType\": \"readMetricsValues\",\n+                              \"chartType\": \"ChartArea\",\n+                              \"aggregation\": \"/\",\n+                              \"aggregationNum\": \"1073741824\"\n+                          },\n+                          {\n+                              \"width\": \"2\",\n+                              \"title\": \"Nodes\",\n+                              \"height\": 350,\n+                              \"entityType\": \"Service\",\n+                              \"independentSelector\": false,\n+                              \"metricType\": \"REGULAR_VALUE\",\n+                              \"metricName\": \"k8s_cluster_node_count\",\n+                              \"queryMetricType\": \"readMetricsValue\",\n+                              \"chartType\": \"ChartNum\"\n+                          },\n+                          {\n+                              \"width\": \"5\",\n+                              \"title\": \"Nodes Status\",\n+                              \"height\": \"350\",\n+                              \"entityType\": \"Service\",\n+                              \"independentSelector\": false,\n+                              \"metricType\": \"LABELED_VALUE\",\n+                              \"metricName\": \"k8s_cluster_node_status\",\n+                              \"queryMetricType\": \"readLabeledMetricsValues\",\n+                              \"chartType\": \"ChartBar\"\n+                          },\n+                          {\n+                              \"width\": \"5\",\n+                              \"title\": \"Namespaces\",\n+                              \"height\": 350,\n+                              \"entityType\": \"Service\",\n+                              \"independentSelector\": false,\n+                              \"metricType\": \"LABELED_VALUE\",\n+                              \"metricName\": \"k8s_cluster_namespace_count\",\n+                              \"queryMetricType\": \"readLabeledMetricsValues\",\n+                              \"chartType\": \"ChartBar\"\n+                          },\n+                          {\n+                              \"width\": 4,\n+                              \"title\": \"Deployments\",\n+                              \"height\": 350,\n+                              \"entityType\": \"Service\",\n+                              \"independentSelector\": false,\n+                              \"metricType\": \"LABELED_VALUE\",\n+                              \"metricName\": \"k8s_cluster_deployment_count\",\n+                              \"queryMetricType\": \"readLabeledMetricsValues\",\n+                              \"chartType\": \"ChartBar\"\n+                          },\n+                          {\n+                              \"width\": \"4\",\n+                              \"title\": \"Deployments Status\",\n+                              \"height\": 350,\n+                              \"entityType\": \"Service\",\n+                              \"independentSelector\": false,\n+                              \"metricType\": \"LABELED_VALUE\",\n+                              \"metricName\": \"k8s_cluster_deployment_status\",\n+                              \"queryMetricType\": \"readLabeledMetricsValues\",\n+                              \"chartType\": \"ChartBar\"\n+                          },\n+                          {\n+                              \"width\": \"4\",\n+                              \"title\": \"Deployments Spec Replicas\",\n+                              \"height\": 350,\n+                              \"entityType\": \"Service\",\n+                              \"independentSelector\": false,\n+                              \"metricType\": \"LABELED_VALUE\",\n+                              \"queryMetricType\": \"readLabeledMetricsValues\",\n+                              \"chartType\": \"ChartBar\",\n+                              \"metricName\": \"k8s_cluster_deployment_spec_replicas\"\n+                          },\n+                          {\n+                              \"width\": 3,\n+                              \"title\": \"Services\",\n+                              \"height\": 350,\n+                              \"entityType\": \"Service\",\n+                              \"independentSelector\": false,\n+                              \"metricType\": \"LABELED_VALUE\",\n+                              \"metricName\": \"k8s_cluster_service_count\",\n+                              \"queryMetricType\": \"readLabeledMetricsValues\",\n+                              \"chartType\": \"ChartBar\"\n+                          },\n+                          {\n+                              \"width\": 3,\n+                              \"title\": \"Containers\",\n+                              \"height\": 350,\n+                              \"entityType\": \"Service\",\n+                              \"independentSelector\": false,\n+                              \"metricType\": \"LABELED_VALUE\",\n+                              \"metricName\": \"k8s_cluster_container_count\",\n+                              \"queryMetricType\": \"readLabeledMetricsValues\",\n+                              \"chartType\": \"ChartBar\"\n+                          },\n+                          {\n+                              \"width\": 3,\n+                              \"title\": \"Container Status Waiting\",\n+                              \"height\": 350,\n+                              \"entityType\": \"Service\",\n+                              \"independentSelector\": false,\n+                              \"metricType\": \"LABELED_VALUE\",\n+                              \"metricName\": \"k8s_cluster_container_status_waiting\",\n+                              \"queryMetricType\": \"readLabeledMetricsValues\",\n+                              \"chartType\": \"ChartBar\"\n+                          },\n+                          {\n+                              \"width\": 3,\n+                              \"title\": \"Container Status Terminated\",\n+                              \"height\": 350,\n+                              \"entityType\": \"Service\",\n+                              \"independentSelector\": false,\n+                              \"metricType\": \"LABELED_VALUE\",\n+                              \"metricName\": \"k8s_cluster_container_status_terminated\",\n+                              \"queryMetricType\": \"readLabeledMetricsValues\",\n+                              \"chartType\": \"ChartBar\"\n+                          },\n+                          {\n+                              \"width\": \"2\",\n+                              \"title\": \"Pods\",\n+                              \"height\": 350,\n+                              \"entityType\": \"Service\",\n+                              \"independentSelector\": false,\n+                              \"metricType\": \"REGULAR_VALUE\",\n+                              \"metricName\": \"k8s_cluster_pod_count\",\n+                              \"queryMetricType\": \"readMetricsValue\",\n+                              \"chartType\": \"ChartNum\"\n+                          },\n+                          {\n+                              \"width\": \"5\",\n+                              \"title\": \"Pods Status Running\",\n+                              \"height\": 350,\n+                              \"entityType\": \"Service\",\n+                              \"independentSelector\": false,\n+                              \"metricType\": \"LABELED_VALUE\",\n+                              \"queryMetricType\": \"readLabeledMetricsValues\",\n+                              \"chartType\": \"ChartBar\",\n+                              \"metricName\": \"k8s_cluster_pod_status_running,k8s_cluster_pod_status_not_running\"\n+                          },\n+                          {\n+                              \"width\": \"5\",\n+                              \"title\": \"Pods Status Not Running\",\n+                              \"height\": 350,\n+                              \"entityType\": \"Service\",\n+                              \"independentSelector\": false,\n+                              \"metricType\": \"LABELED_VALUE\",\n+                              \"metricName\": \"k8s_cluster_pod_status_not_running\",\n+                              \"queryMetricType\": \"readLabeledMetricsValues\",\n+                              \"chartType\": \"ChartBar\"\n+                          }\n+                      ]\n+                  }\n+              ]\n+          }\n+      ]\n+    # Activated as the DASHBOARD type, makes this templates added into the UI page automatically.\n+    # False means providing a basic template, user needs to add it manually.\n+    activated: true\n+    # True means wouldn't show up on the dashboard. Only keeps the definition in the storage.\n+    disabled: false"
  }
]

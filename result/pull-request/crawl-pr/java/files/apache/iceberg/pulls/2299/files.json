[
  {
    "sha": "684bcbf4977e35169c9b5d98fb4ad9592072b87d",
    "filename": "api/src/main/java/org/apache/iceberg/TableScan.java",
    "status": "modified",
    "additions": 4,
    "deletions": 0,
    "changes": 4,
    "blob_url": "https://github.com/apache/iceberg/blob/3126a02076dfb5748b2f6fb7907976184602d8be/api/src/main/java/org/apache/iceberg/TableScan.java",
    "raw_url": "https://github.com/apache/iceberg/raw/3126a02076dfb5748b2f6fb7907976184602d8be/api/src/main/java/org/apache/iceberg/TableScan.java",
    "contents_url": "https://api.github.com/repos/apache/iceberg/contents/api/src/main/java/org/apache/iceberg/TableScan.java?ref=3126a02076dfb5748b2f6fb7907976184602d8be",
    "patch": "@@ -209,4 +209,8 @@ default TableScan select(String... columns) {\n    */\n   boolean isCaseSensitive();\n \n+  /**\n+   * Returns the target split size for this scan.\n+   */\n+  long targetSplitSize();\n }"
  },
  {
    "sha": "86b227af6965731feff2c1035eb37d10cc302880",
    "filename": "core/src/main/java/org/apache/iceberg/AllDataFilesTable.java",
    "status": "modified",
    "additions": 2,
    "deletions": 2,
    "changes": 4,
    "blob_url": "https://github.com/apache/iceberg/blob/3126a02076dfb5748b2f6fb7907976184602d8be/core/src/main/java/org/apache/iceberg/AllDataFilesTable.java",
    "raw_url": "https://github.com/apache/iceberg/raw/3126a02076dfb5748b2f6fb7907976184602d8be/core/src/main/java/org/apache/iceberg/AllDataFilesTable.java",
    "contents_url": "https://api.github.com/repos/apache/iceberg/contents/core/src/main/java/org/apache/iceberg/AllDataFilesTable.java?ref=3126a02076dfb5748b2f6fb7907976184602d8be",
    "patch": "@@ -120,8 +120,8 @@ public TableScan asOfTime(long timestampMillis) {\n     }\n \n     @Override\n-    protected long targetSplitSize(TableOperations ops) {\n-      return ops.current().propertyAsLong(\n+    public long targetSplitSize() {\n+      return tableOps().current().propertyAsLong(\n           TableProperties.METADATA_SPLIT_SIZE, TableProperties.METADATA_SPLIT_SIZE_DEFAULT);\n     }\n "
  },
  {
    "sha": "b8f5747a194597b20ac9d0fcebe2b368dad8cd48",
    "filename": "core/src/main/java/org/apache/iceberg/AllEntriesTable.java",
    "status": "modified",
    "additions": 2,
    "deletions": 2,
    "changes": 4,
    "blob_url": "https://github.com/apache/iceberg/blob/3126a02076dfb5748b2f6fb7907976184602d8be/core/src/main/java/org/apache/iceberg/AllEntriesTable.java",
    "raw_url": "https://github.com/apache/iceberg/raw/3126a02076dfb5748b2f6fb7907976184602d8be/core/src/main/java/org/apache/iceberg/AllEntriesTable.java",
    "contents_url": "https://api.github.com/repos/apache/iceberg/contents/core/src/main/java/org/apache/iceberg/AllEntriesTable.java?ref=3126a02076dfb5748b2f6fb7907976184602d8be",
    "patch": "@@ -107,8 +107,8 @@ protected TableScan newRefinedScan(TableOperations ops, Table table, Schema sche\n     }\n \n     @Override\n-    protected long targetSplitSize(TableOperations ops) {\n-      return ops.current().propertyAsLong(\n+    public long targetSplitSize() {\n+      return tableOps().current().propertyAsLong(\n           TableProperties.METADATA_SPLIT_SIZE, TableProperties.METADATA_SPLIT_SIZE_DEFAULT);\n     }\n "
  },
  {
    "sha": "1a71fd9c48827bf9bbfeb00253dd2493a2767eb6",
    "filename": "core/src/main/java/org/apache/iceberg/AllManifestsTable.java",
    "status": "modified",
    "additions": 2,
    "deletions": 2,
    "changes": 4,
    "blob_url": "https://github.com/apache/iceberg/blob/3126a02076dfb5748b2f6fb7907976184602d8be/core/src/main/java/org/apache/iceberg/AllManifestsTable.java",
    "raw_url": "https://github.com/apache/iceberg/raw/3126a02076dfb5748b2f6fb7907976184602d8be/core/src/main/java/org/apache/iceberg/AllManifestsTable.java",
    "contents_url": "https://api.github.com/repos/apache/iceberg/contents/core/src/main/java/org/apache/iceberg/AllManifestsTable.java?ref=3126a02076dfb5748b2f6fb7907976184602d8be",
    "patch": "@@ -128,8 +128,8 @@ public TableScan asOfTime(long timestampMillis) {\n     }\n \n     @Override\n-    protected long targetSplitSize(TableOperations ops) {\n-      return ops.current().propertyAsLong(\n+    public long targetSplitSize() {\n+      return tableOps().current().propertyAsLong(\n           TableProperties.METADATA_SPLIT_SIZE, TableProperties.METADATA_SPLIT_SIZE_DEFAULT);\n     }\n "
  },
  {
    "sha": "356d909f6bba5418f4f9acb7005aae85583bed57",
    "filename": "core/src/main/java/org/apache/iceberg/BaseTableScan.java",
    "status": "modified",
    "additions": 1,
    "deletions": 4,
    "changes": 5,
    "blob_url": "https://github.com/apache/iceberg/blob/3126a02076dfb5748b2f6fb7907976184602d8be/core/src/main/java/org/apache/iceberg/BaseTableScan.java",
    "raw_url": "https://github.com/apache/iceberg/raw/3126a02076dfb5748b2f6fb7907976184602d8be/core/src/main/java/org/apache/iceberg/BaseTableScan.java",
    "contents_url": "https://api.github.com/repos/apache/iceberg/contents/core/src/main/java/org/apache/iceberg/BaseTableScan.java?ref=3126a02076dfb5748b2f6fb7907976184602d8be",
    "patch": "@@ -93,9 +93,6 @@ protected  TableScanContext context() {\n     return context;\n   }\n \n-  @SuppressWarnings(\"checkstyle:HiddenField\")\n-  protected abstract long targetSplitSize(TableOperations ops);\n-\n   @SuppressWarnings(\"checkstyle:HiddenField\")\n   protected abstract TableScan newRefinedScan(\n       TableOperations ops, Table table, Schema schema, TableScanContext context);\n@@ -224,7 +221,7 @@ public TableScan ignoreResiduals() {\n     if (options.containsKey(TableProperties.SPLIT_SIZE)) {\n       splitSize = Long.parseLong(options.get(TableProperties.SPLIT_SIZE));\n     } else {\n-      splitSize = targetSplitSize(ops);\n+      splitSize = targetSplitSize();\n     }\n     int lookback;\n     if (options.containsKey(TableProperties.SPLIT_LOOKBACK)) {"
  },
  {
    "sha": "8a13cbf2b01ab548e88a783334df843561112df1",
    "filename": "core/src/main/java/org/apache/iceberg/DataFilesTable.java",
    "status": "modified",
    "additions": 2,
    "deletions": 2,
    "changes": 4,
    "blob_url": "https://github.com/apache/iceberg/blob/3126a02076dfb5748b2f6fb7907976184602d8be/core/src/main/java/org/apache/iceberg/DataFilesTable.java",
    "raw_url": "https://github.com/apache/iceberg/raw/3126a02076dfb5748b2f6fb7907976184602d8be/core/src/main/java/org/apache/iceberg/DataFilesTable.java",
    "contents_url": "https://api.github.com/repos/apache/iceberg/contents/core/src/main/java/org/apache/iceberg/DataFilesTable.java?ref=3126a02076dfb5748b2f6fb7907976184602d8be",
    "patch": "@@ -102,8 +102,8 @@ protected TableScan newRefinedScan(TableOperations ops, Table table, Schema sche\n     }\n \n     @Override\n-    protected long targetSplitSize(TableOperations ops) {\n-      return ops.current().propertyAsLong(\n+    public long targetSplitSize() {\n+      return tableOps().current().propertyAsLong(\n           TableProperties.METADATA_SPLIT_SIZE, TableProperties.METADATA_SPLIT_SIZE_DEFAULT);\n     }\n "
  },
  {
    "sha": "fdcd5ed356459f2eb2312d280ae4267b01c90ca9",
    "filename": "core/src/main/java/org/apache/iceberg/DataTableScan.java",
    "status": "modified",
    "additions": 2,
    "deletions": 2,
    "changes": 4,
    "blob_url": "https://github.com/apache/iceberg/blob/3126a02076dfb5748b2f6fb7907976184602d8be/core/src/main/java/org/apache/iceberg/DataTableScan.java",
    "raw_url": "https://github.com/apache/iceberg/raw/3126a02076dfb5748b2f6fb7907976184602d8be/core/src/main/java/org/apache/iceberg/DataTableScan.java",
    "contents_url": "https://api.github.com/repos/apache/iceberg/contents/core/src/main/java/org/apache/iceberg/DataTableScan.java?ref=3126a02076dfb5748b2f6fb7907976184602d8be",
    "patch": "@@ -90,8 +90,8 @@ protected TableScan newRefinedScan(TableOperations ops, Table table, Schema sche\n   }\n \n   @Override\n-  protected long targetSplitSize(TableOperations ops) {\n-    return ops.current().propertyAsLong(\n+  public long targetSplitSize() {\n+    return tableOps().current().propertyAsLong(\n         TableProperties.SPLIT_SIZE, TableProperties.SPLIT_SIZE_DEFAULT);\n   }\n }"
  },
  {
    "sha": "9851d720aa4fbc188a45294f3fd4372195243557",
    "filename": "core/src/main/java/org/apache/iceberg/ManifestEntriesTable.java",
    "status": "modified",
    "additions": 2,
    "deletions": 2,
    "changes": 4,
    "blob_url": "https://github.com/apache/iceberg/blob/3126a02076dfb5748b2f6fb7907976184602d8be/core/src/main/java/org/apache/iceberg/ManifestEntriesTable.java",
    "raw_url": "https://github.com/apache/iceberg/raw/3126a02076dfb5748b2f6fb7907976184602d8be/core/src/main/java/org/apache/iceberg/ManifestEntriesTable.java",
    "contents_url": "https://api.github.com/repos/apache/iceberg/contents/core/src/main/java/org/apache/iceberg/ManifestEntriesTable.java?ref=3126a02076dfb5748b2f6fb7907976184602d8be",
    "patch": "@@ -104,8 +104,8 @@ protected TableScan newRefinedScan(TableOperations ops, Table table, Schema sche\n     }\n \n     @Override\n-    protected long targetSplitSize(TableOperations ops) {\n-      return ops.current().propertyAsLong(\n+    public long targetSplitSize() {\n+      return tableOps().current().propertyAsLong(\n           TableProperties.METADATA_SPLIT_SIZE, TableProperties.METADATA_SPLIT_SIZE_DEFAULT);\n     }\n "
  },
  {
    "sha": "3e1918566a65eeed5eac905a9a2658bb105d85f1",
    "filename": "core/src/main/java/org/apache/iceberg/StaticTableScan.java",
    "status": "modified",
    "additions": 2,
    "deletions": 2,
    "changes": 4,
    "blob_url": "https://github.com/apache/iceberg/blob/3126a02076dfb5748b2f6fb7907976184602d8be/core/src/main/java/org/apache/iceberg/StaticTableScan.java",
    "raw_url": "https://github.com/apache/iceberg/raw/3126a02076dfb5748b2f6fb7907976184602d8be/core/src/main/java/org/apache/iceberg/StaticTableScan.java",
    "contents_url": "https://api.github.com/repos/apache/iceberg/contents/core/src/main/java/org/apache/iceberg/StaticTableScan.java?ref=3126a02076dfb5748b2f6fb7907976184602d8be",
    "patch": "@@ -38,8 +38,8 @@ private StaticTableScan(TableOperations ops, Table table, Schema schema,\n   }\n \n   @Override\n-  protected long targetSplitSize(TableOperations ops) {\n-    return ops.current().propertyAsLong(\n+  public long targetSplitSize() {\n+    return tableOps().current().propertyAsLong(\n         TableProperties.METADATA_SPLIT_SIZE, TableProperties.METADATA_SPLIT_SIZE_DEFAULT);\n   }\n "
  }
]

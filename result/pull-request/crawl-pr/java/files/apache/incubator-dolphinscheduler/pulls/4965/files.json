[
  {
    "sha": "ca847388aa3ba4da3c86d4aa9b6a22f0143a15cb",
    "filename": "dolphinscheduler-server/src/main/java/org/apache/dolphinscheduler/server/worker/processor/TaskKillProcessor.java",
    "status": "modified",
    "additions": 16,
    "deletions": 10,
    "changes": 26,
    "blob_url": "https://github.com/apache/incubator-dolphinscheduler/blob/325823d18a4e1863645738c1781c0ad50838ccdc/dolphinscheduler-server/src/main/java/org/apache/dolphinscheduler/server/worker/processor/TaskKillProcessor.java",
    "raw_url": "https://github.com/apache/incubator-dolphinscheduler/raw/325823d18a4e1863645738c1781c0ad50838ccdc/dolphinscheduler-server/src/main/java/org/apache/dolphinscheduler/server/worker/processor/TaskKillProcessor.java",
    "contents_url": "https://api.github.com/repos/apache/incubator-dolphinscheduler/contents/dolphinscheduler-server/src/main/java/org/apache/dolphinscheduler/server/worker/processor/TaskKillProcessor.java?ref=325823d18a4e1863645738c1781c0ad50838ccdc",
    "patch": "@@ -19,11 +19,8 @@\n \n import org.apache.dolphinscheduler.common.Constants;\n import org.apache.dolphinscheduler.common.enums.ExecutionStatus;\n-import org.apache.dolphinscheduler.common.utils.JSONUtils;\n-import org.apache.dolphinscheduler.common.utils.LoggerUtils;\n-import org.apache.dolphinscheduler.common.utils.OSUtils;\n-import org.apache.dolphinscheduler.common.utils.Preconditions;\n-import org.apache.dolphinscheduler.common.utils.StringUtils;\n+import org.apache.dolphinscheduler.common.enums.TaskType;\n+import org.apache.dolphinscheduler.common.utils.*;\n import org.apache.dolphinscheduler.remote.command.Command;\n import org.apache.dolphinscheduler.remote.command.CommandType;\n import org.apache.dolphinscheduler.remote.command.TaskKillRequestCommand;\n@@ -37,6 +34,7 @@\n import org.apache.dolphinscheduler.server.worker.cache.impl.TaskExecutionContextCacheManagerImpl;\n import org.apache.dolphinscheduler.server.worker.config.WorkerConfig;\n import org.apache.dolphinscheduler.server.worker.runner.WorkerManagerThread;\n+import org.apache.dolphinscheduler.server.worker.task.spark.SparkTask;\n import org.apache.dolphinscheduler.service.bean.SpringApplicationContext;\n import org.apache.dolphinscheduler.service.log.LogClientService;\n \n@@ -129,11 +127,19 @@ public void process(Channel channel, Command command) {\n \n             OSUtils.exeCmd(cmd);\n \n-            // find log and kill yarn job\n-            appIds = killYarnJob(Host.of(taskExecutionContext.getHost()).getIp(),\n-                taskExecutionContext.getLogPath(),\n-                taskExecutionContext.getExecutePath(),\n-                taskExecutionContext.getTenantCode());\n+            TaskType anEnum = EnumUtils.getEnum(TaskType.class, taskExecutionContext.getTaskType());\n+            switch (anEnum) {\n+                case SPARK:\n+                case FLINK:\n+                    // find log and kill yarn job\n+                    appIds = killYarnJob(Host.of(taskExecutionContext.getHost()).getIp(),\n+                            taskExecutionContext.getLogPath(),\n+                            taskExecutionContext.getExecutePath(),\n+                            taskExecutionContext.getTenantCode());\n+                    break;\n+                default:\n+                    appIds = Collections.EMPTY_LIST;\n+            }\n \n             return Pair.of(true, appIds);\n         } catch (Exception e) {"
  }
]

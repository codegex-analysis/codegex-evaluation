[
  {
    "sha": "3b15320447f575ea7f56ae5b4f800e2fb25e1914",
    "filename": "flink-dist/pom.xml",
    "status": "modified",
    "additions": 1,
    "deletions": 1,
    "changes": 2,
    "blob_url": "https://github.com/apache/flink/blob/ac91363f476031fe77b25495ffe48fae2de45d77/flink-dist/pom.xml",
    "raw_url": "https://github.com/apache/flink/raw/ac91363f476031fe77b25495ffe48fae2de45d77/flink-dist/pom.xml",
    "contents_url": "https://api.github.com/repos/apache/flink/contents/flink-dist/pom.xml?ref=ac91363f476031fe77b25495ffe48fae2de45d77",
    "patch": "@@ -267,7 +267,7 @@ under the License.\n \n \t\t<dependency>\n \t\t\t<groupId>org.apache.flink</groupId>\n-\t\t\t<artifactId>flink-metrics-prometheus_${scala.binary.version}</artifactId>\n+\t\t\t<artifactId>flink-metrics-prometheus</artifactId>\n \t\t\t<version>${project.version}</version>\n \t\t\t<scope>provided</scope>\n \t\t</dependency>"
  },
  {
    "sha": "811dafc2853b1cf3f2297275cf8533bbc8ad2a5f",
    "filename": "flink-dist/src/main/assemblies/plugins.xml",
    "status": "modified",
    "additions": 1,
    "deletions": 1,
    "changes": 2,
    "blob_url": "https://github.com/apache/flink/blob/ac91363f476031fe77b25495ffe48fae2de45d77/flink-dist/src/main/assemblies/plugins.xml",
    "raw_url": "https://github.com/apache/flink/raw/ac91363f476031fe77b25495ffe48fae2de45d77/flink-dist/src/main/assemblies/plugins.xml",
    "contents_url": "https://api.github.com/repos/apache/flink/contents/flink-dist/src/main/assemblies/plugins.xml?ref=ac91363f476031fe77b25495ffe48fae2de45d77",
    "patch": "@@ -53,7 +53,7 @@\n \t\t</file>\n \n \t\t<file>\n-\t\t\t<source>../flink-metrics/flink-metrics-prometheus/target/flink-metrics-prometheus_${scala.binary.version}-${project.version}.jar</source>\n+\t\t\t<source>../flink-metrics/flink-metrics-prometheus/target/flink-metrics-prometheus-${project.version}.jar</source>\n \t\t\t<outputDirectory>plugins/metrics-prometheus/</outputDirectory>\n \t\t\t<destName>flink-metrics-prometheus-${project.version}.jar</destName>\n \t\t\t<fileMode>0644</fileMode>"
  },
  {
    "sha": "2d047b745b3e2ee98ff3518774af38243df3bc9e",
    "filename": "flink-docs/pom.xml",
    "status": "modified",
    "additions": 1,
    "deletions": 1,
    "changes": 2,
    "blob_url": "https://github.com/apache/flink/blob/ac91363f476031fe77b25495ffe48fae2de45d77/flink-docs/pom.xml",
    "raw_url": "https://github.com/apache/flink/raw/ac91363f476031fe77b25495ffe48fae2de45d77/flink-docs/pom.xml",
    "contents_url": "https://api.github.com/repos/apache/flink/contents/flink-docs/pom.xml?ref=ac91363f476031fe77b25495ffe48fae2de45d77",
    "patch": "@@ -71,7 +71,7 @@ under the License.\n \t\t</dependency>\n \t\t<dependency>\n \t\t\t<groupId>org.apache.flink</groupId>\n-\t\t\t<artifactId>flink-metrics-prometheus_${scala.binary.version}</artifactId>\n+\t\t\t<artifactId>flink-metrics-prometheus</artifactId>\n \t\t\t<version>${project.version}</version>\n \t\t</dependency>\n \t\t<dependency>"
  },
  {
    "sha": "4869c9afd76756c7e87dd63f9f8d92b9b8157065",
    "filename": "flink-end-to-end-tests/flink-metrics-reporter-prometheus-test/pom.xml",
    "status": "modified",
    "additions": 1,
    "deletions": 1,
    "changes": 2,
    "blob_url": "https://github.com/apache/flink/blob/ac91363f476031fe77b25495ffe48fae2de45d77/flink-end-to-end-tests/flink-metrics-reporter-prometheus-test/pom.xml",
    "raw_url": "https://github.com/apache/flink/raw/ac91363f476031fe77b25495ffe48fae2de45d77/flink-end-to-end-tests/flink-metrics-reporter-prometheus-test/pom.xml",
    "contents_url": "https://api.github.com/repos/apache/flink/contents/flink-end-to-end-tests/flink-metrics-reporter-prometheus-test/pom.xml?ref=ac91363f476031fe77b25495ffe48fae2de45d77",
    "patch": "@@ -40,7 +40,7 @@ under the License.\n \t\t</dependency>\n \t\t<dependency>\n \t\t\t<groupId>org.apache.flink</groupId>\n-\t\t\t<artifactId>flink-metrics-prometheus_${scala.binary.version}</artifactId>\n+\t\t\t<artifactId>flink-metrics-prometheus</artifactId>\n \t\t\t<version>${project.version}</version>\n \t\t\t<scope>test</scope>\n \t\t</dependency>"
  },
  {
    "sha": "1a04d8a6eca97673a7e4fa3c719e95ea8b93256b",
    "filename": "flink-metrics/flink-metrics-core/src/main/java/org/apache/flink/metrics/LogicalScopeProvider.java",
    "status": "added",
    "additions": 25,
    "deletions": 0,
    "changes": 25,
    "blob_url": "https://github.com/apache/flink/blob/ac91363f476031fe77b25495ffe48fae2de45d77/flink-metrics/flink-metrics-core/src/main/java/org/apache/flink/metrics/LogicalScopeProvider.java",
    "raw_url": "https://github.com/apache/flink/raw/ac91363f476031fe77b25495ffe48fae2de45d77/flink-metrics/flink-metrics-core/src/main/java/org/apache/flink/metrics/LogicalScopeProvider.java",
    "contents_url": "https://api.github.com/repos/apache/flink/contents/flink-metrics/flink-metrics-core/src/main/java/org/apache/flink/metrics/LogicalScopeProvider.java?ref=ac91363f476031fe77b25495ffe48fae2de45d77",
    "patch": "@@ -0,0 +1,25 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.flink.metrics;\n+\n+/** Extension for metric groups that support logical scopes. */\n+public interface LogicalScopeProvider {\n+    String getLogicalScope(CharacterFilter filter);\n+\n+    String getLogicalScope(CharacterFilter filter, char delimiter);\n+}"
  },
  {
    "sha": "db462a42b486f9d50085410d94ed867ae41b3d58",
    "filename": "flink-metrics/flink-metrics-influxdb/src/main/java/org/apache/flink/metrics/influxdb/MeasurementInfoProvider.java",
    "status": "modified",
    "additions": 2,
    "deletions": 4,
    "changes": 6,
    "blob_url": "https://github.com/apache/flink/blob/ac91363f476031fe77b25495ffe48fae2de45d77/flink-metrics/flink-metrics-influxdb/src/main/java/org/apache/flink/metrics/influxdb/MeasurementInfoProvider.java",
    "raw_url": "https://github.com/apache/flink/raw/ac91363f476031fe77b25495ffe48fae2de45d77/flink-metrics/flink-metrics-influxdb/src/main/java/org/apache/flink/metrics/influxdb/MeasurementInfoProvider.java",
    "contents_url": "https://api.github.com/repos/apache/flink/contents/flink-metrics/flink-metrics-influxdb/src/main/java/org/apache/flink/metrics/influxdb/MeasurementInfoProvider.java?ref=ac91363f476031fe77b25495ffe48fae2de45d77",
    "patch": "@@ -20,9 +20,8 @@\n \n import org.apache.flink.annotation.VisibleForTesting;\n import org.apache.flink.metrics.CharacterFilter;\n+import org.apache.flink.metrics.LogicalScopeProvider;\n import org.apache.flink.metrics.MetricGroup;\n-import org.apache.flink.runtime.metrics.groups.AbstractMetricGroup;\n-import org.apache.flink.runtime.metrics.groups.FrontMetricGroup;\n \n import java.util.HashMap;\n import java.util.Map;\n@@ -63,7 +62,6 @@ private static String getScopedName(String metricName, MetricGroup group) {\n     }\n \n     private static String getLogicalScope(MetricGroup group) {\n-        return ((FrontMetricGroup<AbstractMetricGroup<?>>) group)\n-                .getLogicalScope(CHARACTER_FILTER, SCOPE_SEPARATOR);\n+        return ((LogicalScopeProvider) group).getLogicalScope(CHARACTER_FILTER, SCOPE_SEPARATOR);\n     }\n }"
  },
  {
    "sha": "e91884a753271ab1a7535487e770bb86048b100a",
    "filename": "flink-metrics/flink-metrics-jmx/src/main/java/org/apache/flink/metrics/jmx/JMXReporter.java",
    "status": "modified",
    "additions": 2,
    "deletions": 4,
    "changes": 6,
    "blob_url": "https://github.com/apache/flink/blob/ac91363f476031fe77b25495ffe48fae2de45d77/flink-metrics/flink-metrics-jmx/src/main/java/org/apache/flink/metrics/jmx/JMXReporter.java",
    "raw_url": "https://github.com/apache/flink/raw/ac91363f476031fe77b25495ffe48fae2de45d77/flink-metrics/flink-metrics-jmx/src/main/java/org/apache/flink/metrics/jmx/JMXReporter.java",
    "contents_url": "https://api.github.com/repos/apache/flink/contents/flink-metrics/flink-metrics-jmx/src/main/java/org/apache/flink/metrics/jmx/JMXReporter.java?ref=ac91363f476031fe77b25495ffe48fae2de45d77",
    "patch": "@@ -23,15 +23,14 @@\n import org.apache.flink.metrics.Counter;\n import org.apache.flink.metrics.Gauge;\n import org.apache.flink.metrics.Histogram;\n+import org.apache.flink.metrics.LogicalScopeProvider;\n import org.apache.flink.metrics.Meter;\n import org.apache.flink.metrics.Metric;\n import org.apache.flink.metrics.MetricConfig;\n import org.apache.flink.metrics.MetricGroup;\n import org.apache.flink.metrics.reporter.InstantiateViaFactory;\n import org.apache.flink.metrics.reporter.MetricReporter;\n import org.apache.flink.runtime.management.JMXService;\n-import org.apache.flink.runtime.metrics.groups.AbstractMetricGroup;\n-import org.apache.flink.runtime.metrics.groups.FrontMetricGroup;\n \n import org.slf4j.Logger;\n import org.slf4j.LoggerFactory;\n@@ -198,8 +197,7 @@ public void notifyOfRemovedMetric(Metric metric, String metricName, MetricGroup\n \n     static String generateJmxDomain(String metricName, MetricGroup group) {\n         return JMX_DOMAIN_PREFIX\n-                + ((FrontMetricGroup<AbstractMetricGroup<?>>) group)\n-                        .getLogicalScope(CHARACTER_FILTER, '.')\n+                + ((LogicalScopeProvider) group).getLogicalScope(CHARACTER_FILTER, '.')\n                 + '.'\n                 + metricName;\n     }"
  },
  {
    "sha": "251611a154cf7c9f1ff70f7a0ed8b203e82dc7e3",
    "filename": "flink-metrics/flink-metrics-prometheus/pom.xml",
    "status": "modified",
    "additions": 1,
    "deletions": 8,
    "changes": 9,
    "blob_url": "https://github.com/apache/flink/blob/ac91363f476031fe77b25495ffe48fae2de45d77/flink-metrics/flink-metrics-prometheus/pom.xml",
    "raw_url": "https://github.com/apache/flink/raw/ac91363f476031fe77b25495ffe48fae2de45d77/flink-metrics/flink-metrics-prometheus/pom.xml",
    "contents_url": "https://api.github.com/repos/apache/flink/contents/flink-metrics/flink-metrics-prometheus/pom.xml?ref=ac91363f476031fe77b25495ffe48fae2de45d77",
    "patch": "@@ -29,7 +29,7 @@ under the License.\n \t\t<relativePath>..</relativePath>\n \t</parent>\n \n-\t<artifactId>flink-metrics-prometheus_${scala.binary.version}</artifactId>\n+\t<artifactId>flink-metrics-prometheus</artifactId>\n \t<name>Flink : Metrics : Prometheus</name>\n \n \t<dependencies>\n@@ -47,13 +47,6 @@ under the License.\n \t\t\t<scope>provided</scope>\n \t\t</dependency>\n \n-\t\t<dependency>\n-\t\t\t<groupId>org.apache.flink</groupId>\n-\t\t\t<artifactId>flink-runtime_${scala.binary.version}</artifactId>\n-\t\t\t<version>${project.version}</version>\n-\t\t\t<scope>provided</scope>\n-\t\t</dependency>\n-\n \t\t<dependency>\n \t\t\t<groupId>org.apache.flink</groupId>\n \t\t\t<artifactId>flink-metrics-core</artifactId>"
  },
  {
    "sha": "2328b6298b428dba47e0e7933b079a4fef29637b",
    "filename": "flink-metrics/flink-metrics-prometheus/src/main/java/org/apache/flink/metrics/prometheus/AbstractPrometheusReporter.java",
    "status": "modified",
    "additions": 2,
    "deletions": 4,
    "changes": 6,
    "blob_url": "https://github.com/apache/flink/blob/ac91363f476031fe77b25495ffe48fae2de45d77/flink-metrics/flink-metrics-prometheus/src/main/java/org/apache/flink/metrics/prometheus/AbstractPrometheusReporter.java",
    "raw_url": "https://github.com/apache/flink/raw/ac91363f476031fe77b25495ffe48fae2de45d77/flink-metrics/flink-metrics-prometheus/src/main/java/org/apache/flink/metrics/prometheus/AbstractPrometheusReporter.java",
    "contents_url": "https://api.github.com/repos/apache/flink/contents/flink-metrics/flink-metrics-prometheus/src/main/java/org/apache/flink/metrics/prometheus/AbstractPrometheusReporter.java?ref=ac91363f476031fe77b25495ffe48fae2de45d77",
    "patch": "@@ -25,13 +25,12 @@\n import org.apache.flink.metrics.Gauge;\n import org.apache.flink.metrics.Histogram;\n import org.apache.flink.metrics.HistogramStatistics;\n+import org.apache.flink.metrics.LogicalScopeProvider;\n import org.apache.flink.metrics.Meter;\n import org.apache.flink.metrics.Metric;\n import org.apache.flink.metrics.MetricConfig;\n import org.apache.flink.metrics.MetricGroup;\n import org.apache.flink.metrics.reporter.MetricReporter;\n-import org.apache.flink.runtime.metrics.groups.AbstractMetricGroup;\n-import org.apache.flink.runtime.metrics.groups.FrontMetricGroup;\n \n import io.prometheus.client.Collector;\n import io.prometheus.client.CollectorRegistry;\n@@ -251,8 +250,7 @@ public void notifyOfRemovedMetric(\n \n     @SuppressWarnings(\"unchecked\")\n     private static String getLogicalScope(MetricGroup group) {\n-        return ((FrontMetricGroup<AbstractMetricGroup<?>>) group)\n-                .getLogicalScope(CHARACTER_FILTER, SCOPE_SEPARATOR);\n+        return ((LogicalScopeProvider) group).getLogicalScope(CHARACTER_FILTER, SCOPE_SEPARATOR);\n     }\n \n     @VisibleForTesting"
  },
  {
    "sha": "6776c6c3e9760fab7473bfbd55f3637bb5b8663a",
    "filename": "flink-runtime/src/main/java/org/apache/flink/runtime/metrics/groups/FrontMetricGroup.java",
    "status": "modified",
    "additions": 5,
    "deletions": 1,
    "changes": 6,
    "blob_url": "https://github.com/apache/flink/blob/ac91363f476031fe77b25495ffe48fae2de45d77/flink-runtime/src/main/java/org/apache/flink/runtime/metrics/groups/FrontMetricGroup.java",
    "raw_url": "https://github.com/apache/flink/raw/ac91363f476031fe77b25495ffe48fae2de45d77/flink-runtime/src/main/java/org/apache/flink/runtime/metrics/groups/FrontMetricGroup.java",
    "contents_url": "https://api.github.com/repos/apache/flink/contents/flink-runtime/src/main/java/org/apache/flink/runtime/metrics/groups/FrontMetricGroup.java?ref=ac91363f476031fe77b25495ffe48fae2de45d77",
    "patch": "@@ -20,6 +20,7 @@\n \n import org.apache.flink.annotation.VisibleForTesting;\n import org.apache.flink.metrics.CharacterFilter;\n+import org.apache.flink.metrics.LogicalScopeProvider;\n \n import java.util.Map;\n \n@@ -32,7 +33,8 @@\n  *\n  * @param <P> parentMetricGroup to {@link AbstractMetricGroup AbstractMetricGroup}\n  */\n-public class FrontMetricGroup<P extends AbstractMetricGroup<?>> extends ProxyMetricGroup<P> {\n+public class FrontMetricGroup<P extends AbstractMetricGroup<?>> extends ProxyMetricGroup<P>\n+        implements LogicalScopeProvider {\n \n     @VisibleForTesting static final char DEFAULT_REPLACEMENT = '_';\n     @VisibleForTesting static final char DEFAULT_REPLACEMENT_ALTERNATIVE = '-';\n@@ -68,11 +70,13 @@ public String getMetricIdentifier(String metricName, CharacterFilter filter) {\n                 this.settings.getReporterIndex(), this.settings.getExcludedVariables());\n     }\n \n+    @Override\n     public String getLogicalScope(CharacterFilter filter) {\n         return parentMetricGroup.getLogicalScope(\n                 getDelimiterFilter(this.settings, filter), this.settings.getDelimiter());\n     }\n \n+    @Override\n     public String getLogicalScope(CharacterFilter filter, char delimiter) {\n         return parentMetricGroup.getLogicalScope(\n                 getDelimiterFilter(this.settings, filter),"
  }
]

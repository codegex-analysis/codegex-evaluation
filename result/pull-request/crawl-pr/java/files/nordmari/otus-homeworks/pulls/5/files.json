[
  {
    "sha": "c01d75d486fac978985b29bef9c80ab3b0d64c48",
    "filename": "L16-io/homework/build.gradle",
    "status": "added",
    "additions": 29,
    "deletions": 0,
    "changes": 29,
    "blob_url": "https://github.com/nordmari/otus-homeworks/blob/177381c9e7673240b8192c5ddc64d41122a242c1/L16-io/homework/build.gradle",
    "raw_url": "https://github.com/nordmari/otus-homeworks/raw/177381c9e7673240b8192c5ddc64d41122a242c1/L16-io/homework/build.gradle",
    "contents_url": "https://api.github.com/repos/nordmari/otus-homeworks/contents/L16-io/homework/build.gradle?ref=177381c9e7673240b8192c5ddc64d41122a242c1",
    "patch": "@@ -0,0 +1,29 @@\n+plugins {\n+    id 'java'\n+}\n+\n+dependencies {\n+    implementation 'com.google.guava:guava'\n+    implementation 'com.fasterxml.jackson.core:jackson-databind'\n+    implementation 'javax.json:javax.json-api'\n+\n+    testImplementation ('org.junit.jupiter:junit-jupiter-api')\n+    testImplementation ('org.junit.jupiter:junit-jupiter-engine')\n+    testImplementation ('org.junit.jupiter:junit-jupiter-params')\n+    testImplementation ('org.assertj:assertj-core')\n+    testImplementation ('org.mockito:mockito-core')\n+    testImplementation ('org.mockito:mockito-junit-jupiter')\n+}\n+\n+test {\n+    useJUnitPlatform()\n+    testLogging {\n+        events \"passed\", \"skipped\", \"failed\"\n+    }\n+}\n+\n+tasks.withType(JavaCompile) {\n+    options.with {\n+        encoding = 'UTF-8'\n+    }\n+}\n\\ No newline at end of file"
  },
  {
    "sha": "2832779aaeb7d767b2107fc1089e39953b107cfe",
    "filename": "L16-io/homework/src/main/java/ru/otus/dataprocessor/FileLoader.java",
    "status": "added",
    "additions": 46,
    "deletions": 0,
    "changes": 46,
    "blob_url": "https://github.com/nordmari/otus-homeworks/blob/177381c9e7673240b8192c5ddc64d41122a242c1/L16-io/homework/src/main/java/ru/otus/dataprocessor/FileLoader.java",
    "raw_url": "https://github.com/nordmari/otus-homeworks/raw/177381c9e7673240b8192c5ddc64d41122a242c1/L16-io/homework/src/main/java/ru/otus/dataprocessor/FileLoader.java",
    "contents_url": "https://api.github.com/repos/nordmari/otus-homeworks/contents/L16-io/homework/src/main/java/ru/otus/dataprocessor/FileLoader.java?ref=177381c9e7673240b8192c5ddc64d41122a242c1",
    "patch": "@@ -0,0 +1,46 @@\n+package ru.otus.dataprocessor;\n+\n+import com.fasterxml.jackson.core.JsonProcessingException;\n+import com.fasterxml.jackson.core.type.TypeReference;\n+import ru.otus.dataprocessor.exception.FileProcessingException;\n+import ru.otus.model.Measurement;\n+\n+import java.io.IOException;\n+import java.nio.file.Files;\n+import java.nio.file.Paths;\n+import java.util.List;\n+\n+import static ru.otus.dataprocessor.jackson.mapping.ObjectMapperFactory.measurementMapper;\n+\n+public class FileLoader implements Loader {\n+\n+    private final String fileName;\n+\n+    public FileLoader(String fileName) {\n+        this.fileName = fileName;\n+    }\n+\n+    @Override\n+    public List<Measurement> load() {\n+        //читает файл, парсит и возвращает результат\n+        var jsonMeasurementsList = readJsonStringFromFile();\n+        return deserializeMeasurements(jsonMeasurementsList);\n+    }\n+\n+    private List<Measurement> deserializeMeasurements(String jsonMeasurementsArray) {\n+        try {\n+            return measurementMapper().readValue(jsonMeasurementsArray, new TypeReference<>() {\n+            });\n+        } catch (JsonProcessingException e) {\n+            throw new FileProcessingException(\"Failed to deserialize string \" + jsonMeasurementsArray, e);\n+        }\n+    }\n+\n+    private String readJsonStringFromFile() {\n+        try {\n+            return Files.readString(Paths.get(fileName));\n+        } catch (IOException e) {\n+            throw new FileProcessingException(\"Failed to read from file\", e);\n+        }\n+    }\n+}"
  },
  {
    "sha": "db06333df044c2ee5eff6171f4da777275e89eb5",
    "filename": "L16-io/homework/src/main/java/ru/otus/dataprocessor/FileProcessException.java",
    "status": "added",
    "additions": 11,
    "deletions": 0,
    "changes": 11,
    "blob_url": "https://github.com/nordmari/otus-homeworks/blob/177381c9e7673240b8192c5ddc64d41122a242c1/L16-io/homework/src/main/java/ru/otus/dataprocessor/FileProcessException.java",
    "raw_url": "https://github.com/nordmari/otus-homeworks/raw/177381c9e7673240b8192c5ddc64d41122a242c1/L16-io/homework/src/main/java/ru/otus/dataprocessor/FileProcessException.java",
    "contents_url": "https://api.github.com/repos/nordmari/otus-homeworks/contents/L16-io/homework/src/main/java/ru/otus/dataprocessor/FileProcessException.java?ref=177381c9e7673240b8192c5ddc64d41122a242c1",
    "patch": "@@ -0,0 +1,11 @@\n+package ru.otus.dataprocessor;\n+\n+public class FileProcessException extends RuntimeException {\n+    public FileProcessException(Exception ex) {\n+        super(ex);\n+    }\n+\n+    public FileProcessException(String msg) {\n+        super(msg);\n+    }\n+}"
  },
  {
    "sha": "d8adec5680e2a1e904d9eab1c0a73772fc60a79b",
    "filename": "L16-io/homework/src/main/java/ru/otus/dataprocessor/FileSerializer.java",
    "status": "added",
    "additions": 31,
    "deletions": 0,
    "changes": 31,
    "blob_url": "https://github.com/nordmari/otus-homeworks/blob/177381c9e7673240b8192c5ddc64d41122a242c1/L16-io/homework/src/main/java/ru/otus/dataprocessor/FileSerializer.java",
    "raw_url": "https://github.com/nordmari/otus-homeworks/raw/177381c9e7673240b8192c5ddc64d41122a242c1/L16-io/homework/src/main/java/ru/otus/dataprocessor/FileSerializer.java",
    "contents_url": "https://api.github.com/repos/nordmari/otus-homeworks/contents/L16-io/homework/src/main/java/ru/otus/dataprocessor/FileSerializer.java?ref=177381c9e7673240b8192c5ddc64d41122a242c1",
    "patch": "@@ -0,0 +1,31 @@\n+package ru.otus.dataprocessor;\n+\n+import ru.otus.dataprocessor.exception.FileProcessingException;\n+\n+import java.io.IOException;\n+import java.nio.charset.StandardCharsets;\n+import java.nio.file.Files;\n+import java.nio.file.Paths;\n+import java.util.Map;\n+\n+import static ru.otus.dataprocessor.jackson.mapping.ObjectMapperFactory.commonMapper;\n+\n+public class FileSerializer implements Serializer {\n+\n+    private final String fileName;\n+\n+    public FileSerializer(String fileName) {\n+        this.fileName = fileName;\n+    }\n+\n+    @Override\n+    public void serialize(Map<String, Double> data) {\n+        //формирует результирующий json и сохраняет его в файл\n+        try {\n+            String jsonString = commonMapper().writeValueAsString(data);\n+            Files.write(Paths.get(fileName), jsonString.getBytes(StandardCharsets.UTF_8));\n+        } catch (IOException e) {\n+            throw new FileProcessingException(\"Failed to write to file\", e);\n+        }\n+    }\n+}"
  },
  {
    "sha": "177a0ba3863e38ca5ddcd703fbb8983221193185",
    "filename": "L16-io/homework/src/main/java/ru/otus/dataprocessor/Loader.java",
    "status": "added",
    "additions": 10,
    "deletions": 0,
    "changes": 10,
    "blob_url": "https://github.com/nordmari/otus-homeworks/blob/177381c9e7673240b8192c5ddc64d41122a242c1/L16-io/homework/src/main/java/ru/otus/dataprocessor/Loader.java",
    "raw_url": "https://github.com/nordmari/otus-homeworks/raw/177381c9e7673240b8192c5ddc64d41122a242c1/L16-io/homework/src/main/java/ru/otus/dataprocessor/Loader.java",
    "contents_url": "https://api.github.com/repos/nordmari/otus-homeworks/contents/L16-io/homework/src/main/java/ru/otus/dataprocessor/Loader.java?ref=177381c9e7673240b8192c5ddc64d41122a242c1",
    "patch": "@@ -0,0 +1,10 @@\n+package ru.otus.dataprocessor;\n+\n+import ru.otus.model.Measurement;\n+\n+import java.util.List;\n+\n+public interface Loader {\n+\n+    List<Measurement> load();\n+}"
  },
  {
    "sha": "58e05a6c8dfe374b6d31f6015338bbcd86867dda",
    "filename": "L16-io/homework/src/main/java/ru/otus/dataprocessor/Processor.java",
    "status": "added",
    "additions": 11,
    "deletions": 0,
    "changes": 11,
    "blob_url": "https://github.com/nordmari/otus-homeworks/blob/177381c9e7673240b8192c5ddc64d41122a242c1/L16-io/homework/src/main/java/ru/otus/dataprocessor/Processor.java",
    "raw_url": "https://github.com/nordmari/otus-homeworks/raw/177381c9e7673240b8192c5ddc64d41122a242c1/L16-io/homework/src/main/java/ru/otus/dataprocessor/Processor.java",
    "contents_url": "https://api.github.com/repos/nordmari/otus-homeworks/contents/L16-io/homework/src/main/java/ru/otus/dataprocessor/Processor.java?ref=177381c9e7673240b8192c5ddc64d41122a242c1",
    "patch": "@@ -0,0 +1,11 @@\n+package ru.otus.dataprocessor;\n+\n+import ru.otus.model.Measurement;\n+\n+import java.util.List;\n+import java.util.Map;\n+\n+public interface Processor {\n+\n+    Map<String, Double> process(List<Measurement> data);\n+}"
  },
  {
    "sha": "7dfad22b5a3e6e2b228623ff4b82799ae0375dce",
    "filename": "L16-io/homework/src/main/java/ru/otus/dataprocessor/ProcessorAggregator.java",
    "status": "added",
    "additions": 20,
    "deletions": 0,
    "changes": 20,
    "blob_url": "https://github.com/nordmari/otus-homeworks/blob/177381c9e7673240b8192c5ddc64d41122a242c1/L16-io/homework/src/main/java/ru/otus/dataprocessor/ProcessorAggregator.java",
    "raw_url": "https://github.com/nordmari/otus-homeworks/raw/177381c9e7673240b8192c5ddc64d41122a242c1/L16-io/homework/src/main/java/ru/otus/dataprocessor/ProcessorAggregator.java",
    "contents_url": "https://api.github.com/repos/nordmari/otus-homeworks/contents/L16-io/homework/src/main/java/ru/otus/dataprocessor/ProcessorAggregator.java?ref=177381c9e7673240b8192c5ddc64d41122a242c1",
    "patch": "@@ -0,0 +1,20 @@\n+package ru.otus.dataprocessor;\n+\n+import ru.otus.model.Measurement;\n+\n+import java.util.List;\n+import java.util.Map;\n+import java.util.TreeMap;\n+\n+import static java.util.Comparator.naturalOrder;\n+import static java.util.stream.Collectors.toMap;\n+\n+public class ProcessorAggregator implements Processor {\n+\n+    @Override\n+    public Map<String, Double> process(List<Measurement> data) {\n+        //группирует выходящий список по name, при этом суммирует поля value\n+        return data.stream()\n+                .collect(toMap(Measurement::getName, Measurement::getValue, Double::sum, () -> new TreeMap<>(naturalOrder())));\n+    }\n+}"
  },
  {
    "sha": "1af8fb2e1c7db7bc139ceb9d1e2af92a5ec97161",
    "filename": "L16-io/homework/src/main/java/ru/otus/dataprocessor/Serializer.java",
    "status": "added",
    "additions": 8,
    "deletions": 0,
    "changes": 8,
    "blob_url": "https://github.com/nordmari/otus-homeworks/blob/177381c9e7673240b8192c5ddc64d41122a242c1/L16-io/homework/src/main/java/ru/otus/dataprocessor/Serializer.java",
    "raw_url": "https://github.com/nordmari/otus-homeworks/raw/177381c9e7673240b8192c5ddc64d41122a242c1/L16-io/homework/src/main/java/ru/otus/dataprocessor/Serializer.java",
    "contents_url": "https://api.github.com/repos/nordmari/otus-homeworks/contents/L16-io/homework/src/main/java/ru/otus/dataprocessor/Serializer.java?ref=177381c9e7673240b8192c5ddc64d41122a242c1",
    "patch": "@@ -0,0 +1,8 @@\n+package ru.otus.dataprocessor;\n+\n+import java.util.Map;\n+\n+public interface Serializer {\n+\n+    void serialize(Map<String, Double> data);\n+}"
  },
  {
    "sha": "10245d215b5ff9d859b8b391f45d741ef0984fe9",
    "filename": "L16-io/homework/src/main/java/ru/otus/dataprocessor/exception/FileProcessingException.java",
    "status": "added",
    "additions": 7,
    "deletions": 0,
    "changes": 7,
    "blob_url": "https://github.com/nordmari/otus-homeworks/blob/177381c9e7673240b8192c5ddc64d41122a242c1/L16-io/homework/src/main/java/ru/otus/dataprocessor/exception/FileProcessingException.java",
    "raw_url": "https://github.com/nordmari/otus-homeworks/raw/177381c9e7673240b8192c5ddc64d41122a242c1/L16-io/homework/src/main/java/ru/otus/dataprocessor/exception/FileProcessingException.java",
    "contents_url": "https://api.github.com/repos/nordmari/otus-homeworks/contents/L16-io/homework/src/main/java/ru/otus/dataprocessor/exception/FileProcessingException.java?ref=177381c9e7673240b8192c5ddc64d41122a242c1",
    "patch": "@@ -0,0 +1,7 @@\n+package ru.otus.dataprocessor.exception;\n+\n+public class FileProcessingException extends RuntimeException {\n+    public FileProcessingException(String message, Throwable cause) {\n+        super(message, cause);\n+    }\n+}"
  },
  {
    "sha": "1a983fdc7fac4d03e7306d2e9f5aa02b2d33a3d5",
    "filename": "L16-io/homework/src/main/java/ru/otus/dataprocessor/jackson/mapping/MeasurementMappingMixIn.java",
    "status": "added",
    "additions": 10,
    "deletions": 0,
    "changes": 10,
    "blob_url": "https://github.com/nordmari/otus-homeworks/blob/177381c9e7673240b8192c5ddc64d41122a242c1/L16-io/homework/src/main/java/ru/otus/dataprocessor/jackson/mapping/MeasurementMappingMixIn.java",
    "raw_url": "https://github.com/nordmari/otus-homeworks/raw/177381c9e7673240b8192c5ddc64d41122a242c1/L16-io/homework/src/main/java/ru/otus/dataprocessor/jackson/mapping/MeasurementMappingMixIn.java",
    "contents_url": "https://api.github.com/repos/nordmari/otus-homeworks/contents/L16-io/homework/src/main/java/ru/otus/dataprocessor/jackson/mapping/MeasurementMappingMixIn.java?ref=177381c9e7673240b8192c5ddc64d41122a242c1",
    "patch": "@@ -0,0 +1,10 @@\n+package ru.otus.dataprocessor.jackson.mapping;\n+\n+import com.fasterxml.jackson.annotation.JsonCreator;\n+import com.fasterxml.jackson.annotation.JsonProperty;\n+\n+public class MeasurementMappingMixIn {\n+    @JsonCreator\n+    public MeasurementMappingMixIn(@JsonProperty(\"name\") String name, @JsonProperty(\"value\") double value) {\n+    }\n+}"
  },
  {
    "sha": "491d5a121a87d27fe7b123afe50ea3e789d61eee",
    "filename": "L16-io/homework/src/main/java/ru/otus/dataprocessor/jackson/mapping/ObjectMapperFactory.java",
    "status": "added",
    "additions": 24,
    "deletions": 0,
    "changes": 24,
    "blob_url": "https://github.com/nordmari/otus-homeworks/blob/177381c9e7673240b8192c5ddc64d41122a242c1/L16-io/homework/src/main/java/ru/otus/dataprocessor/jackson/mapping/ObjectMapperFactory.java",
    "raw_url": "https://github.com/nordmari/otus-homeworks/raw/177381c9e7673240b8192c5ddc64d41122a242c1/L16-io/homework/src/main/java/ru/otus/dataprocessor/jackson/mapping/ObjectMapperFactory.java",
    "contents_url": "https://api.github.com/repos/nordmari/otus-homeworks/contents/L16-io/homework/src/main/java/ru/otus/dataprocessor/jackson/mapping/ObjectMapperFactory.java?ref=177381c9e7673240b8192c5ddc64d41122a242c1",
    "patch": "@@ -0,0 +1,24 @@\n+package ru.otus.dataprocessor.jackson.mapping;\n+\n+import com.fasterxml.jackson.databind.ObjectMapper;\n+import ru.otus.model.Measurement;\n+\n+public final class ObjectMapperFactory {\n+    private ObjectMapperFactory() {\n+    }\n+\n+    private static final ObjectMapper commonMapper = new ObjectMapper();\n+    private static final ObjectMapper measurementMapper = new ObjectMapper();\n+\n+    static {\n+        measurementMapper.addMixIn(Measurement.class, MeasurementMappingMixIn.class);\n+    }\n+\n+    public static ObjectMapper measurementMapper() {\n+        return measurementMapper;\n+    }\n+\n+    public static ObjectMapper commonMapper() {\n+        return commonMapper;\n+    }\n+}"
  },
  {
    "sha": "3d82f8c55e7b997321a781c91540b6b4b22200d4",
    "filename": "L16-io/homework/src/main/java/ru/otus/model/Measurement.java",
    "status": "added",
    "additions": 29,
    "deletions": 0,
    "changes": 29,
    "blob_url": "https://github.com/nordmari/otus-homeworks/blob/177381c9e7673240b8192c5ddc64d41122a242c1/L16-io/homework/src/main/java/ru/otus/model/Measurement.java",
    "raw_url": "https://github.com/nordmari/otus-homeworks/raw/177381c9e7673240b8192c5ddc64d41122a242c1/L16-io/homework/src/main/java/ru/otus/model/Measurement.java",
    "contents_url": "https://api.github.com/repos/nordmari/otus-homeworks/contents/L16-io/homework/src/main/java/ru/otus/model/Measurement.java?ref=177381c9e7673240b8192c5ddc64d41122a242c1",
    "patch": "@@ -0,0 +1,29 @@\n+package ru.otus.model;\n+\n+\n+//Допустим, этот класс библиотечный, его нельзя менять\n+public class Measurement {\n+    private final String name;\n+    private final double value;\n+\n+    public Measurement(String name, double value) {\n+        this.name = name;\n+        this.value = value;\n+    }\n+\n+    public String getName() {\n+        return name;\n+    }\n+\n+    public double getValue() {\n+        return value;\n+    }\n+\n+    @Override\n+    public String toString() {\n+        return \"Measurement{\" +\n+                \"name='\" + name + '\\'' +\n+                \", value=\" + value +\n+                '}';\n+    }\n+}"
  },
  {
    "sha": "194c7af1018658f131cf5d65d664483543445906",
    "filename": "L16-io/homework/src/test/java/ru/otus/dataprocessor/ProcessorTest.java",
    "status": "added",
    "additions": 46,
    "deletions": 0,
    "changes": 46,
    "blob_url": "https://github.com/nordmari/otus-homeworks/blob/177381c9e7673240b8192c5ddc64d41122a242c1/L16-io/homework/src/test/java/ru/otus/dataprocessor/ProcessorTest.java",
    "raw_url": "https://github.com/nordmari/otus-homeworks/raw/177381c9e7673240b8192c5ddc64d41122a242c1/L16-io/homework/src/test/java/ru/otus/dataprocessor/ProcessorTest.java",
    "contents_url": "https://api.github.com/repos/nordmari/otus-homeworks/contents/L16-io/homework/src/test/java/ru/otus/dataprocessor/ProcessorTest.java?ref=177381c9e7673240b8192c5ddc64d41122a242c1",
    "patch": "@@ -0,0 +1,46 @@\n+package ru.otus.dataprocessor;\n+\n+import org.junit.jupiter.api.DisplayName;\n+import org.junit.jupiter.api.Test;\n+import org.junit.jupiter.api.io.TempDir;\n+\n+import java.io.File;\n+import java.io.IOException;\n+import java.nio.file.Files;\n+import java.nio.file.Path;\n+import java.nio.file.Paths;\n+\n+import static org.assertj.core.api.AssertionsForInterfaceTypes.assertThat;\n+\n+class ProcessorTest {\n+\n+    //Надо реализовать методы классов и убедиться, что тест проходит\n+\n+    @Test\n+    @DisplayName(\"Из файла читается json, обрабатывается, результат сериализуется в строку\")\n+    void processingTest(@TempDir Path tempDir) throws IOException {\n+        System.out.println(tempDir);\n+\n+        //given\n+        var inputDataFileName = \"inputData.json\";\n+        var outputDataFileName = \"outputData.json\";\n+        var fullOutputFilePath = String.format(\"%s%s%s\", tempDir, File.separator, outputDataFileName);\n+\n+        var loader = new FileLoader(inputDataFileName);\n+        var processor = new ProcessorAggregator();\n+        var serializer = new FileSerializer(fullOutputFilePath);\n+\n+        //when\n+        var loadedMeasurements = loader.load();\n+        var aggregatedMeasurements = processor.process(loadedMeasurements);\n+        serializer.serialize(aggregatedMeasurements);\n+\n+        //then\n+        assertThat(loadedMeasurements.size()).isEqualTo(9);\n+        assertThat(aggregatedMeasurements.entrySet().size()).isEqualTo(3);\n+\n+        var serializedOutput = Files.readString(Paths.get(fullOutputFilePath));\n+        //обратите внимание: важен порядок ключей\n+        assertThat(serializedOutput).isEqualTo(\"{\\\"val1\\\":3.0,\\\"val2\\\":30.0,\\\"val3\\\":33.0}\");\n+    }\n+}"
  },
  {
    "sha": "f0482566f2beb603d48cc51ea079a07741976a76",
    "filename": "L16-io/homework/src/test/resources/inputData.json",
    "status": "added",
    "additions": 1,
    "deletions": 0,
    "changes": 1,
    "blob_url": "https://github.com/nordmari/otus-homeworks/blob/177381c9e7673240b8192c5ddc64d41122a242c1/L16-io/homework/src/test/resources/inputData.json",
    "raw_url": "https://github.com/nordmari/otus-homeworks/raw/177381c9e7673240b8192c5ddc64d41122a242c1/L16-io/homework/src/test/resources/inputData.json",
    "contents_url": "https://api.github.com/repos/nordmari/otus-homeworks/contents/L16-io/homework/src/test/resources/inputData.json?ref=177381c9e7673240b8192c5ddc64d41122a242c1",
    "patch": "@@ -0,0 +1 @@\n+[{\"name\":\"val1\",\"value\":0.0},{\"name\":\"val1\",\"value\":1.0},{\"name\":\"val1\",\"value\":2.0},{\"name\":\"val2\",\"value\":0.0},{\"name\":\"val2\",\"value\":10.0},{\"name\":\"val2\",\"value\":20.0},{\"name\":\"val3\",\"value\":10.0},{\"name\":\"val3\",\"value\":11.0},{\"name\":\"val3\",\"value\":12.0}]"
  },
  {
    "sha": "642bb13206b72272df05099bc290813c2cf146a5",
    "filename": "settings.gradle",
    "status": "modified",
    "additions": 1,
    "deletions": 0,
    "changes": 1,
    "blob_url": "https://github.com/nordmari/otus-homeworks/blob/177381c9e7673240b8192c5ddc64d41122a242c1/settings.gradle",
    "raw_url": "https://github.com/nordmari/otus-homeworks/raw/177381c9e7673240b8192c5ddc64d41122a242c1/settings.gradle",
    "contents_url": "https://api.github.com/repos/nordmari/otus-homeworks/contents/settings.gradle?ref=177381c9e7673240b8192c5ddc64d41122a242c1",
    "patch": "@@ -3,3 +3,4 @@ include 'hw01-gradle'\n include 'L04-generics'\n include 'hw06-annotations'\n include 'hw12-solid'\n+include 'L16-io:homework'"
  }
]

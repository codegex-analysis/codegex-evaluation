[
  {
    "sha": "3e480c692ece211a40c98ddeab27046b214b604e",
    "filename": "pom.xml",
    "status": "modified",
    "additions": 5,
    "deletions": 0,
    "changes": 5,
    "blob_url": "https://github.com/Demis05/OrderService/blob/237e07d1d28ff946faa58d91019b0de79bcb2f01/pom.xml",
    "raw_url": "https://github.com/Demis05/OrderService/raw/237e07d1d28ff946faa58d91019b0de79bcb2f01/pom.xml",
    "contents_url": "https://api.github.com/repos/Demis05/OrderService/contents/pom.xml?ref=237e07d1d28ff946faa58d91019b0de79bcb2f01",
    "patch": "@@ -31,6 +31,11 @@\n             <version>1.18.16</version>\n             <scope>provided</scope>\n         </dependency>\n+        <dependency>\n+            <groupId>org.json</groupId>\n+            <artifactId>json</artifactId>\n+            <version>20180130</version>\n+        </dependency>\n \n <!--        <dependency>-->\n <!--            <groupId>io.springfox</groupId>-->"
  },
  {
    "sha": "30b7ede848986c4c92780b344c9de7f2fba40bed",
    "filename": "src/main/java/com/exadel/fedorov/domain/Order.java",
    "status": "removed",
    "additions": 0,
    "deletions": 26,
    "changes": 26,
    "blob_url": "https://github.com/Demis05/OrderService/blob/cf0da4e7a4ff15fe9b5b69f43d26b6321955bc9a/src/main/java/com/exadel/fedorov/domain/Order.java",
    "raw_url": "https://github.com/Demis05/OrderService/raw/cf0da4e7a4ff15fe9b5b69f43d26b6321955bc9a/src/main/java/com/exadel/fedorov/domain/Order.java",
    "contents_url": "https://api.github.com/repos/Demis05/OrderService/contents/src/main/java/com/exadel/fedorov/domain/Order.java?ref=cf0da4e7a4ff15fe9b5b69f43d26b6321955bc9a",
    "patch": "@@ -1,26 +0,0 @@\n-package com.exadel.fedorov.domain;\n-\n-import lombok.Data;\n-\n-import java.math.BigDecimal;\n-import java.sql.Timestamp;\n-\n-@Data\n-public class Order {\n-\n-    private Long id;\n-    private BigDecimal totalPrice;\n-    private Timestamp time;\n-    private OrderStatus status;\n-    private String statusDescription;\n-\n-    public Order() {\n-    }\n-\n-    public Order(BigDecimal totalPrice, Timestamp time, OrderStatus status, String statusDescription) {\n-        this.totalPrice = totalPrice;\n-        this.time = time;\n-        this.status = status;\n-        this.statusDescription = statusDescription;\n-    }\n-}"
  },
  {
    "sha": "ead4c58f383d3a8fdcc46512328f6e0f9ac646d6",
    "filename": "src/main/java/com/exadel/fedorov/domain/OrderDetail.java",
    "status": "removed",
    "additions": 0,
    "deletions": 25,
    "changes": 25,
    "blob_url": "https://github.com/Demis05/OrderService/blob/cf0da4e7a4ff15fe9b5b69f43d26b6321955bc9a/src/main/java/com/exadel/fedorov/domain/OrderDetail.java",
    "raw_url": "https://github.com/Demis05/OrderService/raw/cf0da4e7a4ff15fe9b5b69f43d26b6321955bc9a/src/main/java/com/exadel/fedorov/domain/OrderDetail.java",
    "contents_url": "https://api.github.com/repos/Demis05/OrderService/contents/src/main/java/com/exadel/fedorov/domain/OrderDetail.java?ref=cf0da4e7a4ff15fe9b5b69f43d26b6321955bc9a",
    "patch": "@@ -1,25 +0,0 @@\n-package com.exadel.fedorov.domain;\n-\n-import lombok.Data;\n-\n-import java.math.BigDecimal;\n-\n-@Data\n-public class OrderDetail {\n-\n-    private int id;\n-    private int orderId;\n-    private BigDecimal positionPrice;\n-    private Integer productId;\n-    private Integer productCount;\n-\n-    public OrderDetail(int orderId, BigDecimal positionPrice, Integer productId, Integer productCount) {\n-        this.orderId = orderId;\n-        this.positionPrice = positionPrice;\n-        this.productId = productId;\n-        this.productCount = productCount;\n-    }\n-\n-    public OrderDetail() {\n-    }\n-}"
  },
  {
    "sha": "8cba6f853f690bafce5cefea97f42ca143b47d78",
    "filename": "src/main/java/com/exadel/fedorov/dto/OrderDTO.java",
    "status": "removed",
    "additions": 0,
    "deletions": 31,
    "changes": 31,
    "blob_url": "https://github.com/Demis05/OrderService/blob/cf0da4e7a4ff15fe9b5b69f43d26b6321955bc9a/src/main/java/com/exadel/fedorov/dto/OrderDTO.java",
    "raw_url": "https://github.com/Demis05/OrderService/raw/cf0da4e7a4ff15fe9b5b69f43d26b6321955bc9a/src/main/java/com/exadel/fedorov/dto/OrderDTO.java",
    "contents_url": "https://api.github.com/repos/Demis05/OrderService/contents/src/main/java/com/exadel/fedorov/dto/OrderDTO.java?ref=cf0da4e7a4ff15fe9b5b69f43d26b6321955bc9a",
    "patch": "@@ -1,31 +0,0 @@\n-package com.exadel.fedorov.dto;\n-\n-import lombok.Getter;\n-\n-import java.math.BigDecimal;\n-import java.util.List;\n-\n-@Getter\n-public class OrderDTO {\n-\n-    private final List<OrderPositionDTO> positions;\n-    private BigDecimal orderPrice;\n-    private Integer count;\n-\n-    public OrderDTO(List<OrderPositionDTO> positions) {\n-        this.positions = positions;\n-        setCount();\n-        setOrderPrice();\n-    }\n-\n-    private void setCount() {\n-        this.count = positions.size();\n-    }\n-\n-    private void setOrderPrice() {\n-        for (OrderPositionDTO position : positions) {\n-            orderPrice = orderPrice.add(position.getTotalPrice());\n-        }\n-    }\n-\n-}"
  },
  {
    "sha": "db530a74ad79a1d134001f7fc4d2405e20bc6e4c",
    "filename": "src/main/java/com/exadel/fedorov/dto/OrderPositionDTO.java",
    "status": "removed",
    "additions": 0,
    "deletions": 40,
    "changes": 40,
    "blob_url": "https://github.com/Demis05/OrderService/blob/cf0da4e7a4ff15fe9b5b69f43d26b6321955bc9a/src/main/java/com/exadel/fedorov/dto/OrderPositionDTO.java",
    "raw_url": "https://github.com/Demis05/OrderService/raw/cf0da4e7a4ff15fe9b5b69f43d26b6321955bc9a/src/main/java/com/exadel/fedorov/dto/OrderPositionDTO.java",
    "contents_url": "https://api.github.com/repos/Demis05/OrderService/contents/src/main/java/com/exadel/fedorov/dto/OrderPositionDTO.java?ref=cf0da4e7a4ff15fe9b5b69f43d26b6321955bc9a",
    "patch": "@@ -1,40 +0,0 @@\n-package com.exadel.fedorov.dto;\n-\n-import java.math.BigDecimal;\n-\n-public class OrderPositionDTO {\n-\n-//    private Product product;\n-    private BigDecimal totalPrice;\n-    private Integer count;\n-    public OrderPositionDTO(/*Product product,*/ Integer count) {\n-//    public OrderPositionDTO(Product product, Integer count) {\n-//        this.product = product;\n-        this.count = count;\n-        setTotalPrice();\n-    }\n-\n-    public Integer getCount() {\n-        return count;\n-    }\n-\n-    public void setCount(Integer count) {\n-        this.count = count;\n-    }\n-\n-//    public Product getProduct() {\n-//        return product;\n-//    }\n-\n-//    public void setProduct(Product product) {\n-//        this.product = product;\n-//    }\n-\n-    public BigDecimal getTotalPrice() {\n-        return totalPrice;\n-    }\n-\n-    private void setTotalPrice() {\n-//        this.totalPrice = BigDecimal.valueOf(product.getPrice() * count);\n-    }\n-}"
  },
  {
    "sha": "3e7db365a145fb2091c4af866f696aa7b7c214cc",
    "filename": "src/main/java/com/exadel/fedorov/orders/Application.java",
    "status": "renamed",
    "additions": 1,
    "deletions": 1,
    "changes": 2,
    "blob_url": "https://github.com/Demis05/OrderService/blob/237e07d1d28ff946faa58d91019b0de79bcb2f01/src/main/java/com/exadel/fedorov/orders/Application.java",
    "raw_url": "https://github.com/Demis05/OrderService/raw/237e07d1d28ff946faa58d91019b0de79bcb2f01/src/main/java/com/exadel/fedorov/orders/Application.java",
    "contents_url": "https://api.github.com/repos/Demis05/OrderService/contents/src/main/java/com/exadel/fedorov/orders/Application.java?ref=237e07d1d28ff946faa58d91019b0de79bcb2f01",
    "patch": "@@ -1,4 +1,4 @@\n-package com.exadel.fedorov;\n+package com.exadel.fedorov.orders;\n \n import org.springframework.boot.SpringApplication;\n import org.springframework.boot.autoconfigure.SpringBootApplication;",
    "previous_filename": "src/main/java/com/exadel/fedorov/Application.java"
  },
  {
    "sha": "88c78eda92a0d101c042af470f7f4766ff717ead",
    "filename": "src/main/java/com/exadel/fedorov/orders/config/ApiConfig.java",
    "status": "renamed",
    "additions": 3,
    "deletions": 8,
    "changes": 11,
    "blob_url": "https://github.com/Demis05/OrderService/blob/237e07d1d28ff946faa58d91019b0de79bcb2f01/src/main/java/com/exadel/fedorov/orders/config/ApiConfig.java",
    "raw_url": "https://github.com/Demis05/OrderService/raw/237e07d1d28ff946faa58d91019b0de79bcb2f01/src/main/java/com/exadel/fedorov/orders/config/ApiConfig.java",
    "contents_url": "https://api.github.com/repos/Demis05/OrderService/contents/src/main/java/com/exadel/fedorov/orders/config/ApiConfig.java?ref=237e07d1d28ff946faa58d91019b0de79bcb2f01",
    "patch": "@@ -1,4 +1,4 @@\n-package com.exadel.fedorov.config;\n+package com.exadel.fedorov.orders.config;\n \n import org.springframework.context.annotation.Bean;\n import org.springframework.context.annotation.ComponentScan;\n@@ -27,20 +27,15 @@ public void addResourceHandlers(ResourceHandlerRegistry registry) {\n                 .addResourceLocations(\"/assets/\");\n     }\n \n-    //    @Bean\n+//    @Bean\n //    public Docket api() {\n //        return new Docket(DocumentationType.SWAGGER_2)\n //                .select()\n //                .apis(RequestHandlerSelectors.basePackage(\"com.exadel.fedorov.rest\"))\n //                .paths(PathSelectors.ant(\"/rest/**\"))\n //                .build();\n-//\n //    }\n-//*spring.datasource.url=jdbc:postgresql://3.135.191.95:5432/order_db\n-//spring.datasource.username=postgres\n-//spring.datasource.password=fred\n-//\n-// */\n+\n     @Bean(name = \"dataSource\")\n     public DataSource getDataSource() {\n         DriverManagerDataSource dataSource = new DriverManagerDataSource();",
    "previous_filename": "src/main/java/com/exadel/fedorov/config/ApiConfig.java"
  },
  {
    "sha": "db305437f678abe6c9764811b683feaa43cc778e",
    "filename": "src/main/java/com/exadel/fedorov/orders/config/WebAppInit.java",
    "status": "renamed",
    "additions": 1,
    "deletions": 1,
    "changes": 2,
    "blob_url": "https://github.com/Demis05/OrderService/blob/237e07d1d28ff946faa58d91019b0de79bcb2f01/src/main/java/com/exadel/fedorov/orders/config/WebAppInit.java",
    "raw_url": "https://github.com/Demis05/OrderService/raw/237e07d1d28ff946faa58d91019b0de79bcb2f01/src/main/java/com/exadel/fedorov/orders/config/WebAppInit.java",
    "contents_url": "https://api.github.com/repos/Demis05/OrderService/contents/src/main/java/com/exadel/fedorov/orders/config/WebAppInit.java?ref=237e07d1d28ff946faa58d91019b0de79bcb2f01",
    "patch": "@@ -1,4 +1,4 @@\n-package com.exadel.fedorov.config;\n+package com.exadel.fedorov.orders.config;\n \n import org.springframework.web.WebApplicationInitializer;\n import org.springframework.web.context.support.AnnotationConfigWebApplicationContext;",
    "previous_filename": "src/main/java/com/exadel/fedorov/config/WebAppInit.java"
  },
  {
    "sha": "2b235e041b49e10f65c3f699ee641ddbc4a72147",
    "filename": "src/main/java/com/exadel/fedorov/orders/controllers/OrderController.java",
    "status": "renamed",
    "additions": 22,
    "deletions": 18,
    "changes": 40,
    "blob_url": "https://github.com/Demis05/OrderService/blob/237e07d1d28ff946faa58d91019b0de79bcb2f01/src/main/java/com/exadel/fedorov/orders/controllers/OrderController.java",
    "raw_url": "https://github.com/Demis05/OrderService/raw/237e07d1d28ff946faa58d91019b0de79bcb2f01/src/main/java/com/exadel/fedorov/orders/controllers/OrderController.java",
    "contents_url": "https://api.github.com/repos/Demis05/OrderService/contents/src/main/java/com/exadel/fedorov/orders/controllers/OrderController.java?ref=237e07d1d28ff946faa58d91019b0de79bcb2f01",
    "patch": "@@ -1,7 +1,9 @@\n-package com.exadel.fedorov.rest;\n+package com.exadel.fedorov.orders.controllers;\n \n-import com.exadel.fedorov.domain.Order;\n-import com.exadel.fedorov.service.OrderService;\n+import com.exadel.fedorov.orders.domain.Order;\n+import com.exadel.fedorov.orders.dto.dto_request.ReqOrderDTO;\n+import com.exadel.fedorov.orders.dto.dto_request.ReqOrderItemDTO;\n+import com.exadel.fedorov.orders.service.OrderService;\n import org.springframework.beans.factory.annotation.Autowired;\n import org.springframework.http.HttpHeaders;\n import org.springframework.http.HttpStatus;\n@@ -16,19 +18,22 @@\n import org.springframework.web.bind.annotation.ResponseStatus;\n import org.springframework.web.bind.annotation.RestController;\n \n+import java.math.BigDecimal;\n import java.util.List;\n import java.util.Objects;\n import java.util.Optional;\n \n @RequestMapping(\"/rest/orders\")\n @RestController\n-public class OrderRest {\n+public class OrderController {\n \n+    private static final String DEFAULT_CLIENT_NAME = \"FirstName LastName\";\n+    private static final String DEFAULT_STATUS_DESCRIPTION = \"OK\";\n     @Autowired\n     private OrderService orderService;\n \n     @GetMapping\n-    public ResponseEntity<List<Order>> getOrders() {\n+    public ResponseEntity<List<Order>> readAll() {\n         List<Order> orders = orderService.findAll();\n         if (orders.isEmpty()) {\n             return new ResponseEntity<>(HttpStatus.NOT_FOUND);\n@@ -37,38 +42,41 @@\n     }\n \n     @GetMapping(value = \"/{id}\")\n-    public ResponseEntity<Order> getOrder(@PathVariable(\"id\") Long orderId) {\n+    public ResponseEntity<Order> read(@PathVariable(\"id\") Long orderId) {\n         if (orderId == null) {\n             return new ResponseEntity<>(HttpStatus.BAD_REQUEST);\n         }\n         Optional<Order> order = orderService.findById(orderId);\n         if (!order.isPresent()) {\n             return new ResponseEntity<>(HttpStatus.NOT_FOUND);\n         }\n-\n         return new ResponseEntity(order, HttpStatus.OK);\n     }\n \n     @ResponseStatus(HttpStatus.CREATED)\n     @PostMapping\n-    public ResponseEntity<Order> saveOrder(@RequestBody Order order) {\n-        HttpHeaders headers = new HttpHeaders();\n-        if (order == null) {\n+    public ResponseEntity<Order> create(@RequestBody List<ReqOrderItemDTO> orderItems) {\n+        if (orderItems.isEmpty()) {\n             return new ResponseEntity<>(HttpStatus.BAD_REQUEST);\n         }\n-        orderService.create(order);\n-        return new ResponseEntity<>(headers, HttpStatus.CREATED);\n+        BigDecimal total = new BigDecimal(0);\n+        for (ReqOrderItemDTO item : orderItems) {\n+            total = total.add(item.getPrice().multiply(BigDecimal.valueOf(item.getCount())));\n+        }\n+        orderService.createOrder(\n+                new ReqOrderDTO(orderItems, total, DEFAULT_CLIENT_NAME, DEFAULT_STATUS_DESCRIPTION));\n+        return new ResponseEntity<>(HttpStatus.CREATED);\n     }\n \n     @ResponseStatus(HttpStatus.OK)\n     @PutMapping(value = \"/{id}\")\n-    public ResponseEntity<Order> updateOrder(@PathVariable(\"id\") Long id, @RequestBody Order order) {\n+    public ResponseEntity<Order> update(@PathVariable(\"id\") Long id, @RequestBody Order order) {\n         HttpHeaders headers = new HttpHeaders();\n \n         if (order == null) {\n             return new ResponseEntity<>(HttpStatus.BAD_REQUEST);\n         }\n-        if (Objects.nonNull(orderService.findById((order.getId())))) {\n+        if (Objects.nonNull(orderService.findById(id))) {\n             orderService.update(order);\n         }\n         return new ResponseEntity<>(order, headers, HttpStatus.OK);\n@@ -77,10 +85,6 @@\n     @DeleteMapping(value = \"/{id}\")\n     @ResponseStatus(HttpStatus.OK)\n     public ResponseEntity<Order> deleteOrder(@PathVariable(\"id\") Long id) {\n-        Optional<Order> order = orderService.findById(id);\n-        if (!order.isPresent()) {\n-            return new ResponseEntity<>(HttpStatus.NOT_FOUND);\n-        }\n         orderService.deleteById(id);\n         return new ResponseEntity<>(HttpStatus.NO_CONTENT);\n     }",
    "previous_filename": "src/main/java/com/exadel/fedorov/rest/OrderRest.java"
  },
  {
    "sha": "3e8e25e1e3808d178f2d329b311569cb8bc18d8c",
    "filename": "src/main/java/com/exadel/fedorov/orders/domain/Order.java",
    "status": "added",
    "additions": 33,
    "deletions": 0,
    "changes": 33,
    "blob_url": "https://github.com/Demis05/OrderService/blob/237e07d1d28ff946faa58d91019b0de79bcb2f01/src/main/java/com/exadel/fedorov/orders/domain/Order.java",
    "raw_url": "https://github.com/Demis05/OrderService/raw/237e07d1d28ff946faa58d91019b0de79bcb2f01/src/main/java/com/exadel/fedorov/orders/domain/Order.java",
    "contents_url": "https://api.github.com/repos/Demis05/OrderService/contents/src/main/java/com/exadel/fedorov/orders/domain/Order.java?ref=237e07d1d28ff946faa58d91019b0de79bcb2f01",
    "patch": "@@ -0,0 +1,33 @@\n+package com.exadel.fedorov.orders.domain;\n+\n+import lombok.Data;\n+import lombok.NonNull;\n+\n+import java.math.BigDecimal;\n+import java.sql.Timestamp;\n+\n+@Data\n+public class Order {\n+\n+    private Long id;\n+    private Timestamp time;\n+    private OrderStatus status;\n+    private String clientName;\n+    private BigDecimal totalPrice;\n+    private String statusDescription;\n+\n+    public Order(@NonNull String clientName, @NonNull BigDecimal totalPrice, @NonNull String statusDescription) {\n+        this.clientName = clientName;\n+        this.totalPrice = totalPrice;\n+        this.statusDescription = statusDescription;\n+    }\n+\n+    public Order(Timestamp time, OrderStatus status, String clientName, BigDecimal totalPrice, String statusDescription) {\n+        this.time = time;\n+        this.status = status;\n+        this.clientName = clientName;\n+        this.totalPrice = totalPrice;\n+        this.statusDescription = statusDescription;\n+    }\n+\n+}"
  },
  {
    "sha": "3c009231b5ff92847ec4a197d75f270070cc65fc",
    "filename": "src/main/java/com/exadel/fedorov/orders/domain/OrderDetail.java",
    "status": "added",
    "additions": 21,
    "deletions": 0,
    "changes": 21,
    "blob_url": "https://github.com/Demis05/OrderService/blob/237e07d1d28ff946faa58d91019b0de79bcb2f01/src/main/java/com/exadel/fedorov/orders/domain/OrderDetail.java",
    "raw_url": "https://github.com/Demis05/OrderService/raw/237e07d1d28ff946faa58d91019b0de79bcb2f01/src/main/java/com/exadel/fedorov/orders/domain/OrderDetail.java",
    "contents_url": "https://api.github.com/repos/Demis05/OrderService/contents/src/main/java/com/exadel/fedorov/orders/domain/OrderDetail.java?ref=237e07d1d28ff946faa58d91019b0de79bcb2f01",
    "patch": "@@ -0,0 +1,21 @@\n+package com.exadel.fedorov.orders.domain;\n+\n+import lombok.Data;\n+import lombok.NonNull;\n+\n+import java.math.BigDecimal;\n+\n+@Data\n+public class OrderDetail {\n+\n+    private int id;\n+\n+    @NonNull\n+    private BigDecimal positionPrice;\n+    @NonNull\n+    private int orderId;\n+    @NonNull\n+    private Integer productId;\n+    @NonNull\n+    private Integer productCount;\n+}"
  },
  {
    "sha": "97a4c5c22c099ad211e7830502b20f9e8e26369c",
    "filename": "src/main/java/com/exadel/fedorov/orders/domain/OrderStatus.java",
    "status": "renamed",
    "additions": 2,
    "deletions": 1,
    "changes": 3,
    "blob_url": "https://github.com/Demis05/OrderService/blob/237e07d1d28ff946faa58d91019b0de79bcb2f01/src/main/java/com/exadel/fedorov/orders/domain/OrderStatus.java",
    "raw_url": "https://github.com/Demis05/OrderService/raw/237e07d1d28ff946faa58d91019b0de79bcb2f01/src/main/java/com/exadel/fedorov/orders/domain/OrderStatus.java",
    "contents_url": "https://api.github.com/repos/Demis05/OrderService/contents/src/main/java/com/exadel/fedorov/orders/domain/OrderStatus.java?ref=237e07d1d28ff946faa58d91019b0de79bcb2f01",
    "patch": "@@ -1,4 +1,4 @@\n-package com.exadel.fedorov.domain;\n+package com.exadel.fedorov.orders.domain;\n \n import java.util.Arrays;\n import java.util.List;\n@@ -22,4 +22,5 @@\n     public String getStatus() {\n         return status;\n     }\n+\n }\n\\ No newline at end of file",
    "previous_filename": "src/main/java/com/exadel/fedorov/domain/OrderStatus.java"
  },
  {
    "sha": "898f44aece1863723d3d59d64c558a115ee3b092",
    "filename": "src/main/java/com/exadel/fedorov/orders/dto/dto_request/ReqOrderDTO.java",
    "status": "added",
    "additions": 16,
    "deletions": 0,
    "changes": 16,
    "blob_url": "https://github.com/Demis05/OrderService/blob/237e07d1d28ff946faa58d91019b0de79bcb2f01/src/main/java/com/exadel/fedorov/orders/dto/dto_request/ReqOrderDTO.java",
    "raw_url": "https://github.com/Demis05/OrderService/raw/237e07d1d28ff946faa58d91019b0de79bcb2f01/src/main/java/com/exadel/fedorov/orders/dto/dto_request/ReqOrderDTO.java",
    "contents_url": "https://api.github.com/repos/Demis05/OrderService/contents/src/main/java/com/exadel/fedorov/orders/dto/dto_request/ReqOrderDTO.java?ref=237e07d1d28ff946faa58d91019b0de79bcb2f01",
    "patch": "@@ -0,0 +1,16 @@\n+package com.exadel.fedorov.orders.dto.dto_request;\n+\n+import lombok.Value;\n+\n+import java.math.BigDecimal;\n+import java.util.List;\n+\n+@Value\n+public class ReqOrderDTO {\n+\n+    List<ReqOrderItemDTO> positions;\n+    BigDecimal total;\n+    String clientName;\n+    String statusDescription;\n+\n+}"
  },
  {
    "sha": "57268b1d440cc4d7194a288c813a55701d712647",
    "filename": "src/main/java/com/exadel/fedorov/orders/dto/dto_request/ReqOrderItemDTO.java",
    "status": "added",
    "additions": 20,
    "deletions": 0,
    "changes": 20,
    "blob_url": "https://github.com/Demis05/OrderService/blob/237e07d1d28ff946faa58d91019b0de79bcb2f01/src/main/java/com/exadel/fedorov/orders/dto/dto_request/ReqOrderItemDTO.java",
    "raw_url": "https://github.com/Demis05/OrderService/raw/237e07d1d28ff946faa58d91019b0de79bcb2f01/src/main/java/com/exadel/fedorov/orders/dto/dto_request/ReqOrderItemDTO.java",
    "contents_url": "https://api.github.com/repos/Demis05/OrderService/contents/src/main/java/com/exadel/fedorov/orders/dto/dto_request/ReqOrderItemDTO.java?ref=237e07d1d28ff946faa58d91019b0de79bcb2f01",
    "patch": "@@ -0,0 +1,20 @@\n+package com.exadel.fedorov.orders.dto.dto_request;\n+\n+import lombok.AllArgsConstructor;\n+import lombok.Getter;\n+import lombok.NoArgsConstructor;\n+import lombok.ToString;\n+\n+import java.math.BigDecimal;\n+\n+@NoArgsConstructor\n+@AllArgsConstructor\n+@Getter\n+@ToString\n+public class ReqOrderItemDTO {\n+\n+    Integer productId;\n+    BigDecimal price;\n+    Integer count;\n+\n+}\n\\ No newline at end of file"
  },
  {
    "sha": "d0d7eafa7b21f3191d03020ad674777385c01bc7",
    "filename": "src/main/java/com/exadel/fedorov/orders/dto/dto_response/RespOrderDTO.java",
    "status": "added",
    "additions": 18,
    "deletions": 0,
    "changes": 18,
    "blob_url": "https://github.com/Demis05/OrderService/blob/237e07d1d28ff946faa58d91019b0de79bcb2f01/src/main/java/com/exadel/fedorov/orders/dto/dto_response/RespOrderDTO.java",
    "raw_url": "https://github.com/Demis05/OrderService/raw/237e07d1d28ff946faa58d91019b0de79bcb2f01/src/main/java/com/exadel/fedorov/orders/dto/dto_response/RespOrderDTO.java",
    "contents_url": "https://api.github.com/repos/Demis05/OrderService/contents/src/main/java/com/exadel/fedorov/orders/dto/dto_response/RespOrderDTO.java?ref=237e07d1d28ff946faa58d91019b0de79bcb2f01",
    "patch": "@@ -0,0 +1,18 @@\n+package com.exadel.fedorov.orders.dto.dto_response;\n+\n+import lombok.Value;\n+\n+import java.math.BigDecimal;\n+import java.util.List;\n+\n+@Value\n+public class RespOrderDTO {\n+\n+    List<RespOrderItemDTO> positions;\n+    BigDecimal orderPrice;\n+    Integer count;\n+    String clientName;\n+    String status;\n+    String statusDescription;\n+\n+}"
  },
  {
    "sha": "6f46d57853ffbac8d3bc4702ff04753117ffe58a",
    "filename": "src/main/java/com/exadel/fedorov/orders/dto/dto_response/RespOrderItemDTO.java",
    "status": "added",
    "additions": 13,
    "deletions": 0,
    "changes": 13,
    "blob_url": "https://github.com/Demis05/OrderService/blob/237e07d1d28ff946faa58d91019b0de79bcb2f01/src/main/java/com/exadel/fedorov/orders/dto/dto_response/RespOrderItemDTO.java",
    "raw_url": "https://github.com/Demis05/OrderService/raw/237e07d1d28ff946faa58d91019b0de79bcb2f01/src/main/java/com/exadel/fedorov/orders/dto/dto_response/RespOrderItemDTO.java",
    "contents_url": "https://api.github.com/repos/Demis05/OrderService/contents/src/main/java/com/exadel/fedorov/orders/dto/dto_response/RespOrderItemDTO.java?ref=237e07d1d28ff946faa58d91019b0de79bcb2f01",
    "patch": "@@ -0,0 +1,13 @@\n+package com.exadel.fedorov.orders.dto.dto_response;\n+\n+import lombok.Value;\n+import java.math.BigDecimal;\n+\n+@Value\n+public class RespOrderItemDTO {\n+\n+    Integer productId;\n+    BigDecimal totalPrice;\n+    Integer count;\n+\n+}"
  },
  {
    "sha": "1ddb13a36f73d35c2870af53e3c306f469cf05b6",
    "filename": "src/main/java/com/exadel/fedorov/orders/repository/OrderDAO.java",
    "status": "added",
    "additions": 126,
    "deletions": 0,
    "changes": 126,
    "blob_url": "https://github.com/Demis05/OrderService/blob/237e07d1d28ff946faa58d91019b0de79bcb2f01/src/main/java/com/exadel/fedorov/orders/repository/OrderDAO.java",
    "raw_url": "https://github.com/Demis05/OrderService/raw/237e07d1d28ff946faa58d91019b0de79bcb2f01/src/main/java/com/exadel/fedorov/orders/repository/OrderDAO.java",
    "contents_url": "https://api.github.com/repos/Demis05/OrderService/contents/src/main/java/com/exadel/fedorov/orders/repository/OrderDAO.java?ref=237e07d1d28ff946faa58d91019b0de79bcb2f01",
    "patch": "@@ -0,0 +1,126 @@\n+package com.exadel.fedorov.orders.repository;\n+\n+import com.exadel.fedorov.orders.domain.Order;\n+import com.exadel.fedorov.orders.domain.OrderStatus;\n+import com.exadel.fedorov.orders.dto.dto_request.ReqOrderDTO;\n+import com.exadel.fedorov.orders.dto.dto_request.ReqOrderItemDTO;\n+import org.json.JSONArray;\n+import org.json.JSONObject;\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.springframework.jdbc.core.JdbcTemplate;\n+import org.springframework.jdbc.core.namedparam.MapSqlParameterSource;\n+import org.springframework.jdbc.core.namedparam.SqlParameterSource;\n+import org.springframework.jdbc.core.simple.SimpleJdbcCall;\n+import org.springframework.stereotype.Repository;\n+\n+import javax.sql.DataSource;\n+import java.util.List;\n+import java.util.Optional;\n+\n+\n+@Repository\n+public class OrderDAO {\n+\n+    private static final String CREATE_QUERY = \"INSERT INTO public.orders(status, status_description, time, total_price) VALUES (?, ?, ?, ?);\";\n+    private static final String FIND_BY_ID_QUERY = \"select * from orders where id = ?\";\n+    private static final String UPDATE_QUERY = \"UPDATE public.orders SET status=?, status_description=?, total_price=? WHERE id = ?;\";\n+    private static final String FIND_ALL_QUERY = \"select * from public.orders\";\n+    private static final String DELETE_QUERY = \"delete from public.orders where id = ?\";\n+\n+\n+    private static final String TIME_FIELD = \"time\";\n+    private static final String STATUS_FIELD = \"status\";\n+\n+    private static final String STATUS_DESCRIPTION_IN_FIELD = \"status_description_in\";\n+    private static final String CLIENT_NAME_IN_FIELD = \"client_name_in\";\n+    private static final String TOTAL_PRICE_IN_FIELD = \"total_price_in\";\n+    private static final String IN_ARRAY_FIELD = \"in_array\";\n+    private static final String STATUS_DESCRIPTION_FIELD = \"status_description\";\n+    private static final String CLIENT_NAME_FIELD = \"client_name\";\n+    private static final String TOTAL_PRICE_FIELD = \"total_price\";\n+\n+    private static final String ID_FIELD = \"id\";\n+    private static final String CREATE_ORDER_PROCEDURE = \"create_order_function\";\n+    private static final String PRODUCT_ID_FIELD = \"product_id\";\n+    private static final String PRODUCT_COUNT_FIELD = \"product_count\";\n+    private static final String POSITION_PRICE_FIELD = \"position_price\";\n+\n+\n+    private JdbcTemplate jdbcTemplate;\n+    private SimpleJdbcCall simpleJdbcCall;\n+\n+    @Autowired\n+    public void setDataSource(DataSource dataSource) {\n+        this.jdbcTemplate = new JdbcTemplate(dataSource);\n+        simpleJdbcCall = new SimpleJdbcCall(dataSource);\n+    }\n+\n+    public int create(Order order) {\n+        return jdbcTemplate.update(\n+                CREATE_QUERY,\n+                order.getStatus().toString(),\n+                order.getStatusDescription(),\n+                order.getTime(),\n+                order.getTotalPrice());\n+    }\n+\n+    public Optional<Order> findById(Long id) {\n+\n+        return jdbcTemplate.queryForObject(\n+                FIND_BY_ID_QUERY,\n+                new Object[]{id},\n+                (rs, rowNum) ->\n+                        Optional.of(new Order(\n+                                rs.getTimestamp(TIME_FIELD),\n+                                OrderStatus.valueOf(rs.getString(STATUS_FIELD)),\n+                                rs.getString(CLIENT_NAME_FIELD),\n+                                rs.getBigDecimal(TOTAL_PRICE_FIELD),\n+                                rs.getString(STATUS_DESCRIPTION_FIELD)\n+                        ))\n+        );\n+    }\n+\n+    public void update(Order order) {\n+        jdbcTemplate.update(\n+                UPDATE_QUERY,\n+                order.getStatus(), order.getStatusDescription(), order.getId());\n+    }\n+\n+    public void deleteById(Long id) {\n+        jdbcTemplate.update(DELETE_QUERY, id);\n+    }\n+\n+    public List<Order> findAll() {\n+        return jdbcTemplate.query(\n+                FIND_ALL_QUERY,\n+                (rs, rowNum) ->\n+                        new Order(\n+                                rs.getTimestamp(TIME_FIELD),\n+                                OrderStatus.valueOf(rs.getString(STATUS_FIELD)),\n+                                rs.getString(CLIENT_NAME_FIELD),\n+                                rs.getBigDecimal(TOTAL_PRICE_FIELD),\n+                                rs.getString(STATUS_DESCRIPTION_FIELD)\n+                        )\n+        );\n+    }\n+\n+    public void createOrderWithProcedure(ReqOrderDTO reqOrderDTO) {\n+\n+        simpleJdbcCall = simpleJdbcCall.withProcedureName(CREATE_ORDER_PROCEDURE);\n+        JSONArray inArray = new JSONArray();\n+\n+        for (ReqOrderItemDTO item : reqOrderDTO.getPositions()) {\n+            JSONObject jsonItem = new JSONObject();\n+            jsonItem.put(PRODUCT_ID_FIELD, item.getProductId());\n+            jsonItem.put(PRODUCT_COUNT_FIELD, item.getCount());\n+            jsonItem.put(POSITION_PRICE_FIELD, item.getPrice());\n+            inArray.put(jsonItem);\n+        }\n+        SqlParameterSource in = new MapSqlParameterSource()\n+                .addValue(STATUS_DESCRIPTION_IN_FIELD, reqOrderDTO.getStatusDescription())\n+                .addValue(CLIENT_NAME_IN_FIELD, reqOrderDTO.getClientName())\n+                .addValue(TOTAL_PRICE_IN_FIELD, Double.valueOf(reqOrderDTO.getTotal().toString()))\n+                .addValue(IN_ARRAY_FIELD, inArray);\n+        simpleJdbcCall.execute(in);\n+    }\n+}"
  },
  {
    "sha": "3c49c852e3e24467ebca05dc86087dd8b80dd310",
    "filename": "src/main/java/com/exadel/fedorov/orders/service/OrderService.java",
    "status": "added",
    "additions": 42,
    "deletions": 0,
    "changes": 42,
    "blob_url": "https://github.com/Demis05/OrderService/blob/237e07d1d28ff946faa58d91019b0de79bcb2f01/src/main/java/com/exadel/fedorov/orders/service/OrderService.java",
    "raw_url": "https://github.com/Demis05/OrderService/raw/237e07d1d28ff946faa58d91019b0de79bcb2f01/src/main/java/com/exadel/fedorov/orders/service/OrderService.java",
    "contents_url": "https://api.github.com/repos/Demis05/OrderService/contents/src/main/java/com/exadel/fedorov/orders/service/OrderService.java?ref=237e07d1d28ff946faa58d91019b0de79bcb2f01",
    "patch": "@@ -0,0 +1,42 @@\n+package com.exadel.fedorov.orders.service;\n+\n+import com.exadel.fedorov.orders.domain.Order;\n+import com.exadel.fedorov.orders.dto.dto_request.ReqOrderDTO;\n+import com.exadel.fedorov.orders.repository.OrderDAO;\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.springframework.stereotype.Service;\n+\n+import java.util.List;\n+import java.util.Optional;\n+\n+@Service\n+public class OrderService {\n+\n+    @Autowired\n+    OrderDAO orderDAO;\n+\n+    public List<Order> findAll() {\n+        return orderDAO.findAll();\n+    }\n+\n+    public int create(Order order) {\n+        return orderDAO.create(order);\n+    }\n+\n+    public Optional<Order> findById(Long id) {\n+        return orderDAO.findById(id);\n+    }\n+\n+    public void update(Order order) {\n+        orderDAO.update(order);\n+    }\n+\n+    public void deleteById(Long id) {\n+        orderDAO.deleteById(id);\n+    }\n+\n+    public void createOrder(ReqOrderDTO reqOrderDTO) {\n+        orderDAO.createOrderWithProcedure(reqOrderDTO);\n+    }\n+\n+}\n\\ No newline at end of file"
  },
  {
    "sha": "18b9a7f682e1760a8170d6bebfeb85dd83b841d8",
    "filename": "src/main/java/com/exadel/fedorov/repository/OrderRepository.java",
    "status": "removed",
    "additions": 0,
    "deletions": 67,
    "changes": 67,
    "blob_url": "https://github.com/Demis05/OrderService/blob/cf0da4e7a4ff15fe9b5b69f43d26b6321955bc9a/src/main/java/com/exadel/fedorov/repository/OrderRepository.java",
    "raw_url": "https://github.com/Demis05/OrderService/raw/cf0da4e7a4ff15fe9b5b69f43d26b6321955bc9a/src/main/java/com/exadel/fedorov/repository/OrderRepository.java",
    "contents_url": "https://api.github.com/repos/Demis05/OrderService/contents/src/main/java/com/exadel/fedorov/repository/OrderRepository.java?ref=cf0da4e7a4ff15fe9b5b69f43d26b6321955bc9a",
    "patch": "@@ -1,67 +0,0 @@\n-package com.exadel.fedorov.repository;\n-\n-import com.exadel.fedorov.domain.Order;\n-import com.exadel.fedorov.domain.OrderStatus;\n-import org.springframework.beans.factory.annotation.Autowired;\n-import org.springframework.jdbc.core.JdbcTemplate;\n-import org.springframework.stereotype.Repository;\n-\n-import javax.sql.DataSource;\n-import java.util.List;\n-import java.util.Optional;\n-\n-\n-@Repository\n-public class OrderRepository {\n-\n-    private JdbcTemplate jdbcTemplate;\n-\n-    @Autowired\n-    public void setDataSource(DataSource dataSource) {\n-        this.jdbcTemplate = new JdbcTemplate(dataSource);\n-    }\n-\n-    public int create(Order order) {\n-        return jdbcTemplate.update(\n-                \"INSERT INTO public.orders(status, status_description, time, total_price) VALUES (?, ?, ?, ?);\",\n-                order.getStatus().toString(), order.getStatusDescription(), order.getTime(), order.getTotalPrice());\n-    }\n-\n-    public Optional<Order> findById(Long id) {\n-        return jdbcTemplate.queryForObject(\n-                \"select * from orders where id = ?\",\n-                new Object[]{id},\n-                (rs, rowNum) ->\n-                        Optional.of(new Order(\n-                                rs.getBigDecimal(\"total_price\"),\n-                                rs.getTimestamp(\"time\"),\n-                                OrderStatus.valueOf(rs.getString(\"status\")),\n-                                rs.getString(\"status_description\")\n-\n-                        ))\n-        );\n-    }\n-\n-    public void update(Order order) {\n-        jdbcTemplate.update(\n-                \"UPDATE public.orders SET status=?, status_description=?, total_price=? WHERE id = ?;\",\n-                order.getStatus(), order.getStatusDescription(), order.getTotalPrice(), order.getId());\n-    }\n-\n-    public void deleteById(Long id) {\n-        jdbcTemplate.update(\"delete from public.orders where id = ?\", id);\n-    }\n-\n-    public List<Order> findAll() {\n-        return jdbcTemplate.query(\n-                \"select * from public.orders\",\n-                (rs, rowNum) ->\n-                        new Order(\n-                                rs.getBigDecimal(\"total_price\"),\n-                                rs.getTimestamp(\"time\"),\n-                                OrderStatus.valueOf(rs.getString(\"status\")),\n-                                rs.getString(\"status_description\")\n-                        ));\n-    }\n-\n-}"
  },
  {
    "sha": "a690eda7b09caa799873ed9914639edf1c3424f3",
    "filename": "src/main/java/com/exadel/fedorov/service/OrderService.java",
    "status": "removed",
    "additions": 0,
    "deletions": 38,
    "changes": 38,
    "blob_url": "https://github.com/Demis05/OrderService/blob/cf0da4e7a4ff15fe9b5b69f43d26b6321955bc9a/src/main/java/com/exadel/fedorov/service/OrderService.java",
    "raw_url": "https://github.com/Demis05/OrderService/raw/cf0da4e7a4ff15fe9b5b69f43d26b6321955bc9a/src/main/java/com/exadel/fedorov/service/OrderService.java",
    "contents_url": "https://api.github.com/repos/Demis05/OrderService/contents/src/main/java/com/exadel/fedorov/service/OrderService.java?ref=cf0da4e7a4ff15fe9b5b69f43d26b6321955bc9a",
    "patch": "@@ -1,38 +0,0 @@\n-package com.exadel.fedorov.service;\n-\n-import com.exadel.fedorov.domain.Order;\n-import com.exadel.fedorov.repository.OrderRepository;\n-import org.springframework.beans.factory.annotation.Autowired;\n-import org.springframework.stereotype.Service;\n-\n-import java.util.List;\n-import java.util.Optional;\n-\n-@Service\n-public class OrderService {\n-\n-    @Autowired\n-    OrderRepository orderRepository;\n-\n-    public List<Order> findAll() {\n-        return orderRepository.findAll();\n-    }\n-\n-    public int create(Order order) {\n-        return orderRepository.create(order);\n-    }\n-\n-    public Optional<Order> findById(Long id) {\n-        return orderRepository.findById(id);\n-    }\n-\n-\n-    public void update(Order order) {\n-        orderRepository.update(order);\n-    }\n-\n-    public void deleteById(Long id) {\n-        orderRepository.deleteById(id);\n-    }\n-\n-}\n\\ No newline at end of file"
  }
]

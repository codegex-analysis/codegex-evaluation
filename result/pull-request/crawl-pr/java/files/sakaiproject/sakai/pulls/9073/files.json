[
  {
    "sha": "e8d6d0630518ca12ee074b9bf0be2e7bd14e4faa",
    "filename": "site-manage/datemanager/tool/src/main/java/org/sakaiproject/datemanager/tool/DateManagerViewObject.java",
    "status": "added",
    "additions": 13,
    "deletions": 0,
    "changes": 13,
    "blob_url": "https://github.com/sakaiproject/sakai/blob/ba375c5fce6b650213e4cb9275ddc25baeb4d587/site-manage/datemanager/tool/src/main/java/org/sakaiproject/datemanager/tool/DateManagerViewObject.java",
    "raw_url": "https://github.com/sakaiproject/sakai/raw/ba375c5fce6b650213e4cb9275ddc25baeb4d587/site-manage/datemanager/tool/src/main/java/org/sakaiproject/datemanager/tool/DateManagerViewObject.java",
    "contents_url": "https://api.github.com/repos/sakaiproject/sakai/contents/site-manage/datemanager/tool/src/main/java/org/sakaiproject/datemanager/tool/DateManagerViewObject.java?ref=ba375c5fce6b650213e4cb9275ddc25baeb4d587",
    "patch": "@@ -0,0 +1,13 @@\n+package org.sakaiproject.datemanager.tool;\n+\n+import org.json.simple.JSONArray;\n+\n+import lombok.Data;\n+\n+@Data\n+public class DateManagerViewObject {\n+\t\n+\tpublic JSONArray toolJson;\n+\tprivate String toolTitle;\n+\n+}"
  },
  {
    "sha": "ebe85af2f70f86548a291e48593ba7c7265f3566",
    "filename": "site-manage/datemanager/tool/src/main/java/org/sakaiproject/datemanager/tool/MainController.java",
    "status": "modified",
    "additions": 45,
    "deletions": 18,
    "changes": 63,
    "blob_url": "https://github.com/sakaiproject/sakai/blob/ba375c5fce6b650213e4cb9275ddc25baeb4d587/site-manage/datemanager/tool/src/main/java/org/sakaiproject/datemanager/tool/MainController.java",
    "raw_url": "https://github.com/sakaiproject/sakai/raw/ba375c5fce6b650213e4cb9275ddc25baeb4d587/site-manage/datemanager/tool/src/main/java/org/sakaiproject/datemanager/tool/MainController.java",
    "contents_url": "https://api.github.com/repos/sakaiproject/sakai/contents/site-manage/datemanager/tool/src/main/java/org/sakaiproject/datemanager/tool/MainController.java?ref=ba375c5fce6b650213e4cb9275ddc25baeb4d587",
    "patch": "@@ -14,7 +14,9 @@\n package org.sakaiproject.datemanager.tool;\n \n import java.util.ArrayList;\n+import java.util.Comparator;\n import java.util.Locale;\n+import java.util.stream.Collectors;\n import java.util.List;\n import javax.inject.Inject;\n import javax.servlet.http.HttpServletRequest;\n@@ -74,62 +76,87 @@ public String showIndex(@RequestParam(required=false) String code, Model model,\n \t\tmodel.addAttribute(\"userCountry\", loc.getCountry());\n \t\tmodel.addAttribute(\"userLanguage\", loc.getLanguage());\n \t\tmodel.addAttribute(\"userLocale\", loc.toString());\n+\t\t\n+\t\tList<DateManagerViewObject> dateManagerViewObjectList = new ArrayList<DateManagerViewObject>();\n \n \t\tif (dateManagerService.currentSiteContainsTool(DateManagerConstants.COMMON_ID_ASSIGNMENTS)) {\n \t\t\tJSONArray assignmentsJson = dateManagerService.getAssignmentsForContext(siteId);\n-\t\t\tmodel.addAttribute(\"assignments\", assignmentsJson);\n-\t\t\tmodel.addAttribute(\"assignmentsToolTitle\", dateManagerService.getToolTitle(DateManagerConstants.COMMON_ID_ASSIGNMENTS));\n+\t\t\tDateManagerViewObject dateManagerViewObject = new DateManagerViewObject();\n+\t\t\tdateManagerViewObject.setToolJson(assignmentsJson);\n+\t\t\tdateManagerViewObject.setToolTitle(dateManagerService.getToolTitle(DateManagerConstants.COMMON_ID_ASSIGNMENTS));\n+\t\t\tdateManagerViewObjectList.add(dateManagerViewObject);\n \t\t\tlog.debug(\"assignments {}\", assignmentsJson);\n \t\t}\n \t\tif (dateManagerService.currentSiteContainsTool(DateManagerConstants.COMMON_ID_ASSESSMENTS)) {\n \t\t\tJSONArray assessmentsJson = dateManagerService.getAssessmentsForContext(siteId);\n-\t\t\tmodel.addAttribute(\"assessments\", assessmentsJson);\n-\t\t\tmodel.addAttribute(\"assessmentsToolTitle\", dateManagerService.getToolTitle(DateManagerConstants.COMMON_ID_ASSESSMENTS));\n+\t\t\tDateManagerViewObject dateManagerViewObject = new DateManagerViewObject();\n+\t\t\tdateManagerViewObject.setToolJson(assessmentsJson);\n+\t\t\tdateManagerViewObject.setToolTitle(dateManagerService.getToolTitle(DateManagerConstants.COMMON_ID_ASSESSMENTS));\n+\t\t\tdateManagerViewObjectList.add(dateManagerViewObject);\n \t\t\tlog.debug(\"assessments {}\", assessmentsJson);\n \t\t}\n \t\tif (dateManagerService.currentSiteContainsTool(DateManagerConstants.COMMON_ID_GRADEBOOK)) {\n \t\t\tJSONArray gradebookItemsJson = dateManagerService.getGradebookItemsForContext(siteId);\n-\t\t\tmodel.addAttribute(\"gradebookItems\", gradebookItemsJson);\n-\t\t\tmodel.addAttribute(\"gradebookItemsToolTitle\", dateManagerService.getToolTitle(DateManagerConstants.COMMON_ID_GRADEBOOK));\n+\t\t\tDateManagerViewObject dateManagerViewObject = new DateManagerViewObject();\n+\t\t\tdateManagerViewObject.setToolJson(gradebookItemsJson);\n+\t\t\tdateManagerViewObject.setToolTitle(dateManagerService.getToolTitle(DateManagerConstants.COMMON_ID_GRADEBOOK));\n+\t\t\tdateManagerViewObjectList.add(dateManagerViewObject);\n \t\t\tlog.debug(\"gradebookItemsJson {}\", gradebookItemsJson);\n \t\t}\n \t\tif (dateManagerService.currentSiteContainsTool(DateManagerConstants.COMMON_ID_SIGNUP)) {\n \t\t\tJSONArray signupMeetingsJson = dateManagerService.getSignupMeetingsForContext(siteId);\n-\t\t\tmodel.addAttribute(\"signupMeetings\", signupMeetingsJson);\n-\t\t\tmodel.addAttribute(\"signupMeetingsToolTitle\", dateManagerService.getToolTitle(DateManagerConstants.COMMON_ID_SIGNUP));\n+\t\t\tDateManagerViewObject dateManagerViewObject = new DateManagerViewObject();\n+\t\t\tdateManagerViewObject.setToolJson(signupMeetingsJson);\n+\t\t\tdateManagerViewObject.setToolTitle(dateManagerService.getToolTitle(DateManagerConstants.COMMON_ID_SIGNUP));\n+\t\t\tdateManagerViewObjectList.add(dateManagerViewObject);\n \t\t\tlog.debug(\"signupMeetingsJson {}\", signupMeetingsJson);\n \t\t}\n \t\tif (dateManagerService.currentSiteContainsTool(DateManagerConstants.COMMON_ID_RESOURCES)) {\n \t\t\tJSONArray resourcesJson = dateManagerService.getResourcesForContext(siteId);\n-\t\t\tmodel.addAttribute(\"resources\", resourcesJson);\n-\t\t\tmodel.addAttribute(\"resourcesToolTitle\", dateManagerService.getToolTitle(DateManagerConstants.COMMON_ID_RESOURCES));\n+\t\t\tDateManagerViewObject dateManagerViewObject = new DateManagerViewObject();\n+\t\t\tdateManagerViewObject.setToolJson(resourcesJson);\n+\t\t\tdateManagerViewObject.setToolTitle(dateManagerService.getToolTitle(DateManagerConstants.COMMON_ID_RESOURCES));\n+\t\t\tdateManagerViewObjectList.add(dateManagerViewObject);\n \t\t\tlog.debug(\"resourcesJson {}\", resourcesJson);\n \t\t}\n \t\tif (dateManagerService.currentSiteContainsTool(DateManagerConstants.COMMON_ID_CALENDAR)) {\n \t\t\tJSONArray calendarJson = dateManagerService.getCalendarEventsForContext(siteId);\n-\t\t\tmodel.addAttribute(\"calendarEvents\", calendarJson);\n-\t\t\tmodel.addAttribute(\"calendarEventsToolTitle\", dateManagerService.getToolTitle(DateManagerConstants.COMMON_ID_CALENDAR));\n+\t\t\tDateManagerViewObject dateManagerViewObject = new DateManagerViewObject();\n+\t\t\tdateManagerViewObject.setToolJson(calendarJson);\n+\t\t\tdateManagerViewObject.setToolTitle(dateManagerService.getToolTitle(DateManagerConstants.COMMON_ID_CALENDAR));\n+\t\t\tdateManagerViewObjectList.add(dateManagerViewObject);\n \t\t\tlog.debug(\"calendarJson {}\", calendarJson);\n \t\t}\n \t\tif (dateManagerService.currentSiteContainsTool(DateManagerConstants.COMMON_ID_FORUMS)) {\n \t\t\tJSONArray forumsJson = dateManagerService.getForumsForContext(siteId);\n-\t\t\tmodel.addAttribute(\"forums\", forumsJson);\n-\t\t\tmodel.addAttribute(\"forumsToolTitle\", dateManagerService.getToolTitle(DateManagerConstants.COMMON_ID_FORUMS));\n+\t\t\tDateManagerViewObject dateManagerViewObject = new DateManagerViewObject();\n+\t\t\tdateManagerViewObject.setToolJson(forumsJson);\n+\t\t\tdateManagerViewObject.setToolTitle(dateManagerService.getToolTitle(DateManagerConstants.COMMON_ID_FORUMS));\n+\t\t\tdateManagerViewObjectList.add(dateManagerViewObject);\n \t\t\tlog.debug(\"forums {}\", forumsJson);\n \t\t}\n \t\tif (dateManagerService.currentSiteContainsTool(DateManagerConstants.COMMON_ID_ANNOUNCEMENTS)) {\n \t\t\tJSONArray announcementsJson = dateManagerService.getAnnouncementsForContext(siteId);\n-\t\t\tmodel.addAttribute(\"announcements\", announcementsJson);\n-\t\t\tmodel.addAttribute(\"announcementsToolTitle\", dateManagerService.getToolTitle(DateManagerConstants.COMMON_ID_ANNOUNCEMENTS));\n+\t\t\tDateManagerViewObject dateManagerViewObject = new DateManagerViewObject();\n+\t\t\tdateManagerViewObject.setToolJson(announcementsJson);\n+\t\t\tdateManagerViewObject.setToolTitle(dateManagerService.getToolTitle(DateManagerConstants.COMMON_ID_ANNOUNCEMENTS));\n+\t\t\tdateManagerViewObjectList.add(dateManagerViewObject);\n \t\t\tlog.debug(\"announcementsJson {}\", announcementsJson);\n \t\t}\n \t\tif (dateManagerService.currentSiteContainsTool(DateManagerConstants.COMMON_ID_LESSONS)) {\n \t\t\tJSONArray lessonsJson = dateManagerService.getLessonsForContext(siteId);\n-\t\t\tmodel.addAttribute(\"lessons\", lessonsJson);\n-\t\t\tmodel.addAttribute(\"lessonsToolTitle\", dateManagerService.getToolTitle(DateManagerConstants.COMMON_ID_LESSONS));\n+\t\t\tDateManagerViewObject dateManagerViewObject = new DateManagerViewObject();\n+\t\t\tdateManagerViewObject.setToolJson(lessonsJson);\n+\t\t\tdateManagerViewObject.setToolTitle(dateManagerService.getToolTitle(DateManagerConstants.COMMON_ID_LESSONS));\n+\t\t\tdateManagerViewObjectList.add(dateManagerViewObject);\n \t\t\tlog.debug(\"lessonsJson {}\", lessonsJson);\n \t\t}\n \n+\t\tList<DateManagerViewObject> dateManagerSortedObjectList = dateManagerViewObjectList.stream()\n+\t\t\t\t.sorted(Comparator.comparing(DateManagerViewObject::getToolTitle))\n+\t\t\t\t.collect(Collectors.toList());\n+\t\tmodel.addAttribute(\"dateManagerSortedObjectList\", dateManagerSortedObjectList);\n+\t\t\n \t\treturn \"index\";\n \t}\n "
  },
  {
    "sha": "cb3622b3726445bd17b7fc3a8aae3fd741af6d04",
    "filename": "site-manage/datemanager/tool/src/main/webapp/WEB-INF/templates/index.html",
    "status": "modified",
    "additions": 10,
    "deletions": 70,
    "changes": 80,
    "blob_url": "https://github.com/sakaiproject/sakai/blob/ba375c5fce6b650213e4cb9275ddc25baeb4d587/site-manage/datemanager/tool/src/main/webapp/WEB-INF/templates/index.html",
    "raw_url": "https://github.com/sakaiproject/sakai/raw/ba375c5fce6b650213e4cb9275ddc25baeb4d587/site-manage/datemanager/tool/src/main/webapp/WEB-INF/templates/index.html",
    "contents_url": "https://api.github.com/repos/sakaiproject/sakai/contents/site-manage/datemanager/tool/src/main/webapp/WEB-INF/templates/index.html?ref=ba375c5fce6b650213e4cb9275ddc25baeb4d587",
    "patch": "@@ -34,77 +34,17 @@ <h1 th:text=\"#{page.instructions}\">Add/Edit Options in batch</h1>\n \t\t\t\t<span th:text=\"#{success.message}\">The dates were updated successfully.</span>\n \t\t\t</div>\n \n-\t\t\t<div th:if=\"${assignments != null}\" class=\"panel panel-default\">\n-\t\t\t\t<div class=\"panel-heading\">\n-\t\t\t\t\t<h4 class=\"panel-title\">\n-\t\t\t\t\t\t<a data-toggle=\"collapse\" data-parent=\"#accordion\" href=\"#collapse-assignments\" class=\"collapsed\" aria-expanded=\"false\"><span th:text=\"${assignmentsToolTitle}\">Assignments</span></a>\n-\t\t\t\t\t</h4>\n-\t\t\t\t</div>\n-\t\t\t\t<div th:replace=\"tool_fragment :: tool_fragment(items=${assignments}, toolId='assignments', collapseId='collapse-assignments')\"></div>\n-\t\t\t</div>\n-\t\t\t<div th:if=\"${assessments != null}\" class=\"panel panel-default\">\n-\t\t\t\t<div class=\"panel-heading\">\n-\t\t\t\t\t<h4 class=\"panel-title\">\n-\t\t\t\t\t\t<a data-toggle=\"collapse\" data-parent=\"#accordion\" href=\"#collapse-assessments\" class=\"collapsed\" aria-expanded=\"false\"><span th:text=\"${assessmentsToolTitle}\">Tests & Quizzes</span></a>\n-\t\t\t\t\t</h4>\n-\t\t\t\t</div>\n-\t\t\t\t<div th:replace=\"tool_fragment :: tool_fragment(items=${assessments}, toolId='assessments', collapseId='collapse-assessments')\"></div>\n-\t\t\t</div>\n-\t\t\t<div th:if=\"${signupMeetings != null}\" class=\"panel panel-default\">\n-\t\t\t\t<div class=\"panel-heading\">\n-\t\t\t\t\t<h4 class=\"panel-title\">\n-\t\t\t\t\t\t<a data-toggle=\"collapse\" data-parent=\"#accordion\" href=\"#collapse-signup\" class=\"collapsed\" aria-expanded=\"false\"><span th:text=\"${signupMeetingsToolTitle}\">Sign up</span></a>\n-\t\t\t\t\t</h4>\n-\t\t\t\t</div>\n-\t\t\t\t<div th:replace=\"tool_fragment :: tool_fragment(items=${signupMeetings}, toolId='signupMeetings', collapseId='collapse-signup')\"></div>\n-\t\t\t</div>\n-\t\t\t<div th:if=\"${gradebookItems != null}\" class=\"panel panel-default\">\n-\t\t\t\t<div class=\"panel-heading\">\n-\t\t\t\t\t<h4 class=\"panel-title\">\n-\t\t\t\t\t\t<a data-toggle=\"collapse\" data-parent=\"#accordion\" href=\"#collapse-gradebook\" class=\"collapsed\" aria-expanded=\"false\"><span th:text=\"${gradebookItemsToolTitle}\">Gradebook</span></a>\n-\t\t\t\t\t</h4>\n-\t\t\t\t</div>\n-\t\t\t\t<div th:replace=\"tool_fragment :: tool_fragment(items=${gradebookItems}, toolId='gradebookItems', collapseId='collapse-gradebook')\"></div>\n-\t\t\t</div>\n-\t\t\t<div th:if=\"${resources != null}\" class=\"panel panel-default\">\n-\t\t\t\t<div class=\"panel-heading\">\n-\t\t\t\t\t<h4 class=\"panel-title\">\n-\t\t\t\t\t\t<a data-toggle=\"collapse\" data-parent=\"#accordion\" href=\"#collapse-resources\" class=\"collapsed\" aria-expanded=\"false\"><span th:text=\"${resourcesToolTitle}\">Resources</span></a>\n-\t\t\t\t\t</h4>\n-\t\t\t\t</div>\n-\t\t\t\t<div th:replace=\"tool_fragment :: tool_fragment(items=${resources}, toolId='resources', collapseId='collapse-resources')\"></div>\n-\t\t\t</div>\n-\t\t\t<div th:if=\"${calendarEvents != null}\" class=\"panel panel-default\">\n-\t\t\t\t<div class=\"panel-heading\">\n-\t\t\t\t\t<h4 class=\"panel-title\">\n-\t\t\t\t\t\t<a data-toggle=\"collapse\" data-parent=\"#accordion\" href=\"#collapse-calendar\" class=\"collapsed\" aria-expanded=\"false\"><span th:text=\"${calendarEventsToolTitle}\">Calendar</span></a>\n-\t\t\t\t\t</h4>\n-\t\t\t\t</div>\n-\t\t\t\t<div th:replace=\"tool_fragment :: tool_fragment(items=${calendarEvents}, toolId='calendarEvents', collapseId='collapse-calendar')\"></div>\n-\t\t\t</div>\n-\t\t\t<div th:if=\"${forums != null}\" class=\"panel panel-default\">\n-\t\t\t\t<div class=\"panel-heading\">\n-\t\t\t\t\t<h4 class=\"panel-title\">\n-\t\t\t\t\t\t<a data-toggle=\"collapse\" data-parent=\"#accordion\" href=\"#collapse-forums\" class=\"collapsed\" aria-expanded=\"false\"><span th:text=\"${forumsToolTitle}\">Forums</span></a>\n-\t\t\t\t\t</h4>\n-\t\t\t\t</div>\n-\t\t\t\t<div th:replace=\"tool_fragment :: tool_fragment(items=${forums}, toolId='forums', collapseId='collapse-forums')\"></div>\n-\t\t\t</div>\n-\t\t\t<div th:if=\"${announcements != null}\" class=\"panel panel-default\">\n-\t\t\t\t<div class=\"panel-heading\">\n-\t\t\t\t\t<h4 class=\"panel-title\">\n-\t\t\t\t\t\t<a data-toggle=\"collapse\" data-parent=\"#accordion\" href=\"#collapse-announcements\" class=\"collapsed\" aria-expanded=\"false\"><span th:text=\"${announcementsToolTitle}\">Announcements</span></a>\n-\t\t\t\t\t</h4>\n-\t\t\t\t</div>\n-\t\t\t\t<div th:replace=\"tool_fragment :: tool_fragment(items=${announcements}, toolId='announcements', collapseId='collapse-announcements')\"></div>\n-\t\t\t</div>\n-\t\t\t<div th:if=\"${lessons != null}\" class=\"panel panel-default\">\n-\t\t\t\t<div class=\"panel-heading\">\n-\t\t\t\t\t<h4 class=\"panel-title\">\n-\t\t\t\t\t\t<a data-toggle=\"collapse\" data-parent=\"#accordion\" href=\"#collapse-lessons\" class=\"collapsed\" aria-expanded=\"false\"><span th:text=\"${lessonsToolTitle}\">Lessons</span></a>\n-\t\t\t\t\t</h4>\n+\t\t\t<div th:if=\"${dateManagerSortedObjectList != null and !dateManagerSortedObjectList.isEmpty()}\">\n+\t\t\t\t<div th:each=\"tool: ${dateManagerSortedObjectList}\">\n+\t\t\t\t\t<div th:if=\"${tool.toolJson != null}\" class=\"panel panel-default\">\n+\t\t\t\t\t\t<div class=\"panel-heading\">\n+\t\t\t\t\t\t\t<h4 class=\"panel-title\">\n+\t\t\t\t\t\t\t\t<a data-toggle=\"collapse\" data-parent=\"#accordion\" href=\"#collapse-${tool.toolTitle}\" class=\"collapsed\" aria-expanded=\"false\"><span th:text=\"${tool.toolTitle}\"></span></a>\t\t\t\t\t\t\t\t\n+\t\t\t\t\t\t\t</h4>\n+\t\t\t\t\t\t</div>\n+\t\t\t\t\t\t\n+\t\t\t\t\t</div>\n \t\t\t\t</div>\n-\t\t\t\t<div th:replace=\"tool_fragment :: tool_fragment(items=${lessons}, toolId='lessons', collapseId='collapse-lessons')\"></div>\n \t\t\t</div>\n \n \t\t\t<div class=\"act\">"
  }
]

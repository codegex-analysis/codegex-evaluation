[
  {
    "sha": "9ec7ffdb318fb7f7290f98ac054f337af61b44cc",
    "filename": "server/src/main/java/org/elasticsearch/search/aggregations/bucket/histogram/AutoDateHistogramAggregatorFactory.java",
    "status": "modified",
    "additions": 41,
    "deletions": 2,
    "changes": 43,
    "blob_url": "https://github.com/elastic/elasticsearch/blob/b629dd4d56142f0444056dbb9c6dac38a70dbf88/server/src/main/java/org/elasticsearch/search/aggregations/bucket/histogram/AutoDateHistogramAggregatorFactory.java",
    "raw_url": "https://github.com/elastic/elasticsearch/raw/b629dd4d56142f0444056dbb9c6dac38a70dbf88/server/src/main/java/org/elasticsearch/search/aggregations/bucket/histogram/AutoDateHistogramAggregatorFactory.java",
    "contents_url": "https://api.github.com/repos/elastic/elasticsearch/contents/server/src/main/java/org/elasticsearch/search/aggregations/bucket/histogram/AutoDateHistogramAggregatorFactory.java?ref=b629dd4d56142f0444056dbb9c6dac38a70dbf88",
    "patch": "@@ -8,6 +8,8 @@\n \n package org.elasticsearch.search.aggregations.bucket.histogram;\n \n+import org.elasticsearch.common.logging.DeprecationCategory;\n+import org.elasticsearch.common.logging.DeprecationLogger;\n import org.elasticsearch.search.aggregations.Aggregator;\n import org.elasticsearch.search.aggregations.AggregatorFactories;\n import org.elasticsearch.search.aggregations.AggregatorFactory;\n@@ -25,12 +27,49 @@\n \n public final class AutoDateHistogramAggregatorFactory extends ValuesSourceAggregatorFactory {\n \n+    private static final DeprecationLogger DEPRECATION_LOGGER = DeprecationLogger.getLogger(AutoDateHistogramAggregator.class);\n+\n     public static void registerAggregators(ValuesSourceRegistry.Builder builder) {\n         builder.register(\n             AutoDateHistogramAggregationBuilder.REGISTRY_KEY,\n-            List.of(CoreValuesSourceType.DATE, CoreValuesSourceType.NUMERIC, CoreValuesSourceType.BOOLEAN),\n+            List.of(CoreValuesSourceType.DATE, CoreValuesSourceType.NUMERIC),\n             AutoDateHistogramAggregator::build,\n-                true);\n+            true\n+        );\n+\n+        builder.register(\n+            AutoDateHistogramAggregationBuilder.REGISTRY_KEY,\n+            CoreValuesSourceType.BOOLEAN,\n+            (\n+                String name,\n+                AggregatorFactories factories,\n+                int targetBuckets,\n+                RoundingInfo[] roundingInfos,\n+                ValuesSourceConfig valuesSourceConfig,\n+                AggregationContext context,\n+                Aggregator parent,\n+                CardinalityUpperBound cardinality,\n+                Map<String, Object> metadata) -> {\n+\n+                DEPRECATION_LOGGER.deprecate(\n+                    DeprecationCategory.AGGREGATIONS,\n+                    \"auto-date-histogram-boolean\",\n+                    \"Running AutoIntervalDateHistogram aggregations on [boolean] fields is deprecated\"\n+                );\n+                return AutoDateHistogramAggregator.build(\n+                    name,\n+                    factories,\n+                    targetBuckets,\n+                    roundingInfos,\n+                    valuesSourceConfig,\n+                    context,\n+                    parent,\n+                    cardinality,\n+                    metadata\n+                );\n+            },\n+            true\n+        );\n     }\n \n     private final AutoDateHistogramAggregatorSupplier aggregatorSupplier;"
  },
  {
    "sha": "054e7adb7c6685ac43c1924adec89e56a583ff33",
    "filename": "server/src/main/java/org/elasticsearch/search/aggregations/bucket/histogram/DateHistogramAggregatorFactory.java",
    "status": "modified",
    "additions": 45,
    "deletions": 1,
    "changes": 46,
    "blob_url": "https://github.com/elastic/elasticsearch/blob/b629dd4d56142f0444056dbb9c6dac38a70dbf88/server/src/main/java/org/elasticsearch/search/aggregations/bucket/histogram/DateHistogramAggregatorFactory.java",
    "raw_url": "https://github.com/elastic/elasticsearch/raw/b629dd4d56142f0444056dbb9c6dac38a70dbf88/server/src/main/java/org/elasticsearch/search/aggregations/bucket/histogram/DateHistogramAggregatorFactory.java",
    "contents_url": "https://api.github.com/repos/elastic/elasticsearch/contents/server/src/main/java/org/elasticsearch/search/aggregations/bucket/histogram/DateHistogramAggregatorFactory.java?ref=b629dd4d56142f0444056dbb9c6dac38a70dbf88",
    "patch": "@@ -9,6 +9,8 @@\n package org.elasticsearch.search.aggregations.bucket.histogram;\n \n import org.elasticsearch.common.Rounding;\n+import org.elasticsearch.common.logging.DeprecationCategory;\n+import org.elasticsearch.common.logging.DeprecationLogger;\n import org.elasticsearch.search.aggregations.Aggregator;\n import org.elasticsearch.search.aggregations.AggregatorFactories;\n import org.elasticsearch.search.aggregations.AggregatorFactory;\n@@ -25,15 +27,57 @@\n import java.util.Map;\n \n public final class DateHistogramAggregatorFactory extends ValuesSourceAggregatorFactory {\n+    private static final DeprecationLogger DEPRECATION_LOGGER = DeprecationLogger.getLogger(DateHistogramAggregatorFactory.class);\n \n     public static void registerAggregators(ValuesSourceRegistry.Builder builder) {\n         builder.register(\n             DateHistogramAggregationBuilder.REGISTRY_KEY,\n-            List.of(CoreValuesSourceType.DATE, CoreValuesSourceType.NUMERIC, CoreValuesSourceType.BOOLEAN),\n+            List.of(CoreValuesSourceType.DATE, CoreValuesSourceType.NUMERIC),\n             DateHistogramAggregator::build,\n                 true);\n \n         builder.register(DateHistogramAggregationBuilder.REGISTRY_KEY, CoreValuesSourceType.RANGE, DateRangeHistogramAggregator::new, true);\n+\n+        builder.register(\n+            DateHistogramAggregationBuilder.REGISTRY_KEY,\n+            CoreValuesSourceType.BOOLEAN,\n+            (\n+                name,\n+                factories,\n+                rounding,\n+                order,\n+                keyed,\n+                minDocCount,\n+                extendedBounds,\n+                hardBounds,\n+                valuesSourceConfig,\n+                context,\n+                parent,\n+                cardinality,\n+                metadata) -> {\n+                DEPRECATION_LOGGER.deprecate(\n+                    DeprecationCategory.AGGREGATIONS,\n+                    \"date-histogram-boolean\",\n+                    \"Running DateHistogram aggregations on [boolean] fields is deprecated\"\n+                );\n+                return DateHistogramAggregator.build(\n+                    name,\n+                    factories,\n+                    rounding,\n+                    order,\n+                    keyed,\n+                    minDocCount,\n+                    extendedBounds,\n+                    hardBounds,\n+                    valuesSourceConfig,\n+                    context,\n+                    parent,\n+                    cardinality,\n+                    metadata\n+                );\n+            },\n+            true\n+        );\n     }\n \n     private final DateHistogramAggregationSupplier aggregatorSupplier;"
  },
  {
    "sha": "918537d7cbf51146d7703b2ff013f6895b57cd55",
    "filename": "server/src/main/java/org/elasticsearch/search/aggregations/bucket/histogram/HistogramAggregatorFactory.java",
    "status": "modified",
    "additions": 2,
    "deletions": 1,
    "changes": 3,
    "blob_url": "https://github.com/elastic/elasticsearch/blob/b629dd4d56142f0444056dbb9c6dac38a70dbf88/server/src/main/java/org/elasticsearch/search/aggregations/bucket/histogram/HistogramAggregatorFactory.java",
    "raw_url": "https://github.com/elastic/elasticsearch/raw/b629dd4d56142f0444056dbb9c6dac38a70dbf88/server/src/main/java/org/elasticsearch/search/aggregations/bucket/histogram/HistogramAggregatorFactory.java",
    "contents_url": "https://api.github.com/repos/elastic/elasticsearch/contents/server/src/main/java/org/elasticsearch/search/aggregations/bucket/histogram/HistogramAggregatorFactory.java?ref=b629dd4d56142f0444056dbb9c6dac38a70dbf88",
    "patch": "@@ -44,7 +44,8 @@ static void registerAggregators(ValuesSourceRegistry.Builder builder) {\n             HistogramAggregationBuilder.REGISTRY_KEY,\n             List.of(CoreValuesSourceType.NUMERIC, CoreValuesSourceType.DATE, CoreValuesSourceType.BOOLEAN),\n             NumericHistogramAggregator::new,\n-                true);\n+            true\n+        );\n     }\n \n     public HistogramAggregatorFactory(String name,"
  },
  {
    "sha": "34b7f7c86811cc39f5541595c695d8c811170229",
    "filename": "server/src/main/java/org/elasticsearch/search/aggregations/bucket/range/AbstractRangeAggregatorFactory.java",
    "status": "modified",
    "additions": 0,
    "deletions": 13,
    "changes": 13,
    "blob_url": "https://github.com/elastic/elasticsearch/blob/b629dd4d56142f0444056dbb9c6dac38a70dbf88/server/src/main/java/org/elasticsearch/search/aggregations/bucket/range/AbstractRangeAggregatorFactory.java",
    "raw_url": "https://github.com/elastic/elasticsearch/raw/b629dd4d56142f0444056dbb9c6dac38a70dbf88/server/src/main/java/org/elasticsearch/search/aggregations/bucket/range/AbstractRangeAggregatorFactory.java",
    "contents_url": "https://api.github.com/repos/elastic/elasticsearch/contents/server/src/main/java/org/elasticsearch/search/aggregations/bucket/range/AbstractRangeAggregatorFactory.java?ref=b629dd4d56142f0444056dbb9c6dac38a70dbf88",
    "patch": "@@ -15,13 +15,11 @@\n import org.elasticsearch.search.aggregations.bucket.range.RangeAggregator.Range;\n import org.elasticsearch.search.aggregations.bucket.range.RangeAggregator.Unmapped;\n import org.elasticsearch.search.aggregations.support.AggregationContext;\n-import org.elasticsearch.search.aggregations.support.CoreValuesSourceType;\n import org.elasticsearch.search.aggregations.support.ValuesSourceAggregatorFactory;\n import org.elasticsearch.search.aggregations.support.ValuesSourceConfig;\n import org.elasticsearch.search.aggregations.support.ValuesSourceRegistry;\n \n import java.io.IOException;\n-import java.util.List;\n import java.util.Map;\n \n public class AbstractRangeAggregatorFactory<R extends Range> extends ValuesSourceAggregatorFactory {\n@@ -32,17 +30,6 @@\n     private final ValuesSourceRegistry.RegistryKey<RangeAggregatorSupplier> registryKey;\n     private final RangeAggregatorSupplier aggregatorSupplier;\n \n-    public static void registerAggregators(\n-        ValuesSourceRegistry.Builder builder,\n-        ValuesSourceRegistry.RegistryKey<RangeAggregatorSupplier> registryKey\n-    ) {\n-        builder.register(\n-            registryKey,\n-            List.of(CoreValuesSourceType.NUMERIC, CoreValuesSourceType.DATE, CoreValuesSourceType.BOOLEAN),\n-            RangeAggregator::build,\n-                true);\n-    }\n-\n     public AbstractRangeAggregatorFactory(String name,\n                                           ValuesSourceRegistry.RegistryKey<RangeAggregatorSupplier> registryKey,\n                                           ValuesSourceConfig config,"
  },
  {
    "sha": "35035cf55b0e64a67f51e2e1c577dc53834c03cc",
    "filename": "server/src/main/java/org/elasticsearch/search/aggregations/bucket/range/DateRangeAggregationBuilder.java",
    "status": "modified",
    "additions": 47,
    "deletions": 1,
    "changes": 48,
    "blob_url": "https://github.com/elastic/elasticsearch/blob/b629dd4d56142f0444056dbb9c6dac38a70dbf88/server/src/main/java/org/elasticsearch/search/aggregations/bucket/range/DateRangeAggregationBuilder.java",
    "raw_url": "https://github.com/elastic/elasticsearch/raw/b629dd4d56142f0444056dbb9c6dac38a70dbf88/server/src/main/java/org/elasticsearch/search/aggregations/bucket/range/DateRangeAggregationBuilder.java",
    "contents_url": "https://api.github.com/repos/elastic/elasticsearch/contents/server/src/main/java/org/elasticsearch/search/aggregations/bucket/range/DateRangeAggregationBuilder.java?ref=b629dd4d56142f0444056dbb9c6dac38a70dbf88",
    "patch": "@@ -9,11 +9,15 @@\n package org.elasticsearch.search.aggregations.bucket.range;\n \n import org.elasticsearch.common.io.stream.StreamInput;\n+import org.elasticsearch.common.logging.DeprecationCategory;\n+import org.elasticsearch.common.logging.DeprecationLogger;\n import org.elasticsearch.common.xcontent.ObjectParser;\n import org.elasticsearch.search.DocValueFormat;\n import org.elasticsearch.search.aggregations.AggregationBuilder;\n+import org.elasticsearch.search.aggregations.Aggregator;\n import org.elasticsearch.search.aggregations.AggregatorFactories;\n import org.elasticsearch.search.aggregations.AggregatorFactory;\n+import org.elasticsearch.search.aggregations.CardinalityUpperBound;\n import org.elasticsearch.search.aggregations.support.AggregationContext;\n import org.elasticsearch.search.aggregations.support.CoreValuesSourceType;\n import org.elasticsearch.search.aggregations.support.ValuesSourceAggregationBuilder;\n@@ -23,6 +27,7 @@\n \n import java.io.IOException;\n import java.time.ZonedDateTime;\n+import java.util.List;\n import java.util.Map;\n \n public class DateRangeAggregationBuilder extends AbstractRangeBuilder<DateRangeAggregationBuilder, RangeAggregator.Range> {\n@@ -45,8 +50,49 @@\n         }, (p, c) -> RangeAggregator.Range.PARSER.parse(p, null), RangeAggregator.RANGES_FIELD);\n     }\n \n+    private static final DeprecationLogger DEPRECATION_LOGGER = DeprecationLogger.getLogger(DateRangeAggregationBuilder.class);\n     public static void registerAggregators(ValuesSourceRegistry.Builder builder) {\n-        AbstractRangeAggregatorFactory.registerAggregators(builder, REGISTRY_KEY);\n+        builder.register(\n+            REGISTRY_KEY,\n+            List.of(CoreValuesSourceType.NUMERIC, CoreValuesSourceType.DATE),\n+            RangeAggregator::build,\n+            true\n+        );\n+\n+        builder.register(\n+            REGISTRY_KEY,\n+            CoreValuesSourceType.BOOLEAN,\n+            (\n+                String name,\n+                AggregatorFactories factories,\n+                ValuesSourceConfig valuesSourceConfig,\n+                InternalRange.Factory<?, ?> rangeFactory,\n+                RangeAggregator.Range[] ranges,\n+                boolean keyed,\n+                AggregationContext context,\n+                Aggregator parent,\n+                CardinalityUpperBound cardinality,\n+                Map<String, Object> metadata) -> {\n+                DEPRECATION_LOGGER.deprecate(\n+                    DeprecationCategory.AGGREGATIONS,\n+                    \"Range-boolean\",\n+                    \"Running Range or DateRange aggregations on [boolean] fields is deprecated\"\n+                );\n+                return RangeAggregator.build(\n+                    name,\n+                    factories,\n+                    valuesSourceConfig,\n+                    rangeFactory,\n+                    ranges,\n+                    keyed,\n+                    context,\n+                    parent,\n+                    cardinality,\n+                    metadata\n+                );\n+            },\n+            true\n+        );\n     }\n \n     public DateRangeAggregationBuilder(String name) {"
  },
  {
    "sha": "08ea745c74a92ba0737644c6cdc6e858d7c6a657",
    "filename": "server/src/main/java/org/elasticsearch/search/aggregations/bucket/range/RangeAggregationBuilder.java",
    "status": "modified",
    "additions": 8,
    "deletions": 1,
    "changes": 9,
    "blob_url": "https://github.com/elastic/elasticsearch/blob/b629dd4d56142f0444056dbb9c6dac38a70dbf88/server/src/main/java/org/elasticsearch/search/aggregations/bucket/range/RangeAggregationBuilder.java",
    "raw_url": "https://github.com/elastic/elasticsearch/raw/b629dd4d56142f0444056dbb9c6dac38a70dbf88/server/src/main/java/org/elasticsearch/search/aggregations/bucket/range/RangeAggregationBuilder.java",
    "contents_url": "https://api.github.com/repos/elastic/elasticsearch/contents/server/src/main/java/org/elasticsearch/search/aggregations/bucket/range/RangeAggregationBuilder.java?ref=b629dd4d56142f0444056dbb9c6dac38a70dbf88",
    "patch": "@@ -16,11 +16,13 @@\n import org.elasticsearch.search.aggregations.AggregatorFactory;\n import org.elasticsearch.search.aggregations.bucket.range.RangeAggregator.Range;\n import org.elasticsearch.search.aggregations.support.AggregationContext;\n+import org.elasticsearch.search.aggregations.support.CoreValuesSourceType;\n import org.elasticsearch.search.aggregations.support.ValuesSourceAggregationBuilder;\n import org.elasticsearch.search.aggregations.support.ValuesSourceConfig;\n import org.elasticsearch.search.aggregations.support.ValuesSourceRegistry;\n \n import java.io.IOException;\n+import java.util.List;\n import java.util.Map;\n \n public class RangeAggregationBuilder extends AbstractRangeBuilder<RangeAggregationBuilder, Range> {\n@@ -44,7 +46,12 @@\n     }\n \n     public static void registerAggregators(ValuesSourceRegistry.Builder builder) {\n-        AbstractRangeAggregatorFactory.registerAggregators(builder, REGISTRY_KEY);\n+        builder.register(\n+            REGISTRY_KEY,\n+            List.of(CoreValuesSourceType.NUMERIC, CoreValuesSourceType.DATE, CoreValuesSourceType.BOOLEAN),\n+            RangeAggregator::build,\n+            true\n+        );\n     }\n \n     public RangeAggregationBuilder(String name) {"
  }
]

[
  {
    "sha": "3d5cfe83961053c03634d66a4a790568b946fbf0",
    "filename": "azure-pipelines/authclient/azure-pipelines.yml",
    "status": "renamed",
    "additions": 1,
    "deletions": 1,
    "changes": 2,
    "blob_url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/blob/2d703bfff4625f5df03fdf1b9419df00679ccda2/azure-pipelines/authclient/azure-pipelines.yml",
    "raw_url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/raw/2d703bfff4625f5df03fdf1b9419df00679ccda2/azure-pipelines/authclient/azure-pipelines.yml",
    "contents_url": "https://api.github.com/repos/AzureAD/microsoft-authentication-library-common-for-android/contents/azure-pipelines/authclient/azure-pipelines.yml?ref=2d703bfff4625f5df03fdf1b9419df00679ccda2",
    "patch": "@@ -18,7 +18,7 @@ steps:\n     echo =============================================\n     echo Run unit and instrumented inside docker container\n     echo =============================================\n-    docker run --privileged --cpus=\"3\" --memory=\"12g\" -v \"$PWD\":/home/gradle/ -w /home/gradle/ authclient.azurecr.io/samples/dbi-instrumented-api30 sh scripts/run-instrumented-tests.sh\n+    docker run --privileged --cpus=\"3\" --memory=\"12g\" -v \"$PWD\":/home/gradle/ -w /home/gradle/ authclient.azurecr.io/samples/dbi-instrumented-api30 sh ../../scripts/run-instrumented-tests.sh\n   displayName: 'Build and test inside docker container'\n - script: |\n     echo =============================================",
    "previous_filename": "azure-pipelines.yml"
  },
  {
    "sha": "2c8081f4e7f2b3c01723d923d5d1143f321e4c1f",
    "filename": "azure-pipelines/maven-release/common.yml",
    "status": "added",
    "additions": 58,
    "deletions": 0,
    "changes": 58,
    "blob_url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/blob/2d703bfff4625f5df03fdf1b9419df00679ccda2/azure-pipelines/maven-release/common.yml",
    "raw_url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/raw/2d703bfff4625f5df03fdf1b9419df00679ccda2/azure-pipelines/maven-release/common.yml",
    "contents_url": "https://api.github.com/repos/AzureAD/microsoft-authentication-library-common-for-android/contents/azure-pipelines/maven-release/common.yml?ref=2d703bfff4625f5df03fdf1b9419df00679ccda2",
    "patch": "@@ -0,0 +1,58 @@\n+# 'Allow scripts to access the OAuth token' was selected in pipeline.  Add the following YAML to any steps requiring access:\n+#       env:\n+#           MY_ACCESS_TOKEN: $(System.AccessToken)\n+# Variable 'android:serverUrl' was defined in the Variables tab\n+# Variable 'commonVersion' was defined in the Variables tab\n+# Variable 'test_repo_branch' was defined in the Variables tab\n+# Variable 'test_repo_dir' was defined in the Variables tab\n+name: $(date:yyyyMMdd)$(rev:.r)\n+resources:\n+  repositories:\n+  - repository: self\n+    type: git\n+    ref: master\n+jobs:\n+- job: Phase_1\n+  displayName: SDL and Maven Build\n+  cancelTimeoutInMinutes: 1\n+  pool:\n+    name: Hosted Windows 2019 with VS2019\n+  steps:\n+  - checkout: self\n+    clean: true\n+    persistCredentials: True\n+  - template: ../templates/steps/credscan-policheck.yml\n+    parameters:\n+      policheckCmdLineArgsDir: common\n+  - template: ../templates/steps/maven-release/generate-release-artifacts.yml\n+    parameters:\n+      gradleAssembleReleaseTask: common:clean common:build common:assembleRelease\n+      gradleGeneratePomFiletask: common:generatePomFileForReleasePublication\n+      aarSourceFolder: common\\build\\outputs\\aar\\\n+      jarSourceFolder: common\\build\\outputs\\jar\n+      pomSourceFolder: common\\build\\publications\\release\\\n+- job: Job_1\n+  displayName: GPG Signing\n+  cancelTimeoutInMinutes: 1\n+  dependsOn: Phase_1\n+  pool:\n+    name: Hosted Ubuntu 1604\n+  steps:\n+  - checkout: self\n+    clean: true\n+  - template: ../templates/steps/maven-release/gpg-signing.yml\n+    parameters:\n+      gpgSigning: \"#!/bin/bash\\n\\nsudo apt-get update\\nsudo apt-get install -y gnupg2\\n\\nGPG_TTY=$(tty)\\nexport GPG_TTY\\n\\ngpg --import $(public.secureFilePath)\\ngpg --import $(private.secureFilePath)\\n\\n\\n\\ngpg --batch --no-use-agent --passphrase-file $(passphrase.secureFilePath) --armor --detach-sign $(System.ArtifactsDirectory)/build_outputs/common-$(commonVersion).aar\\n\\ngpg --batch --no-use-agent --passphrase-file $(passphrase.secureFilePath) --armor --detach-sign $(System.ArtifactsDirectory)/build_outputs/common-$(commonVersion)-sources.jar\\n\\ngpg --batch --no-use-agent --passphrase-file $(passphrase.secureFilePath) --armor --detach-sign $(System.ArtifactsDirectory)/build_outputs/pom-default.xml\\n\\ncd $(System.ArtifactsDirectory)/build_outputs/ &&\\nfor file in *; do\\n if [[ -f \\\"$file\\\" ]]; then\\n     md5sum -- \\\"$file\\\" > \\\"${file}.md5\\\"\\n fi \\n if [[ -f \\\"$file\\\" ]]; then\\n     shasum -- \\\"$file\\\" > \\\"${file}.sha1\\\"\\n fi\\ndone\\n\\nmkdir  -p $(System.ArtifactsDirectory)/common/$(commonVersion)\\n\\nmv $(System.ArtifactsDirectory)/build_outputs/*.jar $(System.ArtifactsDirectory)/common/$(commonVersion)\\nmv $(System.ArtifactsDirectory)/build_outputs/*.asc $(System.ArtifactsDirectory)/common/$(commonVersion)\\nmv $(System.ArtifactsDirectory)/build_outputs/*.aar $(System.ArtifactsDirectory)/common/$(commonVersion)\\nmv $(System.ArtifactsDirectory)/build_outputs/*.xml $(System.ArtifactsDirectory)/common/$(commonVersion)\\nmv $(System.ArtifactsDirectory)/build_outputs/*.sha1 $(System.ArtifactsDirectory)/common/$(commonVersion)\\nmv $(System.ArtifactsDirectory)/build_outputs/*.md5 $(System.ArtifactsDirectory)/common/$(commonVersion)\"\n+  - task: CmdLine@2\n+    displayName: Download certificates library\n+    inputs:\n+      script: >\n+        pip install certifi\n+  - task: PublishPipelineArtifact@1\n+    displayName: 'Publish Artifact: GPG Signing artifacts'\n+    inputs:\n+      PathtoPublish: $(System.ArtifactsDirectory)/common/$(commonVersion)\n+      ArtifactName: GPG Signing artifacts\n+  - template: ../templates/steps/maven-release/upload-to-nexus-sonatype.yml\n+    parameters:\n+      project: common\n\\ No newline at end of file"
  },
  {
    "sha": "a0433720e6473868646ec159e3e6578788f5b3ea",
    "filename": "azure-pipelines/nightly-snapshot-releases/Latest Common VSTS Release.yml",
    "status": "added",
    "additions": 108,
    "deletions": 0,
    "changes": 108,
    "blob_url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/blob/2d703bfff4625f5df03fdf1b9419df00679ccda2/azure-pipelines/nightly-snapshot-releases/Latest%20Common%20VSTS%20Release.yml",
    "raw_url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/raw/2d703bfff4625f5df03fdf1b9419df00679ccda2/azure-pipelines/nightly-snapshot-releases/Latest%20Common%20VSTS%20Release.yml",
    "contents_url": "https://api.github.com/repos/AzureAD/microsoft-authentication-library-common-for-android/contents/azure-pipelines/nightly-snapshot-releases/Latest%20Common%20VSTS%20Release.yml?ref=2d703bfff4625f5df03fdf1b9419df00679ccda2",
    "patch": "@@ -0,0 +1,108 @@\n+# 'Allow scripts to access the OAuth token' was selected in pipeline.  Add the following YAML to any steps requiring access:\n+#       env:\n+#           MY_ACCESS_TOKEN: $(System.AccessToken)\n+# Variable 'android:serverUrl' was defined in the Variables tab\n+# Variable 'ENV_VSTS_MVN_ANDROIDCOMMON_USERNAME' was defined in the Variables tab\n+# Variable 'test_repo_branch' was defined in the Variables tab\n+# Variable 'test_repo_dir' was defined in the Variables tab\n+# Variable Group 'Android Common Variables' was defined in the Variables tab\n+# Cron Schedules have been converted using UTC Time Zone and may need to be updated for your location\n+resources:\n+  pipelines:\n+  - pipeline: Nightly ADAL VSTS Release\n+    source: Nightly ADAL VSTS Release\n+    trigger:\n+      branches:\n+        include:\n+        - dev\n+  repositories:\n+  - repository: self\n+    type: git\n+    ref: dev\n+schedules:\n+- cron: 0 21 * * *\n+  branches:\n+    include:\n+    - dev\n+  always: true\n+name: $(date:yyyyMMdd)$(rev:.r)\n+jobs:\n+- job: Phase_1\n+  displayName: Phase 1\n+  timeoutInMinutes: 90\n+  cancelTimeoutInMinutes: 1\n+  pool:\n+    name: Hosted VS2017\n+  steps:\n+  - checkout: self\n+    clean: true\n+    submodules: recursive\n+    persistCredentials: True\n+  - template: ../templates/steps/credscan-policheck.yml\n+    parameters:\n+      policheckCmdLineArgsDir: adal\n+  - task: CmdLine@1\n+    displayName: Set MVN Access Token in Environment\n+    inputs:\n+      filename: echo\n+      arguments: '##vso[task.setvariable variable=ENV_VSTS_MVN_ANDROIDCOMMON_ACCESSTOKEN]$(mvn_access_token)'\n+  - task: TSAUpload@1\n+    displayName: TSA Upload\n+    enabled: False\n+    inputs:\n+      tsaVersion: TsaV2\n+      codebase: NewOrUpdate\n+      tsaStamp: Azure\n+      codeBaseName: ADALAndroid\n+      notificationAlias: androididentity@microsoft.com\n+      codeBaseAdmins: REDMOND\\androididentity\n+      instanceUrlAzure: IDENTITYDIVISION\n+      instanceUrlForTsaV2: IDENTITYDIVISION\n+      projectNameIDENTITYDIVISION: IDDP\n+      areaPath: IDDP\\DevEx-Client-SDK\\Android\n+      iterationPath: IDDP\\FY19\\Q1\n+      uploadAPIScan: false\n+      uploadBinSkim: false\n+      uploadFortifySCA: false\n+      uploadFxCop: false\n+      uploadModernCop: false\n+      uploadPREfast: false\n+      uploadRoslyn: false\n+      uploadTSLint: false\n+  - task: Gradle@2\n+    displayName: Latest version update\n+    inputs:\n+      tasks: versionLatest\n+      publishJUnitResults: false\n+  - task: Gradle@1\n+    name: Gradle1\n+    displayName: Assemble Release\n+    inputs:\n+      tasks: clean build assembleRelease\n+      publishJUnitResults: false\n+      jdkArchitecture: x86\n+      sqAnalysisBreakBuildIfQualityGateFailed: false\n+  - task: Gradle@2\n+    displayName: Run unit tests\n+    inputs:\n+      tasks: testDebugUnitTest\n+  - task: Gradle@2\n+    displayName: Publish\n+    inputs:\n+      tasks: publish\n+      publishJUnitResults: false\n+  - task: CopyFiles@2\n+    name: CopyFiles1\n+    displayName: Copy Files to Artifact Staging Directory\n+    inputs:\n+      SourceFolder: common\\build\\\n+      TargetFolder: $(build.artifactstagingdirectory)\n+  - task: PublishPipelineArtifact@1\n+    name: PublishPipelineArtifacts1\n+    displayName: 'Publish Artifact: Common Release'\n+    inputs:\n+      ArtifactName: CommonRelease\n+      TargetPath: '\\\\my\\share\\$(Build.DefinitionName)\\$(Build.BuildNumber)'\n+  - task: ComponentGovernanceComponentDetection@0\n+    displayName: Component Detection\n+..."
  },
  {
    "sha": "bb10f4b27f5a7e1a2ee48a420582f0d93038e6f6",
    "filename": "azure-pipelines/nightly-snapshot-releases/Nightly Common VSTS Release.yml",
    "status": "added",
    "additions": 108,
    "deletions": 0,
    "changes": 108,
    "blob_url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/blob/2d703bfff4625f5df03fdf1b9419df00679ccda2/azure-pipelines/nightly-snapshot-releases/Nightly%20Common%20VSTS%20Release.yml",
    "raw_url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/raw/2d703bfff4625f5df03fdf1b9419df00679ccda2/azure-pipelines/nightly-snapshot-releases/Nightly%20Common%20VSTS%20Release.yml",
    "contents_url": "https://api.github.com/repos/AzureAD/microsoft-authentication-library-common-for-android/contents/azure-pipelines/nightly-snapshot-releases/Nightly%20Common%20VSTS%20Release.yml?ref=2d703bfff4625f5df03fdf1b9419df00679ccda2",
    "patch": "@@ -0,0 +1,108 @@\n+# 'Allow scripts to access the OAuth token' was selected in pipeline.  Add the following YAML to any steps requiring access:\n+#       env:\n+#           MY_ACCESS_TOKEN: $(System.AccessToken)\n+# Variable 'android:serverUrl' was defined in the Variables tab\n+# Variable 'ENV_VSTS_MVN_ANDROIDCOMMON_USERNAME' was defined in the Variables tab\n+# Variable 'test_repo_branch' was defined in the Variables tab\n+# Variable 'test_repo_dir' was defined in the Variables tab\n+# Variable Group 'Android Common Variables' was defined in the Variables tab\n+# Cron Schedules have been converted using UTC Time Zone and may need to be updated for your location\n+resources:\n+  pipelines:\n+  - pipeline: Nightly ADAL VSTS Release\n+    source: Nightly ADAL VSTS Release\n+    trigger:\n+      branches:\n+        include:\n+        - dev\n+  repositories:\n+  - repository: self\n+    type: git\n+    ref: dev\n+schedules:\n+- cron: 0 21 * * *\n+  branches:\n+    include:\n+    - dev\n+  always: true\n+name: $(date:yyyyMMdd)$(rev:.r)\n+jobs:\n+- job: Phase_1\n+  displayName: Phase 1\n+  timeoutInMinutes: 90\n+  cancelTimeoutInMinutes: 1\n+  pool:\n+    name: Hosted VS2017\n+  steps:\n+  - checkout: self\n+    clean: true\n+    submodules: recursive\n+    persistCredentials: True\n+  - template: ../templates/steps/credscan-policheck.yml\n+    parameters:\n+      policheckCmdLineArgsDir: adal\n+  - task: CmdLine@1\n+    displayName: Set MVN Access Token in Environment\n+    inputs:\n+      filename: echo\n+      arguments: '##vso[task.setvariable variable=ENV_VSTS_MVN_ANDROIDCOMMON_ACCESSTOKEN]$(mvn_access_token)'\n+  - task: TSAUpload@1\n+    displayName: TSA Upload\n+    enabled: False\n+    inputs:\n+      tsaVersion: TsaV2\n+      codebase: NewOrUpdate\n+      tsaStamp: Azure\n+      codeBaseName: ADALAndroid\n+      notificationAlias: androididentity@microsoft.com\n+      codeBaseAdmins: REDMOND\\androididentity\n+      instanceUrlAzure: IDENTITYDIVISION\n+      instanceUrlForTsaV2: IDENTITYDIVISION\n+      projectNameIDENTITYDIVISION: IDDP\n+      areaPath: IDDP\\DevEx-Client-SDK\\Android\n+      iterationPath: IDDP\\FY19\\Q1\n+      uploadAPIScan: false\n+      uploadBinSkim: false\n+      uploadFortifySCA: false\n+      uploadFxCop: false\n+      uploadModernCop: false\n+      uploadPREfast: false\n+      uploadRoslyn: false\n+      uploadTSLint: false\n+  - task: Gradle@2\n+    displayName: Snapshot version update\n+    inputs:\n+      tasks: common:versionSnapshot\n+      publishJUnitResults: false\n+  - task: Gradle@1\n+    name: Gradle1\n+    displayName: Assemble Release\n+    inputs:\n+      tasks: 'clean common:build common:assembleRelease '\n+      publishJUnitResults: false\n+      jdkArchitecture: x86\n+      sqAnalysisBreakBuildIfQualityGateFailed: false\n+  - task: Gradle@2\n+    displayName: Run unit tests\n+    inputs:\n+      tasks: testDebugUnitTest\n+  - task: Gradle@2\n+    displayName: Publish\n+    inputs:\n+      tasks: common:publish\n+      publishJUnitResults: false\n+  - task: CopyFiles@2\n+    name: CopyFiles1\n+    displayName: Copy Files to Artifact Staging Directory\n+    inputs:\n+      SourceFolder: common\\build\\\n+      TargetFolder: $(build.artifactstagingdirectory)\n+  - task: PublishPipelineArtifact@1\n+    name: PublishPipelineArtifacts1\n+    displayName: 'Publish Artifact: Common Release'\n+    inputs:\n+      ArtifactName: CommonRelease\n+      TargetPath: '\\\\my\\share\\$(Build.DefinitionName)\\$(Build.BuildNumber)'\n+  - task: ComponentGovernanceComponentDetection@0\n+    displayName: Component Detection\n+..."
  },
  {
    "sha": "6f0cf68ae381e506c031f251c6878cb009c71609",
    "filename": "azure-pipelines/pull-request-validation/common.yml",
    "status": "added",
    "additions": 50,
    "deletions": 0,
    "changes": 50,
    "blob_url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/blob/2d703bfff4625f5df03fdf1b9419df00679ccda2/azure-pipelines/pull-request-validation/common.yml",
    "raw_url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/raw/2d703bfff4625f5df03fdf1b9419df00679ccda2/azure-pipelines/pull-request-validation/common.yml",
    "contents_url": "https://api.github.com/repos/AzureAD/microsoft-authentication-library-common-for-android/contents/azure-pipelines/pull-request-validation/common.yml?ref=2d703bfff4625f5df03fdf1b9419df00679ccda2",
    "patch": "@@ -0,0 +1,50 @@\n+# 'Allow scripts to access the OAuth token' was selected in pipeline.  Add the following YAML to any steps requiring access:\n+#       env:\n+#           MY_ACCESS_TOKEN: $(System.AccessToken)\n+# Variable 'android:serverUrl' was defined in the Variables tab\n+# Variable 'ENV_VSTS_MVN_ANDROIDADACCOUNTS_USERNAME' was defined in the Variables tab\n+# Variable 'mvnAccessToken' was defined in the Variables tab\n+# Variable 'test_repo_branch' was defined in the Variables tab\n+# Variable 'test_repo_dir' was defined in the Variables tab\n+trigger:\n+  branches:\n+    include:\n+    - dev\n+    - master\n+  batch: True\n+name: $(date:yyyyMMdd)$(rev:.r)\n+resources:\n+  repositories:\n+  - repository: self\n+    type: git\n+    ref: dev\n+jobs:\n+- job: Phase_1\n+  displayName: Phase 1\n+  cancelTimeoutInMinutes: 1\n+  pool:\n+    name: Hosted Windows 2019 with VS2019\n+  steps:\n+  - checkout: self\n+    clean: true\n+    submodules: recursive\n+    persistCredentials: True\n+  - template: ../templates/steps/credscan-policheck.yml\n+    parameters:\n+      policheckCmdLineArgsDir: adal\n+  - template: ../templates/steps/automation-cert.yml\n+  - task: Gradle@1\n+    name: Gradle1\n+    displayName: Assemble Release\n+    inputs:\n+      tasks: clean common:assemble\n+      publishJUnitResults: false\n+      jdkArchitecture: x86\n+      sqAnalysisBreakBuildIfQualityGateFailed: false\n+  - task: Gradle@2\n+    displayName: Run Unit tests\n+    inputs:\n+      tasks: common:testDebugUnitTest\n+  - task: ComponentGovernanceComponentDetection@0\n+    displayName: Component Detection\n+..."
  },
  {
    "sha": "45d26a36bdeffdaea8e7be6a609558c15795b857",
    "filename": "azure-pipelines/templates/steps/automation-cert.yml",
    "status": "added",
    "additions": 38,
    "deletions": 0,
    "changes": 38,
    "blob_url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/blob/2d703bfff4625f5df03fdf1b9419df00679ccda2/azure-pipelines/templates/steps/automation-cert.yml",
    "raw_url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/raw/2d703bfff4625f5df03fdf1b9419df00679ccda2/azure-pipelines/templates/steps/automation-cert.yml",
    "contents_url": "https://api.github.com/repos/AzureAD/microsoft-authentication-library-common-for-android/contents/azure-pipelines/templates/steps/automation-cert.yml?ref=2d703bfff4625f5df03fdf1b9419df00679ccda2",
    "patch": "@@ -0,0 +1,38 @@\n+# File: automation-cert.yml\n+\n+parameters:\n+- name: envVstsMvnAt\n+  default: ENV_VSTS_MVN_ANDROIDADACCOUNTS_ACCESSTOKEN\n+\n+steps:\n+- task: CmdLine@1\n+  displayName: Set MVN Access Token in Environment\n+  inputs:\n+    filename: echo\n+    arguments: '##vso[task.setvariable variable=${{ parameters.envVstsMvnAt }}]$(mvnAccessToken)'\n+- task: AzureKeyVault@1\n+  displayName: 'Azure Key Vault: Download Cert for Automation'\n+  inputs:\n+    ConnectedServiceName: 9a9308ae-59b4-475f-b49c-3e828c508d8b\n+    KeyVaultName: ADALTestInfo\n+    SecretsFilter: AndroidAutomationRunner\n+- task: PowerShell@2\n+  displayName: Install Automation Cert\n+  inputs:\n+    targetType: inline\n+    script: >\n+      $kvSecretBytes = [System.Convert]::FromBase64String('$(AndroidAutomationRunner)')\n+\n+      $certCollection = New-Object System.Security.Cryptography.X509Certificates.X509Certificate2Collection\n+\n+      $certCollection.Import($kvSecretBytes, $null, [System.Security.Cryptography.X509Certificates.X509KeyStorageFlags]::Exportable)\n+\n+\n+      $protectedCertificateBytes = $certCollection.Export([System.Security.Cryptography.X509Certificates.X509ContentType]::Pkcs12)\n+\n+      $pfxPath = '$(Build.SourcesDirectory)' + \"\\TestCert.pfx\"\n+\n+      [System.IO.File]::WriteAllBytes($pfxPath, $protectedCertificateBytes)\n+\n+\n+      Import-PfxCertificate -FilePath $pfxPath -CertStoreLocation Cert:\\CurrentUser\\My"
  },
  {
    "sha": "975284523d40fc1dac55f586ddeddb5e84d5dc96",
    "filename": "azure-pipelines/templates/steps/credscan-policheck.yml",
    "status": "added",
    "additions": 27,
    "deletions": 0,
    "changes": 27,
    "blob_url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/blob/2d703bfff4625f5df03fdf1b9419df00679ccda2/azure-pipelines/templates/steps/credscan-policheck.yml",
    "raw_url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/raw/2d703bfff4625f5df03fdf1b9419df00679ccda2/azure-pipelines/templates/steps/credscan-policheck.yml",
    "contents_url": "https://api.github.com/repos/AzureAD/microsoft-authentication-library-common-for-android/contents/azure-pipelines/templates/steps/credscan-policheck.yml?ref=2d703bfff4625f5df03fdf1b9419df00679ccda2",
    "patch": "@@ -0,0 +1,27 @@\n+# File: credscan-policheck.yml\n+\n+parameters:\n+- name: policheckCmdLineArgsDir\n+\n+steps:\n+- task: securedevelopmentteam.vss-secure-development-tools.build-task-credscan.CredScan@2\n+  displayName: Run CredScan\n+  inputs:\n+    toolMajorVersion: V2\n+    debugMode: false\n+    folderSuppression: false\n+- task: PoliCheck@1\n+  name: PoliCheck_2\n+  displayName: Run PoliCheck\n+  inputs:\n+    inputType: Basic\n+    cmdLineArgs: /F:$(Build.SourcesDirectory)+\"\\${{ parameters.policheckCmdLineArgsDir }}\\src\\\" /T:9 /O:\\\"PoliCheck.xml\\\"\n+    importEx: 0\n+    optionsFC: 1\n+    optionsXS: 1\n+    optionsSEV: 1|2\n+    optionsPE: 1|2|3|4\n+- task: PublishSecurityAnalysisLogs@2\n+  name: PublishSecurityAnalysisLogs15\n+  displayName: Publish Security Analysis Logs\n+"
  },
  {
    "sha": "f8b542bce14a2906a47aca7a9eb8812b00fae82d",
    "filename": "azure-pipelines/templates/steps/maven-release/generate-release-artifacts.yml",
    "status": "added",
    "additions": 50,
    "deletions": 0,
    "changes": 50,
    "blob_url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/blob/2d703bfff4625f5df03fdf1b9419df00679ccda2/azure-pipelines/templates/steps/maven-release/generate-release-artifacts.yml",
    "raw_url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/raw/2d703bfff4625f5df03fdf1b9419df00679ccda2/azure-pipelines/templates/steps/maven-release/generate-release-artifacts.yml",
    "contents_url": "https://api.github.com/repos/AzureAD/microsoft-authentication-library-common-for-android/contents/azure-pipelines/templates/steps/maven-release/generate-release-artifacts.yml?ref=2d703bfff4625f5df03fdf1b9419df00679ccda2",
    "patch": "@@ -0,0 +1,50 @@\n+# File: generate-release-artifacts.yml\n+\n+parameters:\n+- name: gradleAssembleReleaseTask\n+- name: gradleGeneratePomFiletask\n+- name: aarSourceFolder\n+- name: jarSourceFolder\n+- name: pomSourceFolder\n+\n+steps:\n+- task: Gradle@1\n+  name: Gradle1\n+  displayName: Assemble Release\n+  inputs:\n+    tasks: ${{ parameters.gradleAssembleReleaseTask }}\n+    publishJUnitResults: false\n+    jdkArchitecture: x86\n+    sqAnalysisBreakBuildIfQualityGateFailed: false\n+- task: Gradle@1\n+  displayName: Generate Pom file\n+  inputs:\n+    tasks: ${{ parameters.gradleGeneratePomFiletask }}\n+    publishJUnitResults: false\n+    jdkArchitecture: x86\n+    sqAnalysisBreakBuildIfQualityGateFailed: false\n+- task: CopyFiles@2\n+  name: CopyFiles1\n+  displayName: Copy aar to Artifact Staging Directory\n+  inputs:\n+    SourceFolder: ${{ parameters.aarSourceFolder }}\n+    Contents: '**/*.aar'\n+    TargetFolder: $(build.artifactstagingdirectory)\n+- task: CopyFiles@2\n+  displayName: Copy jars to Artifact Staging Directory\n+  inputs:\n+    SourceFolder: ${{ parameters.jarSourceFolder }}\n+    Contents: '**/*.jar'\n+    TargetFolder: $(build.artifactstagingdirectory)\n+- task: CopyFiles@2\n+  displayName: Copy pom to Artifact Staging Directory\n+  inputs:\n+    SourceFolder: ${{ parameters.pomSourceFolder }}\n+    Contents: '**/*.xml'\n+    TargetFolder: $(build.artifactstagingdirectory)\n+- task: PublishPipelineArtifact@1\n+  name: PublishPipelineArtifact1\n+  displayName: 'Publish Artifact: Build Outputs'\n+  inputs:\n+    ArtifactName: build_outputs\n+    TargetPath: '\\\\my\\share\\$(Build.DefinitionName)\\$(Build.BuildNumber)'\n\\ No newline at end of file"
  },
  {
    "sha": "43541200353d51913c26bdd68f5095a277a5043c",
    "filename": "azure-pipelines/templates/steps/maven-release/gpg-signing.yml",
    "status": "added",
    "additions": 33,
    "deletions": 0,
    "changes": 33,
    "blob_url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/blob/2d703bfff4625f5df03fdf1b9419df00679ccda2/azure-pipelines/templates/steps/maven-release/gpg-signing.yml",
    "raw_url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/raw/2d703bfff4625f5df03fdf1b9419df00679ccda2/azure-pipelines/templates/steps/maven-release/gpg-signing.yml",
    "contents_url": "https://api.github.com/repos/AzureAD/microsoft-authentication-library-common-for-android/contents/azure-pipelines/templates/steps/maven-release/gpg-signing.yml?ref=2d703bfff4625f5df03fdf1b9419df00679ccda2",
    "patch": "@@ -0,0 +1,33 @@\n+# File: gpg-signing.yml\n+\n+parameters:\n+- name: gpgSigning\n+\n+steps:\n+- task: DownloadPipelineArtifact@2\n+  displayName: Download Pipeline Artifacts\n+  inputs:\n+    artifactName: build_outputs\n+- task: DownloadSecureFile@1\n+  name: private\n+  displayName: Download GPG private key\n+  inputs:\n+    secureFile: private.key\n+    retryCount: 5\n+- task: DownloadSecureFile@1\n+  name: public\n+  displayName: Download GPG public key\n+  inputs:\n+    secureFile: public.key\n+    retryCount: 5\n+- task: DownloadSecureFile@1\n+  name: passphrase\n+  displayName: Download GPG passphrase\n+  inputs:\n+    secureFile: passphrase.txt\n+    retryCount: 5\n+- task: Bash@3\n+  displayName: GPG Signing\n+  inputs:\n+    targetType: inline\n+    script: ${{ parameters.gpgSigning }}"
  },
  {
    "sha": "7caa4042bea51bddb3817d069b1392b818e1afe7",
    "filename": "azure-pipelines/templates/steps/maven-release/upload-to-nexus-sonatype.yml",
    "status": "added",
    "additions": 79,
    "deletions": 0,
    "changes": 79,
    "blob_url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/blob/2d703bfff4625f5df03fdf1b9419df00679ccda2/azure-pipelines/templates/steps/maven-release/upload-to-nexus-sonatype.yml",
    "raw_url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/raw/2d703bfff4625f5df03fdf1b9419df00679ccda2/azure-pipelines/templates/steps/maven-release/upload-to-nexus-sonatype.yml",
    "contents_url": "https://api.github.com/repos/AzureAD/microsoft-authentication-library-common-for-android/contents/azure-pipelines/templates/steps/maven-release/upload-to-nexus-sonatype.yml?ref=2d703bfff4625f5df03fdf1b9419df00679ccda2",
    "patch": "@@ -0,0 +1,79 @@\n+# File: automation-cert.yml\n+\n+parameters:\n+- name: project\n+\n+steps:\n+- task: CmdLine@2\n+  displayName: Download Python Requests Library\n+  inputs:\n+    script: pip install requests\n+- task: DownloadSecureFile@1\n+  name: credentials\n+  displayName: Download Nexus Sonatype Login Credentials\n+  inputs:\n+    secureFile: NexusSonatypeCredentials.json\n+    retryCount: 5\n+- task: PythonScript@0\n+  displayName: Upload to Nexus Sonatype Staging Directory\n+  inputs:\n+    arguments: ${{ parameters.project }}\n+    scriptSource: inline\n+    script: >-\n+      import requests\n+\n+      from xml.dom import minidom\n+\n+      import sys\n+\n+      import os\n+\n+      import json\n+\n+      CONFIG = {\n+          'adal': {'profile_id': '4ac616f169d24a', 'env_var': 'ADALVERSION', 'path': 'aad/adal'},\n+          'msal': {'profile_id': '60bca90c1b7703', 'env_var': 'MSALVERSION', 'path': 'identity/client/msal'},\n+          'common': {'profile_id': '60bca90c1b7703', 'env_var': 'COMMONVERSION', 'path': 'identity/common'}\n+      }\n+      if len(sys.argv) == 2 and sys.argv[1] in CONFIG.keys():\n+          prj = sys.argv[1]\n+      else:\n+          sys.exit()\n+\n+      headers = {\n+          'Content-Type': 'application/xml',\n+      }\n+\n+\n+      data = '<promoteRequest><data><description>{}</description></data></promoteRequest>'.format(prj)\n+\n+\n+      credentialsdirectory = os.environ[\"CREDENTIALS_SECUREFILEPATH\"]\n+\n+      with open(credentialsdirectory) as f:\n+          credentials = json.load(f)\n+\n+      response = requests.post('https://oss.sonatype.org/service/local/staging/profiles/{}/start'.format(CONFIG[prj]['profile_id']), headers=headers, data=data, verify=False, auth=(credentials[\"username\"], credentials[\"password\"]))\n+\n+\n+      xmldoc = minidom.parseString(response.content)\n+\n+      repository_id = xmldoc.getElementsByTagName('stagedRepositoryId')[0].firstChild.nodeValue\n+\n+\n+      prjVersion = os.environ[CONFIG[prj]['env_var']]\n+\n+      directory = '{}/{}/{}'.format(os.environ[\"SYSTEM_ARTIFACTSDIRECTORY\"], prj, prjVersion)\n+\n+      for filename in os.listdir(directory):\n+          repo_name = filename\n+          if filename.startswith(\"pom-default.xml\"):\n+              new_string = \"{}-{}.pom\".format(prj, prjVersion)\n+              repo_name = filename.replace(\"pom-default.xml\", new_string)\n+          print(filename)\n+          url = \"https://oss.sonatype.org/service/local/staging/deployByRepositoryId/{}/com/microsoft/{}/{}/{}\".format(repository_id, CONFIG[prj]['path'], prjVersion, repo_name)\n+          print(url)\n+\n+          with open(directory + \"/\" + filename, 'rb') as f:\n+              requests.post(url, data=f, verify=False, auth=(credentials[\"username\"], credentials[\"password\"]))\n+..."
  },
  {
    "sha": "cfcd6d5ab4f8a9fc31788243a65829ffa998dab2",
    "filename": "azure-pipelines/templates/steps/ui-automation/gcloud.yml",
    "status": "added",
    "additions": 107,
    "deletions": 0,
    "changes": 107,
    "blob_url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/blob/2d703bfff4625f5df03fdf1b9419df00679ccda2/azure-pipelines/templates/steps/ui-automation/gcloud.yml",
    "raw_url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/raw/2d703bfff4625f5df03fdf1b9419df00679ccda2/azure-pipelines/templates/steps/ui-automation/gcloud.yml",
    "contents_url": "https://api.github.com/repos/AzureAD/microsoft-authentication-library-common-for-android/contents/azure-pipelines/templates/steps/ui-automation/gcloud.yml?ref=2d703bfff4625f5df03fdf1b9419df00679ccda2",
    "patch": "@@ -0,0 +1,107 @@\n+# File: gcloud.yml\n+\n+parameters:\n+- name: envVstsMvnAt\n+  default: ENV_VSTS_MVN_ANDROIDADACCOUNTS_ACCESSTOKEN\n+\n+steps:\n+- task: CmdLine@1\n+  displayName: Set MVN Access Token in Environment\n+  inputs:\n+    filename: echo\n+    arguments: '##vso[task.setvariable variable=${{ parameters.envVstsMvnAt }}]$(mvnAccessToken)'\n+- task: AzureKeyVault@1\n+  name: secret\n+  displayName: 'Azure Key Vault: Download Secret for Automation'\n+  inputs:\n+    ConnectedServiceName: 9a9308ae-59b4-475f-b49c-3e828c508d8b\n+    KeyVaultName: ADALTestInfo\n+    SecretsFilter: AndroidAutomationRunnerAppSecret\n+- task: DownloadSecureFile@1\n+  name: firebaseKey\n+  displayName: Download Firebase Service Account Key File\n+  inputs:\n+    secureFile: b4ed35b0-bb20-4830-8a21-2297e3de7fa1\n+    retryCount: 5\n+- task: PowerShell@2\n+  displayName: Uninstall gcloud\n+  inputs:\n+    targetType: inline\n+    script: >+\n+      gcloud -v\n+\n+\n+      $sdkRoot = gcloud info --format='value(installation.sdk_root)'\n+\n+      $sdkConfig = gcloud info --format='value(config.paths.global_config_dir)'\n+\n+\n+      $sdkRoot\n+\n+      $sdkConfig\n+\n+\n+      Remove-Item $sdkRoot -Recurse -Force\n+\n+      Remove-Item $sdkConfig -Recurse -Force\n+\n+\n+- task: PowerShell@2\n+  displayName: Install Google Cloud\n+  inputs:\n+    targetType: inline\n+    script: >-\n+      Write-Output \"Downloading gcloud sdk with version 320.0.0\"\n+\n+\n+      $downloadLink = \"https://dl.google.com/dl/cloudsdk/channels/rapid/downloads/google-cloud-sdk-320.0.0-windows-x86-bundled-python.zip\"\n+\n+\n+      Write-Output \"Using download link: $downloadLink\"\n+\n+\n+      $dest = \"$env:Temp\\GoogleCloudSDKInstaller.zip\"\n+\n+      (New-Object Net.WebClient).DownloadFile($downloadLink, $dest)\n+\n+\n+      Write-Output \"Extracting gcloud archive on machine....\"\n+\n+\n+      Expand-Archive -Path $dest -DestinationPath .\\gcloud-extracted\n+\n+\n+      Write-Output \"Finished extracting gcloud archive on machine....\"\n+\n+      Write-Output \"Install gcloud sdk on machine in quiet mode....\"\n+\n+      .\\gcloud-extracted\\google-cloud-sdk\\install.bat -q\n+\n+\n+      $baseDir = pwd\n+\n+      $gcloudDir = \"$baseDir\\gcloud-extracted\\google-cloud-sdk\\bin\"\n+\n+      Write-Output \"gcloud bin dir: $gcloudDir\"\n+\n+      Write-Output \"path: $env:path\"\n+\n+      Write-Output \"Setting gcloud to path\"\n+\n+      Write-Host \"##vso[task.setvariable variable=PATH;]${env:PATH};$gcloudDir\";\n+- task: PowerShell@2\n+  displayName: Google Cloud Init\n+  inputs:\n+    targetType: inline\n+    script: >-\n+      Write-Output \"path: $env:path\"\n+\n+      gcloud auth activate-service-account --key-file $(firebaseKey.secureFilePath)\n+\n+      gcloud init\n+\n+      gcloud version\n+\n+      gcloud config set project $(gcloud_project_id)\n+\n+      gcloud firebase test android models list\n\\ No newline at end of file"
  },
  {
    "sha": "e1c6616daa0a195db1343f603ec9cd8b1368fcff",
    "filename": "azure-pipelines/vsts-releases/common.yml",
    "status": "added",
    "additions": 61,
    "deletions": 0,
    "changes": 61,
    "blob_url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/blob/2d703bfff4625f5df03fdf1b9419df00679ccda2/azure-pipelines/vsts-releases/common.yml",
    "raw_url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/raw/2d703bfff4625f5df03fdf1b9419df00679ccda2/azure-pipelines/vsts-releases/common.yml",
    "contents_url": "https://api.github.com/repos/AzureAD/microsoft-authentication-library-common-for-android/contents/azure-pipelines/vsts-releases/common.yml?ref=2d703bfff4625f5df03fdf1b9419df00679ccda2",
    "patch": "@@ -0,0 +1,61 @@\n+# 'Allow scripts to access the OAuth token' was selected in pipeline.  Add the following YAML to any steps requiring access:\n+#       env:\n+#           MY_ACCESS_TOKEN: $(System.AccessToken)\n+# Variable 'android:serverUrl' was defined in the Variables tab\n+# Variable 'ENV_VSTS_MVN_ANDROIDCOMMON_USERNAME' was defined in the Variables tab\n+# Variable 'mvnAccessToken' was defined in the Variables tab\n+# Variable 'test_repo_branch' was defined in the Variables tab\n+# Variable 'test_repo_dir' was defined in the Variables tab\n+name: $(date:yyyyMMdd)$(rev:.r)\n+resources:\n+  repositories:\n+  - repository: self\n+    type: git\n+    ref: master\n+jobs:\n+- job: Phase_1\n+  displayName: Phase 1\n+  cancelTimeoutInMinutes: 1\n+  pool:\n+    name: Hosted Windows 2019 with VS2019\n+  steps:\n+  - checkout: self\n+    clean: true\n+    submodules: recursive\n+    persistCredentials: True\n+  - task: CmdLine@1\n+    displayName: Set MVN AccessToken in Environment\n+    inputs:\n+      filename: echo\n+      arguments: '##vso[task.setvariable variable=ENV_VSTS_MVN_ANDROIDCOMMON_ACCESSTOKEN]$(mvnAccessToken)'\n+  - template: ../templates/steps/credscan-policheck.yml\n+    parameters:\n+      policheckCmdLineArgsDir: adal\n+  - task: Gradle@1\n+    name: Gradle1\n+    displayName: Assemble Release\n+    inputs:\n+      tasks: 'clean  common:assembleRelease '\n+      publishJUnitResults: false\n+      jdkArchitecture: x86\n+      sqAnalysisBreakBuildIfQualityGateFailed: false\n+  - task: Gradle@2\n+    displayName: Publish\n+    inputs:\n+      tasks: common:publish\n+      publishJUnitResults: false\n+  - task: CopyFiles@2\n+    name: CopyFiles1\n+    displayName: Copy Files to Artifact Staging Directory\n+    inputs:\n+      SourceFolder: common\\build\\\n+      TargetFolder: $(build.artifactstagingdirectory)\n+  - task: PublishPipelineArtifact@1\n+    name: PublishPipelineArtifacts1\n+    displayName: 'Publish Artifact: Common Release'\n+    inputs:\n+      ArtifactName: CommonRelease\n+      TargetPath: '\\\\my\\share\\$(Build.DefinitionName)\\$(Build.BuildNumber)'\n+  - task: ComponentGovernanceComponentDetection@0\n+    displayName: Component Detection\n+..."
  },
  {
    "sha": "1b15420456b62d3a97277075c9b0035d7cad0a1a",
    "filename": "changelog.txt",
    "status": "modified",
    "additions": 1,
    "deletions": 0,
    "changes": 1,
    "blob_url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/blob/2d703bfff4625f5df03fdf1b9419df00679ccda2/changelog.txt",
    "raw_url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/raw/2d703bfff4625f5df03fdf1b9419df00679ccda2/changelog.txt",
    "contents_url": "https://api.github.com/repos/AzureAD/microsoft-authentication-library-common-for-android/contents/changelog.txt?ref=2d703bfff4625f5df03fdf1b9419df00679ccda2",
    "patch": "@@ -1,5 +1,6 @@\n V.Next\n ----------\n+- [MINOR] Converting Classic Azure DevOps Pipelines to YAML (#1274)\n - [MINOR] Enables removeAccount api to remove account records from all environments (#1248)\n - [PATCH] Fix interrupt flow when no login hint is provided (#1490)\n - [MINOR] Added logging functionality to track the request status (#1237)"
  }
]

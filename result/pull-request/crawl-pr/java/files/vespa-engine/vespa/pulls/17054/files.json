[
  {
    "sha": "8a6f2cf9e87398bfde246c452e25cf4656e48951",
    "filename": "container-search/src/main/antlr4/com/yahoo/search/yql/yqlplus.g4",
    "status": "modified",
    "additions": 1,
    "deletions": 1,
    "changes": 2,
    "blob_url": "https://github.com/vespa-engine/vespa/blob/db2d6cb239ad41677950b21750c5fc51a61f6100/container-search/src/main/antlr4/com/yahoo/search/yql/yqlplus.g4",
    "raw_url": "https://github.com/vespa-engine/vespa/raw/db2d6cb239ad41677950b21750c5fc51a61f6100/container-search/src/main/antlr4/com/yahoo/search/yql/yqlplus.g4",
    "contents_url": "https://api.github.com/repos/vespa-engine/vespa/contents/container-search/src/main/antlr4/com/yahoo/search/yql/yqlplus.g4?ref=db2d6cb239ad41677950b21750c5fc51a61f6100",
    "patch": "@@ -221,7 +221,7 @@ ident\n keyword_as_ident\n    : SELECT | TABLE | DELETE | INTO | VALUES | LIMIT | OFFSET | WHERE | 'order' | 'by' | DESC | MERGE | LEFT | JOIN\n    | ON | OUTPUT | COUNT | BEGIN | END | APPLY | TYPE_BYTE | TYPE_INT16 | TYPE_INT32 | TYPE_INT64 | TYPE_BOOLEAN | TYPE_TIMESTAMP | TYPE_DOUBLE | TYPE_STRING | TYPE_ARRAY | TYPE_MAP\n-   | VIEW | CREATE | IMPORT | PROGRAM | NEXT | PAGED | SOURCES | SET | MATCHES | LIKE\n+   | VIEW | CREATE | IMPORT | PROGRAM | NEXT | PAGED | SOURCES | SET | MATCHES | LIKE | CAST\n    ;\n \n program : params? (import_statement SEMI)* (ddl SEMI)* (statement SEMI)* EOF"
  },
  {
    "sha": "d410cedc744bdacedc6b29fe0dd882aeb0b86acc",
    "filename": "container-search/src/test/java/com/yahoo/search/yql/YqlParserTestCase.java",
    "status": "modified",
    "additions": 6,
    "deletions": 0,
    "changes": 6,
    "blob_url": "https://github.com/vespa-engine/vespa/blob/db2d6cb239ad41677950b21750c5fc51a61f6100/container-search/src/test/java/com/yahoo/search/yql/YqlParserTestCase.java",
    "raw_url": "https://github.com/vespa-engine/vespa/raw/db2d6cb239ad41677950b21750c5fc51a61f6100/container-search/src/test/java/com/yahoo/search/yql/YqlParserTestCase.java",
    "contents_url": "https://api.github.com/repos/vespa-engine/vespa/contents/container-search/src/test/java/com/yahoo/search/yql/YqlParserTestCase.java?ref=db2d6cb239ad41677950b21750c5fc51a61f6100",
    "patch": "@@ -128,6 +128,12 @@ public void test() {\n                     \"title:madonna\");\n     }\n \n+    @Test\n+    public void testKeywordAsFieldName() {\n+        assertParse(\"select * from sources * where cast contains sameElement(id contains '16');\",\n+                    \"cast:{id:16}\");\n+    }\n+\n     @Test\n     public void testComplexExpression() {\n         String queryTreeYql = \"rank((((filter contains ([{\\\"origin\\\": {\\\"original\\\": \\\"filter:VideoAdsCappingTestCPM\\\", \\\"offset\\\": 7, \\\"length\\\": 22}, \\\"normalizeCase\\\": false, \\\"id\\\": 1}]\\\"videoadscappingtestcpm\\\") AND hasRankRestriction contains ([{\\\"normalizeCase\\\": false, \\\"implicitTransforms\\\": false, \\\"id\\\": 2}]\\\"0\\\") AND ((objective contains ([{\\\"normalizeCase\\\": false, \\\"implicitTransforms\\\": false, \\\"id\\\": 3}]\\\"install_app\\\") AND availableExtendedFields contains ([{\\\"normalizeCase\\\": false, \\\"implicitTransforms\\\": false, \\\"id\\\": 4}]\\\"cpiparams\\\")) OR (availableExtendedFields contains ([{\\\"normalizeCase\\\": false, \\\"implicitTransforms\\\": false, \\\"id\\\": 5}]\\\"appinstallinfo\\\") AND availableExtendedFields contains ([{\\\"normalizeCase\\\": false, \\\"implicitTransforms\\\": false, \\\"id\\\": 6}]\\\"appmetroplexinfo\\\")) OR (dummyField contains ([{\\\"normalizeCase\\\": false, \\\"implicitTransforms\\\": false, \\\"id\\\": 7}]\\\"default\\\")) AND !(objective contains ([{\\\"normalizeCase\\\": false, \\\"implicitTransforms\\\": false, \\\"id\\\": 8}]\\\"install_app\\\"))) AND advt_age = ([{\\\"id\\\": 9}]2147483647) AND advt_gender contains ([{\\\"normalizeCase\\\": false, \\\"implicitTransforms\\\": false, \\\"id\\\": 10}]\\\"all\\\") AND advt_all_segments = ([{\\\"id\\\": 11}]2147483647) AND advt_keywords contains ([{\\\"normalizeCase\\\": false, \\\"implicitTransforms\\\": false, \\\"id\\\": 12}]\\\"all\\\") AND advMobilePlatform = ([{\\\"id\\\": 13}]2147483647) AND advMobileDeviceType = ([{\\\"id\\\": 14}]2147483647) AND advMobileCon = ([{\\\"id\\\": 15}]2147483647) AND advMobileOSVersions = ([{\\\"id\\\": 16}]2147483647) AND advCarrier = ([{\\\"id\\\": 17}]2147483647) AND ([{\\\"id\\\": 18}]weightedSet(advt_supply, {\\\"all\\\": 1, \\\"pub223\\\": 1, \\\"sec223\\\": 1, \\\"site223\\\": 1})) AND (advt_day_parting contains ([{\\\"normalizeCase\\\": false, \\\"implicitTransforms\\\": false, \\\"id\\\": 19, \\\"weight\\\": 1}]\\\"adv_tuesday\\\") OR advt_day_parting contains ([{\\\"normalizeCase\\\": false, \\\"implicitTransforms\\\": false, \\\"id\\\": 20, \\\"weight\\\": 1}]\\\"adv_tuesday_17\\\") OR advt_day_parting contains ([{\\\"normalizeCase\\\": false, \\\"implicitTransforms\\\": false, \\\"id\\\": 21, \\\"weight\\\": 1}]\\\"adv_tuesday_17_forty_five\\\") OR advt_day_parting contains ([{\\\"normalizeCase\\\": false, \\\"implicitTransforms\\\": false, \\\"id\\\": 22}]\\\"all\\\")) AND isAppReengagementAd = ([{\\\"id\\\": 23}]0) AND dummyField contains ([{\\\"normalizeCase\\\": false, \\\"implicitTransforms\\\": false, \\\"id\\\": 24}]\\\"default\\\") AND serveWithPromotionOnly = ([{\\\"id\\\": 26}]0) AND budgetAdvertiserThrottleRateFilter = ([{\\\"id\\\": 27}]0) AND budgetResellerThrottleRateFilter = ([{\\\"id\\\": 28}]0) AND (isMystiqueRequired = ([{\\\"id\\\": 29}]0) OR (isMystiqueRequired = ([{\\\"id\\\": 30}]1) AND useBcFactorFilter = ([{\\\"id\\\": 31}]1))) AND (((budgetCampaignThrottleRateBits = ([{\\\"id\\\": 32}]55) AND dummyField contains ([{\\\"normalizeCase\\\": false, \\\"implicitTransforms\\\": false, \\\"id\\\": 33}]\\\"default\\\"))) AND !(useBcFactorFilter = ([{\\\"id\\\": 34}]1)) OR ((useBcFactorFilter = ([{\\\"id\\\": 35}]1) AND dummyField contains ([{\\\"normalizeCase\\\": false, \\\"implicitTransforms\\\": false, \\\"id\\\": 36}]\\\"default\\\") AND (bcFactorTiers = ([{\\\"id\\\": 38}]127) OR bcFactorTiers = ([{\\\"id\\\": 39}]0)) AND ((firstPriceEnforced = ([{\\\"id\\\": 40}]0) AND (secondPriceEnforced = ([{\\\"id\\\": 41}]1) OR isPrivateDeal = ([{\\\"id\\\": 42}]0) OR (dummyField contains ([{\\\"normalizeCase\\\": false, \\\"implicitTransforms\\\": false, \\\"id\\\": 43}]\\\"default\\\")) AND !(bcActiveTier = ([{\\\"id\\\": 44}]0)))) OR mystiqueCampaignThrottleRateBits = ([{\\\"id\\\": 45}]18)))) AND !(isOutOfDailyBudget = ([{\\\"id\\\": 37}]1))) AND testCreative = ([{\\\"id\\\": 46}]0) AND advt_geo = ([{\\\"id\\\": 47}]2147483647) AND ((adType contains ([{\\\"normalizeCase\\\": false, \\\"implicitTransforms\\\": false, \\\"id\\\": 48}]\\\"strm_video\\\") AND isPortraitVideo = ([{\\\"id\\\": 49}]0)) OR adType contains ([{\\\"normalizeCase\\\": false, \\\"implicitTransforms\\\": false, \\\"id\\\": 50}]\\\"stream_ad\\\")) AND ((isCPM = ([{\\\"id\\\": 51}]0) AND isOCPC = ([{\\\"id\\\": 52}]0) AND isECPC = ([{\\\"id\\\": 53}]0) AND ((priceType contains ([{\\\"normalizeCase\\\": false, \\\"implicitTransforms\\\": false, \\\"id\\\": 54}]\\\"cpcv\\\") AND bid >= ([{\\\"id\\\": 55}]0.005)) OR (priceType contains ([{\\\"normalizeCase\\\": false, \\\"implicitTransforms\\\": false, \\\"id\\\": 56}]\\\"cpv\\\") AND bid >= ([{\\\"id\\\": 57}]0.01)) OR (priceType contains ([{\\\"normalizeCase\\\": false, \\\"implicitTransforms\\\": false, \\\"id\\\": 58}]\\\"cpc\\\") AND bid >= ([{\\\"id\\\": 59}]0.05)) OR (objective contains ([{\\\"normalizeCase\\\": false, \\\"implicitTransforms\\\": false, \\\"id\\\": 60}]\\\"promote_content\\\") AND bid >= ([{\\\"id\\\": 61}]0.01)) OR hasFloorPriceUsd = ([{\\\"id\\\": 62}]1))) OR isECPC = ([{\\\"id\\\": 63}]1) OR (isCPM = ([{\\\"id\\\": 64}]1) AND isOCPM = ([{\\\"id\\\": 65}]0) AND (([{\\\"id\\\": 66}]range(bid, 0.25, Infinity)) OR hasFloorPriceUsd = ([{\\\"id\\\": 67}]1)))) AND start_date <= ([{\\\"id\\\": 68}]1572976776299L) AND end_date >= ([{\\\"id\\\": 69}]1572976776299L))) AND !(isHoldoutAd = ([{\\\"id\\\": 25}]1))) AND !((disclaimerExtensionsTypes contains ([{\\\"normalizeCase\\\": false, \\\"implicitTransforms\\\": false, \\\"id\\\": 70}]\\\"pharma\\\") OR ([{\\\"id\\\": 71}]weightedSet(exclusion_advt_supply, {\\\"extsite223\\\": 1, \\\"pub223\\\": 1, \\\"sec223\\\": 1, \\\"site223\\\": 1})) OR isPersonalized = ([{\\\"id\\\": 72}]1) OR blocked_section_ids contains ([{\\\"normalizeCase\\\": false, \\\"implicitTransforms\\\": false, \\\"id\\\": 73}]\\\"223\\\") OR blocked_publisher_ids contains ([{\\\"normalizeCase\\\": false, \\\"implicitTransforms\\\": false, \\\"id\\\": 74}]\\\"223\\\") OR blocked_site_ids contains ([{\\\"normalizeCase\\\": false, \\\"implicitTransforms\\\": false, \\\"id\\\": 75}]\\\"223\\\"))), [{\\\"id\\\": 76, \\\"label\\\": \\\"ad_ocpc_max_cpc\\\"}]dotProduct(ocpc_max_cpc, {\\\"0\\\": 1}), [{\\\"id\\\": 77, \\\"label\\\": \\\"ad_ocpc_min_cpc\\\"}]dotProduct(ocpc_min_cpc, {\\\"0\\\": 1}), [{\\\"id\\\": 78, \\\"label\\\": \\\"ad_ocpc_max_alpha\\\"}]dotProduct(ocpc_max_alpha, {\\\"0\\\": 1}), [{\\\"id\\\": 79, \\\"label\\\": \\\"ad_ocpc_min_alpha\\\"}]dotProduct(ocpc_min_alpha, {\\\"0\\\": 1}), [{\\\"id\\\": 80, \\\"label\\\": \\\"ad_ocpc_alpha_0\\\"}]dotProduct(ocpc_alpha_0, {\\\"0\\\": 1}), [{\\\"id\\\": 81, \\\"label\\\": \\\"ad_ocpc_alpha_1\\\"}]dotProduct(ocpc_alpha_1, {\\\"0\\\": 1}), (bidAdjustmentDayParting contains ([{\\\"normalizeCase\\\": false, \\\"implicitTransforms\\\": false, \\\"id\\\": 82, \\\"weight\\\": 1}]\\\"adv_tuesday\\\") OR bidAdjustmentDayParting contains ([{\\\"normalizeCase\\\": false, \\\"implicitTransforms\\\": false, \\\"id\\\": 83, \\\"weight\\\": 1}]\\\"adv_tuesday_17\\\") OR bidAdjustmentDayParting contains ([{\\\"normalizeCase\\\": false, \\\"implicitTransforms\\\": false, \\\"id\\\": 84, \\\"weight\\\": 1}]\\\"adv_tuesday_17_forty_five\\\") OR bidAdjustmentDayPartingForCostCap contains ([{\\\"normalizeCase\\\": false, \\\"implicitTransforms\\\": false, \\\"id\\\": 85, \\\"weight\\\": 1}]\\\"adv_tuesday\\\") OR bidAdjustmentDayPartingForCostCap contains ([{\\\"normalizeCase\\\": false, \\\"implicitTransforms\\\": false, \\\"id\\\": 86, \\\"weight\\\": 1}]\\\"adv_tuesday_17\\\") OR bidAdjustmentDayPartingForCostCap contains ([{\\\"normalizeCase\\\": false, \\\"implicitTransforms\\\": false, \\\"id\\\": 87, \\\"weight\\\": 1}]\\\"adv_tuesday_17_forty_five\\\")), bidAdjustmentForCpi = ([{\\\"id\\\": 88, \\\"weight\\\": 1}]223), [{\\\"id\\\": 89, \\\"label\\\": \\\"boostingForBackfill\\\"}]dotProduct(boostingForBackfill, {\\\"priority\\\": 1000})) limit 0 timeout 3980 | all(group(adTypeForGrouping) each(group(advertiser_id) max(11) output(count() as(groupingCounter)) each(max(1) each(output(summary())))))\";"
  }
]
